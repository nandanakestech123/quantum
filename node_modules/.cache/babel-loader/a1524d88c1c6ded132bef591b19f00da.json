{"ast":null,"code":"import _objectSpread from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"./style.scss\";import{IssuedStaff}from\"./modal\";import{NormalInput,NormalButton,NormalModal,TableWrapper}from\"component/common\";import{getCommonApi,updateForm,commonCreateApi,commonDeleteApi,commonPatchApi}from\"redux/actions/common\";import{Toast}from\"service/toast\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{history}from\"helpers\";import{CreateHoldItem}from\"redux/actions/customer\";export var HoldSectionClass=/*#__PURE__*/function(_Component){_inherits(HoldSectionClass,_Component);var _super=_createSuper(HoldSectionClass);function HoldSectionClass(){var _this;_classCallCheck(this,HoldSectionClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={activeTab:\"\",headerDetails:[{label:\"Date\",sortKey:false,width:\"70px\"},{label:\"Transaction #\",width:\"180px\"},{label:\"Item Name\",sortKey:false,width:\"150px\"},{label:\"Item Code\",sortKey:false,width:\"150px\"},{label:\"Qty Hold\",sortKey:false,width:\"100px\"},{label:\"Qty issued\",sortKey:false,width:\"100px\"},{label:\"Staff issued\",sortKey:false,width:\"100px\"}],accountList:[],accountHeader:{},isIssued:false,isWarning:false,Staffid:0,holdItem:{},formData:[],downloadlLink:\"\",isPrint:false};_this.toggle=function(tab){if(_this.state.activeTab!==tab){_this.setState({activeTab:tab});}};_this.modalclose=function(){_this.setState({isIssued:!_this.state.isIssued});};_this.getAccountData=function(){var accountHeader=_this.state.accountHeader;_this.props.getCommonApi(\"holditem/?cust_id=\".concat(_this.props.id)).then(function(key){var data=key.data,header_data=key.header_data;var accountList=_this.state.accountList;accountList=data;accountHeader=header_data;_this.setState({accountList:accountList,accountHeader:accountHeader});});};_this.handleissuedstaff=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(item){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.setState({holdItem:item});case 2:if(item.check==\"fullpay\"){_this.setState({isIssued:!_this.state.isIssued});}else{_this.setState({isWarning:!_this.state.isWarning});}case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.proceedtoissuedstaff=function(){_this.setState({isWarning:!_this.state.isWarning,isIssued:!_this.state.isIssued});};_this.denyissuedstaff=function(){_this.setState({isWarning:!_this.state.isWarning});};_this.issuedlisttableupdate=function(holdData){var accountList=_this.state.accountList;var filterList=accountList.find(function(account){return account.id===holdData.id;});filterList[\"qty_issued\"]=holdData.issueQty;filterList[\"staff_issued\"]=holdData.emp_name;filterList[\"emp_id\"]=holdData.emp_id;filterList[\"emp_name\"]=holdData.emp_name;_this.setState(_objectSpread(_objectSpread({},_this.state.accountList),{},{filterList:filterList}));};_this.issuedlistupdate=function(holdData){var formData=_this.state.formData;var filterList=formData.find(function(account){return account.id===holdData.id;});if(filterList){filterList[\"id\"]=holdData.id;filterList[\"issued_qty\"]=holdData.issueQty;filterList[\"emp_id\"]=holdData.emp_id;_this.setState(_objectSpread(_objectSpread({},_this.state.formData),{},{filterList:filterList}));}else{var data={};data[\"id\"]=holdData.id;data[\"issued_qty\"]=holdData.issueQty;data[\"emp_id\"]=holdData.emp_id;formData.push(data);_this.setState(_objectSpread(_objectSpread({},_this.state.formData),{},{formData:formData}));}};_this.handlePrint=function(){_this.setState({isPrint:false});window.open(_this.state.downloadlLink);};_this.onSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var formData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:formData=_this.state.formData;if(!(formData.length>0)){_context3.next=6;break;}_context3.next=4;return _this.props.CreateHoldItem(formData).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(res.status===200){Toast({type:\"success\",message:res.message});_this.setState({downloadlLink:res.data,isPrint:true,formData:[]});_this.getAccountData();}else{Toast({type:\"error\",message:res.message});}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());case 4:_context3.next=7;break;case 6:Toast({type:\"error\",message:\"There is no record to update\"});case 7:case\"end\":return _context3.stop();}}},_callee3);}));return _this;}_createClass(HoldSectionClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.getAccountData();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,headerDetails=_this$state.headerDetails,_this$state$accountLi=_this$state.accountList,accountList=_this$state$accountLi===void 0?[]:_this$state$accountLi,activeTab=_this$state.activeTab,isIssued=_this$state.isIssued,isWarning=_this$state.isWarning,Staffid=_this$state.Staffid,_this$state$holdItem=_this$state.holdItem,holdItem=_this$state$holdItem===void 0?{}:_this$state$holdItem,downloadlLink=_this$state.downloadlLink,isPrint=_this$state.isPrint;return/*#__PURE__*/React.createElement(\"div\",{className:\"treatment-account row mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table\"},activeTab!==\"detail\"?/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination},accountList&&accountList.length>0?accountList.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.sa_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.sa_transacno_ref)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.hi_itemdesc)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.itemno)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.holditemqty)),/*#__PURE__*/React.createElement(\"td\",{onClick:function onClick(){return _this2.handleissuedstaff(item);}},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center cursor-pointer\"},item.qty_issued)),/*#__PURE__*/React.createElement(\"td\",{onClick:function onClick(){return _this2.handleissuedstaff(item);}},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.staff_issued)));}):\"\"):\"\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.onSubmit();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},\" \",\"Issued\",\" \"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isIssued?/*#__PURE__*/React.createElement(IssuedStaff,{isIssued:isIssued,key:holdItem.id,toggle:this.modalclose,holdItem:holdItem,handleModal:this.handleissuedstaff,issuedlistupdate:this.issuedlistupdate,issuedlisttableupdate:this.issuedlisttableupdate}):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isWarning?/*#__PURE__*/React.createElement(React.Fragment,null,\" \",/*#__PURE__*/React.createElement(NormalModal,{style:{minWidth:\"280px\"},modal:isWarning,handleModal:this.toggle},/*#__PURE__*/React.createElement(\"div\",{className:\"row new-cart issued-staff p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,\"Product have outstanding, Are you sure you want to issued ?\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.proceedtoissuedstaff();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},\" \",\"Yes\",\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.denyissuedstaff();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},\" \",\"No\",\" \")))))),\" \"):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isPrint?/*#__PURE__*/React.createElement(React.Fragment,null,\" \",/*#__PURE__*/React.createElement(NormalModal,{style:{minWidth:\"280px\"},modal:isPrint,handleModal:this.toggle},/*#__PURE__*/React.createElement(\"div\",{className:\"row new-cart issued-staff p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,\"Do you want to print ?\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.handlePrint();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},\" \",\"Yes\",\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.setState({isPrint:false});},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},\" \",\"No\",\" \")))))),\" \"):\"\"));}}]);return HoldSectionClass;}(Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCommonApi:getCommonApi,updateForm:updateForm,commonCreateApi:commonCreateApi,commonPatchApi:commonPatchApi,commonDeleteApi:commonDeleteApi,CreateHoldItem:CreateHoldItem},dispatch);};export var Hold=connect(null,mapDispatchToProps)(HoldSectionClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Customer/CustomerDetails/HoldSection/Hold.js"],"names":["React","Component","IssuedStaff","NormalInput","NormalButton","NormalModal","TableWrapper","getCommonApi","updateForm","commonCreateApi","commonDeleteApi","commonPatchApi","Toast","connect","bindActionCreators","history","CreateHoldItem","HoldSectionClass","state","activeTab","headerDetails","label","sortKey","width","accountList","accountHeader","isIssued","isWarning","Staffid","holdItem","formData","downloadlLink","isPrint","toggle","tab","setState","modalclose","getAccountData","props","id","then","key","data","header_data","handleissuedstaff","item","check","proceedtoissuedstaff","denyissuedstaff","issuedlisttableupdate","holdData","filterList","find","account","issueQty","emp_name","emp_id","issuedlistupdate","push","handlePrint","window","open","onSubmit","length","res","status","type","message","handlePagination","map","index","sa_date","sa_transacno_ref","hi_itemdesc","itemno","holditemqty","qty_issued","staff_issued","minWidth","mapDispatchToProps","dispatch","Hold"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport { IssuedStaff } from \"./modal\";\r\nimport {\r\n  NormalInput,\r\n  NormalButton,\r\n  NormalModal,\r\n  TableWrapper,\r\n} from \"component/common\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonCreateApi,\r\n  commonDeleteApi,\r\n  commonPatchApi,\r\n} from \"redux/actions/common\";\r\nimport { Toast } from \"service/toast\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { history } from \"helpers\";\r\nimport { CreateHoldItem } from \"redux/actions/customer\";\r\n\r\nexport class HoldSectionClass extends Component {\r\n  state = {\r\n    activeTab: \"\",\r\n    headerDetails: [\r\n      { label: \"Date\", sortKey: false, width: \"70px\" },\r\n      { label: \"Transaction #\", width: \"180px\" },\r\n      { label: \"Item Name\", sortKey: false, width: \"150px\" },\r\n      { label: \"Item Code\", sortKey: false, width: \"150px\" },\r\n      { label: \"Qty Hold\", sortKey: false, width: \"100px\" },\r\n      { label: \"Qty issued\", sortKey: false, width: \"100px\" },\r\n      { label: \"Staff issued\", sortKey: false, width: \"100px\" },\r\n    ],\r\n    accountList: [],\r\n    accountHeader: {},\r\n    isIssued: false,\r\n    isWarning: false,\r\n    Staffid: 0,\r\n    holdItem: {},\r\n    formData: [],\r\n    downloadlLink: \"\",\r\n    isPrint: false,\r\n  };\r\n\r\n  toggle = tab => {\r\n    if (this.state.activeTab !== tab) {\r\n      this.setState({\r\n        activeTab: tab,\r\n      });\r\n    }\r\n  };\r\n  modalclose = () => {\r\n    this.setState({ isIssued: !this.state.isIssued });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getAccountData();\r\n  }\r\n\r\n  getAccountData = () => {\r\n    let { accountHeader } = this.state;\r\n    this.props.getCommonApi(`holditem/?cust_id=${this.props.id}`).then(key => {\r\n      let { data, header_data } = key;\r\n      let { accountList } = this.state;\r\n      accountList = data;\r\n      accountHeader = header_data;\r\n      this.setState({ accountList, accountHeader });\r\n    });\r\n  };\r\n\r\n  handleissuedstaff = async item => {\r\n    await this.setState({\r\n      holdItem: item,\r\n    });\r\n\r\n    if (item.check == \"fullpay\") {\r\n      this.setState({\r\n        isIssued: !this.state.isIssued,\r\n      });\r\n    } else {\r\n      this.setState({\r\n        isWarning: !this.state.isWarning,\r\n      });\r\n    }\r\n  };\r\n\r\n  proceedtoissuedstaff = () => {\r\n    this.setState({\r\n      isWarning: !this.state.isWarning,\r\n      isIssued: !this.state.isIssued,\r\n    });\r\n  };\r\n\r\n  denyissuedstaff = () => {\r\n    this.setState({\r\n      isWarning: !this.state.isWarning,\r\n    });\r\n  };\r\n\r\n  issuedlisttableupdate = holdData => {\r\n    let { accountList } = this.state;\r\n    let filterList = accountList.find(account => account.id === holdData.id);\r\n    filterList[\"qty_issued\"] = holdData.issueQty;\r\n    filterList[\"staff_issued\"] = holdData.emp_name;\r\n    filterList[\"emp_id\"] = holdData.emp_id;\r\n    filterList[\"emp_name\"] = holdData.emp_name;\r\n    this.setState({ ...this.state.accountList, filterList });\r\n  };\r\n\r\n  issuedlistupdate = holdData => {\r\n    let { formData } = this.state;\r\n    let filterList = formData.find(account => account.id === holdData.id);\r\n    if (filterList) {\r\n      filterList[\"id\"] = holdData.id;\r\n      filterList[\"issued_qty\"] = holdData.issueQty;\r\n      filterList[\"emp_id\"] = holdData.emp_id;\r\n      this.setState({ ...this.state.formData, filterList });\r\n    } else {\r\n      let data = {};\r\n      data[\"id\"] = holdData.id;\r\n      data[\"issued_qty\"] = holdData.issueQty;\r\n      data[\"emp_id\"] = holdData.emp_id;\r\n      formData.push(data);\r\n      this.setState({ ...this.state.formData, formData });\r\n    }\r\n  };\r\n\r\n  handlePrint = () => {\r\n    this.setState({ isPrint: false });\r\n    window.open(this.state.downloadlLink);\r\n  };\r\n\r\n  onSubmit = async () => {\r\n    let { formData } = this.state;\r\n    if (formData.length > 0) {\r\n      await this.props.CreateHoldItem(formData).then(async res => {\r\n        if (res.status === 200) {\r\n          Toast({ type: \"success\", message: res.message });\r\n          this.setState({\r\n            downloadlLink: res.data,\r\n            isPrint: true,\r\n            formData: [],\r\n          });\r\n          this.getAccountData();\r\n        } else {\r\n          Toast({ type: \"error\", message: res.message });\r\n        }\r\n      });\r\n    } else {\r\n      Toast({ type: \"error\", message: \"There is no record to update\" });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      headerDetails,\r\n      accountList = [],\r\n      activeTab,\r\n      isIssued,\r\n      isWarning,\r\n      Staffid,\r\n      holdItem = {},\r\n      downloadlLink,\r\n      isPrint,\r\n    } = this.state;\r\n    return (\r\n      <div className=\"treatment-account row mt-3\">\r\n        <div className=\"col-12\">\r\n          <div className=\"table\">\r\n            {activeTab !== \"detail\" ? (\r\n              <TableWrapper\r\n                headerDetails={headerDetails}\r\n                queryHandler={this.handlePagination}\r\n              >\r\n                {accountList && accountList.length > 0\r\n                  ? accountList.map((item, index) => {\r\n                      return (\r\n                        <tr key={index}>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.sa_date}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.sa_transacno_ref}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.hi_itemdesc}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.itemno}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.holditemqty}\r\n                            </div>\r\n                          </td>\r\n                          <td onClick={() => this.handleissuedstaff(item)}>\r\n                            <div className=\"d-flex align-items-center justify-content-center cursor-pointer\">\r\n                              {item.qty_issued}\r\n                            </div>\r\n                          </td>\r\n                          <td onClick={() => this.handleissuedstaff(item)}>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              {item.staff_issued}\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  : \"\"}\r\n              </TableWrapper>\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          <div className=\"col-4\">\r\n            <button\r\n              onClick={() => this.onSubmit()}\r\n              className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n            >\r\n              {\" \"}\r\n              Issued{\" \"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isIssued ? (\r\n            <IssuedStaff\r\n              isIssued={isIssued}\r\n              key={holdItem.id}\r\n              toggle={this.modalclose}\r\n              holdItem={holdItem}\r\n              handleModal={this.handleissuedstaff}\r\n              issuedlistupdate={this.issuedlistupdate}\r\n              issuedlisttableupdate={this.issuedlisttableupdate}\r\n            />\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isWarning ? (\r\n            <>\r\n              {\" \"}\r\n              <NormalModal\r\n                style={{ minWidth: \"280px\" }}\r\n                modal={isWarning}\r\n                handleModal={this.toggle}\r\n              >\r\n                <div className=\"row new-cart issued-staff p-3\">\r\n                  <div className=\"col-12\">\r\n                    <div>\r\n                      <p>\r\n                        Product have outstanding, Are you sure you want to\r\n                        issued ?\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-12 p-3\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.proceedtoissuedstaff()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {\" \"}\r\n                          Yes{\" \"}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.denyissuedstaff()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {\" \"}\r\n                          No{\" \"}\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </NormalModal>{\" \"}\r\n            </>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isPrint ? (\r\n            <>\r\n              {\" \"}\r\n              <NormalModal\r\n                style={{ minWidth: \"280px\" }}\r\n                modal={isPrint}\r\n                handleModal={this.toggle}\r\n              >\r\n                <div className=\"row new-cart issued-staff p-3\">\r\n                  <div className=\"col-12\">\r\n                    <div>\r\n                      <p>Do you want to print ?</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-12 p-3\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.handlePrint()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {\" \"}\r\n                          Yes{\" \"}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.setState({ isPrint: false })}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {\" \"}\r\n                          No{\" \"}\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </NormalModal>{\" \"}\r\n            </>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      updateForm,\r\n      commonCreateApi,\r\n      commonPatchApi,\r\n      commonDeleteApi,\r\n      CreateHoldItem,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Hold = connect(null, mapDispatchToProps)(HoldSectionClass);\r\n"]},"metadata":{},"sourceType":"module"}