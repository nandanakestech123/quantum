{"ast":null,"code":"import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _defineProperty from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{NormalInput,NormalSelect,NormalButton,NormalDate,NormalModal,TableWrapper}from\"component/common\";import{Toast}from\"service/toast\";import{getCommonApi,commonPatchApi}from\"redux/actions/common\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{dateFormat}from\"service/helperFunctions\";import closeIcon from\"assets/images/close.png\";import{CreateNewInventory}from\"./Model\";import\"./style.scss\";import{withTranslation}from\"react-i18next\";export var InventoryListClass=/*#__PURE__*/function(_Component){_inherits(InventoryListClass,_Component);var _super=_createSuper(InventoryListClass);function InventoryListClass(){var _this;_classCallCheck(this,InventoryListClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={searchDate:new Date(),stockMemoList:[],meta:{},stockMemoListHeader:[{label:\"Date\"},{label:\"Product\"},{label:\"Employee\"},{label:\"Qty\"},{label:\"UOM\"},{label:\"Remark\"},{label:\"Reversal\"}],isCreateNewInventoryPopup:false,isReversalPopup:false,stockMemoId:0,reversalqty:0,qty:0};_this.componentDidMount=function(){_this.getstockMemoList({});};_this.getstockMemoList=function(data){var searchDate=_this.state.searchDate;var _data$page=data.page,page=_data$page===void 0?1:_data$page,_data$limit=data.limit,limit=_data$limit===void 0?10:_data$limit,_data$search=data.search,search=_data$search===void 0?\"\":_data$search;_this.props.getCommonApi(\"stockusagememo/?date=\".concat(dateFormat(searchDate),\"&page=\").concat(page,\"&limit=\").concat(limit)).then(function(key){var status=key.status,data=key.data;if(status===200){if(data){_this.setState({stockMemoList:data.dataList,meta:data.meta.pagination});}}});};_this.handleDateChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var _ref$target,value,name;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$target=_ref.target,value=_ref$target.value,name=_ref$target.name;_context.next=3;return _this.setState(_defineProperty({},name,value));case 3:_this.getstockMemoList({});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handlePagination=function(page){_this.getstockMemoList(page);};_this.handleCreateNewPopup=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this.setState(function(prevState){return{isCreateNewInventoryPopup:!prevState.isCreateNewInventoryPopup};});case 2:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleCreateNewSave=function(){_this.handleCreateNewPopup();_this.getstockMemoList({});};_this.handleReversalPopup=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.setState(function(prevState){return{isReversalPopup:!prevState.isReversalPopup};});case 2:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleReversal=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _this.setState({stockMemoId:0,qty:0,reversalqty:0});case 2:_context4.next=4;return _this.setState({stockMemoId:data.id,qty:data.qty});case 4:_this.handleReversalPopup();case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref5.apply(this,arguments);};}();_this.handleReversalSubmitClick=function(){var _this$state=_this.state,reversalqty=_this$state.reversalqty,qty=_this$state.qty;if(reversalqty<=0||reversalqty==\"\"||reversalqty>qty){Toast({type:\"error\",message:\"Please enter valid Qty!\"});}else{_this.handleReversalUpdate();}};_this.handleReversalUpdate=function(){var _this$state2=_this.state,reversalqty=_this$state2.reversalqty,stockMemoId=_this$state2.stockMemoId;var data={quantity:Number(reversalqty)};_this.props.commonPatchApi(\"stockusagememo/\".concat(stockMemoId,\"/\"),data).then(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(res){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(res);if(res.status===200){_this.handleReversalPopup();_this.getstockMemoList({});}case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x3){return _ref6.apply(this,arguments);};}());};_this.handleChange=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref7){var _ref7$target,value,name;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_ref7$target=_ref7.target,value=_ref7$target.value,name=_ref7$target.name;_context6.next=3;return _this.setState(_defineProperty({},name,value));case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x4){return _ref8.apply(this,arguments);};}();return _this;}_createClass(InventoryListClass,[{key:\"render\",value:function render(){var _this2=this;var _this$state3=this.state,searchDate=_this$state3.searchDate,stockMemoList=_this$state3.stockMemoList,stockMemoListHeader=_this$state3.stockMemoListHeader,isCreateNewInventoryPopup=_this$state3.isCreateNewInventoryPopup,meta=_this$state3.meta,isReversalPopup=_this$state3.isReversalPopup,qty=_this$state3.qty,reversalqty=_this$state3.reversalqty;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 p-0 m-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 p-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(NormalDate,{value:new Date(searchDate),name:\"searchDate\",type:\"date\",onChange:this.handleDateChange})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 mb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"col-3\",mainbg:true,className:\"col-12 ml-4 fs-15 \",label:\"Add New\",onClick:this.handleCreateNewPopup})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container table-responsive mt-3\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:stockMemoListHeader,queryHandler:this.handlePagination,pageMeta:meta},stockMemoList&&stockMemoList.length>0?stockMemoList.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{className:\"w-100\",key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.date_out)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.item_name)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.staff_name)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.qty)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.uom)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item.memo_remarks)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:true,className:\"col-12 fs-15 \",label:\"Reversal\",onClick:function onClick(){return _this2.handleReversal(item);}}))));}):null),isReversalPopup?/*#__PURE__*/React.createElement(NormalModal,{className:\"select-category Treatment-usage\",style:{minWidth:\"25%\"},modal:isReversalPopup,handleModal:this.handleReversalPopup},/*#__PURE__*/React.createElement(\"img\",{onClick:this.handleReversalPopup,className:\"close\",src:closeIcon,alt:\"\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex h5 justify-content-center p-1\"},\"Reversal\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 mb-3\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Qty\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{value:qty,name:\"qty\",disabled:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 mb-3\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Reversal Qty\",/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs-16\"},\"*\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{value:reversalqty,name:\"reversalqty\",onChange:this.handleChange,type:\"number\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 mb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center p-4 w-100\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:true,className:\"col-12 ml-4 fs-15 \",label:\"Submit\",onClick:this.handleReversalSubmitClick}))))):null,isCreateNewInventoryPopup?/*#__PURE__*/React.createElement(CreateNewInventory,{isCreateNewInventoryPopup:isCreateNewInventoryPopup,handleCreateNewPopup:this.handleCreateNewPopup,handleCreateNewSave:this.handleCreateNewSave}):null)));}}]);return InventoryListClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCommonApi:getCommonApi,commonPatchApi:commonPatchApi},dispatch);};export var InventoryList=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(InventoryListClass));","map":{"version":3,"sources":["F:/webfe/src/component/Admin/Inventory/InventoryMainPage/InventoryList.js"],"names":["React","Component","NormalInput","NormalSelect","NormalButton","NormalDate","NormalModal","TableWrapper","Toast","getCommonApi","commonPatchApi","connect","bindActionCreators","dateFormat","closeIcon","CreateNewInventory","withTranslation","InventoryListClass","state","searchDate","Date","stockMemoList","meta","stockMemoListHeader","label","isCreateNewInventoryPopup","isReversalPopup","stockMemoId","reversalqty","qty","componentDidMount","getstockMemoList","data","page","limit","search","props","then","key","status","setState","dataList","pagination","handleDateChange","target","value","name","handlePagination","handleCreateNewPopup","prevState","handleCreateNewSave","handleReversalPopup","handleReversal","id","handleReversalSubmitClick","type","message","handleReversalUpdate","quantity","Number","res","console","log","handleChange","length","map","item","index","date_out","item_name","staff_name","uom","memo_remarks","minWidth","mapStateToProps","mapDispatchToProps","dispatch","InventoryList"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  NormalInput,\r\n  NormalSelect,\r\n  NormalButton,\r\n  NormalDate,\r\n  NormalModal,\r\n  TableWrapper,\r\n} from \"component/common\";\r\nimport { Toast } from \"service/toast\";\r\nimport { getCommonApi, commonPatchApi } from \"redux/actions/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport closeIcon from \"assets/images/close.png\";\r\nimport { CreateNewInventory } from \"./Model\";\r\nimport \"./style.scss\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class InventoryListClass extends Component {\r\n  state = {\r\n    searchDate: new Date(),\r\n    stockMemoList: [],\r\n    meta: {},\r\n    stockMemoListHeader: [\r\n      { label: \"Date\" },\r\n      { label: \"Product\" },\r\n      { label: \"Employee\" },\r\n      { label: \"Qty\" },\r\n      { label: \"UOM\" },\r\n      { label: \"Remark\" },\r\n      { label: \"Reversal\" },\r\n    ],\r\n    isCreateNewInventoryPopup: false,\r\n    isReversalPopup: false,\r\n    stockMemoId: 0,\r\n    reversalqty: 0,\r\n    qty: 0,\r\n  };\r\n  componentDidMount = () => {\r\n    this.getstockMemoList({});\r\n  };\r\n\r\n  getstockMemoList = data => {\r\n    let { searchDate } = this.state;\r\n    let { page = 1, limit = 10, search = \"\" } = data;\r\n    this.props\r\n      .getCommonApi(\r\n        `stockusagememo/?date=${dateFormat(\r\n          searchDate\r\n        )}&page=${page}&limit=${limit}`\r\n      )\r\n      .then(key => {\r\n        let { status, data } = key;\r\n        if (status === 200) {\r\n          if (data) {\r\n            this.setState({\r\n              stockMemoList: data.dataList,\r\n              meta: data.meta.pagination,\r\n            });\r\n          }\r\n        }\r\n      });\r\n  };\r\n  handleDateChange = async ({ target: { value, name } }) => {\r\n    await this.setState({\r\n      [name]: value,\r\n    });\r\n    this.getstockMemoList({});\r\n  };\r\n  handlePagination = page => {\r\n    this.getstockMemoList(page);\r\n  };\r\n\r\n  handleCreateNewPopup = async () => {\r\n    await this.setState(prevState => ({\r\n      isCreateNewInventoryPopup: !prevState.isCreateNewInventoryPopup,\r\n    }));\r\n  };\r\n  handleCreateNewSave = () => {\r\n    this.handleCreateNewPopup();\r\n    this.getstockMemoList({});\r\n  };\r\n  handleReversalPopup = async () => {\r\n    await this.setState(prevState => ({\r\n      isReversalPopup: !prevState.isReversalPopup,\r\n    }));\r\n  };\r\n\r\n  handleReversal = async data => {\r\n    await this.setState({\r\n      stockMemoId: 0,\r\n      qty: 0,\r\n      reversalqty: 0,\r\n    });\r\n    await this.setState({\r\n      stockMemoId: data.id,\r\n      qty: data.qty,\r\n    });\r\n    this.handleReversalPopup();\r\n  };\r\n  handleReversalSubmitClick = () => {\r\n    let { reversalqty, qty } = this.state;\r\n    if (reversalqty <= 0 || reversalqty == \"\" || reversalqty > qty) {\r\n      Toast({ type: \"error\", message: \"Please enter valid Qty!\" });\r\n    } else {\r\n      this.handleReversalUpdate();\r\n    }\r\n  };\r\n  handleReversalUpdate = () => {\r\n    let { reversalqty, stockMemoId } = this.state;\r\n    let data = { quantity: Number(reversalqty) };\r\n    this.props\r\n      .commonPatchApi(`stockusagememo/${stockMemoId}/`, data)\r\n      .then(async res => {\r\n        console.log(res);\r\n        if (res.status === 200) {\r\n          this.handleReversalPopup();\r\n          this.getstockMemoList({});\r\n        }\r\n      });\r\n  };\r\n  handleChange = async ({ target: { value, name } }) => {\r\n    await this.setState({\r\n      [name]: value,\r\n    });\r\n  };\r\n  render() {\r\n    let {\r\n      searchDate,\r\n      stockMemoList,\r\n      stockMemoListHeader,\r\n      isCreateNewInventoryPopup,\r\n      meta,\r\n      isReversalPopup,\r\n      qty,\r\n      reversalqty,\r\n    } = this.state;\r\n    return (\r\n      <>\r\n        <div className=\"row mt-3\">\r\n          <div className=\"col-6 p-0 m-0\">\r\n            <div className=\"col-3 p-0\">\r\n              <div className=\"\">\r\n                <NormalDate\r\n                  value={new Date(searchDate)}\r\n                  name=\"searchDate\"\r\n                  type=\"date\"\r\n                  onChange={this.handleDateChange}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-6 mb-3\">\r\n            <div className=\"d-flex justify-content-end\">\r\n              <NormalButton\r\n                buttonClass={\"col-3\"}\r\n                mainbg={true}\r\n                className=\"col-12 ml-4 fs-15 \"\r\n                label=\"Add New\"\r\n                onClick={this.handleCreateNewPopup}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\"table-container table-responsive mt-3\">\r\n            <TableWrapper\r\n              headerDetails={stockMemoListHeader}\r\n              queryHandler={this.handlePagination}\r\n              pageMeta={meta}\r\n            >\r\n              {stockMemoList && stockMemoList.length > 0\r\n                ? stockMemoList.map((item, index) => {\r\n                    return (\r\n                      <tr className=\"w-100\" key={index}>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.date_out}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.item_name}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.staff_name}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.qty}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.uom}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {item.memo_remarks}\r\n                          </div>\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            <NormalButton\r\n                              mainbg={true}\r\n                              className=\"col-12 fs-15 \"\r\n                              label=\"Reversal\"\r\n                              onClick={() => this.handleReversal(item)}\r\n                            />\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })\r\n                : null}\r\n            </TableWrapper>\r\n            {isReversalPopup ? (\r\n              <NormalModal\r\n                className={\"select-category Treatment-usage\"}\r\n                style={{ minWidth: \"25%\" }}\r\n                modal={isReversalPopup}\r\n                handleModal={this.handleReversalPopup}\r\n              >\r\n                <img\r\n                  onClick={this.handleReversalPopup}\r\n                  className=\"close\"\r\n                  src={closeIcon}\r\n                  alt=\"\"\r\n                />\r\n                <div className=\"d-flex h5 justify-content-center p-1\">\r\n                  Reversal\r\n                </div>\r\n                <div className=\"row p-3\">\r\n                  <div className=\"col-4 mb-3\">\r\n                    <label className=\"text-left text-black common-label-text \">\r\n                      Qty\r\n                    </label>\r\n                    <div className=\"input-group\">\r\n                      <NormalInput value={qty} name=\"qty\" disabled />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"col-4 mb-3\">\r\n                    <div>\r\n                      <label className=\"text-left text-black common-label-text \">\r\n                        Reversal Qty\r\n                        <span className=\"error-message text-danger validNo fs-16\">\r\n                          *\r\n                        </span>\r\n                      </label>\r\n                    </div>\r\n                    <div className=\"input-group\">\r\n                      <NormalInput\r\n                        value={reversalqty}\r\n                        name=\"reversalqty\"\r\n                        onChange={this.handleChange}\r\n                        type={`number`}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-4 mb-3\">\r\n                    <div className=\"d-flex justify-content-center p-4 w-100\">\r\n                      <NormalButton\r\n                        mainbg={true}\r\n                        className=\"col-12 ml-4 fs-15 \"\r\n                        label=\"Submit\"\r\n                        onClick={this.handleReversalSubmitClick}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </NormalModal>\r\n            ) : null}\r\n            {isCreateNewInventoryPopup ? (\r\n              <CreateNewInventory\r\n                isCreateNewInventoryPopup={isCreateNewInventoryPopup}\r\n                handleCreateNewPopup={this.handleCreateNewPopup}\r\n                handleCreateNewSave={this.handleCreateNewSave}\r\n              />\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      commonPatchApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const InventoryList = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(InventoryListClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}