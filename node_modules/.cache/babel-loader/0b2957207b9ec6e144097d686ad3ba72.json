{"ast":null,"code":"import _toConsumableArray from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{NormalInput,NormalTextarea,NormalButton,NormalSelect,NormalDate,NormalModal,NormalDateTime}from\"component/common\";import{Button,Form,FormGroup,Label,Input,FormText}from\"reactstrap\";import{getPayment,createPayment}from\"redux/actions/payment\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{history}from\"helpers\";import{getCommonApi,updateForm}from\"redux/actions/common\";import{dateFormat}from\"service/helperFunctions\";import\"./style.scss\";import SimpleReactValidator from\"simple-react-validator\";import closeIcon from\"assets/images/close.png\";import helpers from\"../../../../service/Helper\";import{Toast}from\"service/toast\";import{withTranslation}from\"react-i18next\";import moment from\"moment\";import{isMoment}from\"moment\";export var MakePaymentClass=/*#__PURE__*/function(_Component){_inherits(MakePaymentClass,_Component);var _super=_createSuper(MakePaymentClass);function MakePaymentClass(){var _this;_classCallCheck(this,MakePaymentClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={formFields:{name:\"\",contact:\"\",address:\"\",searchStaff:\"\",payTableDropDownValue:\"\"},responseData:{},premisesOption:[],selectedCards:[],selectedCardsPayAmount:0,cardOption:[],ewalletoptions:[],ewalletField:{pay_typeid:null,pay_amt:\"\",credit_debit:true},cardField:{pay_typeid:null,pay_amt:\"\",credit_debit:true,pay_rem1:\"\",pay_rem2:\"\",pay_rem3:\"\",pay_rem4:\"\",App_code:\"\"},balance:0,errorMessage:\"123\",prepaidCustomerData:[],voucherCustomerData:[],creditNoteCustomerData:[],accountHeader:[],isMakePaymentButtonClicked:\"false\",isTreatmentDoneButton:true,itemProductAmount:0,itemServiceAmount:0,itemProductServiceVoucherAmount:0,displayTablePrepaid:[],displayTableCreditNote:[],displayTableVoucher:[],paytableData:[],paytableFullData:[],payGroupData:[],selectPaymentGroup:\"\",selectPaymentGroupId:\"\",isSelectedPaymentType:\"\",displayModelPaymentType:\"\",txtUserPayAmount:0,isOpenSubPayment:false,pay_rem4:\"\",DateofPay:new Date(),MinimumDate:new Date(),is_paymentdate:false,isMakePaymentLoading:false};_this.componentWillMount=function(){_this.validator=new SimpleReactValidator({element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});};_this.getPayment=function(){var _this$props=_this.props,id=_this$props.id,cartId=_this$props.cartId,cartData=_this$props.cartData;//id = 82318;\n//cartId = \"ICMD100226\";\n//cartData={\"status\":200,\"message\":\"Listed Succesfully\",\"error\":false,\"data\":[{\"id\":57500,\"cust_noid\":82318,\"customer\":\"test17011\",\"customercode\":\"021427HQ\",\"cart_id\":\"ICHQ100234\",\"cart_date\":\"2021-03-14\",\"cart_status\":\"Inprogress\",\"lineno\":1,\"check\":\"New\",\"itemcodeid\":10067,\"itemdesc\":\"Short - Chin Length(Before Shoulder) 128\",\"quantity\":1,\"price\":\"128.00\",\"total_price\":\"128.00\",\"sitecodeid\":31,\"sitecode_name\":\"HQ OFFICE (DEMO)\",\"sitecode\":\"HQ\",\"discount\":\"0.00\",\"discount_amt\":0,\"discount_price\":\"128.00\",\"additional_discount\":0,\"additional_discountamt\":0,\"deposit\":\"128.00\",\"trans_amt\":\"128.00\",\"tax\":0,\"itemstatus\":null,\"ratio\":\"100.000000000000000\",\"helper_name\":null,\"done_sessions\":null,\"type\":\"Deposit\",\"treatment_account\":null,\"treatment\":null,\"deposit_account\":null,\"prepaid_account\":null,\"item_uom\":null,\"recorddetail\":\"Service\",\"itemtype\":\"SINGLE\",\"item_class\":\"HERBAL TREATMENT\",\"sales_staff\":\"SEQ ADMIN\",\"service_staff\":\"\",\"total_disc\":\"0.00\",\"treatment_name\":\"Short - Chin Length(Before Shoulder) 128  (1)\",\"item_name\":\"Short - Chin Length(Before Shoulder) 128\"}],\"subtotal\":\"128.00\",\"discount\":\"0.00\",\"trans_amt\":\"128.00\",\"deposit_amt\":\"128.00\",\"billable_amount\":\"128.00\"}\nif(id){_this.props.getPayment(\"?cart_date=\".concat(dateFormat(new Date(),\"yyyy-mm-dd\"),\"&cust_noid=\").concat(id,\"&cart_id=\").concat(cartId)).then(function(res){console.log(\"Payment Details:\",res);var data=res.data,status=res.status,prepaid_data=res.prepaid_data;if(status===200){_this.setState({responseData:data,balance:Number(data.billable_amount),txtUserPayAmount:Number(data.billable_amount),prepaid_data:prepaid_data.prepaid,product_only:prepaid_data.product_only,service_only:prepaid_data.service_only,all_only:prepaid_data.all_only,is_paymentdate:data.is_paymentdate});}});}//let {cartData} = this.props;\nvar stringifiedCartData=cartData.data;var _this$state=_this.state,itemProductAmount=_this$state.itemProductAmount,itemServiceAmount=_this$state.itemServiceAmount,itemProductServiceVoucherAmount=_this$state.itemProductServiceVoucherAmount;if(stringifiedCartData){stringifiedCartData.map(function(item){//alert(JSON.stringify(item));\nif(item.recorddetail===\"Product\"){itemProductAmount+=parseFloat(item.total_price);}if(item.recorddetail===\"Service\"){itemServiceAmount+=parseFloat(item.total_price);console.log(itemServiceAmount);console.log(item.total_price);}if(item.recorddetail===\"Product\"||item.recorddetail===\"Service\"||item.recorddetail===\"Voucher\"){itemProductServiceVoucherAmount+=parseFloat(item.total_price);}});}_this.setState({itemProductAmount:itemProductAmount,itemServiceAmount:itemServiceAmount,itemProductServiceVoucherAmount:itemProductServiceVoucherAmount});};_this.getDataFromResponses=function(data){var _this$state2=_this.state,cardOption=_this$state2.cardOption,premisesOption=_this$state2.premisesOption;var _iterator=_createForOfIteratorHelper(data.CARD),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;cardOption.push({label:key.pay_description,value:key.id});}}catch(err){_iterator.e(err);}finally{_iterator.f();}var _iterator2=_createForOfIteratorHelper(data.CASH),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _key2=_step2.value;premisesOption.push({label:_key2.pay_description,value:_key2.id});}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}_this.setState({cardOption:cardOption,premisesOption:premisesOption});};_this.handleMultiple=function(_ref){var _ref$target=_ref.target,value=_ref$target.value,name=_ref$target.name;console.log(\"handleMultiple\",value,name);var formFields=Object.assign({},_this.state.formFields);formFields[name]=value;_this.setState({formFields:formFields});};_this.getVoucherData=function(api){_this.props.getCommonApi(\"voucher/?cust_id=\".concat(_this.props.id).concat(api)).then(function(key){var data=key.data;var voucherCustomerData=_this.state.voucherCustomerData;voucherCustomerData=data;console.log(\"voucherCustomerData\",data);// accountHeader = header_data;\n_this.setState({voucherCustomerData:voucherCustomerData},function(){console.log(\"test\");_this.HideVoucherTableData();});});};_this.getPrepaidData=function(){_this.getPrepaidAccountData(\"\");};_this.getPrepaidAccountData=function(api){console.log(\"dd\");_this.props.getCommonApi(\"prepaidacclist/?cust_id=\".concat(_this.props.id).concat(api)).then(function(key){var data=key.data;var prepaidCustomerData=_this.state.prepaidCustomerData;//prepaidCustomerData = data;\nprepaidCustomerData=[];console.log(\"prepaidCustomerData\",data);var _iterator3=_createForOfIteratorHelper(data),_step3;try{var _loop=function _loop(){var item=_step3.value;var itemData={};itemData[\"conditiontype1\"]=item.conditiontype1;itemData[\"cust_code\"]=item.cust_code;itemData[\"all\"]=item.all;itemData[\"exp_status\"]=item.exp_status;itemData[\"exp_date\"]=item.exp_date;itemData[\"last_update\"]=item.last_update;itemData[\"line_no\"]=item.line_no;itemData[\"id\"]=item.id;itemData[\"pp_amt\"]=item.pp_amt;itemData[\"pp_bonus\"]=item.pp_bonus;itemData[\"outstanding\"]=item.outstanding;itemData[\"pp_no\"]=item.pp_no;itemData[\"pp_total\"]=item.pp_total;itemData[\"prepaid\"]=item.prepaid;itemData[\"product\"]=item.product;itemData[\"remain\"]=item.remain;itemData[\"sa_date\"]=item.sa_date;itemData[\"service\"]=item.service;itemData[\"topup_amt\"]=item.topup_amt;itemData[\"type\"]=item.type;itemData[\"use_amt\"]=item.use_amt;itemData[\"pp_desc\"]=item.pp_desc;if(item.conditiontype1===\"Service Only\"){if(Number(_this.state.service_only)>Number(item.remain)){itemData[\"Finaluse_amt\"]=item.remain;}else{itemData[\"Finaluse_amt\"]=_this.state.service_only;}}if(item.conditiontype1===\"Product Only\"){if(Number(_this.state.product_only)>Number(item.remain)){itemData[\"Finaluse_amt\"]=item.remain;}else{itemData[\"Finaluse_amt\"]=_this.state.product_only;}}if(item.conditiontype1===\"All\"){var finalamount=Number(_this.state.all_only);if(_this.state.prepaid_data){_this.state.prepaid_data.filter(function(dataitem){return dataitem.prepaid_id==item.id;}).map(function(filteritem){finalamount=Number(_this.state.all_only)-Number(filteritem.deposit);});}if(Number(finalamount)>Number(item.remain)){itemData[\"Finaluse_amt\"]=Number(item.remain).toFixed(2);}else{itemData[\"Finaluse_amt\"]=Number(finalamount).toFixed(2);}}prepaidCustomerData.push(itemData);};for(_iterator3.s();!(_step3=_iterator3.n()).done;){_loop();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}_this.setState({prepaidCustomerData:prepaidCustomerData},function(){_this.HidePrepaidTableData();});});// accountHeader = header_data;\n};_this.getCreditNoteAccountData=function(api){_this.props.getCommonApi(\"creditnotelist/?cust_id=\".concat(_this.props.id).concat(api)).then(function(key){var data=key.data;var creditNoteCustomerData=_this.state.creditNoteCustomerData;creditNoteCustomerData=data;// accountHeader = header_data;\n_this.setState({creditNoteCustomerData:creditNoteCustomerData},function(){_this.HideCreditNoteTableData();});});};_this.getPayGroup=function(){_this.props.getCommonApi(\"paygroup/\").then(function(res){var payGroupData=_this.state.payGroupData;var _iterator4=_createForOfIteratorHelper(res.data),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var key=_step4.value;payGroupData.push({label:key.pay_group_code,value:key.id,picturelocation:key.picturelocation});}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}_this.setState({payGroupData:payGroupData});});};_this.getFullPayTable=function(){_this.props.getCommonApi(\"paytablenew/\").then(function(res){var paytableFullData=_this.state.paytableFullData;paytableFullData=res.data;_this.setState({paytableFullData:paytableFullData});});};_this.getPayTableNameBasedOnId=function(payTableId){//debugger;\nconsole.log(payTableId);var paytableFullData=_this.state.paytableFullData;var test=paytableFullData.filter(function(res){return res.id==payTableId;});return test[0].pay_description;};_this.handleChange=function(_ref2){var _ref2$target=_ref2.target,value=_ref2$target.value,name=_ref2$target.name;var formFields=Object.assign({},_this.state.formFields);formFields[name]=value;_this.setState({formFields:formFields});var _this$state3=_this.state,balance=_this$state3.balance,selectedCards=_this$state3.selectedCards,txtUserPayAmount=_this$state3.txtUserPayAmount,isOpenSubPayment=_this$state3.isOpenSubPayment;isOpenSubPayment=false;selectedCards.push({pay_typeid:value,pay_amt:parseFloat(txtUserPayAmount),credit_debit:false,pay_premise:true,prepaid:false,pay_rem4:_this.state.pay_rem4});balance=parseFloat(balance-txtUserPayAmount).toFixed(2);txtUserPayAmount=balance;_this.setState({txtUserPayAmount:txtUserPayAmount,balance:balance,isOpenSubPayment:isOpenSubPayment});};_this.handleCreditChange=function(_ref3){var _ref3$target=_ref3.target,value=_ref3$target.value,name=_ref3$target.name;var cardField=Object.assign({},_this.state.cardField);cardField[name]=value;_this.setState({cardField:cardField});};_this.handleTreatmentDone=function(){var _this$state4=_this.state,selectedCards=_this$state4.selectedCards,DateofPay=_this$state4.DateofPay;selectedCards.push({pay_typeid:2,//pay_typeid: 1,\npay_amt:0,credit_debit:false,pay_premise:true,prepaid:false,pay_rem4:_this.state.pay_rem4});var data=selectedCards;var _this$props2=_this.props,id=_this$props2.id,cartId=_this$props2.cartId;_this.props.createPayment(\"?cart_date=\".concat(dateFormat(new Date(),\"yyyy-mm-dd\"),\"&cust_noid=\").concat(id,\"&cart_id=\").concat(cartId,\"&pay_date=\").concat(dateFormat(new Date(DateofPay),\"yyyy-mm-dd\")),data).then(function(res){history.push(\"/admin/billing/print/bill/\".concat(res.data.sa_transacno));});};_this.handleSubmit=function(){_this.setState({isMakePaymentLoading:true});var _this$state5=_this.state,selectedCards=_this$state5.selectedCards,DateofPay=_this$state5.DateofPay;_this.setState({isMakePaymentButtonClicked:\"true\"});console.log(\"Selected Date: \",dateFormat(new Date(DateofPay),\"yyyy-mm-dd\"));var data=selectedCards;console.log(\"SubmitDatapayment\",data);var _this$props3=_this.props,id=_this$props3.id,cartId=_this$props3.cartId;_this.props.createPayment(\"?cart_date=\".concat(dateFormat(new Date(),\"yyyy-mm-dd\"),\"&cust_noid=\").concat(id,\"&cart_id=\").concat(cartId,\"&pay_date=\").concat(dateFormat(new Date(DateofPay),\"yyyy-mm-dd\")),data).then(function(res){_this.setState({isMakePaymentLoading:false});history.push(\"/admin/billing/print/bill/\".concat(res.data.sa_transacno));});_this.setState({isMakePaymentLoading:false});};_this.addCreditCard=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state6,cardField,selectedCards,balance,responseData,txtUserPayAmount,userPayAmount,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(_this.validator.fieldValid(\"cardFieldType\")){_context.next=3;break;}_this.validator.showMessageFor(\"cardFieldType\");return _context.abrupt(\"return\");case 3:_this$state6=_this.state,cardField=_this$state6.cardField,selectedCards=_this$state6.selectedCards,balance=_this$state6.balance,responseData=_this$state6.responseData,txtUserPayAmount=_this$state6.txtUserPayAmount;userPayAmount=parseFloat(txtUserPayAmount);if(!(parseFloat(_this.state.responseData.billable_amount)>0)){_context.next=8;break;}if(!(userPayAmount==0)){_context.next=8;break;}return _context.abrupt(\"return\");case 8:if(!_this.checkPayTypeIdAlreadyExists(cardField.pay_typeid)){_context.next=14;break;}result=_this.getPayTableNameBasedOnId(cardField.pay_typeid)+\" already exists\";Toast({type:\"error\",message:result});// alert(\n//   this.getPayTableNameBasedOnId(cardField.pay_typeid) + \" already exists\"\n// );\nreturn _context.abrupt(\"return\");case 14:selectedCards.push({pay_typeid:cardField.pay_typeid,pay_amt:userPayAmount,credit_debit:true,pay_premise:false,pay_rem1:cardField.pay_rem1,pay_rem2:cardField.pay_rem2,pay_rem3:cardField.pay_rem3,pay_rem4:_this.state.pay_rem4,prepaid:false});case 15:balance=parseFloat(balance-userPayAmount).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);case 18:case\"end\":return _context.stop();}}},_callee);}));_this.addPrepaid=function(selectedPrepaid){var prepaidExpDate=moment(selectedPrepaid.exp_date).format(\"YYYY-MM-DD\");var todaysDate=moment(new Date()).format(\"YYYY-MM-DD\");var isValid=moment(todaysDate).isSameOrAfter(prepaidExpDate);var userPayAmount=0;var _this$state7=_this.state,itemServiceAmount=_this$state7.itemServiceAmount,itemProductAmount=_this$state7.itemProductAmount,itemProductServiceVoucherAmount=_this$state7.itemProductServiceVoucherAmount,txtUserPayAmount=_this$state7.txtUserPayAmount;console.log(txtUserPayAmount);userPayAmount=parseFloat(txtUserPayAmount);if(isValid){Toast({type:\"error\",message:\"Check Expiry Date\"});return;}if(userPayAmount<=0){// alert(\"hi\");\nToast({type:\"error\",message:\"Prepaid is Not allowed\"});return;}var selectedRemainingPrepaidAmount=parseFloat(selectedPrepaid.remain);if(selectedRemainingPrepaidAmount<userPayAmount){//return\n}else if(selectedRemainingPrepaidAmount>userPayAmount){selectedRemainingPrepaidAmount=parseFloat(userPayAmount);}/*\r\n    if (!this.validator.fieldValid(\"PrepaidBalanceAmount\")) {\r\n      this.validator.showMessageFor(\"PrepaidBalanceAmount\");\r\n      return;\r\n    }\r\n    if (!this.validator.fieldValid(\"PrepaidBalanceAmount\")) {\r\n      this.validator.showMessageFor(\"PrepaidBalanceAmount\");\r\n      return;\r\n    }\r\n*/if(selectedPrepaid.conditiontype1===\"Service Only\"){//For Service\nif(parseFloat(itemServiceAmount)==0){Toast({type:\"error\",message:\"Prepaid is Not allowed\"});return;}if(parseFloat(itemServiceAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemServiceAmount)?parseFloat(txtUserPayAmount):parseFloat(itemServiceAmount);console.log(itemServiceAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemServiceAmount=itemServiceAmount-userPayAmount;_this.setState({itemServiceAmount:itemServiceAmount});}else if(selectedPrepaid.conditiontype1===\"Product Only\"){//For Product\nif(parseFloat(itemProductAmount)==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}if(parseFloat(itemProductAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemProductAmount)?parseFloat(txtUserPayAmount):parseFloat(itemProductAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemProductAmount=itemProductAmount-userPayAmount;_this.setState({itemProductAmount:itemProductAmount});}else{if(parseFloat(itemProductServiceVoucherAmount)==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}if(parseFloat(itemProductServiceVoucherAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemProductServiceVoucherAmount)?parseFloat(txtUserPayAmount):parseFloat(itemProductServiceVoucherAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemProductServiceVoucherAmount=itemProductServiceVoucherAmount-userPayAmount;_this.setState({itemProductServiceVoucherAmount:itemProductServiceVoucherAmount});}if(userPayAmount==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}var payTypeId=23;//normal\n//const payTypeId = 19; //healspa\n//const payTypeId = 8; //glamour\n//const payTypeId = 9; //beskin\nvar _this$state8=_this.state,cardField=_this$state8.cardField,ewalletField=_this$state8.ewalletField,balance=_this$state8.balance,selectedCards=_this$state8.selectedCards,isOpenSubPayment=_this$state8.isOpenSubPayment;selectedCards.push({pay_typeid:payTypeId,prepaid:true,pay_amt:userPayAmount,credit_debit:false,pay_premise:false,pay_rem1:selectedPrepaid.pp_no+\" - \"+selectedPrepaid.line_no+\" - \"+selectedPrepaid.pp_desc,pay_rem2:selectedPrepaid.id,pay_rem4:_this.state.pay_rem4,prepaid_ct:selectedPrepaid.conditiontype1});console.log(\"BeforeAdd-displayTablePrepaid\",_this.state.displayTablePrepaid);var setdisplayTablePrepaid=_this.state.displayTablePrepaid;setdisplayTablePrepaid.push(selectedPrepaid.id);_this.setState({displayTablePrepaid:setdisplayTablePrepaid});console.log(\"AfterAdd-displayTablePrepaid\",_this.state.displayTablePrepaid);_this.HidePrepaidTableData();balance=parseFloat(balance-userPayAmount).toFixed(2);_this.setBalanceToAllTextBoxes(balance);console.log(balance);_this.setState({isOpenSubPayment:false});};_this.addVoucher=function(selectedVoucher){var _this$state9=_this.state,cardField=_this$state9.cardField,ewalletField=_this$state9.ewalletField,balance=_this$state9.balance,txtUserPayAmount=_this$state9.txtUserPayAmount,isOpenSubPayment=_this$state9.isOpenSubPayment,selectedCards=_this$state9.selectedCards;if(txtUserPayAmount==0){Toast({type:\"error\",message:\"Voucher is not allowed\"});return;}var selectedVoucherAmount=parseFloat(selectedVoucher.value);var pay_amt_setup=0;if(selectedVoucherAmount<=parseFloat(txtUserPayAmount)){pay_amt_setup=selectedVoucherAmount;}else{Toast({type:\"error\",message:\"Partial Amount is not applicable in voucher\"});return;// alert(\"Partial Amount is not applicable in voucher\");\n// return;\n}var payTypeId=9;//normal\n//const payTypeId = 8; //healspa\n//const payTypeId = 4; //glamour\n//const payTypeId = 5; //beskin\nselectedCards.push({pay_typeid:payTypeId,prepaid:false,pay_amt:parseFloat(pay_amt_setup),credit_debit:false,pay_premise:false,pay_rem1:selectedVoucher.voucher_no,pay_rem2:selectedVoucher.voucher_no,pay_rem4:_this.state.pay_rem4});console.log(\"BeforeAdd-displayTableVoucher\",_this.state.displayTableVoucher);var setdisplayTableVoucher=_this.state.displayTableVoucher;setdisplayTableVoucher.push(selectedVoucher.voucher_no);_this.setState({displayTableVoucher:setdisplayTableVoucher});console.log(\"AfterAdd-displayTableCreditNote\",_this.state.displayTableVoucher);_this.HideVoucherTableData();balance=parseFloat(balance-pay_amt_setup).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);};_this.addCreditNote=function(selectedCreditNote){console.log(selectedCreditNote);var _this$state10=_this.state,cardField=_this$state10.cardField,ewalletField=_this$state10.ewalletField,balance=_this$state10.balance,txtUserPayAmount=_this$state10.txtUserPayAmount,selectedCards=_this$state10.selectedCards;if(txtUserPayAmount==0){Toast({type:\"error\",message:\"Credit Note is not allowed\"});return;}var selectedCreditNoteAmount=parseFloat(selectedCreditNote.balance);console.log(selectedCreditNoteAmount);var pay_amt_setup=0;if(selectedCreditNoteAmount<=parseFloat(txtUserPayAmount)){pay_amt_setup=selectedCreditNoteAmount;}else{pay_amt_setup=txtUserPayAmount;}var payTypeId=17;//normal\n//const payTypeId = 12; //healspa\n//const payTypeId = 5; //glamour\n//const payTypeId = 6; //beskin\nselectedCards.push({pay_typeid:payTypeId,prepaid:false,pay_amt:parseFloat(pay_amt_setup),credit_debit:false,pay_premise:false,pay_rem1:selectedCreditNote.credit_code,pay_rem2:selectedCreditNote.transaction,pay_rem4:_this.state.pay_rem4});console.log(\"BeforeAdd-displayTableCreditNote\",_this.state.displayTableCreditNote);var setdisplayTableCreditNote=_this.state.displayTableCreditNote;setdisplayTableCreditNote.push(selectedCreditNote.credit_code);_this.setState({displayTableCreditNote:setdisplayTableCreditNote});console.log(\"AfterAdd-displayTableCreditNote\",_this.state.displayTableCreditNote);_this.HideCreditNoteTableData();balance=parseFloat(balance-pay_amt_setup).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);};_this.removeCards=function(idx){return function(){var _this$state11=_this.state,selectedCards=_this$state11.selectedCards,balance=_this$state11.balance,cardField=_this$state11.cardField,ewalletField=_this$state11.ewalletField,itemProductServiceVoucherAmount=_this$state11.itemProductServiceVoucherAmount,itemProductAmount=_this$state11.itemProductAmount,itemServiceAmount=_this$state11.itemServiceAmount;_this.setState({isMakePaymentButtonClicked:\"false\"});balance=parseFloat(balance)+parseFloat(idx.pay_amt);var array=_toConsumableArray(selectedCards);// make a separate copy of the array\nvar index=array.indexOf(idx);if(idx.pay_typeid==23){//normal\n//if (idx.pay_typeid == 19) { //normal\n//if (idx.pay_typeid == 8) { //glamour\n//if (idx.pay_typeid == 9) { //beskin\nif(idx.prepaid_ct==\"Product Only\"){itemProductAmount=itemProductAmount+idx.pay_amt;}else if(idx.prepaid_ct==\"Service Only\"){itemServiceAmount=itemServiceAmount+idx.pay_amt;}else{itemProductServiceVoucherAmount=itemProductServiceVoucherAmount+idx.pay_amt;}_this.setState({itemProductServiceVoucherAmount:itemProductServiceVoucherAmount,itemProductAmount:itemProductAmount,itemServiceAmount:itemServiceAmount});}if(index!==-1){array.splice(index,1);_this.setState({selectedCards:array,balance:balance});}//console.log(\"idx\", idx);\nvar removedTerm=idx.pay_typeid;//console.log(\"removedTerm\", removedTerm);\n//console.log(\"idx.pay_rem2\", idx.pay_rem2);\nif(removedTerm==\"23\"){//normal\n//if (removedTerm == \"19\") { //healspa\n//if (removedTerm == \"8\") { //glamour\n//if (removedTerm == \"9\") { //beskin\nvar items=_this.state.displayTablePrepaid;console.log(\"BeforeRemove-displayTablePrepaid\",items);var valueToRemove=idx.pay_rem2;//For Prepaid Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",valueToRemove);var filteredItems=items.filter(function(item){return item!==valueToRemove;});_this.setState({displayTablePrepaid:filteredItems},function(){console.log(\"AfterRemove-displayTablePrepaid\",_this.state.displayTablePrepaid);});_this.getPrepaidAccountData(\"\");// this.HidePrepaidTableData();\n}if(removedTerm==\"17\"){//normal\n//if (removedTerm == \"12\") { //normal\n//if (removedTerm == \"5\") { //glamour\n//if (removedTerm == \"6\") { //beskin\nvar _items=_this.state.displayTableCreditNote;console.log(\"BeforeRemove-displayTableCreditNote\",_items);var _valueToRemove=idx.pay_rem1;//For Credit Note Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",_valueToRemove);var _filteredItems=_items.filter(function(item){return item!==_valueToRemove;});_this.setState({displayTableCreditNote:_filteredItems},function(){console.log(\"AfterRemove-displayTableCreditNote\",_this.state.displayTableCreditNote);});_this.getCreditNoteAccountData(\"\");// this.HidePrepaidTableData();\n}if(removedTerm==\"9\"){//normal\n//if (removedTerm == \"8\") { //healspa\n//if (removedTerm == \"4\") { //glamour\n//if (removedTerm == \"5\") { //beskin\nvar _items2=_this.state.displayTableVoucher;console.log(\"BeforeRemove-displayTableVoucher\",_items2);var _valueToRemove2=idx.pay_rem1;//For Credit Note Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",_valueToRemove2);var _filteredItems2=_items2.filter(function(item){return item!==_valueToRemove2;});_this.setState({displayTableVoucher:_filteredItems2},function(){console.log(\"AfterRemove-displayTableVoucher\",_this.state.displayTableVoucher);});_this.getVoucherData(\"\");}cardField[\"pay_amt\"]=balance;ewalletField[\"pay_amt\"]=balance;_this.setBalanceToAllTextBoxes(balance);};};_this.addNewPaymentData=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(selPayTypeId,selPayTypeName){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(_this.validator.fieldValid(\"Amount\")){_context2.next=3;break;}_this.validator.showMessageFor(\"Amount\");return _context2.abrupt(\"return\");case 3:if(_this.validator.fieldValid(\"Amount\")){_context2.next=6;break;}_this.validator.showMessageFor(\"Amount\");return _context2.abrupt(\"return\");case 6:_this.props.getCommonApi(\"paytablenew/?paygroupid=\".concat(selPayTypeId)).then(function(res){_this.setState({paytableData:[]});var _this$state12=_this.state,paytableData=_this$state12.paytableData,isSelectedPaymentType=_this$state12.isSelectedPaymentType,displayModelPaymentType=_this$state12.displayModelPaymentType;isSelectedPaymentType=selPayTypeName.trim();displayModelPaymentType=selPayTypeName.trim();var _iterator5=_createForOfIteratorHelper(res.data),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var key=_step5.value;paytableData.push({label:key.pay_description,value:key.id});}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}_this.setState({paytableData:paytableData},function(){var isOpenSubPayment=_this.state.isOpenSubPayment;if(paytableData.length==0){Toast({type:\"error\",message:\"Pay Table Not Exists\"});return;}else if(selPayTypeName.trim()===\"VOUCHER\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"PREPAID\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"Credit\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"CARD\"){isOpenSubPayment=true;}else if(paytableData.length==1){isOpenSubPayment=false;var payTypeId=paytableData[0].value;var _this$state13=_this.state,balance=_this$state13.balance,selectedCards=_this$state13.selectedCards,txtUserPayAmount=_this$state13.txtUserPayAmount;if(parseFloat(_this.state.responseData.billable_amount)>0){if(parseFloat(txtUserPayAmount)==0){return;}}if(_this.checkPayTypeIdAlreadyExists(payTypeId)){// alert(\n//   this.getPayTableNameBasedOnId(payTypeId) + \" already exists\"\n// );\nvar result=_this.getPayTableNameBasedOnId(payTypeId)+\" already exists\";Toast({type:\"error\",message:result});//alert(\"Already Exists\");\nreturn;}else{selectedCards.push({pay_typeid:payTypeId,pay_amt:parseFloat(txtUserPayAmount),credit_debit:false,pay_premise:true,prepaid:false,pay_rem4:_this.state.pay_rem4});balance=parseFloat(balance-txtUserPayAmount).toFixed(2);txtUserPayAmount=balance;_this.setState({txtUserPayAmount:txtUserPayAmount,balance:balance});return;}}else if(paytableData.length>=1){isOpenSubPayment=true;isSelectedPaymentType=\"Multiple\";}_this.setState({isOpenSubPayment:isOpenSubPayment,isSelectedPaymentType:isSelectedPaymentType,displayModelPaymentType:displayModelPaymentType});});});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2){return _ref5.apply(this,arguments);};}();_this.handleDialog=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var isOpenSubPayment;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isOpenSubPayment=_this.state.isOpenSubPayment;isOpenSubPayment=false;_context3.next=4;return _this.setState({isOpenSubPayment:isOpenSubPayment});case 4:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleChangeCard=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref7){var _ref7$target,value,name,cardField;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_ref7$target=_ref7.target,value=_ref7$target.value,name=_ref7$target.name;cardField=Object.assign({},_this.state.cardField);cardField[name]=value;_context4.next=5;return _this.setState({cardField:cardField});case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x3){return _ref8.apply(this,arguments);};}();_this.handleDatePick=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref9){var _ref9$target,value,name,DateofPay,DatePayment;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_ref9$target=_ref9.target,value=_ref9$target.value,name=_ref9$target.name;DateofPay=_this.state.DateofPay;DateofPay=value;_context5.next=5;return _this.setState({DateofPay:DateofPay});case 5:DatePayment={};DatePayment[\"DateofPayment\"]=value;_context5.next=9;return _this.props.updateForm(\"CartPaymentDate\",DatePayment);case 9:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref10.apply(this,arguments);};}();return _this;}_createClass(MakePaymentClass,[{key:\"componentDidMount\",value:function componentDidMount(){//debugger;\nvar From=new Date();var _this$state14=this.state,MinimumDate=_this$state14.MinimumDate,DateofPay=_this$state14.DateofPay;var firstdayMonth=new Date(From.getFullYear(),From.getMonth()-6,From.getDate()+1);if(this.props.CartPaymentDate&&this.props.CartPaymentDate[\"DateofPayment\"]){DateofPay=new Date(this.props.CartPaymentDate.DateofPayment);}else{DateofPay=new Date();}MinimumDate=firstdayMonth;this.setState({MinimumDate:MinimumDate,DateofPay:DateofPay});this.getPayment();this.getPayGroup();this.getFullPayTable();this.getPrepaidData();this.getCreditNoteAccountData(\"\");this.getVoucherData(\"\");console.log(\"cartdata From cart\",this.props.cartData);}},{key:\"handleChangeTextBox\",value:function handleChangeTextBox(event){this.setState({txtUserPayAmount:event.target.value});}},{key:\"handleChangeRemarkBox\",value:function handleChangeRemarkBox(event){this.setState({pay_rem4:event.target.value});}},{key:\"checkPayTypeIdAlreadyExists\",value:function checkPayTypeIdAlreadyExists(val){return this.state.selectedCards.some(function(item){return val===item.pay_typeid;});}},{key:\"HidePrepaidTableData\",value:function HidePrepaidTableData(){var _this2=this;var _this$state15=this.state,prepaidCustomerData=_this$state15.prepaidCustomerData,displayTablePrepaid=_this$state15.displayTablePrepaid;displayTablePrepaid.map(function(item){var selectedPrepaid=prepaidCustomerData.filter(function(prepaid){return prepaid.id!=item;});_this2.setState({prepaidCustomerData:selectedPrepaid});});}},{key:\"HideCreditNoteTableData\",value:function HideCreditNoteTableData(){var _this3=this;var _this$state16=this.state,creditNoteCustomerData=_this$state16.creditNoteCustomerData,displayTableCreditNote=_this$state16.displayTableCreditNote;displayTableCreditNote.map(function(item){var selectedCreditNote=creditNoteCustomerData.filter(function(creditNote){return creditNote.credit_code!=item;});_this3.setState({creditNoteCustomerData:selectedCreditNote});});}},{key:\"HideVoucherTableData\",value:function HideVoucherTableData(){var _this4=this;var _this$state17=this.state,voucherCustomerData=_this$state17.voucherCustomerData,displayTableVoucher=_this$state17.displayTableVoucher;displayTableVoucher.map(function(item){var selectedVoucher=voucherCustomerData.filter(function(voucher){return voucher.voucher_no!=item;});_this4.setState({voucherCustomerData:selectedVoucher});});}},{key:\"setBalanceToAllTextBoxes\",value:function setBalanceToAllTextBoxes(balance){this.setState({balance:balance,txtUserPayAmount:balance});}},{key:\"checkTypeOfCartItemContainsDeposit\",value:function checkTypeOfCartItemContainsDeposit(cartData){var _this5=this;var stringifiedCartData=cartData.data;if(stringifiedCartData){stringifiedCartData.map(function(item){if(item.type===\"Deposit\"||item.type===\"Top Up\"){_this5.state.isTreatmentDoneButton=false;}});}}},{key:\"render\",value:function render(){var _this6=this;var _this$state18=this.state,responseData=_this$state18.responseData,balance=_this$state18.balance,isTreatmentDoneButton=_this$state18.isTreatmentDoneButton,payGroupData=_this$state18.payGroupData,paytableData=_this$state18.paytableData,isOpenSubPayment=_this$state18.isOpenSubPayment,isSelectedPaymentType=_this$state18.isSelectedPaymentType,displayModelPaymentType=_this$state18.displayModelPaymentType,cardField=_this$state18.cardField,pay_rem4=_this$state18.pay_rem4,DateofPay=_this$state18.DateofPay,MinimumDate=_this$state18.MinimumDate,is_paymentdate=_this$state18.is_paymentdate,isMakePaymentLoading=_this$state18.isMakePaymentLoading;var t=this.props.t;var payTableDropDownValue=this.state.formFields.payTableDropDownValue;console.log(payTableDropDownValue);var insideRadioButtonData;console.log(isSelectedPaymentType,\"selectedpaymenttype\");if(isSelectedPaymentType==\"VOUCHER\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Vocucher No\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Value\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Exp. Date\"))),this.state.voucherCustomerData.map(function(selectedVoucher,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addVoucher.bind(_this6,selectedVoucher)},/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.voucher_no),/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.value),/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.issued_expiry_date));})));}else if(isSelectedPaymentType==\"PREPAID\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Category\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Amount\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Remaining\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Invoice No.\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Exp. Date\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Condition Type\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Use Amount\"))),this.state.prepaidCustomerData.map(function(selectedPrepaid,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addPrepaid.bind(_this6,selectedPrepaid)},/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.pp_desc),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.pp_total),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.remain),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.prepaid),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.exp_date),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.conditiontype1),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.Finaluse_amt));})));}else if(isSelectedPaymentType==\"Credit\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Credit\"),\" #\"),/*#__PURE__*/React.createElement(\"td\",null,t(\"Date\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Amount\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Balance\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Status\"))),this.state.creditNoteCustomerData.map(function(creditNote,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addCreditNote.bind(_this6,creditNote)},/*#__PURE__*/React.createElement(\"td\",null,creditNote.credit_code),/*#__PURE__*/React.createElement(\"td\",null,creditNote.sa_date),/*#__PURE__*/React.createElement(\"td\",null,creditNote.amount),/*#__PURE__*/React.createElement(\"td\",null,creditNote.balance),/*#__PURE__*/React.createElement(\"td\",null,creditNote.status));})));}else if(isSelectedPaymentType==\"CARD\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-start\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Select Card\"),/*#__PURE__*/React.createElement(NormalSelect,{placeholder:\"Search type...\",options:paytableData,value:cardField.pay_typeid,name:\"pay_typeid\",onChange:this.handleCreditChange})),this.validator.message(\"cardFieldType\",cardField.pay_typeid,\"required\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Card No.\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.pay_rem1,name:\"pay_rem1\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Name\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.pay_rem2,name:\"pay_rem2\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Exp Month\"),\" / \",t(\"Year\"),/*#__PURE__*/React.createElement(NormalInput,{placeholder:\"mm/YYYY\",value:cardField.pay_rem3,name:\"pay_rem3\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Approval Code\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.App_code,name:\"App_code\",onChange:this.handleChangeCard})))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:false,className:\"col-12 mt-4 ml-2 btn-outline-success\",label:\"CONFIRM\",onClick:function onClick(){return _this6.addCreditCard();}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}))));}else if(isSelectedPaymentType==\"Multiple\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(Label,{className:\"col-12 fs-15\"},t(\"Choose Option\")),/*#__PURE__*/React.createElement(NormalSelect,{placeholder:\"Search type...\",options:paytableData,value:payTableDropDownValue,name:\"payTableDropDownValue\",onChange:this.handleChange})))));}else{insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null);}var payGroupDataContent=[];console.log(payGroupData);payGroupData.forEach(function(item,i){payGroupDataContent.push(/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 col-4 payment-item cursor-pointer\",style:{width:\"50px\",padding:\"15px\"},key:i,onClick:function onClick(){return _this6.addNewPaymentData(item.value,item.label);}},/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"img\",{src:helpers.getMediaUrl()+\"media/\"+item.picturelocation,label:item.label,style:{textAlign:\"center\"},width:\"40\",height:\"40\"})),/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"p\",{style:{width:\"100px\",textAlign:\"center\"}},item.label))));});var _this$props4=this.props,cartId=_this$props4.cartId,cartData=_this$props4.cartData,tokenDetails=_this$props4.tokenDetails;console.log(cartId,tokenDetails,this.props.cartData);this.checkTypeOfCartItemContainsDeposit(cartData);var userAddedPayTableData=/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered\"},this.state.selectedCards.map(function(selectedCards,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",{className:\"fs-18\"},_this6.getPayTableNameBasedOnId(selectedCards.pay_typeid)),/*#__PURE__*/React.createElement(\"td\",{className:\"fs-18\",style:{textAlign:\"right\"}},selectedCards.pay_amt.toFixed(2)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 p-0 fs-20 cursor-pointer\",onClick:_this6.removeCards(selectedCards)},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-delete\"}))));}));return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12 mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},t(\"Enter Amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput,{value:this.state.txtUserPayAmount,onChange:this.handleChangeTextBox.bind(this)}),this.validator.message(\"Amount\",this.state.txtUserPayAmount,\"required|numeric|min:0,num\"),this.validator.message(\"Amount\",this.state.txtUserPayAmount,\"required|numeric|max:\"+this.state.balance+\",num\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-12 mb-2\"},/*#__PURE__*/React.createElement(Label,null,t(\"Remark\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput,{value:pay_rem4,name:\"pay_rem4\",onChange:this.handleChangeRemarkBox.bind(this)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12 mb-2\"},is_paymentdate?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Label,null,t(\"Date\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalDate,{value:new Date(DateofPay),name:\"DateofPay\",type:\"date\",onChange:this.handleDatePick,minDate:new Date(MinimumDate),maxDate:new Date(),showDisabledMonthNavigation:true}))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},isTreatmentDoneButton?/*#__PURE__*/React.createElement(\"div\",{className:\"make-payment mt-3 mr-2 text-center\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:true,className:\"col-12 fs-15\",label:\"TREATMENT DONE\",onClick:function onClick(){return _this6.handleTreatmentDone();}})):null,/*#__PURE__*/React.createElement(\"div\",{className:\"make-payment mt-3 text-center\"},isMakePaymentLoading?/*#__PURE__*/React.createElement(\"div\",{class:\"d-flex align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},t(\"Loading...\")))):this.state.isMakePaymentButtonClicked==\"true\"?/*#__PURE__*/React.createElement(NormalButton,{submitBtn:true,className:\"col-12\",label:\"Make payment\",disabled:true}):/*#__PURE__*/React.createElement(NormalButton,{submitBtn:true,className:\"col-12\",label:\"Make payment\",onClick:function onClick(){return _this6.handleSubmit();},disabled:this.state.selectedCards.length<=0||balance>0}))))),/*#__PURE__*/React.createElement(\"h4\",null,t(\"Select Payment Method\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row paymentGroup\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},payGroupDataContent)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 make-payment-section\"},/*#__PURE__*/React.createElement(\"p\",{className:\"h6\"},t(\"List of Selections\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 mt-1 mb-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex payment\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-7 p-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap fs-14\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Subtotal\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.subtotal),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Discount ($)\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.discount),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Transac amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.trans_amt),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Deposit\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.deposit_amt),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},responseData.tax_lable),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.tax_amt))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 fs-22 text-center\"},t(\"Billing Amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 fs-22 fw-700 text-center text-orenge\"},\"$ \",responseData.billable_amount),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 f-600 text-center mt-2\"},t(\"Balance Amount\"),\": \",Number(balance).toFixed(2))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 mt-2 payment-list\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fs-12\"},userAddedPayTableData)))),/*#__PURE__*/React.createElement(NormalModal,{className:\"payment-modal\",style:{minWidth:\"70%\"},modal:isOpenSubPayment,handleModal:this.handleDialog},/*#__PURE__*/React.createElement(\"img\",{onClick:this.handleDialog,className:\"close cursor-pointer\",src:closeIcon,alt:\"\"}),/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"fs-18 f-600\"},displayModelPaymentType)),/*#__PURE__*/React.createElement(\"br\",null),insideRadioButtonData));}}]);return MakePaymentClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{appointmentDetail:state.appointment.appointmentDetail,selected_cstomer:state.common.selected_cstomer,tokenDetails:state.authStore.tokenDetails,CartPaymentDate:state.appointment.CartPaymentDate};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getPayment:getPayment,getCommonApi:getCommonApi,createPayment:createPayment,updateForm:updateForm},dispatch);};export var Payment=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(MakePaymentClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/cart/payment.js"],"names":["React","Component","NormalInput","NormalTextarea","NormalButton","NormalSelect","NormalDate","NormalModal","NormalDateTime","Button","Form","FormGroup","Label","Input","FormText","getPayment","createPayment","connect","bindActionCreators","history","getCommonApi","updateForm","dateFormat","SimpleReactValidator","closeIcon","helpers","Toast","withTranslation","moment","isMoment","MakePaymentClass","state","formFields","name","contact","address","searchStaff","payTableDropDownValue","responseData","premisesOption","selectedCards","selectedCardsPayAmount","cardOption","ewalletoptions","ewalletField","pay_typeid","pay_amt","credit_debit","cardField","pay_rem1","pay_rem2","pay_rem3","pay_rem4","App_code","balance","errorMessage","prepaidCustomerData","voucherCustomerData","creditNoteCustomerData","accountHeader","isMakePaymentButtonClicked","isTreatmentDoneButton","itemProductAmount","itemServiceAmount","itemProductServiceVoucherAmount","displayTablePrepaid","displayTableCreditNote","displayTableVoucher","paytableData","paytableFullData","payGroupData","selectPaymentGroup","selectPaymentGroupId","isSelectedPaymentType","displayModelPaymentType","txtUserPayAmount","isOpenSubPayment","DateofPay","Date","MinimumDate","is_paymentdate","isMakePaymentLoading","componentWillMount","validator","element","message","autoForceUpdate","props","id","cartId","cartData","then","res","console","log","data","status","prepaid_data","setState","Number","billable_amount","prepaid","product_only","service_only","all_only","stringifiedCartData","map","item","recorddetail","parseFloat","total_price","getDataFromResponses","CARD","key","push","label","pay_description","value","CASH","handleMultiple","target","Object","assign","getVoucherData","api","HideVoucherTableData","getPrepaidData","getPrepaidAccountData","itemData","conditiontype1","cust_code","all","exp_status","exp_date","last_update","line_no","pp_amt","pp_bonus","outstanding","pp_no","pp_total","product","remain","sa_date","service","topup_amt","type","use_amt","pp_desc","finalamount","filter","dataitem","prepaid_id","filteritem","deposit","toFixed","HidePrepaidTableData","getCreditNoteAccountData","HideCreditNoteTableData","getPayGroup","pay_group_code","picturelocation","getFullPayTable","getPayTableNameBasedOnId","payTableId","test","handleChange","pay_premise","handleCreditChange","handleTreatmentDone","sa_transacno","handleSubmit","addCreditCard","fieldValid","showMessageFor","userPayAmount","checkPayTypeIdAlreadyExists","result","setBalanceToAllTextBoxes","addPrepaid","selectedPrepaid","prepaidExpDate","format","todaysDate","isValid","isSameOrAfter","selectedRemainingPrepaidAmount","payTypeId","prepaid_ct","setdisplayTablePrepaid","addVoucher","selectedVoucher","selectedVoucherAmount","pay_amt_setup","voucher_no","setdisplayTableVoucher","addCreditNote","selectedCreditNote","selectedCreditNoteAmount","credit_code","transaction","setdisplayTableCreditNote","removeCards","idx","array","index","indexOf","splice","removedTerm","items","valueToRemove","filteredItems","addNewPaymentData","selPayTypeId","selPayTypeName","trim","length","handleDialog","handleChangeCard","handleDatePick","DatePayment","From","firstdayMonth","getFullYear","getMonth","getDate","CartPaymentDate","DateofPayment","event","val","some","creditNote","voucher","t","insideRadioButtonData","cursor","bind","issued_expiry_date","Finaluse_amt","amount","payGroupDataContent","forEach","i","width","padding","getMediaUrl","textAlign","tokenDetails","checkTypeOfCartItemContainsDeposit","userAddedPayTableData","handleChangeTextBox","handleChangeRemarkBox","subtotal","discount","trans_amt","deposit_amt","tax_lable","tax_amt","minWidth","mapStateToProps","appointmentDetail","appointment","selected_cstomer","common","authStore","mapDispatchToProps","dispatch","Payment"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  NormalInput,\r\n  NormalTextarea,\r\n  NormalButton,\r\n  NormalSelect,\r\n  NormalDate,\r\n  NormalModal,\r\n  NormalDateTime,\r\n} from \"component/common\";\r\nimport { Button, Form, FormGroup, Label, Input, FormText } from \"reactstrap\";\r\nimport { getPayment, createPayment } from \"redux/actions/payment\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { history } from \"helpers\";\r\nimport { getCommonApi, updateForm } from \"redux/actions/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport \"./style.scss\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\nimport closeIcon from \"assets/images/close.png\";\r\nimport helpers from \"../../../../service/Helper\";\r\nimport { Toast } from \"service/toast\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport moment from \"moment\";\r\nimport { isMoment } from \"moment\";\r\n\r\nexport class MakePaymentClass extends Component {\r\n  state = {\r\n    formFields: {\r\n      name: \"\",\r\n      contact: \"\",\r\n      address: \"\",\r\n      searchStaff: \"\",\r\n      payTableDropDownValue: \"\",\r\n    },\r\n    responseData: {},\r\n\r\n    premisesOption: [],\r\n    selectedCards: [],\r\n    selectedCardsPayAmount: 0,\r\n    cardOption: [],\r\n    ewalletoptions: [],\r\n\r\n    ewalletField: {\r\n      pay_typeid: null,\r\n      pay_amt: \"\",\r\n      credit_debit: true,\r\n    },\r\n    cardField: {\r\n      pay_typeid: null,\r\n      pay_amt: \"\",\r\n      credit_debit: true,\r\n      pay_rem1: \"\",\r\n      pay_rem2: \"\",\r\n      pay_rem3: \"\",\r\n      pay_rem4: \"\",\r\n      App_code: \"\",\r\n    },\r\n    balance: 0,\r\n    errorMessage: \"123\",\r\n    prepaidCustomerData: [],\r\n    voucherCustomerData: [],\r\n    creditNoteCustomerData: [],\r\n    accountHeader: [],\r\n    isMakePaymentButtonClicked: \"false\",\r\n    isTreatmentDoneButton: true,\r\n    itemProductAmount: 0,\r\n    itemServiceAmount: 0,\r\n    itemProductServiceVoucherAmount: 0,\r\n    displayTablePrepaid: [],\r\n    displayTableCreditNote: [],\r\n    displayTableVoucher: [],\r\n    paytableData: [],\r\n    paytableFullData: [],\r\n    payGroupData: [],\r\n    selectPaymentGroup: \"\",\r\n    selectPaymentGroupId: \"\",\r\n    isSelectedPaymentType: \"\",\r\n    displayModelPaymentType: \"\",\r\n    txtUserPayAmount: 0,\r\n    isOpenSubPayment: false,\r\n    pay_rem4: \"\",\r\n    DateofPay: new Date(),\r\n    MinimumDate: new Date(),\r\n    is_paymentdate: false,\r\n    isMakePaymentLoading: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    //debugger;\r\n    let From = new Date();\r\n    let { MinimumDate, DateofPay } = this.state;\r\n    let firstdayMonth = new Date(\r\n      From.getFullYear(),\r\n      From.getMonth() - 6,\r\n      From.getDate() + 1\r\n    );\r\n\r\n    if (\r\n      this.props.CartPaymentDate &&\r\n      this.props.CartPaymentDate[\"DateofPayment\"]\r\n    ) {\r\n      DateofPay = new Date(this.props.CartPaymentDate.DateofPayment);\r\n    } else {\r\n      DateofPay = new Date();\r\n    }\r\n    MinimumDate = firstdayMonth;\r\n    this.setState({\r\n      MinimumDate,\r\n      DateofPay,\r\n    });\r\n    this.getPayment();\r\n    this.getPayGroup();\r\n    this.getFullPayTable();\r\n    this.getPrepaidData();\r\n    this.getCreditNoteAccountData(\"\");\r\n    this.getVoucherData(\"\");\r\n    console.log(\"cartdata From cart\", this.props.cartData);\r\n  }\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n  };\r\n  // get method for payment detail against appointment\r\n  getPayment = () => {\r\n    let { id, cartId, cartData } = this.props;\r\n\r\n    //id = 82318;\r\n    //cartId = \"ICMD100226\";\r\n    //cartData={\"status\":200,\"message\":\"Listed Succesfully\",\"error\":false,\"data\":[{\"id\":57500,\"cust_noid\":82318,\"customer\":\"test17011\",\"customercode\":\"021427HQ\",\"cart_id\":\"ICHQ100234\",\"cart_date\":\"2021-03-14\",\"cart_status\":\"Inprogress\",\"lineno\":1,\"check\":\"New\",\"itemcodeid\":10067,\"itemdesc\":\"Short - Chin Length(Before Shoulder) 128\",\"quantity\":1,\"price\":\"128.00\",\"total_price\":\"128.00\",\"sitecodeid\":31,\"sitecode_name\":\"HQ OFFICE (DEMO)\",\"sitecode\":\"HQ\",\"discount\":\"0.00\",\"discount_amt\":0,\"discount_price\":\"128.00\",\"additional_discount\":0,\"additional_discountamt\":0,\"deposit\":\"128.00\",\"trans_amt\":\"128.00\",\"tax\":0,\"itemstatus\":null,\"ratio\":\"100.000000000000000\",\"helper_name\":null,\"done_sessions\":null,\"type\":\"Deposit\",\"treatment_account\":null,\"treatment\":null,\"deposit_account\":null,\"prepaid_account\":null,\"item_uom\":null,\"recorddetail\":\"Service\",\"itemtype\":\"SINGLE\",\"item_class\":\"HERBAL TREATMENT\",\"sales_staff\":\"SEQ ADMIN\",\"service_staff\":\"\",\"total_disc\":\"0.00\",\"treatment_name\":\"Short - Chin Length(Before Shoulder) 128  (1)\",\"item_name\":\"Short - Chin Length(Before Shoulder) 128\"}],\"subtotal\":\"128.00\",\"discount\":\"0.00\",\"trans_amt\":\"128.00\",\"deposit_amt\":\"128.00\",\"billable_amount\":\"128.00\"}\r\n    if (id) {\r\n      this.props\r\n        .getPayment(\r\n          `?cart_date=${dateFormat(\r\n            new Date(),\r\n            \"yyyy-mm-dd\"\r\n          )}&cust_noid=${id}&cart_id=${cartId}`\r\n        )\r\n        .then(res => {\r\n          console.log(\"Payment Details:\", res);\r\n          let { data, status, prepaid_data } = res;\r\n          if (status === 200) {\r\n            this.setState({\r\n              responseData: data,\r\n              balance: Number(data.billable_amount),\r\n              txtUserPayAmount: Number(data.billable_amount),\r\n              prepaid_data: prepaid_data.prepaid,\r\n              product_only: prepaid_data.product_only,\r\n              service_only: prepaid_data.service_only,\r\n              all_only: prepaid_data.all_only,\r\n              is_paymentdate: data.is_paymentdate,\r\n            });\r\n          }\r\n        });\r\n    }\r\n\r\n    //let {cartData} = this.props;\r\n    let stringifiedCartData = cartData.data;\r\n\r\n    let {\r\n      itemProductAmount,\r\n      itemServiceAmount,\r\n      itemProductServiceVoucherAmount,\r\n    } = this.state;\r\n    if (stringifiedCartData) {\r\n      stringifiedCartData.map(item => {\r\n        //alert(JSON.stringify(item));\r\n        if (item.recorddetail === \"Product\") {\r\n          itemProductAmount += parseFloat(item.total_price);\r\n        }\r\n        if (item.recorddetail === \"Service\") {\r\n          itemServiceAmount += parseFloat(item.total_price);\r\n          console.log(itemServiceAmount);\r\n          console.log(item.total_price);\r\n        }\r\n        if (\r\n          item.recorddetail === \"Product\" ||\r\n          item.recorddetail === \"Service\" ||\r\n          item.recorddetail === \"Voucher\"\r\n        ) {\r\n          itemProductServiceVoucherAmount += parseFloat(item.total_price);\r\n        }\r\n      });\r\n    }\r\n    this.setState({\r\n      itemProductAmount,\r\n      itemServiceAmount,\r\n      itemProductServiceVoucherAmount,\r\n    });\r\n  };\r\n  // set data to dropdown fields\r\n  getDataFromResponses = data => {\r\n    let { cardOption, premisesOption } = this.state;\r\n    for (let key of data.CARD) {\r\n      cardOption.push({ label: key.pay_description, value: key.id });\r\n    }\r\n    for (let key of data.CASH) {\r\n      premisesOption.push({ label: key.pay_description, value: key.id });\r\n    }\r\n    this.setState({\r\n      cardOption,\r\n      premisesOption,\r\n    });\r\n  };\r\n\r\n  handleMultiple = ({ target: { value, name } }) => {\r\n    console.log(\"handleMultiple\", value, name);\r\n    let formFields = Object.assign({}, this.state.formFields);\r\n\r\n    formFields[name] = value;\r\n\r\n    this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n  getVoucherData = api => {\r\n    this.props\r\n      .getCommonApi(`voucher/?cust_id=${this.props.id}${api}`)\r\n      .then(key => {\r\n        let { data } = key;\r\n        let { voucherCustomerData } = this.state;\r\n        voucherCustomerData = data;\r\n        console.log(\"voucherCustomerData\", data);\r\n        // accountHeader = header_data;\r\n        this.setState({ voucherCustomerData }, () => {\r\n          console.log(\"test\");\r\n          this.HideVoucherTableData();\r\n        });\r\n      });\r\n  };\r\n\r\n  getPrepaidData = () => {\r\n    this.getPrepaidAccountData(\"\");\r\n  };\r\n  getPrepaidAccountData = api => {\r\n    console.log(\"dd\");\r\n\r\n    this.props\r\n      .getCommonApi(`prepaidacclist/?cust_id=${this.props.id}${api}`)\r\n      .then(key => {\r\n        let { data } = key;\r\n        let { prepaidCustomerData } = this.state;\r\n        //prepaidCustomerData = data;\r\n        prepaidCustomerData = [];\r\n        console.log(\"prepaidCustomerData\", data);\r\n        for (let item of data) {\r\n          let itemData = {};\r\n          itemData[\"conditiontype1\"] = item.conditiontype1;\r\n          itemData[\"cust_code\"] = item.cust_code;\r\n          itemData[\"all\"] = item.all;\r\n          itemData[\"exp_status\"] = item.exp_status;\r\n          itemData[\"exp_date\"] = item.exp_date;\r\n          itemData[\"last_update\"] = item.last_update;\r\n          itemData[\"line_no\"] = item.line_no;\r\n          itemData[\"id\"] = item.id;\r\n          itemData[\"pp_amt\"] = item.pp_amt;\r\n          itemData[\"pp_bonus\"] = item.pp_bonus;\r\n          itemData[\"outstanding\"] = item.outstanding;\r\n          itemData[\"pp_no\"] = item.pp_no;\r\n          itemData[\"pp_total\"] = item.pp_total;\r\n          itemData[\"prepaid\"] = item.prepaid;\r\n          itemData[\"product\"] = item.product;\r\n          itemData[\"remain\"] = item.remain;\r\n          itemData[\"sa_date\"] = item.sa_date;\r\n          itemData[\"service\"] = item.service;\r\n          itemData[\"topup_amt\"] = item.topup_amt;\r\n          itemData[\"type\"] = item.type;\r\n          itemData[\"use_amt\"] = item.use_amt;\r\n          itemData[\"pp_desc\"] = item.pp_desc;\r\n\r\n          if (item.conditiontype1 === \"Service Only\") {\r\n            if (Number(this.state.service_only) > Number(item.remain)) {\r\n              itemData[\"Finaluse_amt\"] = item.remain;\r\n            } else {\r\n              itemData[\"Finaluse_amt\"] = this.state.service_only;\r\n            }\r\n          }\r\n          if (item.conditiontype1 === \"Product Only\") {\r\n            if (Number(this.state.product_only) > Number(item.remain)) {\r\n              itemData[\"Finaluse_amt\"] = item.remain;\r\n            } else {\r\n              itemData[\"Finaluse_amt\"] = this.state.product_only;\r\n            }\r\n          }\r\n          if (item.conditiontype1 === \"All\") {\r\n            let finalamount = Number(this.state.all_only);\r\n            if (this.state.prepaid_data) {\r\n              this.state.prepaid_data\r\n                .filter(dataitem => dataitem.prepaid_id == item.id)\r\n                .map(filteritem => {\r\n                  finalamount =\r\n                    Number(this.state.all_only) - Number(filteritem.deposit);\r\n                });\r\n            }\r\n\r\n            if (Number(finalamount) > Number(item.remain)) {\r\n              itemData[\"Finaluse_amt\"] = Number(item.remain).toFixed(2);\r\n            } else {\r\n              itemData[\"Finaluse_amt\"] = Number(finalamount).toFixed(2);\r\n            }\r\n          }\r\n\r\n          prepaidCustomerData.push(itemData);\r\n        }\r\n        this.setState({ prepaidCustomerData }, () => {\r\n          this.HidePrepaidTableData();\r\n        });\r\n      });\r\n\r\n    // accountHeader = header_data;\r\n  };\r\n  getCreditNoteAccountData = api => {\r\n    this.props\r\n      .getCommonApi(`creditnotelist/?cust_id=${this.props.id}${api}`)\r\n      .then(key => {\r\n        let { data } = key;\r\n        let { creditNoteCustomerData } = this.state;\r\n        creditNoteCustomerData = data;\r\n        // accountHeader = header_data;\r\n        this.setState({ creditNoteCustomerData }, () => {\r\n          this.HideCreditNoteTableData();\r\n        });\r\n      });\r\n  };\r\n  getPayGroup = () => {\r\n    this.props.getCommonApi(`paygroup/`).then(res => {\r\n      let { payGroupData } = this.state;\r\n      for (let key of res.data) {\r\n        payGroupData.push({\r\n          label: key.pay_group_code,\r\n          value: key.id,\r\n          picturelocation: key.picturelocation,\r\n        });\r\n      }\r\n      this.setState({\r\n        payGroupData,\r\n      });\r\n    });\r\n  };\r\n  getFullPayTable = () => {\r\n    this.props.getCommonApi(`paytablenew/`).then(res => {\r\n      let { paytableFullData } = this.state;\r\n      paytableFullData = res.data;\r\n      this.setState({\r\n        paytableFullData,\r\n      });\r\n    });\r\n  };\r\n\r\n  getPayTableNameBasedOnId = payTableId => {\r\n    //debugger;\r\n    console.log(payTableId);\r\n    let { paytableFullData } = this.state;\r\n    const test = paytableFullData.filter(res => res.id == payTableId);\r\n    return test[0].pay_description;\r\n  };\r\n\r\n  handleChangeTextBox(event) {\r\n    this.setState({\r\n      txtUserPayAmount: event.target.value,\r\n    });\r\n  }\r\n  handleChangeRemarkBox(event) {\r\n    this.setState({\r\n      pay_rem4: event.target.value,\r\n    });\r\n  }\r\n  handleChange = ({ target: { value, name } }) => {\r\n    let formFields = Object.assign({}, this.state.formFields);\r\n\r\n    formFields[name] = value;\r\n    this.setState({\r\n      formFields,\r\n    });\r\n    let { balance, selectedCards, txtUserPayAmount, isOpenSubPayment } =\r\n      this.state;\r\n    isOpenSubPayment = false;\r\n    selectedCards.push({\r\n      pay_typeid: value,\r\n      pay_amt: parseFloat(txtUserPayAmount),\r\n      credit_debit: false,\r\n      pay_premise: true,\r\n      prepaid: false,\r\n      pay_rem4: this.state.pay_rem4,\r\n    });\r\n    balance = parseFloat(balance - txtUserPayAmount).toFixed(2);\r\n    txtUserPayAmount = balance;\r\n    this.setState({ txtUserPayAmount, balance, isOpenSubPayment });\r\n  };\r\n  handleCreditChange = ({ target: { value, name } }) => {\r\n    let cardField = Object.assign({}, this.state.cardField);\r\n\r\n    cardField[name] = value;\r\n    this.setState({\r\n      cardField,\r\n    });\r\n  };\r\n  handleTreatmentDone = () => {\r\n    let { selectedCards, DateofPay } = this.state;\r\n    selectedCards.push({\r\n      pay_typeid: 2,\r\n      //pay_typeid: 1,\r\n      pay_amt: 0,\r\n      credit_debit: false,\r\n      pay_premise: true,\r\n      prepaid: false,\r\n      pay_rem4: this.state.pay_rem4,\r\n    });\r\n    let data = selectedCards;\r\n    let { id, cartId } = this.props;\r\n    this.props\r\n      .createPayment(\r\n        `?cart_date=${dateFormat(\r\n          new Date(),\r\n          \"yyyy-mm-dd\"\r\n        )}&cust_noid=${id}&cart_id=${cartId}&pay_date=${dateFormat(\r\n          new Date(DateofPay),\r\n          \"yyyy-mm-dd\"\r\n        )}`,\r\n        data\r\n      )\r\n      .then(res => {\r\n        history.push(`/admin/billing/print/bill/${res.data.sa_transacno}`);\r\n      });\r\n  };\r\n  // create payment detail\r\n  handleSubmit = () => {\r\n    this.setState({\r\n      isMakePaymentLoading: true,\r\n    });\r\n    let { selectedCards, DateofPay } = this.state;\r\n    this.setState({ isMakePaymentButtonClicked: \"true\" });\r\n    console.log(\r\n      \"Selected Date: \",\r\n      dateFormat(new Date(DateofPay), \"yyyy-mm-dd\")\r\n    );\r\n    let data = selectedCards;\r\n    console.log(\"SubmitDatapayment\", data);\r\n    let { id, cartId } = this.props;\r\n    this.props\r\n      .createPayment(\r\n        `?cart_date=${dateFormat(\r\n          new Date(),\r\n          \"yyyy-mm-dd\"\r\n        )}&cust_noid=${id}&cart_id=${cartId}&pay_date=${dateFormat(\r\n          new Date(DateofPay),\r\n          \"yyyy-mm-dd\"\r\n        )}`,\r\n        data\r\n      )\r\n      .then(res => {\r\n        this.setState({\r\n          isMakePaymentLoading: false,\r\n        });\r\n        history.push(`/admin/billing/print/bill/${res.data.sa_transacno}`);\r\n      });\r\n    this.setState({\r\n      isMakePaymentLoading: false,\r\n    });\r\n  };\r\n  checkPayTypeIdAlreadyExists(val) {\r\n    return this.state.selectedCards.some(item => val === item.pay_typeid);\r\n  }\r\n  addCreditCard = async () => {\r\n    if (!this.validator.fieldValid(\"cardFieldType\")) {\r\n      this.validator.showMessageFor(\"cardFieldType\");\r\n      return;\r\n    }\r\n\r\n    let { cardField, selectedCards, balance, responseData, txtUserPayAmount } =\r\n      this.state;\r\n    let userPayAmount = parseFloat(txtUserPayAmount);\r\n    if (parseFloat(this.state.responseData.billable_amount) > 0) {\r\n      if (userPayAmount == 0) {\r\n        return;\r\n      }\r\n    }\r\n    if (this.checkPayTypeIdAlreadyExists(cardField.pay_typeid)) {\r\n      let result =\r\n        this.getPayTableNameBasedOnId(cardField.pay_typeid) + \" already exists\";\r\n      Toast({\r\n        type: \"error\",\r\n        message: result,\r\n      });\r\n      // alert(\r\n      //   this.getPayTableNameBasedOnId(cardField.pay_typeid) + \" already exists\"\r\n      // );\r\n      return;\r\n    } else {\r\n      selectedCards.push({\r\n        pay_typeid: cardField.pay_typeid,\r\n        pay_amt: userPayAmount,\r\n        credit_debit: true,\r\n        pay_premise: false,\r\n        pay_rem1: cardField.pay_rem1,\r\n        pay_rem2: cardField.pay_rem2,\r\n        pay_rem3: cardField.pay_rem3,\r\n        pay_rem4: this.state.pay_rem4,\r\n        prepaid: false,\r\n      });\r\n    }\r\n\r\n    balance = parseFloat(balance - userPayAmount).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  addPrepaid = selectedPrepaid => {\r\n    const prepaidExpDate = moment(selectedPrepaid.exp_date).format(\r\n      \"YYYY-MM-DD\"\r\n    );\r\n    const todaysDate = moment(new Date()).format(\"YYYY-MM-DD\");\r\n    const isValid = moment(todaysDate).isSameOrAfter(prepaidExpDate);\r\n    let userPayAmount = 0;\r\n    let {\r\n      itemServiceAmount,\r\n      itemProductAmount,\r\n      itemProductServiceVoucherAmount,\r\n      txtUserPayAmount,\r\n    } = this.state;\r\n    console.log(txtUserPayAmount);\r\n    userPayAmount = parseFloat(txtUserPayAmount);\r\n    if (isValid) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Check Expiry Date\",\r\n      });\r\n      return;\r\n    }\r\n    if (userPayAmount <= 0) {\r\n      // alert(\"hi\");\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Prepaid is Not allowed\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    let selectedRemainingPrepaidAmount = parseFloat(selectedPrepaid.remain);\r\n\r\n    if (selectedRemainingPrepaidAmount < userPayAmount) {\r\n      //return\r\n    } else if (selectedRemainingPrepaidAmount > userPayAmount) {\r\n      selectedRemainingPrepaidAmount = parseFloat(userPayAmount);\r\n    }\r\n    /*\r\n    if (!this.validator.fieldValid(\"PrepaidBalanceAmount\")) {\r\n      this.validator.showMessageFor(\"PrepaidBalanceAmount\");\r\n      return;\r\n    }\r\n    if (!this.validator.fieldValid(\"PrepaidBalanceAmount\")) {\r\n      this.validator.showMessageFor(\"PrepaidBalanceAmount\");\r\n      return;\r\n    }\r\n*/\r\n    if (selectedPrepaid.conditiontype1 === \"Service Only\") {\r\n      //For Service\r\n      if (parseFloat(itemServiceAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is Not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (parseFloat(itemServiceAmount) <= selectedRemainingPrepaidAmount) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) < parseFloat(itemServiceAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemServiceAmount);\r\n        console.log(itemServiceAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemServiceAmount = itemServiceAmount - userPayAmount;\r\n      this.setState({ itemServiceAmount });\r\n    } else if (selectedPrepaid.conditiontype1 === \"Product Only\") {\r\n      //For Product\r\n      if (parseFloat(itemProductAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (parseFloat(itemProductAmount) <= selectedRemainingPrepaidAmount) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) < parseFloat(itemProductAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemProductAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemProductAmount = itemProductAmount - userPayAmount;\r\n      this.setState({ itemProductAmount });\r\n    } else {\r\n      if (parseFloat(itemProductServiceVoucherAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (\r\n        parseFloat(itemProductServiceVoucherAmount) <=\r\n        selectedRemainingPrepaidAmount\r\n      ) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) <\r\n          parseFloat(itemProductServiceVoucherAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemProductServiceVoucherAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemProductServiceVoucherAmount =\r\n        itemProductServiceVoucherAmount - userPayAmount;\r\n      this.setState({ itemProductServiceVoucherAmount });\r\n    }\r\n    if (userPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Prepaid is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const payTypeId = 23; //normal\r\n    //const payTypeId = 19; //healspa\r\n    //const payTypeId = 8; //glamour\r\n    //const payTypeId = 9; //beskin\r\n\r\n    let { cardField, ewalletField, balance, selectedCards, isOpenSubPayment } =\r\n      this.state;\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: true,\r\n      pay_amt: userPayAmount,\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1:\r\n        selectedPrepaid.pp_no +\r\n        \" - \" +\r\n        selectedPrepaid.line_no +\r\n        \" - \" +\r\n        selectedPrepaid.pp_desc,\r\n      pay_rem2: selectedPrepaid.id,\r\n      pay_rem4: this.state.pay_rem4,\r\n      prepaid_ct: selectedPrepaid.conditiontype1,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTablePrepaid\",\r\n      this.state.displayTablePrepaid\r\n    );\r\n    let setdisplayTablePrepaid = this.state.displayTablePrepaid;\r\n    setdisplayTablePrepaid.push(selectedPrepaid.id);\r\n    this.setState({ displayTablePrepaid: setdisplayTablePrepaid });\r\n    console.log(\"AfterAdd-displayTablePrepaid\", this.state.displayTablePrepaid);\r\n    this.HidePrepaidTableData();\r\n\r\n    balance = parseFloat(balance - userPayAmount).toFixed(2);\r\n    this.setBalanceToAllTextBoxes(balance);\r\n    console.log(balance);\r\n    this.setState({ isOpenSubPayment: false });\r\n  };\r\n  HidePrepaidTableData() {\r\n    let { prepaidCustomerData, displayTablePrepaid } = this.state;\r\n    displayTablePrepaid.map(item => {\r\n      var selectedPrepaid = prepaidCustomerData.filter(\r\n        prepaid => prepaid.id != item\r\n      );\r\n      this.setState({ prepaidCustomerData: selectedPrepaid });\r\n    });\r\n  }\r\n  HideCreditNoteTableData() {\r\n    let { creditNoteCustomerData, displayTableCreditNote } = this.state;\r\n    displayTableCreditNote.map(item => {\r\n      var selectedCreditNote = creditNoteCustomerData.filter(\r\n        creditNote => creditNote.credit_code != item\r\n      );\r\n      this.setState({ creditNoteCustomerData: selectedCreditNote });\r\n    });\r\n  }\r\n  HideVoucherTableData() {\r\n    let { voucherCustomerData, displayTableVoucher } = this.state;\r\n    displayTableVoucher.map(item => {\r\n      var selectedVoucher = voucherCustomerData.filter(\r\n        voucher => voucher.voucher_no != item\r\n      );\r\n      this.setState({ voucherCustomerData: selectedVoucher });\r\n    });\r\n  }\r\n  addVoucher = selectedVoucher => {\r\n    let {\r\n      cardField,\r\n      ewalletField,\r\n      balance,\r\n      txtUserPayAmount,\r\n      isOpenSubPayment,\r\n      selectedCards,\r\n    } = this.state;\r\n    if (txtUserPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Voucher is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const selectedVoucherAmount = parseFloat(selectedVoucher.value);\r\n    let pay_amt_setup = 0;\r\n    if (selectedVoucherAmount <= parseFloat(txtUserPayAmount)) {\r\n      pay_amt_setup = selectedVoucherAmount;\r\n    } else {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Partial Amount is not applicable in voucher\",\r\n      });\r\n      return;\r\n      // alert(\"Partial Amount is not applicable in voucher\");\r\n      // return;\r\n    }\r\n    const payTypeId = 9; //normal\r\n    //const payTypeId = 8; //healspa\r\n    //const payTypeId = 4; //glamour\r\n    //const payTypeId = 5; //beskin\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: false,\r\n      pay_amt: parseFloat(pay_amt_setup),\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1: selectedVoucher.voucher_no,\r\n      pay_rem2: selectedVoucher.voucher_no,\r\n      pay_rem4: this.state.pay_rem4,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTableVoucher\",\r\n      this.state.displayTableVoucher\r\n    );\r\n    let setdisplayTableVoucher = this.state.displayTableVoucher;\r\n    setdisplayTableVoucher.push(selectedVoucher.voucher_no);\r\n    this.setState({ displayTableVoucher: setdisplayTableVoucher });\r\n    console.log(\r\n      \"AfterAdd-displayTableCreditNote\",\r\n      this.state.displayTableVoucher\r\n    );\r\n    this.HideVoucherTableData();\r\n\r\n    balance = parseFloat(balance - pay_amt_setup).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  addCreditNote = selectedCreditNote => {\r\n    console.log(selectedCreditNote);\r\n    let { cardField, ewalletField, balance, txtUserPayAmount, selectedCards } =\r\n      this.state;\r\n    if (txtUserPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Credit Note is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const selectedCreditNoteAmount = parseFloat(selectedCreditNote.balance);\r\n    console.log(selectedCreditNoteAmount);\r\n    let pay_amt_setup = 0;\r\n    if (selectedCreditNoteAmount <= parseFloat(txtUserPayAmount)) {\r\n      pay_amt_setup = selectedCreditNoteAmount;\r\n    } else {\r\n      pay_amt_setup = txtUserPayAmount;\r\n    }\r\n    const payTypeId = 17; //normal\r\n    //const payTypeId = 12; //healspa\r\n    //const payTypeId = 5; //glamour\r\n    //const payTypeId = 6; //beskin\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: false,\r\n      pay_amt: parseFloat(pay_amt_setup),\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1: selectedCreditNote.credit_code,\r\n      pay_rem2: selectedCreditNote.transaction,\r\n      pay_rem4: this.state.pay_rem4,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTableCreditNote\",\r\n      this.state.displayTableCreditNote\r\n    );\r\n    let setdisplayTableCreditNote = this.state.displayTableCreditNote;\r\n    setdisplayTableCreditNote.push(selectedCreditNote.credit_code);\r\n    this.setState({ displayTableCreditNote: setdisplayTableCreditNote });\r\n    console.log(\r\n      \"AfterAdd-displayTableCreditNote\",\r\n      this.state.displayTableCreditNote\r\n    );\r\n    this.HideCreditNoteTableData();\r\n\r\n    balance = parseFloat(balance - pay_amt_setup).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n\r\n  setBalanceToAllTextBoxes(balance) {\r\n    this.setState({\r\n      balance: balance,\r\n      txtUserPayAmount: balance,\r\n    });\r\n  }\r\n  removeCards = idx => () => {\r\n    let {\r\n      selectedCards,\r\n      balance,\r\n      cardField,\r\n      ewalletField,\r\n      itemProductServiceVoucherAmount,\r\n      itemProductAmount,\r\n      itemServiceAmount,\r\n    } = this.state;\r\n    this.setState({ isMakePaymentButtonClicked: \"false\" });\r\n    balance = parseFloat(balance) + parseFloat(idx.pay_amt);\r\n    var array = [...selectedCards]; // make a separate copy of the array\r\n    var index = array.indexOf(idx);\r\n    if (idx.pay_typeid == 23) { //normal\r\n    //if (idx.pay_typeid == 19) { //normal\r\n    //if (idx.pay_typeid == 8) { //glamour\r\n    //if (idx.pay_typeid == 9) { //beskin\r\n        if (idx.prepaid_ct == \"Product Only\") {\r\n        itemProductAmount = itemProductAmount + idx.pay_amt;\r\n      } else if (idx.prepaid_ct == \"Service Only\") {\r\n        itemServiceAmount = itemServiceAmount + idx.pay_amt;\r\n      } else {\r\n        itemProductServiceVoucherAmount =\r\n          itemProductServiceVoucherAmount + idx.pay_amt;\r\n      }\r\n      this.setState({\r\n        itemProductServiceVoucherAmount,\r\n        itemProductAmount,\r\n        itemServiceAmount,\r\n      });\r\n    }\r\n    if (index !== -1) {\r\n      array.splice(index, 1);\r\n      this.setState({ selectedCards: array, balance });\r\n    }\r\n    //console.log(\"idx\", idx);\r\n    var removedTerm = idx.pay_typeid;\r\n    //console.log(\"removedTerm\", removedTerm);\r\n    //console.log(\"idx.pay_rem2\", idx.pay_rem2);\r\n    if (removedTerm == \"23\") { //normal\r\n    //if (removedTerm == \"19\") { //healspa\r\n    //if (removedTerm == \"8\") { //glamour\r\n    //if (removedTerm == \"9\") { //beskin\r\n      const items = this.state.displayTablePrepaid;\r\n      console.log(\"BeforeRemove-displayTablePrepaid\", items);\r\n      const valueToRemove = idx.pay_rem2; //For Prepaid Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTablePrepaid: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTablePrepaid\",\r\n          this.state.displayTablePrepaid\r\n        );\r\n      });\r\n      this.getPrepaidAccountData(\"\");\r\n      // this.HidePrepaidTableData();\r\n    }\r\n    if (removedTerm == \"17\") { //normal\r\n    //if (removedTerm == \"12\") { //normal\r\n    //if (removedTerm == \"5\") { //glamour\r\n    //if (removedTerm == \"6\") { //beskin\r\n        const items = this.state.displayTableCreditNote;\r\n      console.log(\"BeforeRemove-displayTableCreditNote\", items);\r\n      const valueToRemove = idx.pay_rem1; //For Credit Note Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTableCreditNote: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTableCreditNote\",\r\n          this.state.displayTableCreditNote\r\n        );\r\n      });\r\n      this.getCreditNoteAccountData(\"\");\r\n      // this.HidePrepaidTableData();\r\n    }\r\n    if (removedTerm == \"9\") { //normal\r\n    //if (removedTerm == \"8\") { //healspa\r\n    //if (removedTerm == \"4\") { //glamour\r\n    //if (removedTerm == \"5\") { //beskin\r\n        const items = this.state.displayTableVoucher;\r\n      console.log(\"BeforeRemove-displayTableVoucher\", items);\r\n      const valueToRemove = idx.pay_rem1; //For Credit Note Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTableVoucher: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTableVoucher\",\r\n          this.state.displayTableVoucher\r\n        );\r\n      });\r\n      this.getVoucherData(\"\");\r\n    }\r\n    cardField[\"pay_amt\"] = balance;\r\n    ewalletField[\"pay_amt\"] = balance;\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  checkTypeOfCartItemContainsDeposit(cartData) {\r\n    let stringifiedCartData = cartData.data;\r\n    if (stringifiedCartData) {\r\n      stringifiedCartData.map(item => {\r\n        if (item.type === \"Deposit\" || item.type === \"Top Up\") {\r\n          this.state.isTreatmentDoneButton = false;\r\n        }\r\n      });\r\n    }\r\n  }\r\n  addNewPaymentData = async (selPayTypeId, selPayTypeName) => {\r\n    if (!this.validator.fieldValid(\"Amount\")) {\r\n      this.validator.showMessageFor(\"Amount\");\r\n      return;\r\n    }\r\n    if (!this.validator.fieldValid(\"Amount\")) {\r\n      this.validator.showMessageFor(\"Amount\");\r\n      return;\r\n    }\r\n\r\n    this.props\r\n      .getCommonApi(`paytablenew/?paygroupid=${selPayTypeId}`)\r\n      .then(res => {\r\n        this.setState({\r\n          paytableData: [],\r\n        });\r\n        let { paytableData, isSelectedPaymentType, displayModelPaymentType } =\r\n          this.state;\r\n        isSelectedPaymentType = selPayTypeName.trim();\r\n        displayModelPaymentType = selPayTypeName.trim();\r\n        for (let key of res.data) {\r\n          paytableData.push({ label: key.pay_description, value: key.id });\r\n        }\r\n        this.setState(\r\n          {\r\n            paytableData,\r\n          },\r\n          () => {\r\n            let { isOpenSubPayment } = this.state;\r\n            if (paytableData.length == 0) {\r\n              Toast({\r\n                type: \"error\",\r\n                message: \"Pay Table Not Exists\",\r\n              });\r\n              return;\r\n            } else if (selPayTypeName.trim() === \"VOUCHER\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"PREPAID\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"Credit\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"CARD\") {\r\n              isOpenSubPayment = true;\r\n            } else if (paytableData.length == 1) {\r\n              isOpenSubPayment = false;\r\n              let payTypeId = paytableData[0].value;\r\n              let { balance, selectedCards, txtUserPayAmount } = this.state;\r\n              if (parseFloat(this.state.responseData.billable_amount) > 0) {\r\n                if (parseFloat(txtUserPayAmount) == 0) {\r\n                  return;\r\n                }\r\n              }\r\n              if (this.checkPayTypeIdAlreadyExists(payTypeId)) {\r\n                // alert(\r\n                //   this.getPayTableNameBasedOnId(payTypeId) + \" already exists\"\r\n                // );\r\n                let result =\r\n                  this.getPayTableNameBasedOnId(payTypeId) + \" already exists\";\r\n                Toast({\r\n                  type: \"error\",\r\n                  message: result,\r\n                });\r\n                //alert(\"Already Exists\");\r\n                return;\r\n              } else {\r\n                selectedCards.push({\r\n                  pay_typeid: payTypeId,\r\n                  pay_amt: parseFloat(txtUserPayAmount),\r\n                  credit_debit: false,\r\n                  pay_premise: true,\r\n                  prepaid: false,\r\n                  pay_rem4: this.state.pay_rem4,\r\n                });\r\n                balance = parseFloat(balance - txtUserPayAmount).toFixed(2);\r\n                txtUserPayAmount = balance;\r\n                this.setState({ txtUserPayAmount, balance });\r\n                return;\r\n              }\r\n            } else if (paytableData.length >= 1) {\r\n              isOpenSubPayment = true;\r\n              isSelectedPaymentType = \"Multiple\";\r\n            }\r\n            this.setState({\r\n              isOpenSubPayment,\r\n              isSelectedPaymentType,\r\n              displayModelPaymentType,\r\n            });\r\n          }\r\n        );\r\n      });\r\n  };\r\n\r\n  handleDialog = async () => {\r\n    let { isOpenSubPayment } = this.state;\r\n    isOpenSubPayment = false;\r\n    await this.setState({\r\n      isOpenSubPayment,\r\n    });\r\n  };\r\n\r\n  handleChangeCard = async ({ target: { value, name } }) => {\r\n    let cardField = Object.assign({}, this.state.cardField);\r\n\r\n    cardField[name] = value;\r\n\r\n    await this.setState({\r\n      cardField,\r\n    });\r\n  };\r\n  handleDatePick = async ({ target: { value, name } }) => {\r\n    let { DateofPay } = this.state;\r\n    DateofPay = value;\r\n    await this.setState({\r\n      DateofPay,\r\n    });\r\n\r\n    let DatePayment = {};\r\n    DatePayment[\"DateofPayment\"] = value;\r\n    await this.props.updateForm(\"CartPaymentDate\", DatePayment);\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      responseData,\r\n      balance,\r\n      isTreatmentDoneButton,\r\n      payGroupData,\r\n      paytableData,\r\n      isOpenSubPayment,\r\n      isSelectedPaymentType,\r\n      displayModelPaymentType,\r\n      cardField,\r\n      pay_rem4,\r\n      DateofPay,\r\n      MinimumDate,\r\n      is_paymentdate,\r\n      isMakePaymentLoading,\r\n    } = this.state;\r\n    let { t } = this.props;\r\n    let { payTableDropDownValue } = this.state.formFields;\r\n    console.log(payTableDropDownValue);\r\n    let insideRadioButtonData;\r\n    console.log(isSelectedPaymentType, \"selectedpaymenttype\");\r\n    if (isSelectedPaymentType == \"VOUCHER\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-bordered\">\r\n            <tr>\r\n              <td>{t(\"Vocucher No\")}</td>\r\n              <td>{t(\"Value\")}</td>\r\n              <td>{t(\"Exp. Date\")}</td>\r\n            </tr>\r\n            {this.state.voucherCustomerData.map((selectedVoucher, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addVoucher.bind(this, selectedVoucher)}\r\n              >\r\n                <td>{selectedVoucher.voucher_no}</td>\r\n                <td>{selectedVoucher.value}</td>\r\n                <td>{selectedVoucher.issued_expiry_date}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"PREPAID\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-striped\">\r\n            <tr>\r\n              <td>{t(\"Category\")}</td>\r\n              <td>{t(\"Amount\")}</td>\r\n              <td>{t(\"Remaining\")}</td>\r\n              <td>{t(\"Invoice No.\")}</td>\r\n              <td>{t(\"Exp. Date\")}</td>\r\n              <td>{t(\"Condition Type\")}</td>\r\n              <td>{t(\"Use Amount\")}</td>\r\n            </tr>\r\n            {this.state.prepaidCustomerData.map((selectedPrepaid, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addPrepaid.bind(this, selectedPrepaid)}\r\n              >\r\n                <td>{selectedPrepaid.pp_desc}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.pp_total}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.remain}</td>\r\n                <td>{selectedPrepaid.prepaid}</td>\r\n                <td>{selectedPrepaid.exp_date}</td>\r\n                <td>{selectedPrepaid.conditiontype1}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.Finaluse_amt}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"Credit\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-striped\">\r\n            <tr>\r\n              <td>{t(\"Credit\")} #</td>\r\n              <td>{t(\"Date\")}</td>\r\n              <td>{t(\"Amount\")}</td>\r\n              <td>{t(\"Balance\")}</td>\r\n              <td>{t(\"Status\")}</td>\r\n            </tr>\r\n            {this.state.creditNoteCustomerData.map((creditNote, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addCreditNote.bind(this, creditNote)}\r\n              >\r\n                <td>{creditNote.credit_code}</td>\r\n                <td>{creditNote.sa_date}</td>\r\n                <td>{creditNote.amount}</td>\r\n                <td>{creditNote.balance}</td>\r\n                <td>{creditNote.status}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"CARD\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <div className=\"d-flex flex-wrap justify-content-start\">\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Select Card\")}\r\n                <NormalSelect\r\n                  placeholder=\"Search type...\"\r\n                  options={paytableData}\r\n                  value={cardField.pay_typeid}\r\n                  name=\"pay_typeid\"\r\n                  onChange={this.handleCreditChange}\r\n                />\r\n              </div>\r\n              {this.validator.message(\r\n                \"cardFieldType\",\r\n                cardField.pay_typeid,\r\n                \"required\"\r\n              )}\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Card No.\")}\r\n                <NormalInput\r\n                  value={cardField.pay_rem1}\r\n                  name=\"pay_rem1\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Name\")}\r\n                <NormalInput\r\n                  value={cardField.pay_rem2}\r\n                  name=\"pay_rem2\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Exp Month\")} / {t(\"Year\")}\r\n                <NormalInput\r\n                  placeholder=\"mm/YYYY\"\r\n                  value={cardField.pay_rem3}\r\n                  name=\"pay_rem3\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Approval Code\")}\r\n                <NormalInput\r\n                  value={cardField.App_code}\r\n                  name=\"App_code\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex justify-content-end\">\r\n            <div className=\"col-2\">\r\n              <div className=\"input-group\">\r\n                <NormalButton\r\n                  mainbg={false}\r\n                  className=\"col-12 mt-4 ml-2 btn-outline-success\"\r\n                  label=\"CONFIRM\"\r\n                  onClick={() => this.addCreditCard()}\r\n                />\r\n              </div>\r\n              <div className=\"col-1\"></div>\r\n            </div>\r\n            {/* <div className=\"col-2\">\r\n              <div className=\"input-group\">\r\n                <NormalButton\r\n                  mainbg={true}\r\n                  className=\"col-12 mt-4 ml-2\"\r\n                  label=\"CANCEL\"\r\n                  onClick={() => this.setState({ isOpenSubPayment: false })}\r\n                />\r\n              </div>\r\n            </div> */}\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"Multiple\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <div className=\"row\">\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                <Label className=\"col-12 fs-15\">{t(\"Choose Option\")}</Label>\r\n                <NormalSelect\r\n                  placeholder=\"Search type...\"\r\n                  options={paytableData}\r\n                  value={payTableDropDownValue}\r\n                  name=\"payTableDropDownValue\"\r\n                  onChange={this.handleChange}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      insideRadioButtonData = <div></div>;\r\n    }\r\n    let payGroupDataContent = [];\r\n    console.log(payGroupData);\r\n    payGroupData.forEach((item, i) => {\r\n      payGroupDataContent.push(\r\n        <div\r\n          className=\"col-md-3 col-4 payment-item cursor-pointer\"\r\n          style={{ width: \"50px\", padding: \"15px\" }}\r\n          key={i}\r\n          onClick={() => this.addNewPaymentData(item.value, item.label)}\r\n        >\r\n          <center>\r\n            <img\r\n              src={helpers.getMediaUrl() + \"media/\" + item.picturelocation}\r\n              label={item.label}\r\n              style={{ textAlign: \"center\" }}\r\n              width=\"40\"\r\n              height=\"40\"\r\n            />\r\n          </center>\r\n          <center>\r\n            <p style={{ width: \"100px\", textAlign: \"center\" }}>{item.label}</p>\r\n          </center>\r\n        </div>\r\n      );\r\n    });\r\n\r\n    let { cartId, cartData, tokenDetails } = this.props;\r\n    console.log(cartId, tokenDetails, this.props.cartData);\r\n    this.checkTypeOfCartItemContainsDeposit(cartData);\r\n\r\n    let userAddedPayTableData = (\r\n      <table className=\"table table-bordered\">\r\n        {this.state.selectedCards.map((selectedCards, index) => (\r\n          <tr key={index}>\r\n            <td className=\"fs-18\">\r\n              {this.getPayTableNameBasedOnId(selectedCards.pay_typeid)}\r\n            </td>\r\n            <td className=\"fs-18\" style={{ textAlign: \"right\" }}>\r\n              {selectedCards.pay_amt.toFixed(2)}\r\n            </td>\r\n            <td>\r\n              <div\r\n                className=\"col-4 p-0 fs-20 cursor-pointer\"\r\n                onClick={this.removeCards(selectedCards)}\r\n              >\r\n                <span className=\"icon-delete\"></span>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        ))}\r\n      </table>\r\n    );\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"d-flex flex-wrap\">\r\n          <div className=\"col-md-2 col-12 mb-2\">\r\n            <label className=\"text-left text-black common-label-text \">\r\n              {t(\"Enter Amount\")}\r\n            </label>\r\n\r\n            <div className=\"input-group mb-2\">\r\n              <NormalInput\r\n                value={this.state.txtUserPayAmount}\r\n                onChange={this.handleChangeTextBox.bind(this)}\r\n              />\r\n              {this.validator.message(\r\n                \"Amount\",\r\n                this.state.txtUserPayAmount,\r\n                \"required|numeric|min:0,num\"\r\n              )}\r\n              {this.validator.message(\r\n                \"Amount\",\r\n                this.state.txtUserPayAmount,\r\n                \"required|numeric|max:\" + this.state.balance + \",num\"\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"col-md-4 col-12 mb-2\">\r\n            <Label>{t(\"Remark\")}</Label>\r\n            <div className=\"input-group mb-2\">\r\n              <NormalInput\r\n                value={pay_rem4}\r\n                name=\"pay_rem4\"\r\n                onChange={this.handleChangeRemarkBox.bind(this)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"col-md-2 col-12 mb-2\">\r\n            {is_paymentdate ? (\r\n              <>\r\n                <Label>{t(\"Date\")}</Label>\r\n                <div className=\"input-group mb-2\">\r\n                  <NormalDate\r\n                    value={new Date(DateofPay)}\r\n                    name=\"DateofPay\"\r\n                    type=\"date\"\r\n                    onChange={this.handleDatePick}\r\n                    minDate={new Date(MinimumDate)}\r\n                    maxDate={new Date()}\r\n                    showDisabledMonthNavigation\r\n                  />\r\n                </div>\r\n              </>\r\n            ) : null}\r\n          </div>\r\n\r\n          <div className=\"col-md-4 col-12\">\r\n            <div className=\"d-flex justify-content-end\">\r\n              {isTreatmentDoneButton ? (\r\n                <div className=\"make-payment mt-3 mr-2 text-center\">\r\n                  <NormalButton\r\n                    mainbg={true}\r\n                    className=\"col-12 fs-15\"\r\n                    label=\"TREATMENT DONE\"\r\n                    onClick={() => this.handleTreatmentDone()}\r\n                  />\r\n                </div>\r\n              ) : null}\r\n              <div className=\"make-payment mt-3 text-center\">\r\n                {isMakePaymentLoading ? (\r\n                  <div class=\"d-flex align-items-center justify-content-center\">\r\n                    <div class=\"spinner-border\" role=\"status\">\r\n                      <span class=\"sr-only\">{t(\"Loading...\")}</span>\r\n                    </div>\r\n                  </div>\r\n                ) : this.state.isMakePaymentButtonClicked == \"true\" ? (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    disabled={true}\r\n                  />\r\n                ) : (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    onClick={() => this.handleSubmit()}\r\n                    disabled={\r\n                      this.state.selectedCards.length <= 0 || balance > 0\r\n                    }\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <h4>{t(\"Select Payment Method\")}</h4>\r\n\r\n        <div className=\"row paymentGroup\">\r\n          <div className=\"col-md-6\">\r\n            <div className=\"d-flex flex-wrap\">{payGroupDataContent}</div>\r\n          </div>\r\n          <div className=\"col-md-6 make-payment-section\">\r\n            <p className=\"h6\">{t(\"List of Selections\")}</p>\r\n            <div className=\"row\">\r\n              <div className=\"col-md-12 mt-1 mb-1\">\r\n                <div className=\"d-flex payment\">\r\n                  <div className=\"col-md-7 p-0\">\r\n                    <div className=\"d-flex flex-wrap fs-14\">\r\n                      <div className=\"col-6\">{t(\"Subtotal\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.subtotal}</div>\r\n                      <div className=\"col-6\">{t(\"Discount ($)\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.discount}</div>\r\n                      <div className=\"col-6\">{t(\"Transac amount\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.trans_amt}</div>\r\n                      <div className=\"col-6\">{t(\"Deposit\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.deposit_amt}</div>\r\n                      <div className=\"col-6\">{responseData.tax_lable}</div>\r\n                      <div className=\"col-6\">$ {responseData.tax_amt}</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"col-md-5\">\r\n                    <div className=\"d-flex flex-wrap\">\r\n                      <div className=\"col-12 fs-22 text-center\">\r\n                        {t(\"Billing Amount\")}\r\n                      </div>\r\n                      <div className=\"col-12 fs-22 fw-700 text-center text-orenge\">\r\n                        $ {responseData.billable_amount}\r\n                      </div>\r\n                      <div className=\"col-12 f-600 text-center mt-2\">\r\n                        {t(\"Balance Amount\")}: {Number(balance).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-md-12 mt-2 payment-list\">\r\n              <div className=\"fs-12\">{userAddedPayTableData}</div>\r\n            </div>\r\n            {/* <div className=\"d-flex justify-content-around\">\r\n              {isTreatmentDoneButton ? (\r\n                <div className=\"make-payment mt-3 text-center\">\r\n                  <NormalButton\r\n                    mainbg={true}\r\n                    className=\"col-12 fs-15 \"\r\n                    label=\"TREATMENT DONE\"\r\n                    onClick={() => this.handleTreatmentDone()}\r\n                  />\r\n                </div>\r\n              ) : null}\r\n              <div className=\"make-payment mt-3 text-center\">\r\n                {isMakePaymentLoading ? (\r\n                  <div class=\"d-flex align-items-center justify-content-center\">\r\n                    <div class=\"spinner-border\" role=\"status\">\r\n                      <span class=\"sr-only\">{t(\"Loading...\")}</span>\r\n                    </div>\r\n                  </div>\r\n                ) : this.state.isMakePaymentButtonClicked == \"true\" ? (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    disabled={true}\r\n                  />\r\n                ) : (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    onClick={() => this.handleSubmit()}\r\n                    disabled={\r\n                      this.state.selectedCards.length <= 0 || balance > 0\r\n                    }\r\n                  />\r\n                )}\r\n              </div>\r\n            </div> */}\r\n          </div>\r\n        </div>\r\n\r\n        <NormalModal\r\n          className={\"payment-modal\"}\r\n          style={{ minWidth: \"70%\" }}\r\n          modal={isOpenSubPayment}\r\n          handleModal={this.handleDialog}\r\n        >\r\n          <img\r\n            onClick={this.handleDialog}\r\n            className=\"close cursor-pointer\"\r\n            src={closeIcon}\r\n            alt=\"\"\r\n          />\r\n          <center>\r\n            <p className=\"fs-18 f-600\">{displayModelPaymentType}</p>\r\n          </center>\r\n          <br />\r\n          {insideRadioButtonData}\r\n        </NormalModal>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  appointmentDetail: state.appointment.appointmentDetail,\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  tokenDetails: state.authStore.tokenDetails,\r\n  CartPaymentDate: state.appointment.CartPaymentDate,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getPayment,\r\n      getCommonApi,\r\n      createPayment,\r\n      updateForm,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Payment = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(MakePaymentClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}