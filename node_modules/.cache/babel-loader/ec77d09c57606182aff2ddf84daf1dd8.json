{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{InputSearch,NormalButton,NormalDate,TableWrapper}from\"component/common\";import{connect}from\"react-redux\";import{withTranslation}from\"react-i18next\";import{getCustomerPoints}from\"redux/actions/customerPlus\";import{bindActionCreators}from\"redux\";import{dateFormat}from\"service/helperFunctions\";export var CustomerPointsTableClass=/*#__PURE__*/function(_React$Component){_inherits(CustomerPointsTableClass,_React$Component);var _super=_createSuper(CustomerPointsTableClass);function CustomerPointsTableClass(){var _this;_classCallCheck(this,CustomerPointsTableClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Date\",sortKey:\"remarks\",enabled:true},{label:\"Transcation No\",sortKey:\"transacno\"},{label:\"Type\",sortKey:\"type\",enabled:true},{label:\"Remarks\",sortKey:\"remarks\",enabled:true},{label:\"Earn pts (+)\",sortKey:\"earned\",enabled:true},{label:\"Used pts (-)\",sortKey:\"used\",enabled:true},{label:\"Balance Pts\",sortKey:\"now_point\",enabled:true}],type:\"all\",dataList:[],originalDataList:[],meta:{},searchStartDate:\"\",searchEndDate:\"\",searchString:\"\",isMounted:true,isLoading:true};_this.updateState=function(data){if(_this.state.isMounted)_this.setState(data);};_this.handlePagination=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _data$page,page,_this$state,searchStartDate,searchEndDate,type,searchString,searchParams,startdate,endDate,_this$props$dataList,PointList,pagination;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_data$page=data.page,page=_data$page===void 0?1:_data$page;_this$state=_this.state,searchStartDate=_this$state.searchStartDate,searchEndDate=_this$state.searchEndDate,type=_this$state.type,searchString=_this$state.searchString;_this.setState({isLoading:true});searchParams=\"&search=\".concat(searchString);if(type==\"redeem\"||type==\"reward\")searchParams+=\"&type=\".concat(type);if(searchStartDate!=\"\"){startdate=dateFormat(searchStartDate);endDate=dateFormat(searchEndDate==\"\"?searchStartDate:searchEndDate);searchParams+=\"&startDate=\".concat(startdate,\"&endDate=\").concat(endDate);}_context.next=8;return _this.props.getCustomerPoints(_this.props.id,\"?limit=10&page=\".concat(page)+searchParams);case 8:_this$props$dataList=_this.props.dataList,PointList=_this$props$dataList.PointList,pagination=_this$props$dataList.pagination;PointList.forEach(function(e){if(e.lp_type==\"Reward\"){e.earned=e.total_point;e.used=\"\";}else{e.earned=\"\";e.used=e.total_point;}});_this.updateState({meta:pagination,dataList:PointList,originalDataList:PointList,isLoading:false});case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(CustomerPointsTableClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.state.searchEndDate=new Date();var date=new Date();date.setMonth(date.getMonth()-3);this.state.searchStartDate=date;this.handlePagination({});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.state.isMounted=false;}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,headerDetails=_this$state2.headerDetails,dataList=_this$state2.dataList,meta=_this$state2.meta,isLoading=_this$state2.isLoading,originalDataList=_this$state2.originalDataList,searchStartDate=_this$state2.searchStartDate,searchEndDate=_this$state2.searchEndDate,type=_this$state2.type;var t=this.props.t;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"customer-list container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 mb-2\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"head-label\"},t(\"Customer Points\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 mb-2\"},/*#__PURE__*/React.createElement(NormalButton,{label:\"Add Manual Reward\",mainbg:true,onClick:function onClick(){return _this2.props.history.push(\"/admin/customerplus/\".concat(_this2.props.id,\"/lpmanagement/reward\"));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\"},/*#__PURE__*/React.createElement(NormalButton,{label:\"Add Manual Redeem\",mainbg:true,onClick:function onClick(){return _this2.props.history.push(\"/admin/customerplus/\".concat(_this2.props.id,\"/lpmanagement/redeem\"));}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"container-fuild border rounded p-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 mb-3\"},t(\"Type\"),\":\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col col-md-3\"},/*#__PURE__*/React.createElement(\"input\",{type:\"radio\",className:\"mr-2\",checked:type==\"all\",onChange:function onChange(e){return _this2.updateState({type:\"all\"});}}),/*#__PURE__*/React.createElement(\"label\",null,\"All\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col col-md-3\"},/*#__PURE__*/React.createElement(\"input\",{type:\"radio\",className:\"mr-2\",checked:type==\"reward\",onChange:function onChange(e){return _this2.updateState({type:\"reward\"});}}),/*#__PURE__*/React.createElement(\"label\",null,\"Reward\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col col-md-3\"},/*#__PURE__*/React.createElement(\"input\",{type:\"radio\",className:\"mr-2\",checked:type==\"redeem\",onChange:function onChange(e){return _this2.updateState({type:\"redeem\"});}}),/*#__PURE__*/React.createElement(\"label\",null,\"Redeem\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 mb-2\"},/*#__PURE__*/React.createElement(\"label\",null,t(\"Start Date\"),\":\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalDate,{value:searchStartDate,onChange:function onChange(e){return _this2.updateState({searchStartDate:e.target.value,searchEndDate:e.target.value});}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 mb-2\"},/*#__PURE__*/React.createElement(\"label\",null,t(\"End Date\"),\":\"),/*#__PURE__*/React.createElement(NormalDate,{value:searchEndDate,disabled:searchStartDate==\"\",minDate:searchStartDate,onChange:function onChange(e){return _this2.updateState({searchEndDate:e.target.value});}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 pt-md-2\"},/*#__PURE__*/React.createElement(\"label\",null),/*#__PURE__*/React.createElement(InputSearch,{placeholder:\"Search Policy\",onChange:function onChange(e){return _this2.updateState({searchString:e.target.value});}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-row-reverse\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 mb-2\"},/*#__PURE__*/React.createElement(NormalButton,{label:\"Search\",mainbg:true,onClick:function onClick(e){_this2.handlePagination({});}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 mb-2\"},/*#__PURE__*/React.createElement(NormalButton,{label:\"Clear\",mainbg:true,onClick:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this2.updateState({searchStartDate:\"\",searchEndDate:\"\",type:\"all\",searchString:\"\"});case 2:_this2.handlePagination({});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()})))),isLoading?/*#__PURE__*/React.createElement(\"div\",{class:\"d-flex mt-5 align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\"))):/*#__PURE__*/React.createElement(\"div\",{className:\"tab-table-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:meta,showFilterColumn:true,parentHeaderChange:function parentHeaderChange(value){return _this2.updateState(function(){return headerDetails=value;});},sortData:originalDataList,onSort:function onSort(dataList){return _this2.updateState({dataList:dataList});}},dataList&&dataList.map(function(item,index){var _headerDetails$2$enab,_headerDetails$0$enab,_headerDetails$2$enab2,_headerDetails$2$enab3,_headerDetails$1$enab,_headerDetails$3$enab,_headerDetails$3$enab2;var transacno=item.transacno,remarks=item.remarks,earned=item.earned,used=item.used,now_point=item.now_point,lp_type=item.lp_type,date=item.date;return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$2$enab=headerDetails[2].enabled)!==null&&_headerDetails$2$enab!==void 0?_headerDetails$2$enab:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},new Date(date).toLocaleDateString()+\" \"+new Date(date).toLocaleTimeString())),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$0$enab=headerDetails[0].enabled)!==null&&_headerDetails$0$enab!==void 0?_headerDetails$0$enab:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},transacno)),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$2$enab2=headerDetails[2].enabled)!==null&&_headerDetails$2$enab2!==void 0?_headerDetails$2$enab2:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},lp_type)),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$2$enab3=headerDetails[2].enabled)!==null&&_headerDetails$2$enab3!==void 0?_headerDetails$2$enab3:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},remarks)),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$1$enab=headerDetails[1].enabled)!==null&&_headerDetails$1$enab!==void 0?_headerDetails$1$enab:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},earned)),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$3$enab=headerDetails[3].enabled)!==null&&_headerDetails$3$enab!==void 0?_headerDetails$3$enab:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},used)),/*#__PURE__*/React.createElement(\"td\",{className:((_headerDetails$3$enab2=headerDetails[3].enabled)!==null&&_headerDetails$3$enab2!==void 0?_headerDetails$3$enab2:true)?\"\":\"d-none\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},now_point)));})))))));}}]);return CustomerPointsTableClass;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{dataList:state.customerPlus.customerPoints};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCustomerPoints:getCustomerPoints},dispatch);};export var CustomerPointsTable=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(CustomerPointsTableClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/CustomerPlus/LoyaltyPointsManagement/CustomerPointsTable/index.js"],"names":["React","InputSearch","NormalButton","NormalDate","TableWrapper","connect","withTranslation","getCustomerPoints","bindActionCreators","dateFormat","CustomerPointsTableClass","state","headerDetails","label","sortKey","enabled","type","dataList","originalDataList","meta","searchStartDate","searchEndDate","searchString","isMounted","isLoading","updateState","data","setState","handlePagination","page","searchParams","startdate","endDate","props","id","PointList","pagination","forEach","e","lp_type","earned","total_point","used","Date","date","setMonth","getMonth","t","history","push","target","value","map","item","index","transacno","remarks","now_point","toLocaleDateString","toLocaleTimeString","Component","mapStateToProps","customerPlus","customerPoints","mapDispatchToProps","dispatch","CustomerPointsTable"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  InputSearch,\n  NormalButton,\n  NormalDate,\n  TableWrapper,\n} from \"component/common\";\nimport { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport { getCustomerPoints } from \"redux/actions/customerPlus\";\nimport { bindActionCreators } from \"redux\";\nimport { dateFormat } from \"service/helperFunctions\";\n\nexport class CustomerPointsTableClass extends React.Component {\n  state = {\n    headerDetails: [\n      { label: \"Date\", sortKey: \"remarks\", enabled: true },\n      { label: \"Transcation No\", sortKey: \"transacno\" },\n      { label: \"Type\", sortKey: \"type\", enabled: true },\n      { label: \"Remarks\", sortKey: \"remarks\", enabled: true },\n      { label: \"Earn pts (+)\", sortKey: \"earned\", enabled: true },\n      { label: \"Used pts (-)\", sortKey: \"used\", enabled: true },\n      { label: \"Balance Pts\", sortKey: \"now_point\", enabled: true },\n    ],\n    type: \"all\",\n    dataList: [],\n    originalDataList: [],\n    meta: {},\n    searchStartDate: \"\",\n    searchEndDate: \"\",\n    searchString: \"\",\n    isMounted: true,\n    isLoading: true,\n  };\n\n  componentDidMount() {\n    this.state.searchEndDate = new Date();\n    let date = new Date();\n    date.setMonth(date.getMonth() - 3);\n    this.state.searchStartDate = date;\n    this.handlePagination({});\n  }\n\n  componentWillUnmount() {\n    this.state.isMounted = false;\n  }\n\n  updateState = (data) => {\n    if (this.state.isMounted) this.setState(data);\n  };\n\n  handlePagination = async (data) => {\n    let { page = 1 } = data;\n    let { searchStartDate, searchEndDate, type, searchString } = this.state;\n    this.setState({ isLoading: true });\n    let searchParams = `&search=${searchString}`;\n    if (type == \"redeem\" || type == \"reward\") searchParams += `&type=${type}`;\n    if (searchStartDate != \"\") {\n      let startdate = dateFormat(searchStartDate);\n      let endDate = dateFormat(\n        searchEndDate == \"\" ? searchStartDate : searchEndDate\n      );\n      searchParams += `&startDate=${startdate}&endDate=${endDate}`;\n    }\n    await this.props.getCustomerPoints(\n      this.props.id,\n      `?limit=10&page=${page}` + searchParams\n    );\n    let { PointList, pagination } = this.props.dataList;\n    PointList.forEach((e) => {\n      if (e.lp_type == \"Reward\") {\n        e.earned = e.total_point;\n        e.used = \"\";\n      } else {\n        e.earned = \"\";\n        e.used = e.total_point;\n      }\n    });\n    this.updateState({\n      meta: pagination,\n      dataList: PointList,\n      originalDataList: PointList,\n      isLoading: false,\n    });\n  };\n\n  render() {\n    let {\n      headerDetails,\n      dataList,\n      meta,\n      isLoading,\n      originalDataList,\n      searchStartDate,\n      searchEndDate,\n      type,\n    } = this.state;\n    let { t } = this.props;\n    return (\n      <>\n        <div className=\"customer-list container-fluid\">\n          <div className=\"row mb-2\">\n            <div className=\"col-md-4 mb-2\">\n              <h3 className=\"head-label\">{t(\"Customer Points\")}</h3>\n            </div>\n            <div className=\"col-md-4 mb-2\">\n              <NormalButton\n                label=\"Add Manual Reward\"\n                mainbg={true}\n                onClick={() =>\n                  this.props.history.push(\n                    `/admin/customerplus/${this.props.id}/lpmanagement/reward`\n                  )\n                }\n              />\n            </div>\n            <div className=\"col-md-4\">\n              <NormalButton\n                label=\"Add Manual Redeem\"\n                mainbg={true}\n                onClick={() =>\n                  this.props.history.push(\n                    `/admin/customerplus/${this.props.id}/lpmanagement/redeem`\n                  )\n                }\n              />\n            </div>\n          </div>\n          <div className=\"container-fuild border rounded p-2\">\n            <div className=\"row mb-2\">\n              <div className=\"col-md-2 mb-3\">{t(\"Type\")}:</div>\n              <div className=\"col col-md-3\">\n                <input\n                  type=\"radio\"\n                  className=\"mr-2\"\n                  checked={type == \"all\"}\n                  onChange={(e) => this.updateState({ type: \"all\" })}\n                />\n                <label>All</label>\n              </div>\n              <div className=\"col col-md-3\">\n                <input\n                  type=\"radio\"\n                  className=\"mr-2\"\n                  checked={type == \"reward\"}\n                  onChange={(e) => this.updateState({ type: \"reward\" })}\n                />\n                <label>Reward</label>\n              </div>\n              <div className=\"col col-md-3\">\n                <input\n                  type=\"radio\"\n                  className=\"mr-2\"\n                  checked={type == \"redeem\"}\n                  onChange={(e) => this.updateState({ type: \"redeem\" })}\n                />\n                <label>Redeem</label>\n              </div>\n            </div>\n            <div className=\"row mb-3\">\n              <div className=\"col-md-4 mb-2\">\n                <label>{t(\"Start Date\")}:</label>\n                <div className=\"input-group\">\n                  <NormalDate\n                    value={searchStartDate}\n                    onChange={(e) =>\n                      this.updateState({\n                        searchStartDate: e.target.value,\n                        searchEndDate: e.target.value,\n                      })\n                    }\n                  />\n                </div>\n              </div>\n              <div className=\"col-md-4 mb-2\">\n                <label>{t(\"End Date\")}:</label>\n                <NormalDate\n                  value={searchEndDate}\n                  disabled={searchStartDate == \"\"}\n                  minDate={searchStartDate}\n                  onChange={(e) =>\n                    this.updateState({ searchEndDate: e.target.value })\n                  }\n                />\n              </div>\n              <div className=\"col-md-4 pt-md-2\">\n                <label></label>\n                <InputSearch\n                  placeholder=\"Search Policy\"\n                  onChange={(e) =>\n                    this.updateState({ searchString: e.target.value })\n                  }\n                />\n              </div>\n            </div>\n            <div className=\"d-flex flex-row-reverse\">\n              <div className=\"col-md-3 mb-2\">\n                <NormalButton\n                  label=\"Search\"\n                  mainbg={true}\n                  onClick={(e) => {\n                    this.handlePagination({});\n                  }}\n                />\n              </div>\n              <div className=\"col-md-2 mb-2\">\n                <NormalButton\n                  label=\"Clear\"\n                  mainbg={true}\n                  onClick={async (e) => {\n                    await this.updateState({\n                      searchStartDate: \"\",\n                      searchEndDate: \"\",\n                      type: \"all\",\n                      searchString: \"\",\n                    });\n                    this.handlePagination({});\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n          {isLoading ? (\n            <div class=\"d-flex mt-5 align-items-center justify-content-center\">\n              <div class=\"spinner-border\" role=\"status\">\n                <span class=\"sr-only\">Loading...</span>\n              </div>\n            </div>\n          ) : (\n            <div className=\"tab-table-content\">\n              <div className=\"py-4\">\n                <div className=\"table-container\">\n                  <TableWrapper\n                    headerDetails={headerDetails}\n                    queryHandler={this.handlePagination}\n                    pageMeta={meta}\n                    showFilterColumn={true}\n                    parentHeaderChange={(value) =>\n                      this.updateState(() => (headerDetails = value))\n                    }\n                    sortData={originalDataList}\n                    onSort={(dataList) => this.updateState({ dataList })}\n                  >\n                    {dataList &&\n                      dataList.map((item, index) => {\n                        let {\n                          transacno,\n                          remarks,\n                          earned,\n                          used,\n                          now_point,\n                          lp_type,\n                          date,\n                        } = item;\n                        return (\n                          <tr key={index}>\n                            <td\n                              className={\n                                headerDetails[2].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {new Date(date).toLocaleDateString() +\n                                  \" \" +\n                                  new Date(date).toLocaleTimeString()}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[0].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {transacno}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[2].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {lp_type}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[2].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {remarks}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[1].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {earned}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[3].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {used}\n                              </div>\n                            </td>\n                            <td\n                              className={\n                                headerDetails[3].enabled ?? true ? \"\" : \"d-none\"\n                              }\n                            >\n                              <div className=\"d-flex align-items-center justify-content-center\">\n                                {now_point}\n                              </div>\n                            </td>\n                          </tr>\n                        );\n                      })}\n                  </TableWrapper>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  dataList: state.customerPlus.customerPoints,\n});\n\nconst mapDispatchToProps = (dispatch) => {\n  return bindActionCreators({ getCustomerPoints }, dispatch);\n};\n\nexport const CustomerPointsTable = withTranslation()(\n  connect(mapStateToProps, mapDispatchToProps)(CustomerPointsTableClass)\n);\n"]},"metadata":{},"sourceType":"module"}