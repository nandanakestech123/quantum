{"ast":null,"code":"import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{NormalButton,NormalSelect}from\"component/common\";import{InputSearch,TableWrapper}from\"component/common\";import filter from\"../../../../assets/images/filter.png\";import\"./style.scss\";import{getCustomer}from\"redux/actions/customer\";import{updateForm}from\"redux/actions/common\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import _ from\"lodash\";export var ListCustomerClass=/*#__PURE__*/function(_React$Component){_inherits(ListCustomerClass,_React$Component);var _super=_createSuper(ListCustomerClass);function ListCustomerClass(){var _this;_classCallCheck(this,ListCustomerClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Customer Name\",sortKey:\"customerName\"},{label:\"Address\",sortKey:\"address\"},{label:\"Contact Number\"},{label:\"Last Visit\",sortKey:\"lastVisit\"},{label:\"Upcoming Appointments\"},{label:\"\"}],customerList:[],meta:{},active:false,currentIndex:-1};_this.componentDidMount=function(){_this.getCustomer({});};_this.handleClick=function(key){if(!_this.state.active){document.addEventListener(\"click\",_this.handleOutsideClick,false);}else{document.removeEventListener(\"click\",_this.handleOutsideClick,false);}_this.setState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.handleOutsideClick=function(e){if(_this.node!=null){if(_this.node.contains(e.target)){return;}}_this.handleClick();};_this.getCustomer=function(data){var _data$page=data.page,page=_data$page===void 0?1:_data$page,_data$limit=data.limit,limit=_data$limit===void 0?10:_data$limit,_data$search=data.search,search=_data$search===void 0?\"\":_data$search;_this.props.getCustomer(\"?page=\".concat(page,\"&limit=\").concat(limit,\"&search=\").concat(search)).then(function(res){console.log(res,\"dsfdfaafg\");_this.setState({customerList:res.data.dataList,meta:res.data.meta.pagination});});};_this.handlePagination=function(page){console.log(page,\"dsfsdfsdfsdf\");_this.getCustomer(page);};_this.handlesearch=function(event){console.log(\"sadfasdfasdf\",event.target.value);event.persist();if(!_this.debouncedFn){_this.debouncedFn=_.debounce(function(){var searchString=event.target.value;var data={search:searchString};_this.getCustomer(data);},500);}_this.debouncedFn();};_this.bookAppointment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var formFields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formFields={};formFields[\"custId\"]=data.id;formFields[\"custName\"]=data.cust_name;_context.next=5;return _this.props.updateForm(\"basicApptDetail\",formFields);case 5:_this.props.history.push(\"/admin/newappointment\");case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(ListCustomerClass,[{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,headerDetails=_this$state.headerDetails,customerList=_this$state.customerList,meta=_this$state.meta,currentIndex=_this$state.currentIndex,active=_this$state.active;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"customer-list\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"head-label\"},\"Customer\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"w-100 mr-5\"},/*#__PURE__*/React.createElement(InputSearch,{className:\"\",placeholder:\"Search Customer\",onChange:this.handlesearch})),/*#__PURE__*/React.createElement(\"div\",{className:\"w-100 col-4 p-0\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:true,className:\"col-12 fs-15 float-right\",label:\"Add Customer\",onClick:function onClick(){return _this2.props.history.push(\"/admin/customer/add\");}}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"tab-table-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:meta},customerList?customerList.map(function(item,index){var id=item.id,cust_name=item.cust_name,cust_address=item.cust_address,last_visit=item.last_visit,upcoming_appointments=item.upcoming_appointments,cust_phone2=item.cust_phone2;return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},cust_name)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},cust_address)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},cust_phone2)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},last_visit)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},upcoming_appointments)),/*#__PURE__*/React.createElement(\"td\",{className:\"position-relative\",ref:function ref(node){_this2.node=node;},onClick:function onClick(){return _this2.handleClick(index);}},currentIndex===index?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more-active\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"option card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pt-3\",onClick:function onClick(){return _this2.props.history.push(\"/admin/customer/\".concat(id,\"/details\"));}},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-eye-grey px-3\"}),\" \",\"View\",\" \"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-schedule px-3\"}),\" \",\"Reschedule Appointment\",\" \"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\",onClick:function onClick(){return _this2.bookAppointment(item);}},/*#__PURE__*/React.createElement(\"span\",{className:\"px-2\"},/*#__PURE__*/React.createElement(\"svg\",{width:\"31\",height:\"30\",viewBox:\"0 0 31 30\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"rect\",{width:\"31\",height:\"30\",fill:\"#F9F9F9\"}),/*#__PURE__*/React.createElement(\"path\",{d:\"M15 8V22\",stroke:\"#848484\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}),/*#__PURE__*/React.createElement(\"path\",{d:\"M8 15H22\",stroke:\"#848484\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}))),\"Book Appointment\"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pb-3\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-cancel-schedule px-3\"}),\" \",\"Cancel Appointment\",\" \"))):/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"}))));}):\"\"))))));}}]);return ListCustomerClass;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{// filter: state.dashboard\n};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCustomer:getCustomer,updateForm:updateForm},dispatch);};export var ListCustomer=connect(mapStateToProps,mapDispatchToProps)(ListCustomerClass);","map":{"version":3,"sources":["F:/webfe/src/component/Admin/Customer/ListCustomer/index.js"],"names":["React","NormalButton","NormalSelect","InputSearch","TableWrapper","filter","getCustomer","updateForm","connect","bindActionCreators","_","ListCustomerClass","state","headerDetails","label","sortKey","customerList","meta","active","currentIndex","componentDidMount","handleClick","key","document","addEventListener","handleOutsideClick","removeEventListener","setState","prevState","e","node","contains","target","data","page","limit","search","props","then","res","console","log","dataList","pagination","handlePagination","handlesearch","event","value","persist","debouncedFn","debounce","searchString","bookAppointment","formFields","id","cust_name","history","push","map","item","index","cust_address","last_visit","upcoming_appointments","cust_phone2","Component","mapStateToProps","mapDispatchToProps","dispatch","ListCustomer"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { NormalButton, NormalSelect } from \"component/common\";\r\nimport { InputSearch, TableWrapper } from \"component/common\";\r\nimport filter from \"../../../../assets/images/filter.png\";\r\nimport \"./style.scss\";\r\nimport { getCustomer } from \"redux/actions/customer\";\r\nimport { updateForm } from \"redux/actions/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport _ from \"lodash\";\r\n\r\nexport class ListCustomerClass extends React.Component {\r\n  state = {\r\n    headerDetails: [\r\n      { label: \"Customer Name\", sortKey: \"customerName\" },\r\n      { label: \"Address\", sortKey: \"address\" },\r\n      { label: \"Contact Number\" },\r\n      { label: \"Last Visit\", sortKey: \"lastVisit\" },\r\n      { label: \"Upcoming Appointments\" },\r\n      { label: \"\" },\r\n    ],\r\n    customerList: [],\r\n    meta: {},\r\n    active: false,\r\n    currentIndex: -1,\r\n  };\r\n  // handleClick = (key,active) => {\r\n  //     let currentIndex;\r\n  //     if (this.state.active == true) {\r\n  //         this.setState({\r\n  //             active: false,\r\n  //             currentIndex: '-1'\r\n  //         })\r\n  //     }\r\n  //     else {\r\n  //         this.setState({\r\n  //             active: active,\r\n  //             currentIndex: key\r\n  //         })\r\n  //     }\r\n  // }\r\n\r\n  componentDidMount = () => {\r\n    this.getCustomer({});\r\n  };\r\n\r\n  handleClick = key => {\r\n    if (!this.state.active) {\r\n      document.addEventListener(\"click\", this.handleOutsideClick, false);\r\n    } else {\r\n      document.removeEventListener(\"click\", this.handleOutsideClick, false);\r\n    }\r\n\r\n    this.setState(prevState => ({\r\n      active: !prevState.active,\r\n      currentIndex: key,\r\n    }));\r\n  };\r\n\r\n  handleOutsideClick = e => {\r\n    if (this.node != null) {\r\n      if (this.node.contains(e.target)) {\r\n        return;\r\n      }\r\n    }\r\n    this.handleClick();\r\n  };\r\n\r\n  getCustomer = data => {\r\n    let { page = 1, limit = 10, search = \"\" } = data;\r\n    this.props\r\n      .getCustomer(`?page=${page}&limit=${limit}&search=${search}`)\r\n      .then(res => {\r\n        console.log(res, \"dsfdfaafg\");\r\n        this.setState({\r\n          customerList: res.data.dataList,\r\n          meta: res.data.meta.pagination,\r\n        });\r\n      });\r\n  };\r\n\r\n  handlePagination = page => {\r\n    console.log(page, \"dsfsdfsdfsdf\");\r\n    this.getCustomer(page);\r\n  };\r\n\r\n  handlesearch = event => {\r\n    console.log(\"sadfasdfasdf\", event.target.value);\r\n    event.persist();\r\n\r\n    if (!this.debouncedFn) {\r\n      this.debouncedFn = _.debounce(() => {\r\n        let searchString = event.target.value;\r\n        let data = { search: searchString };\r\n        this.getCustomer(data);\r\n      }, 500);\r\n    }\r\n    this.debouncedFn();\r\n  };\r\n\r\n  bookAppointment = async data => {\r\n    let formFields = {};\r\n    formFields[\"custId\"] = data.id;\r\n    formFields[\"custName\"] = data.cust_name;\r\n    await this.props.updateForm(\"basicApptDetail\", formFields);\r\n    this.props.history.push(`/admin/newappointment`);\r\n  };\r\n\r\n  render() {\r\n    let { headerDetails, customerList, meta, currentIndex, active } =\r\n      this.state;\r\n    return (\r\n      <>\r\n        <div className=\"customer-list\">\r\n          <div className=\"row align-items-center\">\r\n            <div className=\"col-md-6\">\r\n              <h3 className=\"head-label\">Customer</h3>\r\n            </div>\r\n            <div className=\"col-md-6\">\r\n              <div className=\"d-flex\">\r\n                <div className=\"w-100 mr-5\">\r\n                  <InputSearch\r\n                    className=\"\"\r\n                    placeholder=\"Search Customer\"\r\n                    onChange={this.handlesearch}\r\n                  />\r\n                </div>\r\n                <div className=\"w-100 col-4 p-0\">\r\n                  <NormalButton\r\n                    mainbg={true}\r\n                    className=\"col-12 fs-15 float-right\"\r\n                    label=\"Add Customer\"\r\n                    onClick={() =>\r\n                      this.props.history.push(\"/admin/customer/add\")\r\n                    }\r\n                  />\r\n                </div>\r\n                {/* <div className=\"bg-white ml-5 filter-icon filter-section\" onClick={() => { this.handleClick('filter') }}>\r\n                                    <img src={filter} alt=\"\" />\r\n                                    {currentIndex === 'filter' &&\r\n                                        <>\r\n                                            <div className=\"filter-category\">\r\n                                                <p className=\"subcategory\">Available today</p>\r\n                                                <p className=\"subcategory\">Unavailable today</p>\r\n                                                <p className=\"subcategory\">Morning shift</p>\r\n                                                <p className=\"subcategory\">Evening shift</p>\r\n                                            </div>\r\n                                        </>\r\n                                    }\r\n                                </div> */}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {/* <div className=\"filter-by\">\r\n                        <p className=\"head\">Filter</p>\r\n                        <div className=\"row\">\r\n                            <div className=\"col-md-3\">\r\n                                <div>\r\n                                    <label className=\"label\">Location</label>\r\n                                    <div className=\"input-group\">\r\n                                        <NormalSelect\r\n                                            placeholder=\"Masseuse\"\r\n                                            // options={treatmentOption}\r\n                                            // value={treatment}\r\n                                            iconname=\"icon-down-key\"\r\n                                            name=\"treatment\"\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"col-md-3\">\r\n                                <div>\r\n                                    <label className=\"label\">Service</label>\r\n                                    <div className=\"input-group\">\r\n                                        <NormalSelect\r\n                                            placeholder=\"Select department\"\r\n                                            // options={treatmentOption}\r\n                                            // value={treatment}\r\n                                            iconname=\"icon-down-key\"\r\n                                            name=\"treatment\"\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"col-md-3\">\r\n                                <div>\r\n                                    <label className=\"label\">Date</label>\r\n                                    <div className=\"input-group\">\r\n                                        <NormalSelect\r\n                                            placeholder=\"Select date\"\r\n                                            // options={treatmentOption}\r\n                                            // value={treatment}\r\n                                            iconname=\"icon-down-key\"\r\n                                            name=\"treatment\"\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </div> */}\r\n\r\n          <div className=\"tab-table-content\">\r\n            <div className=\"py-4\">\r\n              <div className=\"table-container\">\r\n                <TableWrapper\r\n                  headerDetails={headerDetails}\r\n                  queryHandler={this.handlePagination}\r\n                  pageMeta={meta}\r\n                >\r\n                  {customerList\r\n                    ? customerList.map((item, index) => {\r\n                        let {\r\n                          id,\r\n                          cust_name,\r\n                          cust_address,\r\n                          last_visit,\r\n                          upcoming_appointments,\r\n                          cust_phone2,\r\n                        } = item;\r\n                        return (\r\n                          <tr key={index}>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {cust_name}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {cust_address}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {cust_phone2}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {last_visit}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {upcoming_appointments}\r\n                              </div>\r\n                            </td>\r\n                            <td\r\n                              className=\"position-relative\"\r\n                              ref={node => {\r\n                                this.node = node;\r\n                              }}\r\n                              onClick={() => this.handleClick(index)}\r\n                            >\r\n                              {currentIndex === index ? (\r\n                                <>\r\n                                  <div className=\"d-flex align-items-center justify-content-center horizontal-more-active\">\r\n                                    <i className=\"icon-more\"></i>\r\n                                  </div>\r\n                                  <div className=\"option card\">\r\n                                    <div\r\n                                      className=\"d-flex align-items-center fs-16 pt-3\"\r\n                                      onClick={() =>\r\n                                        this.props.history.push(\r\n                                          `/admin/customer/${id}/details`\r\n                                        )\r\n                                      }\r\n                                    >\r\n                                      <span className=\"icon-eye-grey px-3\"></span>{\" \"}\r\n                                      View{\" \"}\r\n                                    </div>\r\n                                    <div className=\"d-flex align-items-center fs-16\">\r\n                                      <span className=\"icon-schedule px-3\"></span>{\" \"}\r\n                                      Reschedule Appointment{\" \"}\r\n                                    </div>\r\n                                    <div\r\n                                      className=\"d-flex align-items-center fs-16\"\r\n                                      onClick={() => this.bookAppointment(item)}\r\n                                    >\r\n                                      <span className=\"px-2\">\r\n                                        <svg\r\n                                          width=\"31\"\r\n                                          height=\"30\"\r\n                                          viewBox=\"0 0 31 30\"\r\n                                          fill=\"none\"\r\n                                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                                        >\r\n                                          <rect\r\n                                            width=\"31\"\r\n                                            height=\"30\"\r\n                                            fill=\"#F9F9F9\"\r\n                                          />\r\n                                          <path\r\n                                            d=\"M15 8V22\"\r\n                                            stroke=\"#848484\"\r\n                                            stroke-linecap=\"round\"\r\n                                            stroke-linejoin=\"round\"\r\n                                          />\r\n                                          <path\r\n                                            d=\"M8 15H22\"\r\n                                            stroke=\"#848484\"\r\n                                            stroke-linecap=\"round\"\r\n                                            stroke-linejoin=\"round\"\r\n                                          />\r\n                                        </svg>\r\n                                      </span>\r\n                                      Book Appointment\r\n                                    </div>\r\n                                    <div className=\"d-flex align-items-center fs-16 pb-3\">\r\n                                      <span className=\"icon-cancel-schedule px-3\"></span>{\" \"}\r\n                                      Cancel Appointment{\" \"}\r\n                                    </div>\r\n                                  </div>\r\n                                </>\r\n                              ) : (\r\n                                <div className=\"d-flex align-items-center justify-content-center horizontal-more\">\r\n                                  <i className=\"icon-more\"></i>\r\n                                </div>\r\n                              )}\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })\r\n                    : \"\"}\r\n                </TableWrapper>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  // filter: state.dashboard\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCustomer,\r\n      updateForm,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const ListCustomer = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ListCustomerClass);\r\n"]},"metadata":{},"sourceType":"module"}