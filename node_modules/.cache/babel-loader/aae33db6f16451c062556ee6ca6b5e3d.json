{"ast":null,"code":"/**\r\n * DevExtreme (ui/file_manager/ui.file_manager.file_uploader.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _guid = _interopRequireDefault(require(\"../../core/guid\"));\n\nvar _ui = _interopRequireDefault(require(\"../widget/ui.widget\"));\n\nvar _file_uploader = _interopRequireDefault(require(\"../file_uploader\"));\n\nvar _uiFile_manager = require(\"./ui.file_manager.common\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (\"undefined\" !== typeof Reflect && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function (target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) {\n        return;\n      }\n\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n\n    if (null === object) {\n      break;\n    }\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var result,\n        Super = _getPrototypeOf(Derived);\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (\"undefined\" === typeof Reflect || !Reflect.construct) {\n    return false;\n  }\n\n  if (Reflect.construct.sham) {\n    return false;\n  }\n\n  if (\"function\" === typeof Proxy) {\n    return true;\n  }\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar FILE_MANAGER_FILE_UPLOADER_CLASS = \"dx-filemanager-fileuploader\";\nvar FILE_MANAGER_FILE_UPLOADER_DROPZONE_PLACEHOLER_CLASS = \"dx-filemanager-fileuploader-dropzone-placeholder\";\n\nvar FileManagerFileUploader = function (_Widget) {\n  _inherits(FileManagerFileUploader, _Widget);\n\n  var _super = _createSuper(FileManagerFileUploader);\n\n  function FileManagerFileUploader() {\n    _classCallCheck(this, FileManagerFileUploader);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FileManagerFileUploader, [{\n    key: \"_initMarkup\",\n    value: function () {\n      this._initActions();\n\n      this.$element().addClass(FILE_MANAGER_FILE_UPLOADER_CLASS);\n      this._uploaderInfos = [];\n\n      this._createInternalFileUploader();\n\n      this._createDropZonePlaceholder();\n\n      this._setDropZonePlaceholderVisible(false);\n\n      _get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_initMarkup\", this).call(this);\n    }\n  }, {\n    key: \"_createInternalFileUploader\",\n    value: function () {\n      var _this = this;\n\n      var chunkSize = this._getController().chunkSize;\n\n      var $fileUploader = (0, _renderer.default)(\"<div>\").appendTo(this.$element());\n\n      var fileUploader = this._createComponent($fileUploader, _file_uploader.default, {\n        name: \"file\",\n        multiple: true,\n        showFileList: false,\n        activeStateEnabled: false,\n        focusStateEnabled: false,\n        hoverStateEnabled: false,\n        labelText: \"\",\n        readyToUploadMessage: \"\",\n        accept: \"*\",\n        chunkSize: chunkSize,\n        dropZone: this.option(\"dropZone\"),\n        onValueChanged: function (e) {\n          return _this._onFileUploaderValueChanged(e);\n        },\n        onProgress: function (e) {\n          return _this._onFileUploaderProgress(e);\n        },\n        onUploaded: function (e) {\n          return _this._onFileUploaderUploaded(e);\n        },\n        onUploadAborted: function (e) {\n          return _this._onFileUploaderUploadAborted(e);\n        },\n        onUploadError: function (e) {\n          return _this._onFileUploaderUploadError(e);\n        },\n        onDropZoneEnter: function () {\n          return _this._setDropZonePlaceholderVisible(true);\n        },\n        onDropZoneLeave: function () {\n          return _this._setDropZonePlaceholderVisible(false);\n        }\n      });\n\n      fileUploader.option({\n        uploadChunk: function (file, chunksData) {\n          return _this._fileUploaderUploadChunk(fileUploader, file, chunksData);\n        },\n        abortUpload: function (file, chunksData) {\n          return _this._fileUploaderAbortUpload(fileUploader, file, chunksData);\n        }\n      });\n      var uploaderInfo = {\n        fileUploader: fileUploader\n      };\n\n      this._uploaderInfos.push(uploaderInfo);\n    }\n  }, {\n    key: \"tryUpload\",\n    value: function () {\n      var info = this._findAndUpdateAvailableUploaderInfo();\n\n      if (info) {\n        info.fileUploader._selectButtonClickHandler();\n      }\n    }\n  }, {\n    key: \"cancelUpload\",\n    value: function (sessionId) {\n      this._cancelUpload(sessionId);\n    }\n  }, {\n    key: \"cancelFileUpload\",\n    value: function (sessionId, fileIndex) {\n      this._cancelUpload(sessionId, fileIndex);\n    }\n  }, {\n    key: \"_cancelUpload\",\n    value: function (sessionId, fileIndex) {\n      var _this$_findUploaderIn = this._findUploaderInfoBySessionId(sessionId),\n          fileUploader = _this$_findUploaderIn.fileUploader;\n\n      fileUploader.abortUpload(fileIndex);\n    }\n  }, {\n    key: \"_fileUploaderUploadChunk\",\n    value: function (fileUploader, file, chunksInfo) {\n      var _this$_findSessionByF = this._findSessionByFile(fileUploader, file),\n          session = _this$_findSessionByF.session,\n          fileIndex = _this$_findSessionByF.fileIndex;\n\n      var controller = session.controller;\n      chunksInfo.fileIndex = fileIndex;\n      return controller.uploadFileChunk(file, chunksInfo);\n    }\n  }, {\n    key: \"_fileUploaderAbortUpload\",\n    value: function (fileUploader, file, chunksInfo) {\n      var _this$_findSessionByF2 = this._findSessionByFile(fileUploader, file),\n          session = _this$_findSessionByF2.session,\n          fileIndex = _this$_findSessionByF2.fileIndex;\n\n      var controller = session.controller;\n      chunksInfo.fileIndex = fileIndex;\n      return controller.abortFileUpload(file, chunksInfo);\n    }\n  }, {\n    key: \"_onFileUploaderValueChanged\",\n    value: function (_ref) {\n      var _this2 = this;\n\n      var component = _ref.component,\n          value = _ref.value;\n\n      if (0 === value.length) {\n        return;\n      }\n\n      var files = value.slice();\n\n      var uploaderInfo = this._findUploaderInfo(component);\n\n      this._uploadFiles(uploaderInfo, files);\n\n      setTimeout(function () {\n        if (!_this2._findAndUpdateAvailableUploaderInfo()) {\n          _this2._createInternalFileUploader();\n        }\n      });\n    }\n  }, {\n    key: \"_onFileUploaderProgress\",\n    value: function (_ref2) {\n      var component = _ref2.component,\n          file = _ref2.file,\n          bytesLoaded = _ref2.bytesLoaded,\n          bytesTotal = _ref2.bytesTotal;\n\n      var _this$_findSessionByF3 = this._findSessionByFile(component, file),\n          session = _this$_findSessionByF3.session,\n          fileIndex = _this$_findSessionByF3.fileIndex;\n\n      var fileValue = 0 !== bytesTotal ? bytesLoaded / bytesTotal : 1;\n      var commonValue = component.option(\"progress\") / 100;\n      var args = {\n        sessionId: session.id,\n        fileIndex: fileIndex,\n        commonValue: commonValue,\n        fileValue: fileValue\n      };\n\n      this._raiseUploadProgress(args);\n    }\n  }, {\n    key: \"_onFileUploaderUploaded\",\n    value: function (_ref3) {\n      var component = _ref3.component,\n          file = _ref3.file;\n\n      var deferred = this._getDeferredForFile(component, file);\n\n      deferred.resolve();\n    }\n  }, {\n    key: \"_onFileUploaderUploadAborted\",\n    value: function (_ref4) {\n      var component = _ref4.component,\n          file = _ref4.file;\n\n      var deferred = this._getDeferredForFile(component, file);\n\n      deferred.resolve({\n        canceled: true\n      });\n    }\n  }, {\n    key: \"_onFileUploaderUploadError\",\n    value: function (_ref5) {\n      var component = _ref5.component,\n          file = _ref5.file,\n          error = _ref5.error;\n\n      var deferred = this._getDeferredForFile(component, file);\n\n      deferred.reject(error);\n    }\n  }, {\n    key: \"_createDropZonePlaceholder\",\n    value: function () {\n      this._$dropZonePlaceholder = (0, _renderer.default)(\"<div>\").addClass(FILE_MANAGER_FILE_UPLOADER_DROPZONE_PLACEHOLER_CLASS).appendTo(this.option(\"dropZonePlaceholderContainer\"));\n    }\n  }, {\n    key: \"_adjustDropZonePlaceholder\",\n    value: function () {\n      if (!(0, _window.hasWindow)()) {\n        return;\n      }\n\n      var $dropZoneTarget = this.option(\"dropZone\");\n      var placeholderBorderTopWidth = parseFloat(this._$dropZonePlaceholder.css(\"borderTopWidth\"));\n      var placeholderBorderLeftWidth = parseFloat(this._$dropZonePlaceholder.css(\"borderLeftWidth\"));\n      var $placeholderContainer = this.option(\"dropZonePlaceholderContainer\");\n      var containerBorderBottomWidth = parseFloat($placeholderContainer.css(\"borderBottomWidth\"));\n      var containerBorderLeftWidth = parseFloat($placeholderContainer.css(\"borderLeftWidth\"));\n      var containerHeight = $placeholderContainer.innerHeight();\n      var containerOffset = $placeholderContainer.offset();\n      var dropZoneOffset = $dropZoneTarget.offset();\n\n      this._$dropZonePlaceholder.css({\n        top: dropZoneOffset.top - containerOffset.top - containerHeight - containerBorderBottomWidth,\n        left: dropZoneOffset.left - containerOffset.left - containerBorderLeftWidth\n      });\n\n      this._$dropZonePlaceholder.height($dropZoneTarget.get(0).offsetHeight - 2 * placeholderBorderTopWidth);\n\n      this._$dropZonePlaceholder.width($dropZoneTarget.get(0).offsetWidth - 2 * placeholderBorderLeftWidth);\n    }\n  }, {\n    key: \"_setDropZonePlaceholderVisible\",\n    value: function (visible) {\n      if (visible) {\n        this._adjustDropZonePlaceholder();\n\n        this._$dropZonePlaceholder.css(\"display\", \"\");\n      } else {\n        this._$dropZonePlaceholder.css(\"display\", \"none\");\n      }\n    }\n  }, {\n    key: \"_uploadFiles\",\n    value: function (uploaderInfo, files) {\n      this._setDropZonePlaceholderVisible(false);\n\n      var sessionId = new _guid.default().toString();\n\n      var controller = this._getController();\n\n      var deferreds = files.map(function () {\n        return new _deferred.Deferred();\n      });\n      var session = {\n        id: sessionId,\n        controller: controller,\n        files: files,\n        deferreds: deferreds\n      };\n      uploaderInfo.session = session;\n      var sessionInfo = {\n        sessionId: sessionId,\n        deferreds: deferreds,\n        files: files\n      };\n\n      this._raiseUploadSessionStarted(sessionInfo);\n\n      return (0, _uiFile_manager.whenSome)(deferreds).always(function () {\n        return setTimeout(function () {\n          uploaderInfo.fileUploader.reset();\n          uploaderInfo.session = null;\n        });\n      });\n    }\n  }, {\n    key: \"_getDeferredForFile\",\n    value: function (fileUploader, file) {\n      var _this$_findSessionByF4 = this._findSessionByFile(fileUploader, file),\n          session = _this$_findSessionByF4.session,\n          fileIndex = _this$_findSessionByF4.fileIndex;\n\n      return session.deferreds[fileIndex];\n    }\n  }, {\n    key: \"_findSessionByFile\",\n    value: function (fileUploader, file) {\n      var uploaderInfo = this._findUploaderInfo(fileUploader);\n\n      var session = uploaderInfo.session;\n      var fileIndex = session.files.indexOf(file);\n      return {\n        session: session,\n        fileIndex: fileIndex\n      };\n    }\n  }, {\n    key: \"_findUploaderInfoBySessionId\",\n    value: function (sessionId) {\n      for (var i = 0; i < this._uploaderInfos.length; i++) {\n        var uploaderInfo = this._uploaderInfos[i];\n        var session = uploaderInfo.session;\n\n        if (session && session.id === sessionId) {\n          return uploaderInfo;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"_findAndUpdateAvailableUploaderInfo\",\n    value: function () {\n      var _info;\n\n      var info = null;\n\n      for (var i = 0; i < this._uploaderInfos.length; i++) {\n        var currentInfo = this._uploaderInfos[i];\n        currentInfo.fileUploader.option(\"dropZone\", \"\");\n\n        if (!info && !currentInfo.session) {\n          info = currentInfo;\n        }\n      }\n\n      null === (_info = info) || void 0 === _info ? void 0 : _info.fileUploader.option(\"dropZone\", this.option(\"dropZone\"));\n      return info;\n    }\n  }, {\n    key: \"_findUploaderInfo\",\n    value: function (fileUploader) {\n      for (var i = 0; i < this._uploaderInfos.length; i++) {\n        var info = this._uploaderInfos[i];\n\n        if (info.fileUploader === fileUploader) {\n          return info;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"_getController\",\n    value: function () {\n      var controllerGetter = this.option(\"getController\");\n      return controllerGetter();\n    }\n  }, {\n    key: \"_raiseUploadSessionStarted\",\n    value: function (sessionInfo) {\n      this._actions.onUploadSessionStarted({\n        sessionInfo: sessionInfo\n      });\n    }\n  }, {\n    key: \"_raiseUploadProgress\",\n    value: function (args) {\n      this._actions.onUploadProgress(args);\n    }\n  }, {\n    key: \"_initActions\",\n    value: function () {\n      this._actions = {\n        onUploadSessionStarted: this._createActionByOption(\"onUploadSessionStarted\"),\n        onUploadProgress: this._createActionByOption(\"onUploadProgress\")\n      };\n    }\n  }, {\n    key: \"_getDefaultOptions\",\n    value: function () {\n      return (0, _extend.extend)(_get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_getDefaultOptions\", this).call(this), {\n        getController: null,\n        onUploadSessionStarted: null,\n        onUploadProgress: null\n      });\n    }\n  }, {\n    key: \"_optionChanged\",\n    value: function (args) {\n      var name = args.name;\n\n      switch (name) {\n        case \"getController\":\n          this.repaint();\n          break;\n\n        case \"onUploadSessionStarted\":\n        case \"onUploadProgress\":\n          this._actions[name] = this._createActionByOption(name);\n          break;\n\n        case \"dropZone\":\n          this._findAndUpdateAvailableUploaderInfo();\n\n          this._adjustDropZonePlaceholder();\n\n          break;\n\n        case \"dropZonePlaceholderContainer\":\n          this._$dropZonePlaceholder.detach();\n\n          this._$dropZonePlaceholder.appendTo(args.value);\n\n          break;\n\n        default:\n          _get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_optionChanged\", this).call(this, args);\n\n      }\n    }\n  }]);\n\n  return FileManagerFileUploader;\n}(_ui.default);\n\nvar _default = FileManagerFileUploader;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/file_manager/ui.file_manager.file_uploader.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","exports","default","_renderer","_interopRequireDefault","require","_extend","_deferred","_window","_guid","_ui","_file_uploader","_uiFile_manager","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","value","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","FILE_MANAGER_FILE_UPLOADER_CLASS","FILE_MANAGER_FILE_UPLOADER_DROPZONE_PLACEHOLER_CLASS","FileManagerFileUploader","_Widget","_super","_initActions","$element","addClass","_uploaderInfos","_createInternalFileUploader","_createDropZonePlaceholder","_setDropZonePlaceholderVisible","_this","chunkSize","_getController","$fileUploader","appendTo","fileUploader","_createComponent","name","multiple","showFileList","activeStateEnabled","focusStateEnabled","hoverStateEnabled","labelText","readyToUploadMessage","accept","dropZone","option","onValueChanged","_onFileUploaderValueChanged","onProgress","_onFileUploaderProgress","onUploaded","_onFileUploaderUploaded","onUploadAborted","_onFileUploaderUploadAborted","onUploadError","_onFileUploaderUploadError","onDropZoneEnter","onDropZoneLeave","uploadChunk","file","chunksData","_fileUploaderUploadChunk","abortUpload","_fileUploaderAbortUpload","uploaderInfo","push","info","_findAndUpdateAvailableUploaderInfo","_selectButtonClickHandler","sessionId","_cancelUpload","fileIndex","_this$_findUploaderIn","_findUploaderInfoBySessionId","chunksInfo","_this$_findSessionByF","_findSessionByFile","session","controller","uploadFileChunk","_this$_findSessionByF2","abortFileUpload","_ref","_this2","component","files","slice","_findUploaderInfo","_uploadFiles","setTimeout","_ref2","bytesLoaded","bytesTotal","_this$_findSessionByF3","fileValue","commonValue","args","id","_raiseUploadProgress","_ref3","deferred","_getDeferredForFile","resolve","_ref4","canceled","_ref5","error","reject","_$dropZonePlaceholder","hasWindow","$dropZoneTarget","placeholderBorderTopWidth","parseFloat","css","placeholderBorderLeftWidth","$placeholderContainer","containerBorderBottomWidth","containerBorderLeftWidth","containerHeight","innerHeight","containerOffset","offset","dropZoneOffset","top","left","height","offsetHeight","width","offsetWidth","visible","_adjustDropZonePlaceholder","deferreds","map","Deferred","sessionInfo","_raiseUploadSessionStarted","whenSome","always","reset","_this$_findSessionByF4","indexOf","_info","currentInfo","controllerGetter","_actions","onUploadSessionStarted","onUploadProgress","_createActionByOption","extend","getController","repaint","detach","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/file_manager/ui.file_manager.file_uploader.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _guid = _interopRequireDefault(require(\"../../core/guid\"));\r\nvar _ui = _interopRequireDefault(require(\"../widget/ui.widget\"));\r\nvar _file_uploader = _interopRequireDefault(require(\"../file_uploader\"));\r\nvar _uiFile_manager = require(\"./ui.file_manager.common\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\n\r\nfunction _get(target, property, receiver) {\r\n    if (\"undefined\" !== typeof Reflect && Reflect.get) {\r\n        _get = Reflect.get\r\n    } else {\r\n        _get = function(target, property, receiver) {\r\n            var base = _superPropBase(target, property);\r\n            if (!base) {\r\n                return\r\n            }\r\n            var desc = Object.getOwnPropertyDescriptor(base, property);\r\n            if (desc.get) {\r\n                return desc.get.call(receiver)\r\n            }\r\n            return desc.value\r\n        }\r\n    }\r\n    return _get(target, property, receiver || target)\r\n}\r\n\r\nfunction _superPropBase(object, property) {\r\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\r\n        object = _getPrototypeOf(object);\r\n        if (null === object) {\r\n            break\r\n        }\r\n    }\r\n    return object\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n    if (\"function\" !== typeof superClass && null !== superClass) {\r\n        throw new TypeError(\"Super expression must either be null or a function\")\r\n    }\r\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n        constructor: {\r\n            value: subClass,\r\n            writable: true,\r\n            configurable: true\r\n        }\r\n    });\r\n    if (superClass) {\r\n        _setPrototypeOf(subClass, superClass)\r\n    }\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n    return function() {\r\n        var result, Super = _getPrototypeOf(Derived);\r\n        if (hasNativeReflectConstruct) {\r\n            var NewTarget = _getPrototypeOf(this).constructor;\r\n            result = Reflect.construct(Super, arguments, NewTarget)\r\n        } else {\r\n            result = Super.apply(this, arguments)\r\n        }\r\n        return _possibleConstructorReturn(this, result)\r\n    }\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n    if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\r\n        return call\r\n    }\r\n    return _assertThisInitialized(self)\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n    if (void 0 === self) {\r\n        throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\")\r\n    }\r\n    return self\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n    if (\"undefined\" === typeof Reflect || !Reflect.construct) {\r\n        return false\r\n    }\r\n    if (Reflect.construct.sham) {\r\n        return false\r\n    }\r\n    if (\"function\" === typeof Proxy) {\r\n        return true\r\n    }\r\n    try {\r\n        Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\r\n        return true\r\n    } catch (e) {\r\n        return false\r\n    }\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o)\r\n    };\r\n    return _getPrototypeOf(o)\r\n}\r\nvar FILE_MANAGER_FILE_UPLOADER_CLASS = \"dx-filemanager-fileuploader\";\r\nvar FILE_MANAGER_FILE_UPLOADER_DROPZONE_PLACEHOLER_CLASS = \"dx-filemanager-fileuploader-dropzone-placeholder\";\r\nvar FileManagerFileUploader = function(_Widget) {\r\n    _inherits(FileManagerFileUploader, _Widget);\r\n    var _super = _createSuper(FileManagerFileUploader);\r\n\r\n    function FileManagerFileUploader() {\r\n        _classCallCheck(this, FileManagerFileUploader);\r\n        return _super.apply(this, arguments)\r\n    }\r\n    _createClass(FileManagerFileUploader, [{\r\n        key: \"_initMarkup\",\r\n        value: function() {\r\n            this._initActions();\r\n            this.$element().addClass(FILE_MANAGER_FILE_UPLOADER_CLASS);\r\n            this._uploaderInfos = [];\r\n            this._createInternalFileUploader();\r\n            this._createDropZonePlaceholder();\r\n            this._setDropZonePlaceholderVisible(false);\r\n            _get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_initMarkup\", this).call(this)\r\n        }\r\n    }, {\r\n        key: \"_createInternalFileUploader\",\r\n        value: function() {\r\n            var _this = this;\r\n            var chunkSize = this._getController().chunkSize;\r\n            var $fileUploader = (0, _renderer.default)(\"<div>\").appendTo(this.$element());\r\n            var fileUploader = this._createComponent($fileUploader, _file_uploader.default, {\r\n                name: \"file\",\r\n                multiple: true,\r\n                showFileList: false,\r\n                activeStateEnabled: false,\r\n                focusStateEnabled: false,\r\n                hoverStateEnabled: false,\r\n                labelText: \"\",\r\n                readyToUploadMessage: \"\",\r\n                accept: \"*\",\r\n                chunkSize: chunkSize,\r\n                dropZone: this.option(\"dropZone\"),\r\n                onValueChanged: function(e) {\r\n                    return _this._onFileUploaderValueChanged(e)\r\n                },\r\n                onProgress: function(e) {\r\n                    return _this._onFileUploaderProgress(e)\r\n                },\r\n                onUploaded: function(e) {\r\n                    return _this._onFileUploaderUploaded(e)\r\n                },\r\n                onUploadAborted: function(e) {\r\n                    return _this._onFileUploaderUploadAborted(e)\r\n                },\r\n                onUploadError: function(e) {\r\n                    return _this._onFileUploaderUploadError(e)\r\n                },\r\n                onDropZoneEnter: function() {\r\n                    return _this._setDropZonePlaceholderVisible(true)\r\n                },\r\n                onDropZoneLeave: function() {\r\n                    return _this._setDropZonePlaceholderVisible(false)\r\n                }\r\n            });\r\n            fileUploader.option({\r\n                uploadChunk: function(file, chunksData) {\r\n                    return _this._fileUploaderUploadChunk(fileUploader, file, chunksData)\r\n                },\r\n                abortUpload: function(file, chunksData) {\r\n                    return _this._fileUploaderAbortUpload(fileUploader, file, chunksData)\r\n                }\r\n            });\r\n            var uploaderInfo = {\r\n                fileUploader: fileUploader\r\n            };\r\n            this._uploaderInfos.push(uploaderInfo)\r\n        }\r\n    }, {\r\n        key: \"tryUpload\",\r\n        value: function() {\r\n            var info = this._findAndUpdateAvailableUploaderInfo();\r\n            if (info) {\r\n                info.fileUploader._selectButtonClickHandler()\r\n            }\r\n        }\r\n    }, {\r\n        key: \"cancelUpload\",\r\n        value: function(sessionId) {\r\n            this._cancelUpload(sessionId)\r\n        }\r\n    }, {\r\n        key: \"cancelFileUpload\",\r\n        value: function(sessionId, fileIndex) {\r\n            this._cancelUpload(sessionId, fileIndex)\r\n        }\r\n    }, {\r\n        key: \"_cancelUpload\",\r\n        value: function(sessionId, fileIndex) {\r\n            var _this$_findUploaderIn = this._findUploaderInfoBySessionId(sessionId),\r\n                fileUploader = _this$_findUploaderIn.fileUploader;\r\n            fileUploader.abortUpload(fileIndex)\r\n        }\r\n    }, {\r\n        key: \"_fileUploaderUploadChunk\",\r\n        value: function(fileUploader, file, chunksInfo) {\r\n            var _this$_findSessionByF = this._findSessionByFile(fileUploader, file),\r\n                session = _this$_findSessionByF.session,\r\n                fileIndex = _this$_findSessionByF.fileIndex;\r\n            var controller = session.controller;\r\n            chunksInfo.fileIndex = fileIndex;\r\n            return controller.uploadFileChunk(file, chunksInfo)\r\n        }\r\n    }, {\r\n        key: \"_fileUploaderAbortUpload\",\r\n        value: function(fileUploader, file, chunksInfo) {\r\n            var _this$_findSessionByF2 = this._findSessionByFile(fileUploader, file),\r\n                session = _this$_findSessionByF2.session,\r\n                fileIndex = _this$_findSessionByF2.fileIndex;\r\n            var controller = session.controller;\r\n            chunksInfo.fileIndex = fileIndex;\r\n            return controller.abortFileUpload(file, chunksInfo)\r\n        }\r\n    }, {\r\n        key: \"_onFileUploaderValueChanged\",\r\n        value: function(_ref) {\r\n            var _this2 = this;\r\n            var component = _ref.component,\r\n                value = _ref.value;\r\n            if (0 === value.length) {\r\n                return\r\n            }\r\n            var files = value.slice();\r\n            var uploaderInfo = this._findUploaderInfo(component);\r\n            this._uploadFiles(uploaderInfo, files);\r\n            setTimeout(function() {\r\n                if (!_this2._findAndUpdateAvailableUploaderInfo()) {\r\n                    _this2._createInternalFileUploader()\r\n                }\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_onFileUploaderProgress\",\r\n        value: function(_ref2) {\r\n            var component = _ref2.component,\r\n                file = _ref2.file,\r\n                bytesLoaded = _ref2.bytesLoaded,\r\n                bytesTotal = _ref2.bytesTotal;\r\n            var _this$_findSessionByF3 = this._findSessionByFile(component, file),\r\n                session = _this$_findSessionByF3.session,\r\n                fileIndex = _this$_findSessionByF3.fileIndex;\r\n            var fileValue = 0 !== bytesTotal ? bytesLoaded / bytesTotal : 1;\r\n            var commonValue = component.option(\"progress\") / 100;\r\n            var args = {\r\n                sessionId: session.id,\r\n                fileIndex: fileIndex,\r\n                commonValue: commonValue,\r\n                fileValue: fileValue\r\n            };\r\n            this._raiseUploadProgress(args)\r\n        }\r\n    }, {\r\n        key: \"_onFileUploaderUploaded\",\r\n        value: function(_ref3) {\r\n            var component = _ref3.component,\r\n                file = _ref3.file;\r\n            var deferred = this._getDeferredForFile(component, file);\r\n            deferred.resolve()\r\n        }\r\n    }, {\r\n        key: \"_onFileUploaderUploadAborted\",\r\n        value: function(_ref4) {\r\n            var component = _ref4.component,\r\n                file = _ref4.file;\r\n            var deferred = this._getDeferredForFile(component, file);\r\n            deferred.resolve({\r\n                canceled: true\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_onFileUploaderUploadError\",\r\n        value: function(_ref5) {\r\n            var component = _ref5.component,\r\n                file = _ref5.file,\r\n                error = _ref5.error;\r\n            var deferred = this._getDeferredForFile(component, file);\r\n            deferred.reject(error)\r\n        }\r\n    }, {\r\n        key: \"_createDropZonePlaceholder\",\r\n        value: function() {\r\n            this._$dropZonePlaceholder = (0, _renderer.default)(\"<div>\").addClass(FILE_MANAGER_FILE_UPLOADER_DROPZONE_PLACEHOLER_CLASS).appendTo(this.option(\"dropZonePlaceholderContainer\"))\r\n        }\r\n    }, {\r\n        key: \"_adjustDropZonePlaceholder\",\r\n        value: function() {\r\n            if (!(0, _window.hasWindow)()) {\r\n                return\r\n            }\r\n            var $dropZoneTarget = this.option(\"dropZone\");\r\n            var placeholderBorderTopWidth = parseFloat(this._$dropZonePlaceholder.css(\"borderTopWidth\"));\r\n            var placeholderBorderLeftWidth = parseFloat(this._$dropZonePlaceholder.css(\"borderLeftWidth\"));\r\n            var $placeholderContainer = this.option(\"dropZonePlaceholderContainer\");\r\n            var containerBorderBottomWidth = parseFloat($placeholderContainer.css(\"borderBottomWidth\"));\r\n            var containerBorderLeftWidth = parseFloat($placeholderContainer.css(\"borderLeftWidth\"));\r\n            var containerHeight = $placeholderContainer.innerHeight();\r\n            var containerOffset = $placeholderContainer.offset();\r\n            var dropZoneOffset = $dropZoneTarget.offset();\r\n            this._$dropZonePlaceholder.css({\r\n                top: dropZoneOffset.top - containerOffset.top - containerHeight - containerBorderBottomWidth,\r\n                left: dropZoneOffset.left - containerOffset.left - containerBorderLeftWidth\r\n            });\r\n            this._$dropZonePlaceholder.height($dropZoneTarget.get(0).offsetHeight - 2 * placeholderBorderTopWidth);\r\n            this._$dropZonePlaceholder.width($dropZoneTarget.get(0).offsetWidth - 2 * placeholderBorderLeftWidth)\r\n        }\r\n    }, {\r\n        key: \"_setDropZonePlaceholderVisible\",\r\n        value: function(visible) {\r\n            if (visible) {\r\n                this._adjustDropZonePlaceholder();\r\n                this._$dropZonePlaceholder.css(\"display\", \"\")\r\n            } else {\r\n                this._$dropZonePlaceholder.css(\"display\", \"none\")\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_uploadFiles\",\r\n        value: function(uploaderInfo, files) {\r\n            this._setDropZonePlaceholderVisible(false);\r\n            var sessionId = (new _guid.default).toString();\r\n            var controller = this._getController();\r\n            var deferreds = files.map(function() {\r\n                return new _deferred.Deferred\r\n            });\r\n            var session = {\r\n                id: sessionId,\r\n                controller: controller,\r\n                files: files,\r\n                deferreds: deferreds\r\n            };\r\n            uploaderInfo.session = session;\r\n            var sessionInfo = {\r\n                sessionId: sessionId,\r\n                deferreds: deferreds,\r\n                files: files\r\n            };\r\n            this._raiseUploadSessionStarted(sessionInfo);\r\n            return (0, _uiFile_manager.whenSome)(deferreds).always(function() {\r\n                return setTimeout(function() {\r\n                    uploaderInfo.fileUploader.reset();\r\n                    uploaderInfo.session = null\r\n                })\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_getDeferredForFile\",\r\n        value: function(fileUploader, file) {\r\n            var _this$_findSessionByF4 = this._findSessionByFile(fileUploader, file),\r\n                session = _this$_findSessionByF4.session,\r\n                fileIndex = _this$_findSessionByF4.fileIndex;\r\n            return session.deferreds[fileIndex]\r\n        }\r\n    }, {\r\n        key: \"_findSessionByFile\",\r\n        value: function(fileUploader, file) {\r\n            var uploaderInfo = this._findUploaderInfo(fileUploader);\r\n            var session = uploaderInfo.session;\r\n            var fileIndex = session.files.indexOf(file);\r\n            return {\r\n                session: session,\r\n                fileIndex: fileIndex\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_findUploaderInfoBySessionId\",\r\n        value: function(sessionId) {\r\n            for (var i = 0; i < this._uploaderInfos.length; i++) {\r\n                var uploaderInfo = this._uploaderInfos[i];\r\n                var session = uploaderInfo.session;\r\n                if (session && session.id === sessionId) {\r\n                    return uploaderInfo\r\n                }\r\n            }\r\n            return null\r\n        }\r\n    }, {\r\n        key: \"_findAndUpdateAvailableUploaderInfo\",\r\n        value: function() {\r\n            var _info;\r\n            var info = null;\r\n            for (var i = 0; i < this._uploaderInfos.length; i++) {\r\n                var currentInfo = this._uploaderInfos[i];\r\n                currentInfo.fileUploader.option(\"dropZone\", \"\");\r\n                if (!info && !currentInfo.session) {\r\n                    info = currentInfo\r\n                }\r\n            }\r\n            null === (_info = info) || void 0 === _info ? void 0 : _info.fileUploader.option(\"dropZone\", this.option(\"dropZone\"));\r\n            return info\r\n        }\r\n    }, {\r\n        key: \"_findUploaderInfo\",\r\n        value: function(fileUploader) {\r\n            for (var i = 0; i < this._uploaderInfos.length; i++) {\r\n                var info = this._uploaderInfos[i];\r\n                if (info.fileUploader === fileUploader) {\r\n                    return info\r\n                }\r\n            }\r\n            return null\r\n        }\r\n    }, {\r\n        key: \"_getController\",\r\n        value: function() {\r\n            var controllerGetter = this.option(\"getController\");\r\n            return controllerGetter()\r\n        }\r\n    }, {\r\n        key: \"_raiseUploadSessionStarted\",\r\n        value: function(sessionInfo) {\r\n            this._actions.onUploadSessionStarted({\r\n                sessionInfo: sessionInfo\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_raiseUploadProgress\",\r\n        value: function(args) {\r\n            this._actions.onUploadProgress(args)\r\n        }\r\n    }, {\r\n        key: \"_initActions\",\r\n        value: function() {\r\n            this._actions = {\r\n                onUploadSessionStarted: this._createActionByOption(\"onUploadSessionStarted\"),\r\n                onUploadProgress: this._createActionByOption(\"onUploadProgress\")\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getDefaultOptions\",\r\n        value: function() {\r\n            return (0, _extend.extend)(_get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_getDefaultOptions\", this).call(this), {\r\n                getController: null,\r\n                onUploadSessionStarted: null,\r\n                onUploadProgress: null\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_optionChanged\",\r\n        value: function(args) {\r\n            var name = args.name;\r\n            switch (name) {\r\n                case \"getController\":\r\n                    this.repaint();\r\n                    break;\r\n                case \"onUploadSessionStarted\":\r\n                case \"onUploadProgress\":\r\n                    this._actions[name] = this._createActionByOption(name);\r\n                    break;\r\n                case \"dropZone\":\r\n                    this._findAndUpdateAvailableUploaderInfo();\r\n                    this._adjustDropZonePlaceholder();\r\n                    break;\r\n                case \"dropZonePlaceholderContainer\":\r\n                    this._$dropZonePlaceholder.detach();\r\n                    this._$dropZonePlaceholder.appendTo(args.value);\r\n                    break;\r\n                default:\r\n                    _get(_getPrototypeOf(FileManagerFileUploader.prototype), \"_optionChanged\", this).call(this, args)\r\n            }\r\n        }\r\n    }]);\r\n    return FileManagerFileUploader\r\n}(_ui.default);\r\nvar _default = FileManagerFileUploader;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}