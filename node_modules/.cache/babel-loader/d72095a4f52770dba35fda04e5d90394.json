{"ast":null,"code":"/**\r\n * DevExtreme (viz/funnel/label.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.plugin = void 0;\n\nvar _label = require(\"../series/points/label\");\n\nvar _utils = require(\"../core/utils\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _common = require(\"../../core/utils/common\");\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _e = void 0;\n\n  try {\n    for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) {\n        break;\n      }\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && null != _i.return) {\n        _i.return();\n      }\n    } finally {\n      if (_d) {\n        throw _e;\n      }\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) {\n    return arr;\n  }\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    return _arrayLikeToArray(arr);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nvar OUTSIDE_POSITION = \"outside\";\nvar INSIDE_POSITION = \"inside\";\nvar OUTSIDE_LABEL_INDENT = 5;\nvar COLUMNS_LABEL_INDENT = 20;\nvar CONNECTOR_INDENT = 4;\nvar PREVENT_EMPTY_PIXEL_OFFSET = 1;\n\nfunction getLabelIndent(pos) {\n  pos = (0, _utils.normalizeEnum)(pos);\n\n  if (pos === OUTSIDE_POSITION) {\n    return OUTSIDE_LABEL_INDENT;\n  } else {\n    if (pos === INSIDE_POSITION) {\n      return 0;\n    }\n  }\n\n  return COLUMNS_LABEL_INDENT;\n}\n\nfunction isOutsidePosition(pos) {\n  pos = (0, _utils.normalizeEnum)(pos);\n  return pos === OUTSIDE_POSITION || pos !== INSIDE_POSITION;\n}\n\nfunction correctYForInverted(y, bBox, inverted) {\n  return inverted ? y - bBox.height : y;\n}\n\nfunction getOutsideRightLabelPosition(coords, bBox, options, inverted) {\n  return {\n    x: coords[2] + options.horizontalOffset + OUTSIDE_LABEL_INDENT,\n    y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\n  };\n}\n\nfunction getOutsideLeftLabelPosition(coords, bBox, options, inverted) {\n  return {\n    x: coords[0] - bBox.width - options.horizontalOffset - OUTSIDE_LABEL_INDENT,\n    y: correctYForInverted(coords[1] + options.verticalOffset, bBox, inverted)\n  };\n}\n\nfunction getInsideLabelPosition(coords, bBox, options) {\n  var width = coords[2] - coords[0];\n  var height = coords[7] - coords[1];\n  return {\n    x: coords[0] + width / 2 + options.horizontalOffset - bBox.width / 2,\n    y: coords[1] + options.verticalOffset + height / 2 - bBox.height / 2\n  };\n}\n\nfunction getColumnLabelRightPosition(labelRect, rect, textAlignment) {\n  return function (coords, bBox, options, inverted) {\n    return {\n      x: \"left\" === textAlignment ? rect[2] + options.horizontalOffset + COLUMNS_LABEL_INDENT : labelRect[2] - bBox.width,\n      y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\n    };\n  };\n}\n\nfunction getColumnLabelLeftPosition(labelRect, rect, textAlignment) {\n  return function (coords, bBox, options, inverted) {\n    return {\n      x: \"left\" === textAlignment ? labelRect[0] : rect[0] - bBox.width - options.horizontalOffset - COLUMNS_LABEL_INDENT,\n      y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\n    };\n  };\n}\n\nfunction getConnectorStrategy(options, inverted) {\n  var isLeftPos = \"left\" === options.horizontalAlignment;\n  var connectorIndent = isLeftPos ? CONNECTOR_INDENT : -CONNECTOR_INDENT;\n  var verticalCorrection = inverted ? -PREVENT_EMPTY_PIXEL_OFFSET : 0;\n\n  function getFigureCenter(figure) {\n    return isLeftPos ? [figure[0] + PREVENT_EMPTY_PIXEL_OFFSET, figure[1] + verticalCorrection] : [figure[2] - PREVENT_EMPTY_PIXEL_OFFSET, figure[3] + verticalCorrection];\n  }\n\n  return {\n    isLabelInside: function () {\n      return !isOutsidePosition(options.position);\n    },\n    getFigureCenter: getFigureCenter,\n    prepareLabelPoints: function (bBox) {\n      var x = bBox.x + connectorIndent;\n      var y = bBox.y;\n      var x1 = x + bBox.width;\n      return _toConsumableArray(Array(bBox.height + 1)).map(function (_, i) {\n        return [x, y + i];\n      }).concat(_toConsumableArray(Array(bBox.height + 1)).map(function (_, i) {\n        return [x1, y + i];\n      }));\n    },\n    isHorizontal: function () {\n      return true;\n    },\n    findFigurePoint: function (figure) {\n      return getFigureCenter(figure);\n    },\n    adjustPoints: function (points) {\n      return points.map(Math.round);\n    }\n  };\n}\n\nfunction getLabelOptions(labelOptions, defaultColor, defaultTextAlignment) {\n  var opt = labelOptions || {};\n  var labelFont = (0, _extend.extend)({}, opt.font) || {};\n  var labelBorder = opt.border || {};\n  var labelConnector = opt.connector || {};\n  var backgroundAttr = {\n    fill: opt.backgroundColor || defaultColor,\n    \"stroke-width\": labelBorder.visible ? labelBorder.width || 0 : 0,\n    stroke: labelBorder.visible && labelBorder.width ? labelBorder.color : \"none\",\n    dashStyle: labelBorder.dashStyle\n  };\n  var connectorAttr = {\n    stroke: labelConnector.visible && labelConnector.width ? labelConnector.color || defaultColor : \"none\",\n    \"stroke-width\": labelConnector.visible ? labelConnector.width || 0 : 0,\n    opacity: labelConnector.opacity\n  };\n  labelFont.color = \"none\" === opt.backgroundColor && \"#ffffff\" === (0, _utils.normalizeEnum)(labelFont.color) && \"inside\" !== opt.position ? defaultColor : labelFont.color;\n  return {\n    format: opt.format,\n    textAlignment: opt.textAlignment || (isOutsidePosition(opt.position) ? defaultTextAlignment : \"center\"),\n    customizeText: opt.customizeText,\n    attributes: {\n      font: labelFont\n    },\n    visible: 0 !== labelFont.size ? opt.visible : false,\n    showForZeroValues: opt.showForZeroValues,\n    horizontalOffset: opt.horizontalOffset,\n    verticalOffset: opt.verticalOffset,\n    background: backgroundAttr,\n    connector: connectorAttr,\n    wordWrap: labelOptions.wordWrap,\n    textOverflow: labelOptions.textOverflow\n  };\n}\n\nfunction correctLabelPosition(pos, bBox, rect) {\n  if (pos.x < rect[0]) {\n    pos.x = rect[0];\n  }\n\n  if (pos.x + bBox.width > rect[2]) {\n    pos.x = rect[2] - bBox.width;\n  }\n\n  if (pos.y < rect[1]) {\n    pos.y = rect[1];\n  }\n\n  if (pos.y + bBox.height > rect[3]) {\n    pos.y = rect[3] - bBox.height;\n  }\n\n  return pos;\n}\n\nfunction removeEmptySpace(labels, requiredSpace, startPoint) {\n  labels.reduce(function (requiredSpace, label, index, labels) {\n    var prevLabel = labels[index + 1];\n\n    if (requiredSpace > 0) {\n      var bBox = label.getBoundingRect();\n      var point = prevLabel ? prevLabel.getBoundingRect().y + prevLabel.getBoundingRect().height : startPoint;\n      var emptySpace = bBox.y - point;\n      var shift = Math.min(emptySpace, requiredSpace);\n      labels.slice(0, index + 1).forEach(function (label) {\n        var bBox = label.getBoundingRect();\n        label.shift(bBox.x, bBox.y - shift);\n      });\n      requiredSpace -= shift;\n    }\n\n    return requiredSpace;\n  }, requiredSpace);\n}\n\nvar plugin = {\n  name: \"lables\",\n  init: _common.noop,\n  dispose: _common.noop,\n  extenders: {\n    _initCore: function () {\n      this._labelsGroup = this._renderer.g().attr({\n        \"class\": this._rootClassPrefix + \"-labels\"\n      }).append(this._renderer.root);\n      this._labels = [];\n    },\n    _applySize: function () {\n      var options = this._getOption(\"label\");\n\n      var adaptiveLayout = this._getOption(\"adaptiveLayout\");\n\n      var rect = this._rect;\n      var labelWidth = 0;\n      var width = rect[2] - rect[0];\n      this._labelRect = rect.slice();\n\n      if (!this._labels.length || !isOutsidePosition(options.position)) {\n        if ((0, _utils.normalizeEnum)(\"none\" !== this._getOption(\"resolveLabelOverlapping\", true))) {\n          this._labels.forEach(function (l) {\n            return !l.isVisible() && l.draw(true);\n          });\n        }\n\n        return;\n      }\n\n      var groupWidth = this._labels.map(function (label) {\n        label.resetEllipsis();\n        return label.getBoundingRect().width;\n      }).reduce(function (max, width) {\n        return Math.max(max, width);\n      }, 0);\n\n      labelWidth = groupWidth + options.horizontalOffset + getLabelIndent(options.position);\n\n      if (!adaptiveLayout.keepLabels && width - labelWidth < adaptiveLayout.width) {\n        this._labels.forEach(function (label) {\n          label.draw(false);\n        });\n\n        return;\n      } else {\n        if (width - labelWidth < adaptiveLayout.width) {\n          labelWidth = width - adaptiveLayout.width;\n          labelWidth = labelWidth > 0 ? labelWidth : 0;\n        }\n\n        this._labels.forEach(function (label) {\n          label.draw(true);\n        });\n      }\n\n      if (\"left\" === options.horizontalAlignment) {\n        rect[0] += labelWidth;\n      } else {\n        rect[2] -= labelWidth;\n      }\n    },\n    _buildNodes: function () {\n      this._createLabels();\n    },\n    _change_TILING: function () {\n      var that = this;\n\n      var options = that._getOption(\"label\");\n\n      var getCoords = getInsideLabelPosition;\n\n      var inverted = that._getOption(\"inverted\", true);\n\n      var textAlignment;\n\n      if (isOutsidePosition(options.position)) {\n        if ((0, _utils.normalizeEnum)(options.position) === OUTSIDE_POSITION) {\n          getCoords = \"left\" === options.horizontalAlignment ? getOutsideLeftLabelPosition : getOutsideRightLabelPosition;\n        } else {\n          textAlignment = this._defaultLabelTextAlignment();\n          getCoords = \"left\" === options.horizontalAlignment ? getColumnLabelLeftPosition(this._labelRect, this._rect, textAlignment) : getColumnLabelRightPosition(this._labelRect, this._rect, textAlignment);\n        }\n      }\n\n      that._labels.forEach(function (label, index) {\n        var item = that._items[index];\n        var borderWidth = item.getNormalStyle()[\"stroke-width\"];\n        var halfBorderWidth = inverted ? borderWidth / 2 : -borderWidth / 2;\n        var coords = halfBorderWidth ? item.coords.map(function (coord, index) {\n          if (1 === index || 3 === index) {\n            return coord - halfBorderWidth;\n          } else {\n            if (2 === index) {\n              return coord - borderWidth;\n            } else {\n              if (0 === index) {\n                return coord + borderWidth;\n              }\n            }\n          }\n\n          return coord;\n        }) : item.coords;\n\n        if (!options.showForZeroValues && 0 === item.value) {\n          label.draw(false);\n          return;\n        }\n\n        if (isOutsidePosition(options.position)) {\n          that._correctLabelWidth(label, item.coords, options);\n        }\n\n        var bBox = label.getBoundingRect();\n        var pos = correctLabelPosition(getCoords(coords, bBox, options, inverted), bBox, that._labelRect);\n        label.setFigureToDrawConnector(coords);\n        label.shift(pos.x, pos.y);\n      });\n\n      that._resolveLabelOverlapping();\n    }\n  },\n  members: {\n    _resolveLabelOverlapping: function () {\n      var that = this;\n      var resolveLabelOverlapping = (0, _utils.normalizeEnum)(that._getOption(\"resolveLabelOverlapping\", true));\n      var labels = this._getOption(\"inverted\", true) ? that._labels.slice().reverse() : that._labels;\n\n      if (\"hide\" === resolveLabelOverlapping) {\n        labels.reduce(function (height, label) {\n          if (label.getBoundingRect().y < height) {\n            label.hide();\n          } else {\n            height = label.getBoundingRect().y + label.getBoundingRect().height;\n          }\n\n          return height;\n        }, 0);\n      } else {\n        if (\"shift\" === resolveLabelOverlapping) {\n          var maxHeight = this._labelRect[3];\n          labels.reduce(function (_ref, label, index, labels) {\n            var _ref2 = _slicedToArray(_ref, 2),\n                height = _ref2[0],\n                emptySpace = _ref2[1];\n\n            var bBox = label.getBoundingRect();\n            var y = bBox.y;\n\n            if (bBox.y < height) {\n              label.shift(bBox.x, height);\n              y = height;\n            }\n\n            if (y - height > 0) {\n              emptySpace += y - height;\n            }\n\n            if (y + bBox.height > maxHeight) {\n              if (emptySpace && emptySpace > y + bBox.height - maxHeight) {\n                removeEmptySpace(labels.slice(0, index).reverse(), y + bBox.height - maxHeight, that._labelRect[1]);\n                emptySpace -= y + bBox.height - maxHeight;\n                label.shift(bBox.x, y - (y + bBox.height - maxHeight));\n                height = y - (y + bBox.height - maxHeight) + bBox.height;\n              } else {\n                label.hide();\n              }\n            } else {\n              height = y + bBox.height;\n            }\n\n            return [height, emptySpace];\n          }, [this._labelRect[1], 0]);\n        }\n      }\n    },\n    _defaultLabelTextAlignment: function () {\n      return this._getOption(\"rtlEnabled\", true) ? \"right\" : \"left\";\n    },\n    _correctLabelWidth: function (label, item, options) {\n      var isLeftPos = \"left\" === options.horizontalAlignment;\n      var minX = isLeftPos ? this._labelRect[0] : item[2];\n      var maxX = isLeftPos ? item[0] : this._labelRect[2];\n      var maxWidth = maxX - minX;\n\n      if (label.getBoundingRect().width > maxWidth) {\n        label.fit(maxWidth);\n      }\n    },\n    _createLabels: function () {\n      var that = this;\n\n      var labelOptions = that._getOption(\"label\");\n\n      var connectorStrategy = getConnectorStrategy(labelOptions, that._getOption(\"inverted\", true));\n\n      this._labelsGroup.clear();\n\n      if (!labelOptions.visible) {\n        return;\n      }\n\n      this._labels = that._items.map(function (item) {\n        var label = new _label.Label({\n          renderer: that._renderer,\n          labelsGroup: that._labelsGroup,\n          strategy: connectorStrategy\n        });\n        label.setOptions(getLabelOptions(labelOptions, item.color, that._defaultLabelTextAlignment()));\n        label.setData({\n          item: item,\n          value: item.value,\n          percent: item.percent\n        });\n        label.draw(true);\n        return label;\n      });\n\n      if (this._labels.length && isOutsidePosition(labelOptions.position)) {\n        this._requestChange([\"LAYOUT\"]);\n      }\n    }\n  },\n  customize: function (constructor) {\n    constructor.prototype._proxyData.push(function (x, y) {\n      var that = this;\n      var data;\n\n      that._labels.forEach(function (label, index) {\n        var rect = label.getBoundingRect();\n\n        if (x >= rect.x && x <= rect.x + rect.width && y >= rect.y && y <= rect.y + rect.height) {\n          var pos = isOutsidePosition(that._getOption(\"label\").position) ? \"outside\" : \"inside\";\n          data = {\n            id: index,\n            type: pos + \"-label\"\n          };\n          return true;\n        }\n      });\n\n      return data;\n    });\n\n    [\"label\", \"resolveLabelOverlapping\"].forEach(function (optionName) {\n      constructor.addChange({\n        code: optionName.toUpperCase(),\n        handler: function () {\n          this._createLabels();\n\n          this._requestChange([\"LAYOUT\"]);\n        },\n        isThemeDependent: true,\n        isOptionChange: true,\n        option: optionName\n      });\n    });\n  },\n  fontFields: [\"label.font\"]\n};\nexports.plugin = plugin;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/viz/funnel/label.js"],"names":["exports","plugin","_label","require","_utils","_extend","_common","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","Symbol","iterator","Object","_arr","_n","_d","_e","_s","_i","next","done","push","value","length","err","return","Array","isArray","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","from","test","iter","len","arr2","OUTSIDE_POSITION","INSIDE_POSITION","OUTSIDE_LABEL_INDENT","COLUMNS_LABEL_INDENT","CONNECTOR_INDENT","PREVENT_EMPTY_PIXEL_OFFSET","getLabelIndent","pos","normalizeEnum","isOutsidePosition","correctYForInverted","y","bBox","inverted","height","getOutsideRightLabelPosition","coords","options","x","horizontalOffset","verticalOffset","getOutsideLeftLabelPosition","width","getInsideLabelPosition","getColumnLabelRightPosition","labelRect","rect","textAlignment","getColumnLabelLeftPosition","getConnectorStrategy","isLeftPos","horizontalAlignment","connectorIndent","verticalCorrection","getFigureCenter","figure","isLabelInside","position","prepareLabelPoints","x1","map","_","concat","isHorizontal","findFigurePoint","adjustPoints","points","Math","round","getLabelOptions","labelOptions","defaultColor","defaultTextAlignment","opt","labelFont","extend","font","labelBorder","border","labelConnector","connector","backgroundAttr","fill","backgroundColor","visible","stroke","color","dashStyle","connectorAttr","opacity","format","customizeText","attributes","size","showForZeroValues","background","wordWrap","textOverflow","correctLabelPosition","removeEmptySpace","labels","requiredSpace","startPoint","reduce","label","index","prevLabel","getBoundingRect","point","emptySpace","shift","min","forEach","init","noop","dispose","extenders","_initCore","_labelsGroup","_renderer","g","attr","_rootClassPrefix","append","root","_labels","_applySize","_getOption","adaptiveLayout","_rect","labelWidth","_labelRect","l","isVisible","draw","groupWidth","resetEllipsis","max","keepLabels","_buildNodes","_createLabels","_change_TILING","that","getCoords","_defaultLabelTextAlignment","item","_items","borderWidth","getNormalStyle","halfBorderWidth","coord","_correctLabelWidth","setFigureToDrawConnector","_resolveLabelOverlapping","members","resolveLabelOverlapping","reverse","hide","maxHeight","_ref","_ref2","minX","maxX","maxWidth","fit","connectorStrategy","clear","Label","renderer","labelsGroup","strategy","setOptions","setData","percent","_requestChange","customize","_proxyData","data","id","type","optionName","addChange","code","toUpperCase","handler","isThemeDependent","isOptionChange","option","fontFields"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/funnel/label.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.plugin = void 0;\r\nvar _label = require(\"../series/points/label\");\r\nvar _utils = require(\"../core/utils\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _common = require(\"../../core/utils/common\");\r\n\r\nfunction _slicedToArray(arr, i) {\r\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest()\r\n}\r\n\r\nfunction _nonIterableRest() {\r\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _iterableToArrayLimit(arr, i) {\r\n    if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\r\n        return\r\n    }\r\n    var _arr = [];\r\n    var _n = true;\r\n    var _d = false;\r\n    var _e = void 0;\r\n    try {\r\n        for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\r\n            _arr.push(_s.value);\r\n            if (i && _arr.length === i) {\r\n                break\r\n            }\r\n        }\r\n    } catch (err) {\r\n        _d = true;\r\n        _e = err\r\n    } finally {\r\n        try {\r\n            if (!_n && null != _i.return) {\r\n                _i.return()\r\n            }\r\n        } finally {\r\n            if (_d) {\r\n                throw _e\r\n            }\r\n        }\r\n    }\r\n    return _arr\r\n}\r\n\r\nfunction _arrayWithHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return arr\r\n    }\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(o)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return _arrayLikeToArray(arr)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\nvar OUTSIDE_POSITION = \"outside\";\r\nvar INSIDE_POSITION = \"inside\";\r\nvar OUTSIDE_LABEL_INDENT = 5;\r\nvar COLUMNS_LABEL_INDENT = 20;\r\nvar CONNECTOR_INDENT = 4;\r\nvar PREVENT_EMPTY_PIXEL_OFFSET = 1;\r\n\r\nfunction getLabelIndent(pos) {\r\n    pos = (0, _utils.normalizeEnum)(pos);\r\n    if (pos === OUTSIDE_POSITION) {\r\n        return OUTSIDE_LABEL_INDENT\r\n    } else {\r\n        if (pos === INSIDE_POSITION) {\r\n            return 0\r\n        }\r\n    }\r\n    return COLUMNS_LABEL_INDENT\r\n}\r\n\r\nfunction isOutsidePosition(pos) {\r\n    pos = (0, _utils.normalizeEnum)(pos);\r\n    return pos === OUTSIDE_POSITION || pos !== INSIDE_POSITION\r\n}\r\n\r\nfunction correctYForInverted(y, bBox, inverted) {\r\n    return inverted ? y - bBox.height : y\r\n}\r\n\r\nfunction getOutsideRightLabelPosition(coords, bBox, options, inverted) {\r\n    return {\r\n        x: coords[2] + options.horizontalOffset + OUTSIDE_LABEL_INDENT,\r\n        y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\r\n    }\r\n}\r\n\r\nfunction getOutsideLeftLabelPosition(coords, bBox, options, inverted) {\r\n    return {\r\n        x: coords[0] - bBox.width - options.horizontalOffset - OUTSIDE_LABEL_INDENT,\r\n        y: correctYForInverted(coords[1] + options.verticalOffset, bBox, inverted)\r\n    }\r\n}\r\n\r\nfunction getInsideLabelPosition(coords, bBox, options) {\r\n    var width = coords[2] - coords[0];\r\n    var height = coords[7] - coords[1];\r\n    return {\r\n        x: coords[0] + width / 2 + options.horizontalOffset - bBox.width / 2,\r\n        y: coords[1] + options.verticalOffset + height / 2 - bBox.height / 2\r\n    }\r\n}\r\n\r\nfunction getColumnLabelRightPosition(labelRect, rect, textAlignment) {\r\n    return function(coords, bBox, options, inverted) {\r\n        return {\r\n            x: \"left\" === textAlignment ? rect[2] + options.horizontalOffset + COLUMNS_LABEL_INDENT : labelRect[2] - bBox.width,\r\n            y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\r\n        }\r\n    }\r\n}\r\n\r\nfunction getColumnLabelLeftPosition(labelRect, rect, textAlignment) {\r\n    return function(coords, bBox, options, inverted) {\r\n        return {\r\n            x: \"left\" === textAlignment ? labelRect[0] : rect[0] - bBox.width - options.horizontalOffset - COLUMNS_LABEL_INDENT,\r\n            y: correctYForInverted(coords[3] + options.verticalOffset, bBox, inverted)\r\n        }\r\n    }\r\n}\r\n\r\nfunction getConnectorStrategy(options, inverted) {\r\n    var isLeftPos = \"left\" === options.horizontalAlignment;\r\n    var connectorIndent = isLeftPos ? CONNECTOR_INDENT : -CONNECTOR_INDENT;\r\n    var verticalCorrection = inverted ? -PREVENT_EMPTY_PIXEL_OFFSET : 0;\r\n\r\n    function getFigureCenter(figure) {\r\n        return isLeftPos ? [figure[0] + PREVENT_EMPTY_PIXEL_OFFSET, figure[1] + verticalCorrection] : [figure[2] - PREVENT_EMPTY_PIXEL_OFFSET, figure[3] + verticalCorrection]\r\n    }\r\n    return {\r\n        isLabelInside: function() {\r\n            return !isOutsidePosition(options.position)\r\n        },\r\n        getFigureCenter: getFigureCenter,\r\n        prepareLabelPoints: function(bBox) {\r\n            var x = bBox.x + connectorIndent;\r\n            var y = bBox.y;\r\n            var x1 = x + bBox.width;\r\n            return _toConsumableArray(Array(bBox.height + 1)).map(function(_, i) {\r\n                return [x, y + i]\r\n            }).concat(_toConsumableArray(Array(bBox.height + 1)).map(function(_, i) {\r\n                return [x1, y + i]\r\n            }))\r\n        },\r\n        isHorizontal: function() {\r\n            return true\r\n        },\r\n        findFigurePoint: function(figure) {\r\n            return getFigureCenter(figure)\r\n        },\r\n        adjustPoints: function(points) {\r\n            return points.map(Math.round)\r\n        }\r\n    }\r\n}\r\n\r\nfunction getLabelOptions(labelOptions, defaultColor, defaultTextAlignment) {\r\n    var opt = labelOptions || {};\r\n    var labelFont = (0, _extend.extend)({}, opt.font) || {};\r\n    var labelBorder = opt.border || {};\r\n    var labelConnector = opt.connector || {};\r\n    var backgroundAttr = {\r\n        fill: opt.backgroundColor || defaultColor,\r\n        \"stroke-width\": labelBorder.visible ? labelBorder.width || 0 : 0,\r\n        stroke: labelBorder.visible && labelBorder.width ? labelBorder.color : \"none\",\r\n        dashStyle: labelBorder.dashStyle\r\n    };\r\n    var connectorAttr = {\r\n        stroke: labelConnector.visible && labelConnector.width ? labelConnector.color || defaultColor : \"none\",\r\n        \"stroke-width\": labelConnector.visible ? labelConnector.width || 0 : 0,\r\n        opacity: labelConnector.opacity\r\n    };\r\n    labelFont.color = \"none\" === opt.backgroundColor && \"#ffffff\" === (0, _utils.normalizeEnum)(labelFont.color) && \"inside\" !== opt.position ? defaultColor : labelFont.color;\r\n    return {\r\n        format: opt.format,\r\n        textAlignment: opt.textAlignment || (isOutsidePosition(opt.position) ? defaultTextAlignment : \"center\"),\r\n        customizeText: opt.customizeText,\r\n        attributes: {\r\n            font: labelFont\r\n        },\r\n        visible: 0 !== labelFont.size ? opt.visible : false,\r\n        showForZeroValues: opt.showForZeroValues,\r\n        horizontalOffset: opt.horizontalOffset,\r\n        verticalOffset: opt.verticalOffset,\r\n        background: backgroundAttr,\r\n        connector: connectorAttr,\r\n        wordWrap: labelOptions.wordWrap,\r\n        textOverflow: labelOptions.textOverflow\r\n    }\r\n}\r\n\r\nfunction correctLabelPosition(pos, bBox, rect) {\r\n    if (pos.x < rect[0]) {\r\n        pos.x = rect[0]\r\n    }\r\n    if (pos.x + bBox.width > rect[2]) {\r\n        pos.x = rect[2] - bBox.width\r\n    }\r\n    if (pos.y < rect[1]) {\r\n        pos.y = rect[1]\r\n    }\r\n    if (pos.y + bBox.height > rect[3]) {\r\n        pos.y = rect[3] - bBox.height\r\n    }\r\n    return pos\r\n}\r\n\r\nfunction removeEmptySpace(labels, requiredSpace, startPoint) {\r\n    labels.reduce(function(requiredSpace, label, index, labels) {\r\n        var prevLabel = labels[index + 1];\r\n        if (requiredSpace > 0) {\r\n            var bBox = label.getBoundingRect();\r\n            var point = prevLabel ? prevLabel.getBoundingRect().y + prevLabel.getBoundingRect().height : startPoint;\r\n            var emptySpace = bBox.y - point;\r\n            var shift = Math.min(emptySpace, requiredSpace);\r\n            labels.slice(0, index + 1).forEach(function(label) {\r\n                var bBox = label.getBoundingRect();\r\n                label.shift(bBox.x, bBox.y - shift)\r\n            });\r\n            requiredSpace -= shift\r\n        }\r\n        return requiredSpace\r\n    }, requiredSpace)\r\n}\r\nvar plugin = {\r\n    name: \"lables\",\r\n    init: _common.noop,\r\n    dispose: _common.noop,\r\n    extenders: {\r\n        _initCore: function() {\r\n            this._labelsGroup = this._renderer.g().attr({\r\n                \"class\": this._rootClassPrefix + \"-labels\"\r\n            }).append(this._renderer.root);\r\n            this._labels = []\r\n        },\r\n        _applySize: function() {\r\n            var options = this._getOption(\"label\");\r\n            var adaptiveLayout = this._getOption(\"adaptiveLayout\");\r\n            var rect = this._rect;\r\n            var labelWidth = 0;\r\n            var width = rect[2] - rect[0];\r\n            this._labelRect = rect.slice();\r\n            if (!this._labels.length || !isOutsidePosition(options.position)) {\r\n                if ((0, _utils.normalizeEnum)(\"none\" !== this._getOption(\"resolveLabelOverlapping\", true))) {\r\n                    this._labels.forEach(function(l) {\r\n                        return !l.isVisible() && l.draw(true)\r\n                    })\r\n                }\r\n                return\r\n            }\r\n            var groupWidth = this._labels.map(function(label) {\r\n                label.resetEllipsis();\r\n                return label.getBoundingRect().width\r\n            }).reduce(function(max, width) {\r\n                return Math.max(max, width)\r\n            }, 0);\r\n            labelWidth = groupWidth + options.horizontalOffset + getLabelIndent(options.position);\r\n            if (!adaptiveLayout.keepLabels && width - labelWidth < adaptiveLayout.width) {\r\n                this._labels.forEach(function(label) {\r\n                    label.draw(false)\r\n                });\r\n                return\r\n            } else {\r\n                if (width - labelWidth < adaptiveLayout.width) {\r\n                    labelWidth = width - adaptiveLayout.width;\r\n                    labelWidth = labelWidth > 0 ? labelWidth : 0\r\n                }\r\n                this._labels.forEach(function(label) {\r\n                    label.draw(true)\r\n                })\r\n            }\r\n            if (\"left\" === options.horizontalAlignment) {\r\n                rect[0] += labelWidth\r\n            } else {\r\n                rect[2] -= labelWidth\r\n            }\r\n        },\r\n        _buildNodes: function() {\r\n            this._createLabels()\r\n        },\r\n        _change_TILING: function() {\r\n            var that = this;\r\n            var options = that._getOption(\"label\");\r\n            var getCoords = getInsideLabelPosition;\r\n            var inverted = that._getOption(\"inverted\", true);\r\n            var textAlignment;\r\n            if (isOutsidePosition(options.position)) {\r\n                if ((0, _utils.normalizeEnum)(options.position) === OUTSIDE_POSITION) {\r\n                    getCoords = \"left\" === options.horizontalAlignment ? getOutsideLeftLabelPosition : getOutsideRightLabelPosition\r\n                } else {\r\n                    textAlignment = this._defaultLabelTextAlignment();\r\n                    getCoords = \"left\" === options.horizontalAlignment ? getColumnLabelLeftPosition(this._labelRect, this._rect, textAlignment) : getColumnLabelRightPosition(this._labelRect, this._rect, textAlignment)\r\n                }\r\n            }\r\n            that._labels.forEach(function(label, index) {\r\n                var item = that._items[index];\r\n                var borderWidth = item.getNormalStyle()[\"stroke-width\"];\r\n                var halfBorderWidth = inverted ? borderWidth / 2 : -borderWidth / 2;\r\n                var coords = halfBorderWidth ? item.coords.map(function(coord, index) {\r\n                    if (1 === index || 3 === index) {\r\n                        return coord - halfBorderWidth\r\n                    } else {\r\n                        if (2 === index) {\r\n                            return coord - borderWidth\r\n                        } else {\r\n                            if (0 === index) {\r\n                                return coord + borderWidth\r\n                            }\r\n                        }\r\n                    }\r\n                    return coord\r\n                }) : item.coords;\r\n                if (!options.showForZeroValues && 0 === item.value) {\r\n                    label.draw(false);\r\n                    return\r\n                }\r\n                if (isOutsidePosition(options.position)) {\r\n                    that._correctLabelWidth(label, item.coords, options)\r\n                }\r\n                var bBox = label.getBoundingRect();\r\n                var pos = correctLabelPosition(getCoords(coords, bBox, options, inverted), bBox, that._labelRect);\r\n                label.setFigureToDrawConnector(coords);\r\n                label.shift(pos.x, pos.y)\r\n            });\r\n            that._resolveLabelOverlapping()\r\n        }\r\n    },\r\n    members: {\r\n        _resolveLabelOverlapping: function() {\r\n            var that = this;\r\n            var resolveLabelOverlapping = (0, _utils.normalizeEnum)(that._getOption(\"resolveLabelOverlapping\", true));\r\n            var labels = this._getOption(\"inverted\", true) ? that._labels.slice().reverse() : that._labels;\r\n            if (\"hide\" === resolveLabelOverlapping) {\r\n                labels.reduce(function(height, label) {\r\n                    if (label.getBoundingRect().y < height) {\r\n                        label.hide()\r\n                    } else {\r\n                        height = label.getBoundingRect().y + label.getBoundingRect().height\r\n                    }\r\n                    return height\r\n                }, 0)\r\n            } else {\r\n                if (\"shift\" === resolveLabelOverlapping) {\r\n                    var maxHeight = this._labelRect[3];\r\n                    labels.reduce(function(_ref, label, index, labels) {\r\n                        var _ref2 = _slicedToArray(_ref, 2),\r\n                            height = _ref2[0],\r\n                            emptySpace = _ref2[1];\r\n                        var bBox = label.getBoundingRect();\r\n                        var y = bBox.y;\r\n                        if (bBox.y < height) {\r\n                            label.shift(bBox.x, height);\r\n                            y = height\r\n                        }\r\n                        if (y - height > 0) {\r\n                            emptySpace += y - height\r\n                        }\r\n                        if (y + bBox.height > maxHeight) {\r\n                            if (emptySpace && emptySpace > y + bBox.height - maxHeight) {\r\n                                removeEmptySpace(labels.slice(0, index).reverse(), y + bBox.height - maxHeight, that._labelRect[1]);\r\n                                emptySpace -= y + bBox.height - maxHeight;\r\n                                label.shift(bBox.x, y - (y + bBox.height - maxHeight));\r\n                                height = y - (y + bBox.height - maxHeight) + bBox.height\r\n                            } else {\r\n                                label.hide()\r\n                            }\r\n                        } else {\r\n                            height = y + bBox.height\r\n                        }\r\n                        return [height, emptySpace]\r\n                    }, [this._labelRect[1], 0])\r\n                }\r\n            }\r\n        },\r\n        _defaultLabelTextAlignment: function() {\r\n            return this._getOption(\"rtlEnabled\", true) ? \"right\" : \"left\"\r\n        },\r\n        _correctLabelWidth: function(label, item, options) {\r\n            var isLeftPos = \"left\" === options.horizontalAlignment;\r\n            var minX = isLeftPos ? this._labelRect[0] : item[2];\r\n            var maxX = isLeftPos ? item[0] : this._labelRect[2];\r\n            var maxWidth = maxX - minX;\r\n            if (label.getBoundingRect().width > maxWidth) {\r\n                label.fit(maxWidth)\r\n            }\r\n        },\r\n        _createLabels: function() {\r\n            var that = this;\r\n            var labelOptions = that._getOption(\"label\");\r\n            var connectorStrategy = getConnectorStrategy(labelOptions, that._getOption(\"inverted\", true));\r\n            this._labelsGroup.clear();\r\n            if (!labelOptions.visible) {\r\n                return\r\n            }\r\n            this._labels = that._items.map(function(item) {\r\n                var label = new _label.Label({\r\n                    renderer: that._renderer,\r\n                    labelsGroup: that._labelsGroup,\r\n                    strategy: connectorStrategy\r\n                });\r\n                label.setOptions(getLabelOptions(labelOptions, item.color, that._defaultLabelTextAlignment()));\r\n                label.setData({\r\n                    item: item,\r\n                    value: item.value,\r\n                    percent: item.percent\r\n                });\r\n                label.draw(true);\r\n                return label\r\n            });\r\n            if (this._labels.length && isOutsidePosition(labelOptions.position)) {\r\n                this._requestChange([\"LAYOUT\"])\r\n            }\r\n        }\r\n    },\r\n    customize: function(constructor) {\r\n        constructor.prototype._proxyData.push(function(x, y) {\r\n            var that = this;\r\n            var data;\r\n            that._labels.forEach(function(label, index) {\r\n                var rect = label.getBoundingRect();\r\n                if (x >= rect.x && x <= rect.x + rect.width && y >= rect.y && y <= rect.y + rect.height) {\r\n                    var pos = isOutsidePosition(that._getOption(\"label\").position) ? \"outside\" : \"inside\";\r\n                    data = {\r\n                        id: index,\r\n                        type: pos + \"-label\"\r\n                    };\r\n                    return true\r\n                }\r\n            });\r\n            return data\r\n        });\r\n        [\"label\", \"resolveLabelOverlapping\"].forEach(function(optionName) {\r\n            constructor.addChange({\r\n                code: optionName.toUpperCase(),\r\n                handler: function() {\r\n                    this._createLabels();\r\n                    this._requestChange([\"LAYOUT\"])\r\n                },\r\n                isThemeDependent: true,\r\n                isOptionChange: true,\r\n                option: optionName\r\n            })\r\n        })\r\n    },\r\n    fontFields: [\"label.font\"]\r\n};\r\nexports.plugin = plugin;\r\n"]},"metadata":{},"sourceType":"script"}