{"ast":null,"code":"var _jsxFileName = \"E:\\\\newfrontend\\\\webfe\\\\src\\\\component\\\\Admin\\\\mobileAppointment\\\\MobileListAppointment\\\\Scheduler\\\\index.js\";\nimport React, { Component } from \"react\";\nimport { MobileSchedulerModal } from \"./MobileScheduler\";\nimport { getCustomer, getCommonApi, commonDeleteApi } from \"redux/actions/common\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\"; // import timeOption from 'data/timeOption.json'\n\nimport { dateFormat } from \"service/helperFunctions\";\nimport { history } from \"helpers\";\nimport \"./style.scss\";\nimport SimpleReactValidator from \"simple-react-validator\";\nimport { CreateAppointment, updateForm } from \"redux/actions/appointment\";\nimport { MobileCreateAppointment } from \"../../MobileCreateAppointment/index\";\nimport { LoadPanel } from \"devextreme-react/load-panel\";\nimport moment from \"moment\";\nimport { BrowserView, MobileView, isBrowser, isMobile } from \"react-device-detect\";\nexport class SchedulerClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      appointment: [{\n        time: \"10.00 AM,\",\n        date: \"Wednesday, 1st April, 2020\",\n        name: \"Benjamin\",\n        treatment: \"Head Massage\"\n      }, {\n        time: \"12.00 PM,\",\n        date: \"Wednesday, 1st April, 2020\",\n        name: \"Daniel\",\n        treatment: \"Pedicure\"\n      }, {\n        time: \"1.00 PM,\",\n        date: \"Wednesday, 1st April, 2020\",\n        name: \"John\",\n        treatment: \"Haircut\"\n      }, {\n        time: \"2.00 PM,\",\n        date: \"Wednesday, 1st April, 2020\",\n        name: \"Josua\",\n        treatment: \"Manicure\"\n      }, {\n        time: \"4.00 PM, \",\n        date: \"Wednesday, 1st April, 2020\",\n        name: \"Derrik\",\n        treatment: \"Body Massage\"\n      }],\n      events: [],\n      brachList: [],\n      formField: {\n        branchId: \"\",\n        time: \"\",\n        staff_id: \"\"\n      },\n      list: [],\n      filterDate: new Date(),\n      filterType: \"day\",\n      selectedId: \"\",\n      staffList: [],\n      page: 1,\n      meta: [],\n      searchtext: \"\",\n      staffSortlist: [],\n      isOpenModal: false,\n      loadPanelVisible: false,\n      showIndicator: true,\n      shading: true,\n      showPane: true,\n      groupByType: \"staff\",\n      SchedulerSetting: {\n        settingId: 0,\n        startday_hour: \"\",\n        endday_hour: \"\",\n        cell_duration: \"\",\n        resource_count: \"\"\n      }\n    };\n\n    this.componentWillMount = () => {\n      this.validator = new SimpleReactValidator({\n        element: message => /*#__PURE__*/React.createElement(\"span\", {\n          className: \"error-message text-danger validNo fs14\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 9\n          }\n        }, message),\n        autoForceUpdate: this\n      });\n    };\n\n    this.componentDidMount = () => {\n      this.getSettingInfo();\n    };\n\n    this.getSettingInfo = () => {\n      let {\n        SchedulerSetting\n      } = this.state;\n      this.props.getCommonApi(`siteappointsetting/`).then(async key => {\n        let {\n          status,\n          data\n        } = key;\n        console.log(key, \"siteappointsetting\");\n\n        if (status == \"200\") {\n          if (data) {\n            SchedulerSetting[\"settingId\"] = data[0].id;\n            SchedulerSetting[\"startday_hour\"] = data[0].startday_hour ? Number(data[0].startday_hour) : 8;\n            SchedulerSetting[\"endday_hour\"] = data[0].endday_hour ? Number(data[0].endday_hour) : 21;\n            SchedulerSetting[\"cell_duration\"] = data[0].cell_duration ? Number(data[0].cell_duration) : 15; // SchedulerSetting[\"resource_count\"] = data[0].resource_count\n            //   ? Number(data[0].resource_count)\n            //   : 5;\n\n            SchedulerSetting[\"resource_count\"] = 3;\n            console.log(SchedulerSetting, \"siteappointsettingafterrender\");\n            await this.setState({\n              SchedulerSetting\n            });\n            await this.props.updateForm(\"SchedulerSetting\", SchedulerSetting);\n            let {\n              filterDate,\n              filterType\n            } = this.state; // this.props\n            //   .getCommonApi(\n            //     `customeroutstanding/?date=${dateFormat(\n            //       filterDate\n            //     )}&check=${filterType}`\n            //   )\n            //   .then(key => {});\n\n            this.getAppointmentWithStaff();\n          }\n        }\n      });\n    };\n\n    this.getHoursFromDate = date => {\n      let hour = date.getHours();\n      let minute = date.getMinutes();\n      let hours = hour > 9 ? hour : \"0\" + hour;\n      let minutes;\n\n      if (minute < 15) {\n        minutes = \"00\";\n      } else if (minute >= 15 && minute < 30) {\n        minutes = \"15\";\n      } else if (minute >= 30 && minute < 45) {\n        minutes = \"30\";\n      } else if (minute >= 45 && minute < 59) {\n        minutes = \"45\";\n      }\n\n      return hours + \":\" + minutes;\n    };\n\n    this.handleEmptyEvent = async (date, e) => {\n      let {\n        customerDetail\n      } = this.props;\n      let {\n        formField\n      } = this.state;\n      let time = new Date(date);\n      formField[\"time\"] = this.getHoursFromDate(time);\n      formField[\"date\"] = date;\n      formField[\"appt_id\"] = 0;\n\n      if (e.groups) {\n        formField[\"staff_id\"] = e.groups.id;\n      }\n\n      if (e.appt_id) {\n        formField[\"appt_id\"] = e.appt_id;\n      }\n\n      await this.setState({\n        formField\n      });\n      console.log(date, e, \"hgjsydfisuyfsdfm ==== handleEmptyEvent\", time.getHours);\n      await this.props.updateForm(\"basicApptDetail\", formField);\n      await this.setState({\n        isOpenModal: true\n      });\n    };\n\n    this.handleCloseDialog = async () => {\n      await this.props.updateForm(\"treatmentList\", []);\n      await this.props.updateForm(\"basicApptDetail\", {});\n      await this.props.updateForm(\"appointmentCustomerDetail\", {});\n      await this.setState({\n        isOpenModal: false\n      });\n    };\n\n    this.handleChangeFilter = async (prevMode, prevDate, newMode, newDate, search) => {\n      let {\n        filterDate,\n        filterType,\n        searchtext\n      } = this.state;\n      filterDate = newDate;\n      filterType = newMode;\n      searchtext = search;\n      await this.setState({\n        filterDate,\n        filterType,\n        searchtext\n      }); //if (newMode === \"day\" || newMode === \"week\") {\n      // this.props\n      //   .getCommonApi(\n      //     `customeroutstanding/?date=${dateFormat(newDate)}&check=${newMode}`\n      //   )\n      //   .then(key => {});\n      //}\n\n      console.log(\"dfhgfhjhjghjdfhg\", prevMode, prevDate, newMode, newDate);\n\n      if (prevMode !== newMode || prevDate !== newDate) {\n        this.getAppointmentWithStaff();\n      }\n    };\n\n    this.handleChange = async ({\n      target: {\n        value,\n        name\n      }\n    }) => {\n      let {\n        formField\n      } = this.state;\n      formField[name] = value;\n      await this.setState({\n        formField\n      });\n\n      if (name === \"branchId\") {\n        this.getAppointmentWithStaff();\n      }\n\n      this.props.updateForm(\"basicApptDetail\", formField);\n    };\n\n    this.handleDelete = async (id, event) => {\n      let {\n        selectedId\n      } = this.state;\n      console.log(id, \"===afasfasdfdfasd=====\", selectedId);\n\n      if (id !== selectedId) {\n        await this.setState({\n          selectedId: id\n        });\n        await this.props.commonDeleteApi(`appointment/${id}/`).then(res => {});\n      }\n    };\n\n    this.handleOpenStaff = (one, two, three) => {\n      console.log(\"namdfsfgsghsfghf\", one, two, three);\n      let {\n        filterDate\n      } = this.state;\n      this.props.handleOpen(filterDate);\n    };\n\n    this.getAppointmentWithStaff = () => {\n      this.setState({\n        loadPanelVisible: true\n      }, () => {\n        let {\n          filterDate,\n          filterType,\n          page,\n          searchtext,\n          staffList,\n          events,\n          meta,\n          groupByType\n        } = this.state;\n        this.props.getCommonApi(`empappointmentview/?date=${dateFormat(filterDate)}&check=${filterType}&page=${page}&limit=${Number(this.props.SchedulerSetting.resource_count)}&search=${searchtext}&type=${groupByType}`).then(async key => {\n          console.log(\"starttime: \", moment(new Date(), \"DD/MM/YYYY HH:mm:ss\"));\n          let {\n            status,\n            data,\n            event\n          } = key;\n          setTimeout(this.hideLoadPanel);\n\n          if (status === 200) {\n            if (data) {\n              staffList = [];\n\n              if (data.dataList.length > 0) {\n                staffList = data.dataList;\n              }\n\n              events = [];\n              meta = []; //this.setState({ events, meta });\n\n              meta = data.meta; //events = event;\n\n              if (event.length > 0) {\n                events = event;\n              }\n\n              await this.setState({\n                events,\n                meta,\n                staffList\n              });\n              console.log(\"endtime: \", moment(new Date(), \"DD/MM/YYYY HH:mm:ss\")); // await this.setState({ events, staffList, meta });\n              //console.log(event, \"appointment cell data\");\n            }\n          }\n        });\n      });\n    };\n\n    this.handleNext = async () => {\n      let {\n        page\n      } = this.state;\n      page = page + 1;\n      await this.setState({\n        page\n      });\n\n      if (page > 0) {\n        this.getAppointmentWithStaff();\n      }\n    };\n\n    this.handleBack = async () => {\n      let {\n        page\n      } = this.state;\n      page = page - 1;\n      await this.setState({\n        page\n      });\n\n      if (page > 0) {\n        this.getAppointmentWithStaff();\n      }\n    };\n\n    this.hideLoadPanel = async () => {\n      let loadPanelVisible = Object.assign({}, this.state.loadPanelVisible);\n      loadPanelVisible = false;\n      await this.setState({\n        loadPanelVisible\n      });\n    };\n\n    this.groupByAppointment = async groupBy => {\n      await this.setState({\n        groupByType: groupBy\n      });\n      this.getAppointmentWithStaff();\n    };\n\n    this.timeToMins = time => {\n      var b = time.split(\":\");\n      return b[0] * 60 + +b[1];\n    };\n  }\n\n  render() {\n    let {\n      appointment,\n      brachList,\n      branchId,\n      formField,\n      list,\n      events,\n      filterType,\n      filterDate,\n      staffList,\n      meta,\n      searchtext,\n      staffSortlist,\n      isLoading,\n      isOpenModal,\n      SchedulerSetting\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row m-0\",\n      id: \"mobileappointment\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(LoadPanel, {\n      shadingColor: \"rgba(0,0,0,0.4)\",\n      position: `center`,\n      onHiding: this.hideLoadPanel,\n      visible: this.state.loadPanelVisible,\n      showIndicator: this.state.showIndicator,\n      shading: this.state.shading,\n      showPane: this.state.showPane,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(MobileSchedulerModal, {\n      staffList: this.state.staffList,\n      meta: this.state.meta,\n      event: this.state.events,\n      onEmptyClick: (date, e) => this.handleEmptyEvent(date, e),\n      handleChangeFilter: this.handleChangeFilter,\n      filterType: filterType,\n      filterDate: filterDate,\n      searchtext: searchtext,\n      onDeleteEvent: this.handleDelete,\n      handleBack: this.handleBack,\n      handleNext: this.handleNext,\n      staffSortlist: this.state.staffSortlist,\n      getAppointmentWithStaff: this.getAppointmentWithStaff,\n      groupByAppointment: groupBy => this.groupByAppointment(groupBy),\n      handleAppointmentSetting: this.getSettingInfo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(MobileCreateAppointment, {\n      isOpenModal: isOpenModal,\n      handleCloseDialog: this.handleCloseDialog,\n      handleSaveorUpdate: this.getAppointmentWithStaff,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  customerDetail: state.appointment.customerDetail,\n  customerList: state.common.customerList,\n  multipleCustomerForm: state.appointment.multipleCustomerForm,\n  SchedulerSetting: state.appointment.SchedulerSetting\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    getCustomer,\n    getCommonApi,\n    updateForm,\n    commonDeleteApi\n  }, dispatch);\n};\n\nexport const Scheduler = connect(mapStateToProps, mapDispatchToProps)(SchedulerClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/mobileAppointment/MobileListAppointment/Scheduler/index.js"],"names":["React","Component","MobileSchedulerModal","getCustomer","getCommonApi","commonDeleteApi","connect","bindActionCreators","dateFormat","history","SimpleReactValidator","CreateAppointment","updateForm","MobileCreateAppointment","LoadPanel","moment","BrowserView","MobileView","isBrowser","isMobile","SchedulerClass","state","appointment","time","date","name","treatment","events","brachList","formField","branchId","staff_id","list","filterDate","Date","filterType","selectedId","staffList","page","meta","searchtext","staffSortlist","isOpenModal","loadPanelVisible","showIndicator","shading","showPane","groupByType","SchedulerSetting","settingId","startday_hour","endday_hour","cell_duration","resource_count","componentWillMount","validator","element","message","autoForceUpdate","componentDidMount","getSettingInfo","props","then","key","status","data","console","log","id","Number","setState","getAppointmentWithStaff","getHoursFromDate","hour","getHours","minute","getMinutes","hours","minutes","handleEmptyEvent","e","customerDetail","groups","appt_id","handleCloseDialog","handleChangeFilter","prevMode","prevDate","newMode","newDate","search","handleChange","target","value","handleDelete","event","res","handleOpenStaff","one","two","three","handleOpen","setTimeout","hideLoadPanel","dataList","length","handleNext","handleBack","Object","assign","groupByAppointment","groupBy","timeToMins","b","split","render","isLoading","mapStateToProps","customerList","common","multipleCustomerForm","mapDispatchToProps","dispatch","Scheduler"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { MobileSchedulerModal } from \"./MobileScheduler\";\r\n\r\nimport {\r\n  getCustomer,\r\n  getCommonApi,\r\n  commonDeleteApi,\r\n} from \"redux/actions/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\n// import timeOption from 'data/timeOption.json'\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport { history } from \"helpers\";\r\nimport \"./style.scss\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\nimport { CreateAppointment, updateForm } from \"redux/actions/appointment\";\r\nimport { MobileCreateAppointment } from \"../../MobileCreateAppointment/index\";\r\nimport { LoadPanel } from \"devextreme-react/load-panel\";\r\nimport moment from \"moment\";\r\nimport {\r\n  BrowserView,\r\n  MobileView,\r\n  isBrowser,\r\n  isMobile,\r\n} from \"react-device-detect\";\r\n\r\nexport class SchedulerClass extends Component {\r\n  state = {\r\n    appointment: [\r\n      {\r\n        time: \"10.00 AM,\",\r\n        date: \"Wednesday, 1st April, 2020\",\r\n        name: \"Benjamin\",\r\n        treatment: \"Head Massage\",\r\n      },\r\n      {\r\n        time: \"12.00 PM,\",\r\n        date: \"Wednesday, 1st April, 2020\",\r\n        name: \"Daniel\",\r\n        treatment: \"Pedicure\",\r\n      },\r\n      {\r\n        time: \"1.00 PM,\",\r\n        date: \"Wednesday, 1st April, 2020\",\r\n        name: \"John\",\r\n        treatment: \"Haircut\",\r\n      },\r\n      {\r\n        time: \"2.00 PM,\",\r\n        date: \"Wednesday, 1st April, 2020\",\r\n        name: \"Josua\",\r\n        treatment: \"Manicure\",\r\n      },\r\n      {\r\n        time: \"4.00 PM, \",\r\n        date: \"Wednesday, 1st April, 2020\",\r\n        name: \"Derrik\",\r\n        treatment: \"Body Massage\",\r\n      },\r\n    ],\r\n    events: [],\r\n    brachList: [],\r\n    formField: {\r\n      branchId: \"\",\r\n      time: \"\",\r\n      staff_id: \"\",\r\n    },\r\n    list: [],\r\n    filterDate: new Date(),\r\n    filterType: \"day\",\r\n    selectedId: \"\",\r\n    staffList: [],\r\n    page: 1,\r\n    meta: [],\r\n    searchtext: \"\",\r\n    staffSortlist: [],\r\n    isOpenModal: false,\r\n    loadPanelVisible: false,\r\n    showIndicator: true,\r\n    shading: true,\r\n    showPane: true,\r\n    groupByType: \"staff\",\r\n    SchedulerSetting: {\r\n      settingId: 0,\r\n      startday_hour: \"\",\r\n      endday_hour: \"\",\r\n      cell_duration: \"\",\r\n      resource_count: \"\",\r\n    },\r\n  };\r\n\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n  };\r\n  componentDidMount = () => {\r\n    this.getSettingInfo();\r\n  };\r\n  getSettingInfo = () => {\r\n    let { SchedulerSetting } = this.state;\r\n    this.props.getCommonApi(`siteappointsetting/`).then(async key => {\r\n      let { status, data } = key;\r\n      console.log(key, \"siteappointsetting\");\r\n      if (status == \"200\") {\r\n        if (data) {\r\n          SchedulerSetting[\"settingId\"] = data[0].id;\r\n          SchedulerSetting[\"startday_hour\"] = data[0].startday_hour\r\n            ? Number(data[0].startday_hour)\r\n            : 8;\r\n          SchedulerSetting[\"endday_hour\"] = data[0].endday_hour\r\n            ? Number(data[0].endday_hour)\r\n            : 21;\r\n          SchedulerSetting[\"cell_duration\"] = data[0].cell_duration\r\n            ? Number(data[0].cell_duration)\r\n            : 15;\r\n\r\n          // SchedulerSetting[\"resource_count\"] = data[0].resource_count\r\n          //   ? Number(data[0].resource_count)\r\n          //   : 5;\r\n          SchedulerSetting[\"resource_count\"] = 3;\r\n\r\n          console.log(SchedulerSetting, \"siteappointsettingafterrender\");\r\n          await this.setState({\r\n            SchedulerSetting,\r\n          });\r\n          await this.props.updateForm(\"SchedulerSetting\", SchedulerSetting);\r\n          let { filterDate, filterType } = this.state;\r\n          // this.props\r\n          //   .getCommonApi(\r\n          //     `customeroutstanding/?date=${dateFormat(\r\n          //       filterDate\r\n          //     )}&check=${filterType}`\r\n          //   )\r\n          //   .then(key => {});\r\n          this.getAppointmentWithStaff();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  getHoursFromDate = date => {\r\n    let hour = date.getHours();\r\n    let minute = date.getMinutes();\r\n    let hours = hour > 9 ? hour : \"0\" + hour;\r\n    let minutes;\r\n    if (minute < 15) {\r\n      minutes = \"00\";\r\n    } else if (minute >= 15 && minute < 30) {\r\n      minutes = \"15\";\r\n    } else if (minute >= 30 && minute < 45) {\r\n      minutes = \"30\";\r\n    } else if (minute >= 45 && minute < 59) {\r\n      minutes = \"45\";\r\n    }\r\n    return hours + \":\" + minutes;\r\n  };\r\n\r\n  handleEmptyEvent = async (date, e) => {\r\n    let { customerDetail } = this.props;\r\n    let { formField } = this.state;\r\n\r\n    let time = new Date(date);\r\n\r\n    formField[\"time\"] = this.getHoursFromDate(time);\r\n    formField[\"date\"] = date;\r\n    formField[\"appt_id\"] = 0;\r\n    if (e.groups) {\r\n      formField[\"staff_id\"] = e.groups.id;\r\n    }\r\n    if (e.appt_id) {\r\n      formField[\"appt_id\"] = e.appt_id;\r\n    }\r\n\r\n    await this.setState({ formField });\r\n    console.log(\r\n      date,\r\n      e,\r\n      \"hgjsydfisuyfsdfm ==== handleEmptyEvent\",\r\n      time.getHours\r\n    );\r\n    await this.props.updateForm(\"basicApptDetail\", formField);\r\n    await this.setState({ isOpenModal: true });\r\n  };\r\n  handleCloseDialog = async () => {\r\n    await this.props.updateForm(\"treatmentList\", []);\r\n    await this.props.updateForm(\"basicApptDetail\", {});\r\n    await this.props.updateForm(\"appointmentCustomerDetail\", {});\r\n    await this.setState({\r\n      isOpenModal: false,\r\n    });\r\n  };\r\n\r\n  handleChangeFilter = async (prevMode, prevDate, newMode, newDate, search) => {\r\n    let { filterDate, filterType, searchtext } = this.state;\r\n    filterDate = newDate;\r\n    filterType = newMode;\r\n    searchtext = search;\r\n    await this.setState({\r\n      filterDate,\r\n      filterType,\r\n      searchtext,\r\n    });\r\n    //if (newMode === \"day\" || newMode === \"week\") {\r\n    // this.props\r\n    //   .getCommonApi(\r\n    //     `customeroutstanding/?date=${dateFormat(newDate)}&check=${newMode}`\r\n    //   )\r\n    //   .then(key => {});\r\n    //}\r\n    console.log(\"dfhgfhjhjghjdfhg\", prevMode, prevDate, newMode, newDate);\r\n    if (prevMode !== newMode || prevDate !== newDate) {\r\n      this.getAppointmentWithStaff();\r\n    }\r\n  };\r\n\r\n  handleChange = async ({ target: { value, name } }) => {\r\n    let { formField } = this.state;\r\n    formField[name] = value;\r\n    await this.setState({\r\n      formField,\r\n    });\r\n    if (name === \"branchId\") {\r\n      this.getAppointmentWithStaff();\r\n    }\r\n    this.props.updateForm(\"basicApptDetail\", formField);\r\n  };\r\n\r\n  handleDelete = async (id, event) => {\r\n    let { selectedId } = this.state;\r\n    console.log(id, \"===afasfasdfdfasd=====\", selectedId);\r\n    if (id !== selectedId) {\r\n      await this.setState({\r\n        selectedId: id,\r\n      });\r\n      await this.props.commonDeleteApi(`appointment/${id}/`).then(res => {});\r\n    }\r\n  };\r\n\r\n  handleOpenStaff = (one, two, three) => {\r\n    console.log(\"namdfsfgsghsfghf\", one, two, three);\r\n    let { filterDate } = this.state;\r\n    this.props.handleOpen(filterDate);\r\n  };\r\n\r\n  getAppointmentWithStaff = () => {\r\n    this.setState(\r\n      {\r\n        loadPanelVisible: true,\r\n      },\r\n      () => {\r\n        let {\r\n          filterDate,\r\n          filterType,\r\n          page,\r\n          searchtext,\r\n          staffList,\r\n          events,\r\n          meta,\r\n          groupByType,\r\n        } = this.state;\r\n\r\n        this.props\r\n          .getCommonApi(\r\n            `empappointmentview/?date=${dateFormat(\r\n              filterDate\r\n            )}&check=${filterType}&page=${page}&limit=${Number(\r\n              this.props.SchedulerSetting.resource_count\r\n            )}&search=${searchtext}&type=${groupByType}`\r\n          )\r\n          .then(async key => {\r\n            console.log(\r\n              \"starttime: \",\r\n              moment(new Date(), \"DD/MM/YYYY HH:mm:ss\")\r\n            );\r\n            let { status, data, event } = key;\r\n            setTimeout(this.hideLoadPanel);\r\n            if (status === 200) {\r\n              if (data) {\r\n                staffList = [];\r\n                if (data.dataList.length > 0) {\r\n                  staffList = data.dataList;\r\n                }\r\n                events = [];\r\n                meta = [];\r\n                //this.setState({ events, meta });\r\n                meta = data.meta;\r\n                //events = event;\r\n\r\n                if (event.length > 0) {\r\n                  events = event;\r\n                }\r\n                await this.setState({ events, meta, staffList });\r\n                console.log(\r\n                  \"endtime: \",\r\n                  moment(new Date(), \"DD/MM/YYYY HH:mm:ss\")\r\n                );\r\n                // await this.setState({ events, staffList, meta });\r\n\r\n                //console.log(event, \"appointment cell data\");\r\n              }\r\n            }\r\n          });\r\n      }\r\n    );\r\n  };\r\n\r\n  handleNext = async () => {\r\n    let { page } = this.state;\r\n    page = page + 1;\r\n    await this.setState({\r\n      page,\r\n    });\r\n    if (page > 0) {\r\n      this.getAppointmentWithStaff();\r\n    }\r\n  };\r\n\r\n  handleBack = async () => {\r\n    let { page } = this.state;\r\n    page = page - 1;\r\n    await this.setState({\r\n      page,\r\n    });\r\n    if (page > 0) {\r\n      this.getAppointmentWithStaff();\r\n    }\r\n  };\r\n  hideLoadPanel = async () => {\r\n    let loadPanelVisible = Object.assign({}, this.state.loadPanelVisible);\r\n    loadPanelVisible = false;\r\n    await this.setState({\r\n      loadPanelVisible,\r\n    });\r\n  };\r\n\r\n  groupByAppointment = async groupBy => {\r\n    await this.setState({\r\n      groupByType: groupBy,\r\n    });\r\n    this.getAppointmentWithStaff();\r\n  };\r\n  timeToMins = time => {\r\n    var b = time.split(\":\");\r\n    return b[0] * 60 + +b[1];\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      appointment,\r\n      brachList,\r\n      branchId,\r\n      formField,\r\n      list,\r\n      events,\r\n      filterType,\r\n      filterDate,\r\n      staffList,\r\n      meta,\r\n      searchtext,\r\n      staffSortlist,\r\n      isLoading,\r\n      isOpenModal,\r\n      SchedulerSetting,\r\n    } = this.state;\r\n\r\n    return (\r\n      <div className=\"row m-0\" id=\"mobileappointment\">\r\n        <LoadPanel\r\n          shadingColor=\"rgba(0,0,0,0.4)\"\r\n          position={`center`}\r\n          onHiding={this.hideLoadPanel}\r\n          visible={this.state.loadPanelVisible}\r\n          showIndicator={this.state.showIndicator}\r\n          shading={this.state.shading}\r\n          showPane={this.state.showPane}\r\n        />\r\n        <MobileSchedulerModal\r\n          staffList={this.state.staffList}\r\n          meta={this.state.meta}\r\n          event={this.state.events}\r\n          onEmptyClick={(date, e) => this.handleEmptyEvent(date, e)}\r\n          handleChangeFilter={this.handleChangeFilter}\r\n          filterType={filterType}\r\n          filterDate={filterDate}\r\n          searchtext={searchtext}\r\n          onDeleteEvent={this.handleDelete}\r\n          handleBack={this.handleBack}\r\n          handleNext={this.handleNext}\r\n          staffSortlist={this.state.staffSortlist}\r\n          getAppointmentWithStaff={this.getAppointmentWithStaff}\r\n          groupByAppointment={groupBy => this.groupByAppointment(groupBy)}\r\n          handleAppointmentSetting={this.getSettingInfo}\r\n        />\r\n\r\n        <MobileCreateAppointment\r\n          isOpenModal={isOpenModal}\r\n          handleCloseDialog={this.handleCloseDialog}\r\n          handleSaveorUpdate={this.getAppointmentWithStaff}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  customerDetail: state.appointment.customerDetail,\r\n  customerList: state.common.customerList,\r\n  multipleCustomerForm: state.appointment.multipleCustomerForm,\r\n  SchedulerSetting: state.appointment.SchedulerSetting,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonDeleteApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Scheduler = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(SchedulerClass);\r\n"]},"metadata":{},"sourceType":"module"}