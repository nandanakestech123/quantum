{"ast":null,"code":"var _jsxFileName = \"E:\\\\newfrontend\\\\webfe\\\\src\\\\component\\\\Admin\\\\Cart\\\\cart\\\\productDetailsPopup.js\";\nimport React, { Component } from \"react\";\nimport { NormalInput, NormalButton, NormalSelect } from \"component/common\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { getCommonApi, commonPatchApi, commonCreateApi } from \"redux/actions/common\";\nimport { Toast } from \"service/toast\";\nimport _ from \"lodash\";\nimport \"./style.scss\";\nexport class ProductDetailsPopupClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data_list: [],\n      hold_item_reasons_options: [],\n      sourceList: [],\n      activRow: 0\n    };\n\n    this.getProductList = () => {\n      let {\n        data_list\n      } = this.state;\n      let {\n        basicApptDetail\n      } = this.props;\n      this.props.getCommonApi(`cartpopup/?cust_noid=${basicApptDetail.custId}&cart_id=${this.props.id}&is_product=1`).then(async key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status == \"200\") {\n          console.log(key, \"cartproductpopuplist\");\n          data_list = data;\n          await this.setState({\n            data_list\n          });\n\n          if (this.state.data_list.length > 0) {\n            this.setState({\n              activeRow: this.state.data_list[0].id\n            });\n            document.getElementById(this.state.data_list[0].id).classList.toggle(\"d-none\");\n          }\n        }\n      });\n    };\n\n    this.handleSubmit = () => {\n      let {\n        data_list,\n        sourceList\n      } = this.state;\n      sourceList = [];\n\n      for (let value of data_list) {\n        let currentData = Number(value.deposit).toFixed(2);\n        let transamt = Number(value.trans_amt).toFixed(2);\n\n        if (currentData > transamt) {\n          Toast({\n            type: \"error\",\n            message: \"Deposit amount should be less than or equal to transaction amount\"\n          });\n          return false;\n        } else {\n          if (value.is_foc) {\n            sourceList.push({\n              id: value.id,\n              quantity: Number(value.quantity),\n              price: Number(value.price).toFixed(2),\n              holditemqty: Number(value.holditemqty),\n              holdreason: Number(value.holdreason)\n            });\n          } else {\n            sourceList.push({\n              id: value.id,\n              quantity: Number(value.quantity),\n              price: Number(value.price).toFixed(2),\n              deposit: Number(value.deposit).toFixed(2),\n              holditemqty: Number(value.holditemqty),\n              holdreason: Number(value.holdreason)\n            });\n          }\n        }\n      }\n\n      console.log(sourceList, \"productupdatelist\");\n      this.props.commonCreateApi(`cartpopup/product/`, sourceList).then(key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status == 200) {\n          this.props.handleModal();\n        }\n      });\n    };\n\n    this.handleChange = (e, index) => {\n      let {\n        data_list\n      } = this.state;\n      let data = e.target.value;\n\n      if ([e.target.name] == \"holdreason\") {\n        data_list[index][e.target.name] = Number(data);\n      } else if ([e.target.name] == \"holditemqty\") {\n        let ActualQty = Number(data_list[index][\"quantity\"]);\n        let HoldQty = Number(data);\n\n        if (HoldQty > ActualQty) {\n          Toast({\n            type: \"error\",\n            message: \"Hold quantity should be less than or equal to actual quantity\"\n          });\n        } else {\n          data_list[index][e.target.name] = HoldQty;\n        }\n      } else {\n        data_list[index][e.target.name] = data;\n      }\n\n      this.setState({\n        data_list\n      });\n\n      if ([e.target.name] == \"quantity\" || [e.target.name] == \"price\") {\n        this.handlePriceandQuantityChange(index);\n      }\n    };\n\n    this.handleAccordion = async id => {\n      let elements = document.getElementsByClassName(\"accordion\");\n      await this.setState({\n        activeRow: id\n      });\n\n      for (let i = 0; i < elements.length; i++) {\n        elements[i].classList.add(\"d-none\");\n      }\n\n      document.getElementById(id).classList.toggle(\"d-none\");\n    };\n\n    this.handlePriceandQuantityChange = index => {\n      let {\n        data_list\n      } = this.state;\n      let total_disc = Number(data_list[index][\"discount_amt\"]).toFixed(2) + Number(data_list[index][\"additional_discountamt\"]);\n      data_list[index][\"discount_price\"] = Number(data_list[index][\"price\"] - total_disc).toFixed(2);\n      let after_linedisc = (data_list[index][\"price\"] - data_list[index][\"discount_amt\"]) * data_list[index][\"quantity\"];\n      data_list[index][\"trans_amt\"] = Number(after_linedisc - data_list[index][\"additional_discountamt\"]).toFixed(2);\n      data_list[index][\"deposit\"] = Number(after_linedisc - data_list[index][\"additional_discountamt\"]).toFixed(2);\n      this.setState({\n        data_list\n      });\n    };\n\n    this.validateDepositAmount = (e, index) => {\n      debugger;\n      let {\n        data_list\n      } = this.state;\n      let deposit = Number(data_list[index][\"deposit\"]);\n      let transAmt = Number(data_list[index][\"trans_amt\"]);\n\n      if (deposit > transAmt) {\n        Toast({\n          type: \"error\",\n          message: \"Deposit amount should be less than or equal to transaction amount\"\n        });\n        data_list[index][\"deposit\"] = \"\";\n        this.setState({\n          data_list\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    let {\n      hold_item_reasons_options\n    } = this.state;\n    this.props.getCommonApi(`holditemsetup/`).then(key => {\n      let {\n        status,\n        data\n      } = key;\n\n      if (status === 200) {\n        for (let value of data) {\n          hold_item_reasons_options.push({\n            value: value.id,\n            label: value.hold_desc\n          });\n        }\n\n        this.setState({\n          hold_item_reasons_options\n        });\n      }\n    });\n    this.getProductList();\n  }\n\n  render() {\n    let {\n      data_list,\n      hold_item_reasons_options,\n      activeRow\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid mb-4 mt-2 product-details\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 15\n      }\n    }, \"Product Details\")), data_list && data_list.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(NormalButton, {\n      mainbg: false,\n      className: \"col-12 fs-15 submit-btn\",\n      label: \"Done\",\n      onClick: () => this.handleSubmit(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 17\n      }\n    })) : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-3 pr-5 mt-2 fw-500 h6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 13\n      }\n    }, `Item`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 13\n      }\n    }, `Qty`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 13\n      }\n    }, `Unit Price`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, `Disc $`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 13\n      }\n    }, `D/Price`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 13\n      }\n    }, `Amount`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 13\n      }\n    }, `Deposit`), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 13\n      }\n    }, `Staff`)), data_list && data_list.length <= 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-5 pr-5 mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 13\n      }\n    }, \"No Record Found\") : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-5 pr-5 mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 11\n      }\n    }, data_list.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 mb-2 fs-14\",\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: `row w-100 rounded p-2 accordion-menu border ${activeRow == item.id ? \"border-primary\" : \"\"}`,\n        onClick: () => this.handleAccordion(item.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }\n      }, item.itemdesc), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 21\n        }\n      }, item.quantity), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 21\n        }\n      }, item.price), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }\n      }, item.totl_disc), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 21\n        }\n      }, item.discount_price), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 21\n        }\n      }, item.trans_amt), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 21\n        }\n      }, item.deposit), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 21\n        }\n      }, item.sales_staffs)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 rounded bg-light p-3 d-none accordion fs-14\",\n        id: item.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 pl-3 mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 25\n        }\n      }, \"Quantity\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.quantity,\n        type: \"number\",\n        name: \"quantity\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 27\n        }\n      }))), !item.is_foc ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 27\n        }\n      }, \"Deposit\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.deposit,\n        name: \"deposit\",\n        onChange: e => this.handleChange(e, index),\n        onBlur: e => this.validateDepositAmount(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 29\n        }\n      }))) : null, !item.is_foc ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 27\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.price,\n        type: \"number\",\n        name: \"price\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 29\n        }\n      }))) : null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 25\n        }\n      }, \"Hold Reason\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalSelect, {\n        options: hold_item_reasons_options,\n        value: item.holdreason ? item.holdreason : 0,\n        name: \"holdreason\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 27\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 25\n        }\n      }, \"Hold Quantity\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.holditemqty ? item.holditemqty : \"\",\n        type: \"number\",\n        name: \"holditemqty\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 27\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 pl-3 mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 21\n        }\n      })));\n    }))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  basicApptDetail: state.appointment.basicApptDetail\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    getCommonApi,\n    commonPatchApi,\n    commonCreateApi\n  }, dispatch);\n};\n\nexport const ProductDetailsPopup = connect(mapStateToProps, mapDispatchToProps)(ProductDetailsPopupClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/cart/productDetailsPopup.js"],"names":["React","Component","NormalInput","NormalButton","NormalSelect","connect","bindActionCreators","getCommonApi","commonPatchApi","commonCreateApi","Toast","_","ProductDetailsPopupClass","state","data_list","hold_item_reasons_options","sourceList","activRow","getProductList","basicApptDetail","props","custId","id","then","key","status","data","console","log","setState","length","activeRow","document","getElementById","classList","toggle","handleSubmit","value","currentData","Number","deposit","toFixed","transamt","trans_amt","type","message","is_foc","push","quantity","price","holditemqty","holdreason","handleModal","handleChange","e","index","target","name","ActualQty","HoldQty","handlePriceandQuantityChange","handleAccordion","elements","getElementsByClassName","i","add","total_disc","after_linedisc","validateDepositAmount","transAmt","componentDidMount","label","hold_desc","render","map","item","itemdesc","totl_disc","discount_price","sales_staffs","mapStateToProps","appointment","mapDispatchToProps","dispatch","ProductDetailsPopup"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { NormalInput, NormalButton, NormalSelect } from \"component/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  commonPatchApi,\r\n  commonCreateApi,\r\n} from \"redux/actions/common\";\r\nimport { Toast } from \"service/toast\";\r\nimport _ from \"lodash\";\r\nimport \"./style.scss\";\r\n\r\nexport class ProductDetailsPopupClass extends Component {\r\n  state = {\r\n    data_list: [],\r\n    hold_item_reasons_options: [],\r\n    sourceList: [],\r\n    activRow: 0,\r\n  };\r\n\r\n  componentDidMount() {\r\n    let { hold_item_reasons_options } = this.state;\r\n    this.props.getCommonApi(`holditemsetup/`).then(key => {\r\n      let { status, data } = key;\r\n      if (status === 200) {\r\n        for (let value of data) {\r\n          hold_item_reasons_options.push({\r\n            value: value.id,\r\n            label: value.hold_desc,\r\n          });\r\n        }\r\n        this.setState({ hold_item_reasons_options });\r\n      }\r\n    });\r\n    this.getProductList();\r\n  }\r\n  getProductList = () => {\r\n    let { data_list } = this.state;\r\n    let { basicApptDetail } = this.props;\r\n    this.props\r\n      .getCommonApi(\r\n        `cartpopup/?cust_noid=${basicApptDetail.custId}&cart_id=${this.props.id}&is_product=1`\r\n      )\r\n      .then(async key => {\r\n        let { status, data } = key;\r\n        if (status == \"200\") {\r\n          console.log(key, \"cartproductpopuplist\");\r\n          data_list = data;\r\n          await this.setState({\r\n            data_list,\r\n          });\r\n          if (this.state.data_list.length > 0) {\r\n            this.setState({\r\n              activeRow: this.state.data_list[0].id,\r\n            });\r\n            document\r\n              .getElementById(this.state.data_list[0].id)\r\n              .classList.toggle(\"d-none\");\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  handleSubmit = () => {\r\n    let { data_list, sourceList } = this.state;\r\n    sourceList = [];\r\n\r\n    for (let value of data_list) {\r\n      let currentData = Number(value.deposit).toFixed(2);\r\n      let transamt = Number(value.trans_amt).toFixed(2);\r\n      if (currentData > transamt) {\r\n        Toast({\r\n          type: \"error\",\r\n          message:\r\n            \"Deposit amount should be less than or equal to transaction amount\",\r\n        });\r\n        return false;\r\n      } else {\r\n        if (value.is_foc) {\r\n          sourceList.push({\r\n            id: value.id,\r\n            quantity: Number(value.quantity),\r\n            price: Number(value.price).toFixed(2),\r\n            holditemqty: Number(value.holditemqty),\r\n            holdreason: Number(value.holdreason),\r\n          });\r\n        } else {\r\n          sourceList.push({\r\n            id: value.id,\r\n            quantity: Number(value.quantity),\r\n            price: Number(value.price).toFixed(2),\r\n            deposit: Number(value.deposit).toFixed(2),\r\n            holditemqty: Number(value.holditemqty),\r\n            holdreason: Number(value.holdreason),\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log(sourceList, \"productupdatelist\");\r\n    this.props.commonCreateApi(`cartpopup/product/`, sourceList).then(key => {\r\n      let { status, data } = key;\r\n      if (status == 200) {\r\n        this.props.handleModal();\r\n      }\r\n    });\r\n  };\r\n\r\n  handleChange = (e, index) => {\r\n    let { data_list } = this.state;\r\n    let data = e.target.value;\r\n    if ([e.target.name] == \"holdreason\") {\r\n      data_list[index][e.target.name] = Number(data);\r\n    } else if ([e.target.name] == \"holditemqty\") {\r\n      let ActualQty = Number(data_list[index][\"quantity\"]);\r\n      let HoldQty = Number(data);\r\n      if (HoldQty > ActualQty) {\r\n        Toast({\r\n          type: \"error\",\r\n          message:\r\n            \"Hold quantity should be less than or equal to actual quantity\",\r\n        });\r\n      } else {\r\n        data_list[index][e.target.name] = HoldQty;\r\n      }\r\n    } else {\r\n      data_list[index][e.target.name] = data;\r\n    }\r\n    this.setState({ data_list });\r\n    if ([e.target.name] == \"quantity\" || [e.target.name] == \"price\") {\r\n      this.handlePriceandQuantityChange(index);\r\n    }\r\n  };\r\n\r\n  handleAccordion = async id => {\r\n    let elements = document.getElementsByClassName(\"accordion\");\r\n    await this.setState({\r\n      activeRow: id,\r\n    });\r\n    for (let i = 0; i < elements.length; i++) {\r\n      elements[i].classList.add(\"d-none\");\r\n    }\r\n    document.getElementById(id).classList.toggle(\"d-none\");\r\n  };\r\n  handlePriceandQuantityChange = index => {\r\n    let { data_list } = this.state;\r\n    let total_disc =\r\n      Number(data_list[index][\"discount_amt\"]).toFixed(2) +\r\n      Number(data_list[index][\"additional_discountamt\"]);\r\n    data_list[index][\"discount_price\"] = Number(\r\n      data_list[index][\"price\"] - total_disc\r\n    ).toFixed(2);\r\n    let after_linedisc =\r\n      (data_list[index][\"price\"] - data_list[index][\"discount_amt\"]) *\r\n      data_list[index][\"quantity\"];\r\n    data_list[index][\"trans_amt\"] = Number(\r\n      after_linedisc - data_list[index][\"additional_discountamt\"]\r\n    ).toFixed(2);\r\n    data_list[index][\"deposit\"] = Number(\r\n      after_linedisc - data_list[index][\"additional_discountamt\"]\r\n    ).toFixed(2);\r\n    this.setState({\r\n      data_list,\r\n    });\r\n  };\r\n\r\n  validateDepositAmount = (e, index) => {\r\n    debugger;\r\n    let { data_list } = this.state;\r\n    let deposit = Number(data_list[index][\"deposit\"]);\r\n    let transAmt = Number(data_list[index][\"trans_amt\"]);\r\n    if (deposit > transAmt) {\r\n      Toast({\r\n        type: \"error\",\r\n        message:\r\n          \"Deposit amount should be less than or equal to transaction amount\",\r\n      });\r\n      data_list[index][\"deposit\"] = \"\";\r\n      this.setState({\r\n        data_list,\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let { data_list, hold_item_reasons_options, activeRow } = this.state;\r\n    return (\r\n      <>\r\n        <div className=\"container-fluid mb-4 mt-2 product-details\">\r\n          <div className=\"row\">\r\n            <div className=\"col-10\">\r\n              <h4>Product Details</h4>\r\n            </div>\r\n            {data_list && data_list.length > 0 ? (\r\n              <div className=\"col-2\">\r\n                <NormalButton\r\n                  mainbg={false}\r\n                  className=\"col-12 fs-15 submit-btn\"\r\n                  label=\"Done\"\r\n                  onClick={() => this.handleSubmit()}\r\n                />\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n          <div className=\"row pl-3 pr-5 mt-2 fw-500 h6\">\r\n            <div className=\"col\">{`Item`}</div>\r\n            <div className=\"col\">{`Qty`}</div>\r\n            <div className=\"col\">{`Unit Price`}</div>\r\n            <div className=\"col\">{`Disc $`}</div>\r\n            <div className=\"col\">{`D/Price`}</div>\r\n            <div className=\"col\">{`Amount`}</div>\r\n            <div className=\"col\">{`Deposit`}</div>\r\n            <div className=\"col\">{`Staff`}</div>\r\n          </div>\r\n          {data_list && data_list.length <= 0 ? (\r\n            <div className=\"row pl-5 pr-5 mt-4\">No Record Found</div>\r\n          ) : null}\r\n\r\n          <div className=\"row pl-5 pr-5 mt-4\">\r\n            {data_list.map((item, index) => {\r\n              return (\r\n                <div className=\"row w-100 mb-2 fs-14\" key={index}>\r\n                  <div\r\n                    className={`row w-100 rounded p-2 accordion-menu border ${\r\n                      activeRow == item.id ? \"border-primary\" : \"\"\r\n                    }`}\r\n                    onClick={() => this.handleAccordion(item.id)}\r\n                  >\r\n                    <div className=\"col\">{item.itemdesc}</div>\r\n                    <div className=\"col\">{item.quantity}</div>\r\n                    <div className=\"col\">{item.price}</div>\r\n                    <div className=\"col\">{item.totl_disc}</div>\r\n                    <div className=\"col\">{item.discount_price}</div>\r\n                    <div className=\"col\">{item.trans_amt}</div>\r\n                    <div className=\"col\">{item.deposit}</div>\r\n                    <div className=\"col\">{item.sales_staffs}</div>\r\n                  </div>\r\n                  <div\r\n                    className=\"row w-100 rounded bg-light p-3 d-none accordion fs-14\"\r\n                    id={item.id}\r\n                  >\r\n                    <div className=\"row w-100 pl-3 mb-3\">\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          Quantity\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalInput\r\n                            placeholder=\"Enter here\"\r\n                            value={item.quantity}\r\n                            type=\"number\"\r\n                            name=\"quantity\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      {!item.is_foc ? (\r\n                        <div className=\"col\">\r\n                          <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                            Deposit\r\n                          </label>\r\n                          <div className=\"input-group\">\r\n                            <NormalInput\r\n                              placeholder=\"Enter here\"\r\n                              value={item.deposit}\r\n                              name=\"deposit\"\r\n                              onChange={e => this.handleChange(e, index)}\r\n                              onBlur={e => this.validateDepositAmount(e, index)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n                      {!item.is_foc ? (\r\n                        <div className=\"col\">\r\n                          <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                            Unit Price\r\n                          </label>\r\n                          <div className=\"input-group\">\r\n                            <NormalInput\r\n                              placeholder=\"Enter here\"\r\n                              value={item.price}\r\n                              type=\"number\"\r\n                              name=\"price\"\r\n                              onChange={e => this.handleChange(e, index)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          Hold Reason\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalSelect\r\n                            options={hold_item_reasons_options}\r\n                            value={item.holdreason ? item.holdreason : 0}\r\n                            name=\"holdreason\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          Hold Quantity\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalInput\r\n                            placeholder=\"Enter here\"\r\n                            value={item.holditemqty ? item.holditemqty : \"\"}\r\n                            type=\"number\"\r\n                            name=\"holditemqty\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row w-100 pl-3 mb-3\"></div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      commonPatchApi,\r\n      commonCreateApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\nexport const ProductDetailsPopup = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ProductDetailsPopupClass);\r\n"]},"metadata":{},"sourceType":"module"}