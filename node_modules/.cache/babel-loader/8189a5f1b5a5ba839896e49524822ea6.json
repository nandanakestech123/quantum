{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{NormalButton}from\"component/common\";import{InputSearch,TableWrapper}from\"component/common\";import{Link}from\"react-router-dom\";import\"./style.scss\";import{getCustomerPlus,getCustomerPlusSettings}from\"redux/actions/customerPlus\";import{updateForm}from\"redux/actions/common\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import _ from\"lodash\";import{withTranslation}from\"react-i18next\";export var ListCustomerPlusClass=/*#__PURE__*/function(_React$Component){_inherits(ListCustomerPlusClass,_React$Component);var _super=_createSuper(ListCustomerPlusClass);function ListCustomerPlusClass(){var _this;_classCallCheck(this,ListCustomerPlusClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[],customerList:[],originalCustomerList:[],search:\"\",meta:{},active:false,currentIndex:-1,isLoading:true,isMounted:true};_this.updateState=function(data){if(_this.state.isMounted)_this.setState(data);};_this.componentDidMount=function(){_this.getCustomerPlus({});};_this.handleClick=function(key){if(!_this.state.active){document.addEventListener(\"click\",_this.handleOutsideClick,false);}else{document.removeEventListener(\"click\",_this.handleOutsideClick,false);}_this.updateState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.handleOutsideClick=function(e){if(_this.node!=null){if(_this.node.contains(e.target)){return;}}_this.handleClick();};_this.getCustomerPlus=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _customerDetails$meta;var _this$state,search,headerDetails,_data$page,page,_data$limit,limit,settings,_iterator,_step,_step$value,display_field_name,field_name,visible_in_listing,customerDetails;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.updateState({isLoading:true});_this$state=_this.state,search=_this$state.search,headerDetails=_this$state.headerDetails;_data$page=data.page,page=_data$page===void 0?1:_data$page,_data$limit=data.limit,limit=_data$limit===void 0?10:_data$limit;if(!(headerDetails.length==0)){_context.next=11;break;}_context.next=6;return _this.props.getCustomerPlusSettings();case 6:settings=_this.props.settings;_iterator=_createForOfIteratorHelper(settings);try{for(_iterator.s();!(_step=_iterator.n()).done;){_step$value=_step.value,display_field_name=_step$value.display_field_name,field_name=_step$value.field_name,visible_in_listing=_step$value.visible_in_listing;if(visible_in_listing)headerDetails.push({label:display_field_name,field:field_name,sortKey:field_name});}}catch(err){_iterator.e(err);}finally{_iterator.f();}headerDetails.push({label:\"\"});_this.updateState({headerDetails:headerDetails});case 11:_context.next=13;return _this.props.getCustomerPlus(\"?page=\".concat(page,\"&limit=\").concat(limit,\"&search=\").concat(search));case 13:customerDetails=_this.props.customerDetails;_this.updateState({customerList:customerDetails.dataList,originalCustomerList:customerDetails.dataList,meta:(_customerDetails$meta=customerDetails.meta)===null||_customerDetails$meta===void 0?void 0:_customerDetails$meta.pagination,isLoading:false});case 15:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handlePagination=function(page){_this.getCustomerPlus(page);};_this.handlesearch=function(event){_this.state.search=event.target.value;_this.getCustomerPlus({});};_this.bookAppointment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var formFields;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formFields={};formFields[\"custId\"]=data.id;formFields[\"custName\"]=data.cust_name;_context2.next=5;return _this.props.updateForm(\"basicApptDetail\",formFields);case 5:_this.props.history.push(\"/admin/appointment\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();return _this;}_createClass(ListCustomerPlusClass,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.state.isMounted=false;}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,headerDetails=_this$state2.headerDetails,originalCustomerList=_this$state2.originalCustomerList,customerList=_this$state2.customerList,meta=_this$state2.meta,currentIndex=_this$state2.currentIndex,isLoading=_this$state2.isLoading;var t=this.props.t;return/*#__PURE__*/React.createElement(\"div\",{className:\"customer-list container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-lg-2 mb-2\"},/*#__PURE__*/React.createElement(Link,{to:\"/admin/customerplus/settings\"},/*#__PURE__*/React.createElement(NormalButton,{normal:true,className:\"col-12 fs-15 float-right\",label:\"Settings\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-lg-3 mb-2\"},/*#__PURE__*/React.createElement(Link,{to:\"/admin/customerplus/lpmanagement\"},/*#__PURE__*/React.createElement(NormalButton,{normal:true,className:\"col-12 fs-15 float-right\",label:\"LP Management\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 mb-2\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"head-label\"},t(\"Customer Plus List\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8 col-sm-12 mb-2\"},/*#__PURE__*/React.createElement(InputSearch,{className:\"\",placeholder:\"Search Customer\",onEnter:this.handlesearch,disabled:isLoading})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-sm-12\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:true,className:\"col-12 fs-15 float-right\",label:\"Add Customer\",onClick:function onClick(){return _this2.props.history.push(\"/admin/customerplus/add\");}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tab-table-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:meta,showFilterColumn:true,parentHeaderChange:function parentHeaderChange(value){return _this2.updateState(function(){return headerDetails=value;});},sortData:originalCustomerList,onSort:function onSort(list){return _this2.updateState({customerList:list});}},isLoading?/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"7\"},/*#__PURE__*/React.createElement(\"div\",{class:\"d-flex mt-5 align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\"))))):customerList?customerList.map(function(item,index){var id=item.id;return/*#__PURE__*/React.createElement(\"tr\",{key:index},headerDetails.map(function(e){return e.field?/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item[e.field])):null;}),/*#__PURE__*/React.createElement(\"td\",{className:\"position-relative\",ref:function ref(node){_this2.node=node;},onClick:function onClick(){return _this2.handleClick(index);}},currentIndex===index?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more-active\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"option card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pt-3\",onClick:function onClick(){return _this2.props.history.push(\"/admin/customerplus/\".concat(id,\"/details\"));}},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-eye-grey px-3\"}),t(\"View\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\",onClick:function onClick(){return _this2.props.history.push(\"/admin/customerplus/\".concat(id,\"/lpmanagement\"));}},/*#__PURE__*/React.createElement(\"span\",{className:\"px-2\"},/*#__PURE__*/React.createElement(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"31\",height:\"30\",fill:\"currentColor\",viewBox:\"0 0 15 30\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z\"}))),t(\"Loyalty Points Management\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-schedule px-3\"}),t(\"Reschedule Appointment\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\",onClick:function onClick(){return _this2.bookAppointment(item);}},/*#__PURE__*/React.createElement(\"span\",{className:\"px-2\"},/*#__PURE__*/React.createElement(\"svg\",{width:\"31\",height:\"30\",viewBox:\"0 0 31 30\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"rect\",{width:\"31\",height:\"30\",fill:\"#F9F9F9\"}),/*#__PURE__*/React.createElement(\"path\",{d:\"M15 8V22\",stroke:\"#848484\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}),/*#__PURE__*/React.createElement(\"path\",{d:\"M8 15H22\",stroke:\"#848484\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}))),t(\"Book Appointment\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pb-3\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-cancel-schedule px-3\"}),t(\"Cancel Appointment\")))):/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"}))));}):\"\")))))));}}]);return ListCustomerPlusClass;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{customerDetails:state.customerPlus.customerPlusDetail,settings:state.customerPlus.customerPlusSettings};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCustomerPlus:getCustomerPlus,updateForm:updateForm,getCustomerPlusSettings:getCustomerPlusSettings},dispatch);};export var ListCustomerPlus=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(ListCustomerPlusClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/CustomerPlus/ListCustomerPlus/index.js"],"names":["React","NormalButton","InputSearch","TableWrapper","Link","getCustomerPlus","getCustomerPlusSettings","updateForm","connect","bindActionCreators","_","withTranslation","ListCustomerPlusClass","state","headerDetails","customerList","originalCustomerList","search","meta","active","currentIndex","isLoading","isMounted","updateState","data","setState","componentDidMount","handleClick","key","document","addEventListener","handleOutsideClick","removeEventListener","prevState","e","node","contains","target","page","limit","length","props","settings","display_field_name","field_name","visible_in_listing","push","label","field","sortKey","customerDetails","dataList","pagination","handlePagination","handlesearch","event","value","bookAppointment","formFields","id","cust_name","history","t","list","map","item","index","Component","mapStateToProps","customerPlus","customerPlusDetail","customerPlusSettings","mapDispatchToProps","dispatch","ListCustomerPlus"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { NormalButton } from \"component/common\";\nimport { InputSearch, TableWrapper } from \"component/common\";\nimport { Link } from \"react-router-dom\";\nimport \"./style.scss\";\nimport {\n  getCustomerPlus,\n  getCustomerPlusSettings,\n} from \"redux/actions/customerPlus\";\nimport { updateForm } from \"redux/actions/common\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport _ from \"lodash\";\nimport { withTranslation } from \"react-i18next\";\n\nexport class ListCustomerPlusClass extends React.Component {\n  state = {\n    headerDetails: [],\n    customerList: [],\n    originalCustomerList: [],\n    search: \"\",\n    meta: {},\n    active: false,\n    currentIndex: -1,\n    isLoading: true,\n    isMounted: true,\n  };\n  componentWillUnmount() {\n    this.state.isMounted = false;\n  }\n\n  updateState = (data) => {\n    if (this.state.isMounted) this.setState(data);\n  };\n\n  componentDidMount = () => {\n    this.getCustomerPlus({});\n  };\n\n  handleClick = (key) => {\n    if (!this.state.active) {\n      document.addEventListener(\"click\", this.handleOutsideClick, false);\n    } else {\n      document.removeEventListener(\"click\", this.handleOutsideClick, false);\n    }\n\n    this.updateState((prevState) => ({\n      active: !prevState.active,\n      currentIndex: key,\n    }));\n  };\n\n  handleOutsideClick = (e) => {\n    if (this.node != null) {\n      if (this.node.contains(e.target)) {\n        return;\n      }\n    }\n    this.handleClick();\n  };\n\n  getCustomerPlus = async (data) => {\n    this.updateState({ isLoading: true });\n    let { search, headerDetails } = this.state;\n    let { page = 1, limit = 10 } = data;\n    if (headerDetails.length == 0) {\n      await this.props.getCustomerPlusSettings();\n      let { settings } = this.props;\n      for (let {\n        display_field_name,\n        field_name,\n        visible_in_listing,\n      } of settings) {\n        if (visible_in_listing)\n          headerDetails.push({\n            label: display_field_name,\n            field: field_name,\n            sortKey: field_name,\n          });\n      }\n      headerDetails.push({ label: \"\" });\n      this.updateState({ headerDetails });\n    }\n    await this.props.getCustomerPlus(\n      `?page=${page}&limit=${limit}&search=${search}`\n    );\n    let { customerDetails } = this.props;\n    this.updateState({\n      customerList: customerDetails.dataList,\n      originalCustomerList: customerDetails.dataList,\n      meta: customerDetails.meta?.pagination,\n      isLoading: false,\n    });\n  };\n\n  handlePagination = (page) => {\n    this.getCustomerPlus(page);\n  };\n\n  handlesearch = (event) => {\n    this.state.search = event.target.value;\n    this.getCustomerPlus({});\n  };\n\n  bookAppointment = async (data) => {\n    let formFields = {};\n    formFields[\"custId\"] = data.id;\n    formFields[\"custName\"] = data.cust_name;\n    await this.props.updateForm(\"basicApptDetail\", formFields);\n    this.props.history.push(`/admin/appointment`);\n  };\n\n  render() {\n    let {\n      headerDetails,\n      originalCustomerList,\n      customerList,\n      meta,\n      currentIndex,\n      isLoading,\n    } = this.state;\n    let { t } = this.props;\n    return (\n      <div className=\"customer-list container-fluid\">\n        <div className=\"row mb-4\">\n          <div className=\"col-md-4 col-lg-2 mb-2\">\n            <Link to=\"/admin/customerplus/settings\">\n              <NormalButton\n                normal={true}\n                className=\"col-12 fs-15 float-right\"\n                label=\"Settings\"\n              />\n            </Link>\n          </div>\n          <div className=\"col-md-4 col-lg-3 mb-2\">\n            <Link to=\"/admin/customerplus/lpmanagement\">\n              <NormalButton\n                normal={true}\n                className=\"col-12 fs-15 float-right\"\n                label=\"LP Management\"\n              />\n            </Link>\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col\">\n            <div className=\"row\">\n              <div className=\"col-12 mb-2\">\n                <h3 className=\"head-label\">{t(\"Customer Plus List\")}</h3>\n              </div>\n              <div className=\"col-md-8 col-sm-12 mb-2\">\n                <InputSearch\n                  className=\"\"\n                  placeholder=\"Search Customer\"\n                  onEnter={this.handlesearch}\n                  disabled={isLoading}\n                />\n              </div>\n              <div className=\"col-md-4 col-sm-12\">\n                <NormalButton\n                  mainbg={true}\n                  className=\"col-12 fs-15 float-right\"\n                  label=\"Add Customer\"\n                  onClick={() =>\n                    this.props.history.push(\"/admin/customerplus/add\")\n                  }\n                />\n              </div>\n            </div>\n            <div className=\"tab-table-content\">\n              <div className=\"py-4\">\n                <div className=\"table-container\">\n                  <TableWrapper\n                    headerDetails={headerDetails}\n                    queryHandler={this.handlePagination}\n                    pageMeta={meta}\n                    showFilterColumn={true}\n                    parentHeaderChange={(value) =>\n                      this.updateState(() => (headerDetails = value))\n                    }\n                    sortData={originalCustomerList}\n                    onSort={(list) => this.updateState({ customerList: list })}\n                  >\n                    {isLoading ? (\n                      <tr>\n                        <td colSpan=\"7\">\n                          <div class=\"d-flex mt-5 align-items-center justify-content-center\">\n                            <div class=\"spinner-border\" role=\"status\">\n                              <span class=\"sr-only\">Loading...</span>\n                            </div>\n                          </div>\n                        </td>\n                      </tr>\n                    ) : customerList ? (\n                      customerList.map((item, index) => {\n                        let { id } = item;\n                        return (\n                          <tr key={index}>\n                            {headerDetails.map((e) =>\n                              e.field ? (\n                                <td>\n                                  <div className=\"d-flex align-items-center justify-content-center\">\n                                    {item[e.field]}\n                                  </div>\n                                </td>\n                              ) : null\n                            )}\n                            <td\n                              className=\"position-relative\"\n                              ref={(node) => {\n                                this.node = node;\n                              }}\n                              onClick={() => this.handleClick(index)}\n                            >\n                              {currentIndex === index ? (\n                                <>\n                                  <div className=\"d-flex align-items-center justify-content-center horizontal-more-active\">\n                                    <i className=\"icon-more\"></i>\n                                  </div>\n                                  <div className=\"option card\">\n                                    <div\n                                      className=\"d-flex align-items-center fs-16 pt-3\"\n                                      onClick={() =>\n                                        this.props.history.push(\n                                          `/admin/customerplus/${id}/details`\n                                        )\n                                      }\n                                    >\n                                      <span className=\"icon-eye-grey px-3\"></span>\n                                      {t(\"View\")}\n                                    </div>\n                                    <div\n                                      className=\"d-flex align-items-center fs-16\"\n                                      onClick={() =>\n                                        this.props.history.push(\n                                          `/admin/customerplus/${id}/lpmanagement`\n                                        )\n                                      }\n                                    >\n                                      <span className=\"px-2\">\n                                        <svg\n                                          xmlns=\"http://www.w3.org/2000/svg\"\n                                          width=\"31\"\n                                          height=\"30\"\n                                          fill=\"currentColor\"\n                                          viewBox=\"0 0 15 30\"\n                                        >\n                                          <path d=\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z\" />\n                                        </svg>\n                                      </span>\n                                      {t(\"Loyalty Points Management\")}\n                                    </div>\n                                    <div className=\"d-flex align-items-center fs-16\">\n                                      <span className=\"icon-schedule px-3\"></span>\n                                      {t(\"Reschedule Appointment\")}\n                                    </div>\n                                    <div\n                                      className=\"d-flex align-items-center fs-16\"\n                                      onClick={() => this.bookAppointment(item)}\n                                    >\n                                      <span className=\"px-2\">\n                                        <svg\n                                          width=\"31\"\n                                          height=\"30\"\n                                          viewBox=\"0 0 31 30\"\n                                          fill=\"none\"\n                                          xmlns=\"http://www.w3.org/2000/svg\"\n                                        >\n                                          <rect\n                                            width=\"31\"\n                                            height=\"30\"\n                                            fill=\"#F9F9F9\"\n                                          />\n                                          <path\n                                            d=\"M15 8V22\"\n                                            stroke=\"#848484\"\n                                            stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\"\n                                          />\n                                          <path\n                                            d=\"M8 15H22\"\n                                            stroke=\"#848484\"\n                                            stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\"\n                                          />\n                                        </svg>\n                                      </span>\n                                      {t(\"Book Appointment\")}\n                                    </div>\n                                    <div className=\"d-flex align-items-center fs-16 pb-3\">\n                                      <span className=\"icon-cancel-schedule px-3\"></span>\n                                      {t(\"Cancel Appointment\")}\n                                    </div>\n                                  </div>\n                                </>\n                              ) : (\n                                <div className=\"d-flex align-items-center justify-content-center horizontal-more\">\n                                  <i className=\"icon-more\"></i>\n                                </div>\n                              )}\n                            </td>\n                          </tr>\n                        );\n                      })\n                    ) : (\n                      \"\"\n                    )}\n                  </TableWrapper>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  customerDetails: state.customerPlus.customerPlusDetail,\n  settings: state.customerPlus.customerPlusSettings,\n});\n\nconst mapDispatchToProps = (dispatch) => {\n  return bindActionCreators(\n    {\n      getCustomerPlus,\n      updateForm,\n      getCustomerPlusSettings,\n    },\n    dispatch\n  );\n};\n\nexport const ListCustomerPlus = withTranslation()(\n  connect(mapStateToProps, mapDispatchToProps)(ListCustomerPlusClass)\n);\n"]},"metadata":{},"sourceType":"module"}