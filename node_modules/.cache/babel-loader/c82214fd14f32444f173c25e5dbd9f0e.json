{"ast":null,"code":"import _toConsumableArray from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _createForOfIteratorHelper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{NormalInput,NormalTextarea,NormalButton,NormalSelect,NormalDate,NormalModal,NormalDateTime}from\"component/common\";import{Button,Form,FormGroup,Label,Input,FormText}from\"reactstrap\";import{getPayment,createPayment}from\"redux/actions/payment\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{history}from\"helpers\";import{getCommonApi,updateForm}from\"redux/actions/common\";import{dateFormat}from\"service/helperFunctions\";import\"./style.scss\";import SimpleReactValidator from\"simple-react-validator\";import closeIcon from\"assets/images/close.png\";import helpers from\"../../../service/Helper\";import{Toast}from\"service/toast\";import{withTranslation}from\"react-i18next\";import moment from\"moment\";export var ChangePaymentClass=/*#__PURE__*/function(_Component){_inherits(ChangePaymentClass,_Component);var _super=_createSuper(ChangePaymentClass);function ChangePaymentClass(){var _this;_classCallCheck(this,ChangePaymentClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={formFields:{name:\"\",contact:\"\",address:\"\",searchStaff:\"\",payTableDropDownValue:\"\"},responseData:{},premisesOption:[],selectedCards:[],selectedCardsPayAmount:0,cardOption:[],ewalletoptions:[],ewalletField:{pay_typeid:null,pay_amt:\"\",credit_debit:true},cardField:{pay_typeid:null,pay_amt:\"\",credit_debit:true,pay_rem1:\"\",pay_rem2:\"\",pay_rem3:\"\",pay_rem4:\"\",App_code:\"\"},balance:0,errorMessage:\"123\",prepaidCustomerData:[],voucherCustomerData:[],creditNoteCustomerData:[],accountHeader:[],isMakePaymentButtonClicked:\"false\",itemProductAmount:0,itemServiceAmount:0,itemProductServiceVoucherAmount:0,displayTablePrepaid:[],displayTableCreditNote:[],displayTableVoucher:[],paytableData:[],paytableFullData:[],payGroupData:[],selectPaymentGroup:\"\",selectPaymentGroupId:\"\",isSelectedPaymentType:\"\",displayModelPaymentType:\"\",txtUserPayAmount:0,isOpenSubPayment:false,pay_rem4:\"\",DateofPay:new Date(),MinimumDate:new Date(),is_paymentdate:false,isMakePaymentLoading:false};_this.componentWillMount=function(){_this.validator=new SimpleReactValidator({element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});};_this.getPayment=function(){var TransactionId=_this.props.TransactionId;var selectedCards=_this.state.selectedCards;_this.props.getPayment(\"paymentlist/?sa_transacno=\".concat(TransactionId)).then(function(res){console.log(\"Payment Details:\",res);var _this$state=_this.state,balance=_this$state.balance,selectedCards=_this$state.selectedCards,txtUserPayAmount=_this$state.txtUserPayAmount,isOpenSubPayment=_this$state.isOpenSubPayment;var data=res.data,status=res.status,pay_list=res.pay_list;if(status===200){_this.setState({responseData:data,balance:Number(data.billable_amount),txtUserPayAmount:Number(data.billable_amount)});pay_list.forEach(function(item){if(Number(item.pay_typeid)==2){selectedCards.push({pay_typeid:item.pay_typeid,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,prepaid:item.prepaid,credit_debit:item.credit_debit,pay_rem4:item.pay_rem4,pay_desc:item.pay_desc,gt_group:item.gt_group});}else if(Number(item.pay_typeid)==4){selectedCards.push({credit_debit:item.credit_debit,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,pay_rem1:item.pay_rem1,pay_rem2:item.pay_rem2,pay_rem3:item.pay_rem3,pay_rem4:item.pay_rem4,pay_typeid:item.pay_typeid,prepaid:item.prepaid,pay_desc:item.pay_desc,gt_group:item.gt_group});}else if(Number(item.pay_typeid)==17){selectedCards.push({credit_debit:item.credit_debit,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,pay_rem1:item.pay_rem1,pay_rem2:item.pay_rem2,pay_rem4:item.pay_rem4,pay_typeid:item.pay_typeid,prepaid:item.prepaid,pay_desc:item.pay_desc,gt_group:item.gt_group});}else if(Number(item.pay_typeid)==23){selectedCards.push({credit_debit:item.credit_debit,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,pay_rem1:item.pay_rem1,pay_rem2:item.pay_rem2,pay_rem4:item.pay_rem4,pay_typeid:item.pay_typeid,prepaid:item.prepaid,prepaid_ct:item.prepaid_ct,pay_desc:item.pay_desc,gt_group:item.gt_group});}else if(Number(item.pay_typeid)==9){selectedCards.push({credit_debit:item.credit_debit,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,pay_rem1:item.pay_rem1,pay_rem4:item.pay_rem4,pay_typeid:item.pay_typeid,prepaid:item.prepaid,pay_desc:item.pay_desc,gt_group:item.gt_group});}else{selectedCards.push({credit_debit:item.credit_debit,pay_amt:parseFloat(item.pay_amt),pay_premise:item.pay_premise,pay_rem1:item.pay_rem1,pay_rem2:item.pay_rem2,pay_rem3:item.pay_rem3,pay_rem4:item.pay_rem4,pay_typeid:item.pay_typeid,prepaid:item.prepaid,pay_desc:item.pay_desc,gt_group:item.gt_group});}balance=parseFloat(balance-txtUserPayAmount).toFixed(2);txtUserPayAmount=balance;_this.setState({txtUserPayAmount:txtUserPayAmount,balance:balance});});}});};_this.handleMultiple=function(_ref){var _ref$target=_ref.target,value=_ref$target.value,name=_ref$target.name;console.log(\"handleMultiple\",value,name);var formFields=Object.assign({},_this.state.formFields);formFields[name]=value;_this.setState({formFields:formFields});};_this.getPayGroup=function(){_this.props.getCommonApi(\"paygroup/?gt_group=GT1\").then(function(res){console.log(res,\"paygroupresponse\");var payGroupData=_this.state.payGroupData;var _iterator=_createForOfIteratorHelper(res.data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;payGroupData.push({label:key.pay_group_code,value:key.id,picturelocation:key.picturelocation});}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({payGroupData:payGroupData});});};_this.getFullPayTable=function(){_this.props.getCommonApi(\"paytablenew/\").then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var paytableFullData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:paytableFullData=_this.state.paytableFullData;paytableFullData=res.data;console.log(res.data,\"responseforGetfullpaytable\");_context.next=5;return _this.setState({paytableFullData:paytableFullData});case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());};_this.getPayTableNameBasedOnId=function(payTableId){debugger;// gt_group: \"GT1\"\n// id: 6\n// pay_code: \"UOBPN\"\n// pay_description: \"UOB PAYNOW\"\n// pay_group_name: \"UOB\"\n// pay_groupid: 22\n// if (\n//   isSelectedPaymentType == \"VOUCHER\" ||\n//   isSelectedPaymentType == \"PREPAID\" ||\n//   isSelectedPaymentType == \"Credit\" ||\n//   isSelectedPaymentType == \"OLD BILL\"\n// ) {\n//   const test = paytableFullData.filter(\n//     res => res.pay_group_name.trim() == isSelectedPaymentType.trim()\n//   );\n//   return test[0].pay_description;\n// } else {\nvar test=_this.state.paytableFullData.filter(function(res){return res.id==payTableId;});console.log(test,\"Filtered payment data\");return test[0].pay_description;// }\n};_this.handleChange=function(_ref3){var _ref3$target=_ref3.target,value=_ref3$target.value,name=_ref3$target.name;var formFields=Object.assign({},_this.state.formFields);formFields[name]=value;_this.setState({formFields:formFields});var _this$state2=_this.state,balance=_this$state2.balance,selectedCards=_this$state2.selectedCards,txtUserPayAmount=_this$state2.txtUserPayAmount,isOpenSubPayment=_this$state2.isOpenSubPayment;isOpenSubPayment=false;selectedCards.push({pay_typeid:value,pay_amt:parseFloat(txtUserPayAmount),credit_debit:false,pay_premise:true,prepaid:false,pay_rem4:_this.state.pay_rem4,gt_group:false});balance=parseFloat(balance-txtUserPayAmount).toFixed(2);txtUserPayAmount=balance;_this.setState({txtUserPayAmount:txtUserPayAmount,balance:balance,isOpenSubPayment:isOpenSubPayment});};_this.handleCreditChange=function(_ref4){var _ref4$target=_ref4.target,value=_ref4$target.value,name=_ref4$target.name;var cardField=Object.assign({},_this.state.cardField);cardField[name]=value;_this.setState({cardField:cardField});};_this.handleSubmit=function(){_this.setState({isMakePaymentLoading:true});var _this$state3=_this.state,selectedCards=_this$state3.selectedCards,DateofPay=_this$state3.DateofPay;_this.setState({isMakePaymentButtonClicked:\"true\"});var data=selectedCards;console.log(\"SubmitDatapayment\",data);var TransactionId=_this.props.TransactionId;_this.props.createPayment(\"changepayment/?sa_transacno=\".concat(TransactionId),data).then(function(res){_this.setState({isMakePaymentLoading:false});history.push(\"/admin/billing/print/bill/\".concat(res.data.sa_transacno));});_this.setState({isMakePaymentLoading:false});};_this.addCreditCard=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this$state4,cardField,selectedCards,balance,responseData,txtUserPayAmount,userPayAmount,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(_this.validator.fieldValid(\"cardFieldType\")){_context2.next=3;break;}_this.validator.showMessageFor(\"cardFieldType\");return _context2.abrupt(\"return\");case 3:_this$state4=_this.state,cardField=_this$state4.cardField,selectedCards=_this$state4.selectedCards,balance=_this$state4.balance,responseData=_this$state4.responseData,txtUserPayAmount=_this$state4.txtUserPayAmount;userPayAmount=parseFloat(txtUserPayAmount);if(!(parseFloat(_this.state.responseData.billable_amount)>0)){_context2.next=8;break;}if(!(userPayAmount==0)){_context2.next=8;break;}return _context2.abrupt(\"return\");case 8:if(!_this.checkPayTypeIdAlreadyExists(cardField.pay_typeid)){_context2.next=14;break;}result=_this.getPayTableNameBasedOnId(cardField.pay_typeid)+\" already exists\";Toast({type:\"error\",message:result});return _context2.abrupt(\"return\");case 14:selectedCards.push({pay_typeid:cardField.pay_typeid,pay_amt:userPayAmount,credit_debit:true,pay_premise:false,pay_rem1:cardField.pay_rem1,pay_rem2:cardField.pay_rem2,pay_rem3:cardField.pay_rem3,pay_rem4:_this.state.pay_rem4,prepaid:false,gt_group:false});case 15:balance=parseFloat(balance-userPayAmount).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);case 18:case\"end\":return _context2.stop();}}},_callee2);}));_this.addPrepaid=function(selectedPrepaid){var prepaidExpDate=moment(selectedPrepaid.exp_date).format(\"YYYY-MM-DD\");var todaysDate=moment(new Date()).format(\"YYYY-MM-DD\");var isValid=moment(todaysDate).isSameOrAfter(prepaidExpDate);var userPayAmount=0;var _this$state5=_this.state,itemServiceAmount=_this$state5.itemServiceAmount,itemProductAmount=_this$state5.itemProductAmount,itemProductServiceVoucherAmount=_this$state5.itemProductServiceVoucherAmount,txtUserPayAmount=_this$state5.txtUserPayAmount;console.log(txtUserPayAmount);userPayAmount=parseFloat(txtUserPayAmount);if(isValid){Toast({type:\"error\",message:\"Check Expiry Date\"});return;}if(userPayAmount<=0){Toast({type:\"error\",message:\"Prepaid is Not allowed\"});return;}var selectedRemainingPrepaidAmount=parseFloat(selectedPrepaid.remain);if(selectedRemainingPrepaidAmount<userPayAmount){//return\n}else if(selectedRemainingPrepaidAmount>userPayAmount){selectedRemainingPrepaidAmount=parseFloat(userPayAmount);}if(selectedPrepaid.conditiontype1===\"Service Only\"){//For Service\nif(parseFloat(itemServiceAmount)==0){Toast({type:\"error\",message:\"Prepaid is Not allowed\"});return;}if(parseFloat(itemServiceAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemServiceAmount)?parseFloat(txtUserPayAmount):parseFloat(itemServiceAmount);console.log(itemServiceAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemServiceAmount=itemServiceAmount-userPayAmount;_this.setState({itemServiceAmount:itemServiceAmount});}else if(selectedPrepaid.conditiontype1===\"Product Only\"){//For Product\nif(parseFloat(itemProductAmount)==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}if(parseFloat(itemProductAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemProductAmount)?parseFloat(txtUserPayAmount):parseFloat(itemProductAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemProductAmount=itemProductAmount-userPayAmount;_this.setState({itemProductAmount:itemProductAmount});}else{if(parseFloat(itemProductServiceVoucherAmount)==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}if(parseFloat(itemProductServiceVoucherAmount)<=selectedRemainingPrepaidAmount){userPayAmount=parseFloat(txtUserPayAmount)<parseFloat(itemProductServiceVoucherAmount)?parseFloat(txtUserPayAmount):parseFloat(itemProductServiceVoucherAmount);console.log(userPayAmount);}else{userPayAmount=selectedRemainingPrepaidAmount;console.log(userPayAmount);}itemProductServiceVoucherAmount=itemProductServiceVoucherAmount-userPayAmount;_this.setState({itemProductServiceVoucherAmount:itemProductServiceVoucherAmount});}if(userPayAmount==0){Toast({type:\"error\",message:\"Prepaid is not allowed\"});return;}var payTypeId=23;var _this$state6=_this.state,cardField=_this$state6.cardField,ewalletField=_this$state6.ewalletField,balance=_this$state6.balance,selectedCards=_this$state6.selectedCards,isOpenSubPayment=_this$state6.isOpenSubPayment;selectedCards.push({pay_typeid:payTypeId,prepaid:true,pay_amt:userPayAmount,credit_debit:false,pay_premise:false,pay_rem1:selectedPrepaid.pp_no+\" - \"+selectedPrepaid.line_no+\" - \"+selectedPrepaid.pp_desc,pay_rem2:selectedPrepaid.id,pay_rem4:_this.state.pay_rem4,prepaid_ct:selectedPrepaid.conditiontype1,gt_group:false});console.log(\"BeforeAdd-displayTablePrepaid\",_this.state.displayTablePrepaid);var setdisplayTablePrepaid=_this.state.displayTablePrepaid;setdisplayTablePrepaid.push(selectedPrepaid.id);_this.setState({displayTablePrepaid:setdisplayTablePrepaid});console.log(\"AfterAdd-displayTablePrepaid\",_this.state.displayTablePrepaid);_this.HidePrepaidTableData();balance=parseFloat(balance-userPayAmount).toFixed(2);_this.setBalanceToAllTextBoxes(balance);console.log(balance);_this.setState({isOpenSubPayment:false});};_this.addVoucher=function(selectedVoucher){var _this$state7=_this.state,cardField=_this$state7.cardField,ewalletField=_this$state7.ewalletField,balance=_this$state7.balance,txtUserPayAmount=_this$state7.txtUserPayAmount,isOpenSubPayment=_this$state7.isOpenSubPayment,selectedCards=_this$state7.selectedCards;if(txtUserPayAmount==0){Toast({type:\"error\",message:\"Voucher is not allowed\"});return;}var selectedVoucherAmount=parseFloat(selectedVoucher.value);var pay_amt_setup=0;if(selectedVoucherAmount<=parseFloat(txtUserPayAmount)){pay_amt_setup=selectedVoucherAmount;}else{Toast({type:\"error\",message:\"Partial Amount is not applicable in voucher\"});return;// alert(\"Partial Amount is not applicable in voucher\");\n// return;\n}var payTypeId=9;selectedCards.push({pay_typeid:payTypeId,prepaid:false,pay_amt:parseFloat(pay_amt_setup),credit_debit:false,pay_premise:false,pay_rem1:selectedVoucher.voucher_no,pay_rem2:selectedVoucher.voucher_no,pay_rem4:_this.state.pay_rem4,gt_group:false});console.log(\"BeforeAdd-displayTableVoucher\",_this.state.displayTableVoucher);var setdisplayTableVoucher=_this.state.displayTableVoucher;setdisplayTableVoucher.push(selectedVoucher.voucher_no);_this.setState({displayTableVoucher:setdisplayTableVoucher});console.log(\"AfterAdd-displayTableCreditNote\",_this.state.displayTableVoucher);_this.HideVoucherTableData();balance=parseFloat(balance-pay_amt_setup).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);};_this.addCreditNote=function(selectedCreditNote){console.log(selectedCreditNote);var _this$state8=_this.state,cardField=_this$state8.cardField,ewalletField=_this$state8.ewalletField,balance=_this$state8.balance,txtUserPayAmount=_this$state8.txtUserPayAmount,selectedCards=_this$state8.selectedCards;if(txtUserPayAmount==0){Toast({type:\"error\",message:\"Credit Note is not allowed\"});return;}var selectedCreditNoteAmount=parseFloat(selectedCreditNote.balance);console.log(selectedCreditNoteAmount);var pay_amt_setup=0;if(selectedCreditNoteAmount<=parseFloat(txtUserPayAmount)){pay_amt_setup=selectedCreditNoteAmount;}else{pay_amt_setup=txtUserPayAmount;}var payTypeId=17;selectedCards.push({pay_typeid:payTypeId,prepaid:false,pay_amt:parseFloat(pay_amt_setup),credit_debit:false,pay_premise:false,pay_rem1:selectedCreditNote.credit_code,pay_rem2:selectedCreditNote.transaction,pay_rem4:_this.state.pay_rem4,gt_group:false});console.log(\"BeforeAdd-displayTableCreditNote\",_this.state.displayTableCreditNote);var setdisplayTableCreditNote=_this.state.displayTableCreditNote;setdisplayTableCreditNote.push(selectedCreditNote.credit_code);_this.setState({displayTableCreditNote:setdisplayTableCreditNote});console.log(\"AfterAdd-displayTableCreditNote\",_this.state.displayTableCreditNote);_this.HideCreditNoteTableData();balance=parseFloat(balance-pay_amt_setup).toFixed(2);_this.setState({isOpenSubPayment:false});_this.setBalanceToAllTextBoxes(balance);};_this.removeCards=function(idx){return function(){var _this$state9=_this.state,selectedCards=_this$state9.selectedCards,balance=_this$state9.balance,cardField=_this$state9.cardField,ewalletField=_this$state9.ewalletField,itemProductServiceVoucherAmount=_this$state9.itemProductServiceVoucherAmount,itemProductAmount=_this$state9.itemProductAmount,itemServiceAmount=_this$state9.itemServiceAmount;_this.setState({isMakePaymentButtonClicked:\"false\"});balance=parseFloat(balance)+parseFloat(idx.pay_amt);var array=_toConsumableArray(selectedCards);// make a separate copy of the array\nvar index=array.indexOf(idx);if(idx.pay_typeid==23){if(idx.prepaid_ct==\"Product Only\"){itemProductAmount=itemProductAmount+idx.pay_amt;}else if(idx.prepaid_ct==\"Service Only\"){itemServiceAmount=itemServiceAmount+idx.pay_amt;}else{itemProductServiceVoucherAmount=itemProductServiceVoucherAmount+idx.pay_amt;}_this.setState({itemProductServiceVoucherAmount:itemProductServiceVoucherAmount,itemProductAmount:itemProductAmount,itemServiceAmount:itemServiceAmount});}if(index!==-1){array.splice(index,1);_this.setState({selectedCards:array,balance:balance});}//console.log(\"idx\", idx);\nvar removedTerm=idx.pay_typeid;//console.log(\"removedTerm\", removedTerm);\n//console.log(\"idx.pay_rem2\", idx.pay_rem2);\nif(removedTerm==\"23\"){var items=_this.state.displayTablePrepaid;console.log(\"BeforeRemove-displayTablePrepaid\",items);var valueToRemove=idx.pay_rem2;//For Prepaid Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",valueToRemove);var filteredItems=items.filter(function(item){return item!==valueToRemove;});_this.setState({displayTablePrepaid:filteredItems},function(){console.log(\"AfterRemove-displayTablePrepaid\",_this.state.displayTablePrepaid);});_this.getPrepaidAccountData(\"\");// this.HidePrepaidTableData();\n}if(removedTerm==\"17\"){var _items=_this.state.displayTableCreditNote;console.log(\"BeforeRemove-displayTableCreditNote\",_items);var _valueToRemove=idx.pay_rem1;//For Credit Note Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",_valueToRemove);var _filteredItems=_items.filter(function(item){return item!==_valueToRemove;});_this.setState({displayTableCreditNote:_filteredItems},function(){console.log(\"AfterRemove-displayTableCreditNote\",_this.state.displayTableCreditNote);});_this.getCreditNoteAccountData(\"\");// this.HidePrepaidTableData();\n}if(removedTerm==\"9\"){var _items2=_this.state.displayTableVoucher;console.log(\"BeforeRemove-displayTableVoucher\",_items2);var _valueToRemove2=idx.pay_rem1;//For Credit Note Ony we have added unique id here\nconsole.log(\"BeforeRemove-valueToRemove\",_valueToRemove2);var _filteredItems2=_items2.filter(function(item){return item!==_valueToRemove2;});_this.setState({displayTableVoucher:_filteredItems2},function(){console.log(\"AfterRemove-displayTableVoucher\",_this.state.displayTableVoucher);});_this.getVoucherData(\"\");}cardField[\"pay_amt\"]=balance;ewalletField[\"pay_amt\"]=balance;_this.setBalanceToAllTextBoxes(balance);};};_this.addNewPaymentData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(selPayTypeId,selPayTypeName){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(_this.validator.fieldValid(\"Amount\")){_context3.next=3;break;}_this.validator.showMessageFor(\"Amount\");return _context3.abrupt(\"return\");case 3:if(_this.validator.fieldValid(\"Amount\")){_context3.next=6;break;}_this.validator.showMessageFor(\"Amount\");return _context3.abrupt(\"return\");case 6:_this.props.getCommonApi(\"paytablenew/?paygroupid=\".concat(selPayTypeId)).then(function(res){_this.setState({paytableData:[]});var _this$state10=_this.state,paytableData=_this$state10.paytableData,isSelectedPaymentType=_this$state10.isSelectedPaymentType,displayModelPaymentType=_this$state10.displayModelPaymentType;isSelectedPaymentType=selPayTypeName.trim();displayModelPaymentType=selPayTypeName.trim();var _iterator2=_createForOfIteratorHelper(res.data),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var key=_step2.value;paytableData.push({label:key.pay_description,value:key.id});}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}_this.setState({paytableData:paytableData},function(){var isOpenSubPayment=_this.state.isOpenSubPayment;if(paytableData.length==0){Toast({type:\"error\",message:\"Pay Table Not Exists\"});return;}else if(selPayTypeName.trim()===\"VOUCHER\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"PREPAID\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"Credit\"){isOpenSubPayment=true;}else if(selPayTypeName.trim()===\"CARD\"){isOpenSubPayment=true;}else if(paytableData.length==1){isOpenSubPayment=false;var payTypeId=paytableData[0].value;var _this$state11=_this.state,balance=_this$state11.balance,selectedCards=_this$state11.selectedCards,txtUserPayAmount=_this$state11.txtUserPayAmount;if(parseFloat(_this.state.responseData.billable_amount)>0){if(parseFloat(txtUserPayAmount)==0){return;}}if(_this.checkPayTypeIdAlreadyExists(payTypeId)){var result=_this.getPayTableNameBasedOnId(payTypeId)+\" already exists\";Toast({type:\"error\",message:result});//alert(\"Already Exists\");\nreturn;}else{selectedCards.push({pay_typeid:payTypeId,pay_amt:parseFloat(txtUserPayAmount),credit_debit:false,pay_premise:true,prepaid:false,pay_rem4:_this.state.pay_rem4,gt_group:false});balance=parseFloat(balance-txtUserPayAmount).toFixed(2);txtUserPayAmount=balance;_this.setState({txtUserPayAmount:txtUserPayAmount,balance:balance});return;}}else if(paytableData.length>=1){isOpenSubPayment=true;isSelectedPaymentType=\"Multiple\";}_this.setState({isOpenSubPayment:isOpenSubPayment,isSelectedPaymentType:isSelectedPaymentType,displayModelPaymentType:displayModelPaymentType});});});case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2,_x3){return _ref6.apply(this,arguments);};}();_this.handleDialog=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var isOpenSubPayment;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:isOpenSubPayment=_this.state.isOpenSubPayment;isOpenSubPayment=false;_context4.next=4;return _this.setState({isOpenSubPayment:isOpenSubPayment});case 4:case\"end\":return _context4.stop();}}},_callee4);}));_this.handleChangeCard=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref8){var _ref8$target,value,name,cardField;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_ref8$target=_ref8.target,value=_ref8$target.value,name=_ref8$target.name;cardField=Object.assign({},_this.state.cardField);cardField[name]=value;_context5.next=5;return _this.setState({cardField:cardField});case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref9.apply(this,arguments);};}();_this.handleDatePick=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref10){var _ref10$target,value,name,DateofPay,DatePayment;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_ref10$target=_ref10.target,value=_ref10$target.value,name=_ref10$target.name;DateofPay=_this.state.DateofPay;DateofPay=value;_context6.next=5;return _this.setState({DateofPay:DateofPay});case 5:DatePayment={};DatePayment[\"DateofPayment\"]=value;_context6.next=9;return _this.props.updateForm(\"CartPaymentDate\",DatePayment);case 9:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x5){return _ref11.apply(this,arguments);};}();return _this;}_createClass(ChangePaymentClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.getFullPayTable();this.getPayGroup();this.getPayment();}},{key:\"handleChangeTextBox\",value:function handleChangeTextBox(event){this.setState({txtUserPayAmount:event.target.value});}},{key:\"handleChangeRemarkBox\",value:function handleChangeRemarkBox(event){this.setState({pay_rem4:event.target.value});}},{key:\"checkPayTypeIdAlreadyExists\",value:function checkPayTypeIdAlreadyExists(val){return this.state.selectedCards.some(function(item){return val===item.pay_typeid;});}},{key:\"HidePrepaidTableData\",value:function HidePrepaidTableData(){var _this2=this;var _this$state12=this.state,prepaidCustomerData=_this$state12.prepaidCustomerData,displayTablePrepaid=_this$state12.displayTablePrepaid;displayTablePrepaid.map(function(item){var selectedPrepaid=prepaidCustomerData.filter(function(prepaid){return prepaid.id!=item;});_this2.setState({prepaidCustomerData:selectedPrepaid});});}},{key:\"HideCreditNoteTableData\",value:function HideCreditNoteTableData(){var _this3=this;var _this$state13=this.state,creditNoteCustomerData=_this$state13.creditNoteCustomerData,displayTableCreditNote=_this$state13.displayTableCreditNote;displayTableCreditNote.map(function(item){var selectedCreditNote=creditNoteCustomerData.filter(function(creditNote){return creditNote.credit_code!=item;});_this3.setState({creditNoteCustomerData:selectedCreditNote});});}},{key:\"HideVoucherTableData\",value:function HideVoucherTableData(){var _this4=this;var _this$state14=this.state,voucherCustomerData=_this$state14.voucherCustomerData,displayTableVoucher=_this$state14.displayTableVoucher;displayTableVoucher.map(function(item){var selectedVoucher=voucherCustomerData.filter(function(voucher){return voucher.voucher_no!=item;});_this4.setState({voucherCustomerData:selectedVoucher});});}},{key:\"setBalanceToAllTextBoxes\",value:function setBalanceToAllTextBoxes(balance){this.setState({balance:balance,txtUserPayAmount:balance});}},{key:\"checkTypeOfCartItemContainsDeposit\",value:function checkTypeOfCartItemContainsDeposit(cartData){var _this5=this;var stringifiedCartData=cartData.data;if(stringifiedCartData){stringifiedCartData.map(function(item){if(item.type===\"Deposit\"||item.type===\"Top Up\"){_this5.state.isTreatmentDoneButton=false;}});}}},{key:\"render\",value:function render(){var _this6=this;var _this$state15=this.state,responseData=_this$state15.responseData,balance=_this$state15.balance,payGroupData=_this$state15.payGroupData,paytableData=_this$state15.paytableData,isOpenSubPayment=_this$state15.isOpenSubPayment,isSelectedPaymentType=_this$state15.isSelectedPaymentType,displayModelPaymentType=_this$state15.displayModelPaymentType,cardField=_this$state15.cardField,pay_rem4=_this$state15.pay_rem4,DateofPay=_this$state15.DateofPay,MinimumDate=_this$state15.MinimumDate,is_paymentdate=_this$state15.is_paymentdate,isMakePaymentLoading=_this$state15.isMakePaymentLoading;var t=this.props.t;var payTableDropDownValue=this.state.formFields.payTableDropDownValue;console.log(payTableDropDownValue);var insideRadioButtonData;console.log(isSelectedPaymentType,\"selectedpaymenttype\");if(isSelectedPaymentType==\"VOUCHER\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Vocucher No\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Value\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Exp. Date\"))),this.state.voucherCustomerData.map(function(selectedVoucher,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addVoucher.bind(_this6,selectedVoucher)},/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.voucher_no),/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.value),/*#__PURE__*/React.createElement(\"td\",null,selectedVoucher.issued_expiry_date));})));}else if(isSelectedPaymentType==\"PREPAID\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Category\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Amount\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Remaining\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Invoice No.\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Exp. Date\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Condition Type\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Use Amount\"))),this.state.prepaidCustomerData.map(function(selectedPrepaid,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addPrepaid.bind(_this6,selectedPrepaid)},/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.pp_desc),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.pp_total),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.remain),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.prepaid),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.exp_date),/*#__PURE__*/React.createElement(\"td\",null,selectedPrepaid.conditiontype1),/*#__PURE__*/React.createElement(\"td\",{className:\"text-right\"},selectedPrepaid.Finaluse_amt));})));}else if(isSelectedPaymentType==\"Credit\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,t(\"Credit\"),\" #\"),/*#__PURE__*/React.createElement(\"td\",null,t(\"Date\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Amount\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Balance\")),/*#__PURE__*/React.createElement(\"td\",null,t(\"Status\"))),this.state.creditNoteCustomerData.map(function(creditNote,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index,style:{cursor:\"pointer\"},onClick:_this6.addCreditNote.bind(_this6,creditNote)},/*#__PURE__*/React.createElement(\"td\",null,creditNote.credit_code),/*#__PURE__*/React.createElement(\"td\",null,creditNote.sa_date),/*#__PURE__*/React.createElement(\"td\",null,creditNote.amount),/*#__PURE__*/React.createElement(\"td\",null,creditNote.balance),/*#__PURE__*/React.createElement(\"td\",null,creditNote.status));})));}else if(isSelectedPaymentType==\"CARD\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-start\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Select Card\"),/*#__PURE__*/React.createElement(NormalSelect,{placeholder:\"Search type...\",options:paytableData,value:cardField.pay_typeid,name:\"pay_typeid\",onChange:this.handleCreditChange})),this.validator.message(\"cardFieldType\",cardField.pay_typeid,\"required\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Card No.\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.pay_rem1,name:\"pay_rem1\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Name\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.pay_rem2,name:\"pay_rem2\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Exp Month\"),\" / \",t(\"Year\"),/*#__PURE__*/React.createElement(NormalInput,{placeholder:\"mm/YYYY\",value:cardField.pay_rem3,name:\"pay_rem3\",onChange:this.handleChangeCard}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},t(\"Approval Code\"),/*#__PURE__*/React.createElement(NormalInput,{value:cardField.App_code,name:\"App_code\",onChange:this.handleChangeCard})))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalButton,{mainbg:false,className:\"col-12 mt-4 ml-2 btn-outline-success\",label:\"CONFIRM\",onClick:function onClick(){return _this6.addCreditCard();}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}))));}else if(isSelectedPaymentType==\"Multiple\"){insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(Label,{className:\"col-12 fs-15\"},t(\"Choose Option\")),/*#__PURE__*/React.createElement(NormalSelect,{placeholder:\"Search type...\",options:paytableData,value:payTableDropDownValue,name:\"payTableDropDownValue\",onChange:this.handleChange})))));}else{insideRadioButtonData=/*#__PURE__*/React.createElement(\"div\",null);}var payGroupDataContent=[];console.log(payGroupData);payGroupData.forEach(function(item,i){payGroupDataContent.push(/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 col-4 payment-item cursor-pointer\",style:{width:\"50px\",padding:\"15px\"},key:i,onClick:function onClick(){return _this6.addNewPaymentData(item.value,item.label);}},/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"img\",{src:helpers.getUrl()+\"media/\"+item.picturelocation,label:item.label,style:{textAlign:\"center\"},width:\"40\",height:\"40\"})),/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"p\",{style:{width:\"100px\",textAlign:\"center\"}},item.label))));});var _this$props=this.props,cartId=_this$props.cartId,cartData=_this$props.cartData,tokenDetails=_this$props.tokenDetails;console.log(cartId,tokenDetails,this.props.cartData);//this.checkTypeOfCartItemContainsDeposit(cartData);\nvar userAddedPayTableData=/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered\"},this.state.selectedCards.map(function(selectedCards,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",{className:\"fs-18\"},selectedCards.pay_desc?selectedCards.pay_desc:_this6.getPayTableNameBasedOnId(selectedCards.pay_typeid)),/*#__PURE__*/React.createElement(\"td\",{className:\"fs-18\",style:{textAlign:\"right\"}},selectedCards.pay_amt.toFixed(2)),/*#__PURE__*/React.createElement(\"td\",null,!selectedCards.gt_group?/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 p-0 fs-20 cursor-pointer\",onClick:_this6.removeCards(selectedCards)},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-delete\"})):null));}));return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12 mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},t(\"Enter Amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput,{value:this.state.txtUserPayAmount,onChange:this.handleChangeTextBox.bind(this)}),this.validator.message(\"Amount\",this.state.txtUserPayAmount,\"required|numeric|min:0,num\"),this.validator.message(\"Amount\",this.state.txtUserPayAmount,\"required|numeric|max:\"+this.state.balance+\",num\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-12 mb-2\"},/*#__PURE__*/React.createElement(Label,null,t(\"Remark\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput,{value:pay_rem4,name:\"pay_rem4\",onChange:this.handleChangeRemarkBox.bind(this)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12 mb-2\"},is_paymentdate?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Label,null,t(\"Date\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalDate,{value:new Date(DateofPay),name:\"DateofPay\",type:\"date\",onChange:this.handleDatePick,minDate:new Date(MinimumDate),maxDate:new Date(),showDisabledMonthNavigation:true}))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"make-payment mt-3 text-center\"},isMakePaymentLoading?/*#__PURE__*/React.createElement(\"div\",{class:\"d-flex align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},t(\"Loading...\")))):this.state.isMakePaymentButtonClicked==\"true\"?/*#__PURE__*/React.createElement(NormalButton,{submitBtn:true,className:\"col-12\",label:\"Make payment\",disabled:true}):/*#__PURE__*/React.createElement(NormalButton,{submitBtn:true,className:\"col-12\",label:\"Make payment\",onClick:function onClick(){return _this6.handleSubmit();},disabled:this.state.selectedCards.length<=0||balance>0}))))),/*#__PURE__*/React.createElement(\"h4\",null,t(\"Select Payment Method\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row paymentGroup\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},payGroupData.length>0?payGroupData.map(function(item,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 col-4 payment-item cursor-pointer\",style:{width:\"50px\",padding:\"15px\"},key:index,onClick:function onClick(){return _this6.addNewPaymentData(item.value,item.label);}},/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"img\",{src:helpers.getUrl()+\"media/\"+item.picturelocation,label:item.label,style:{textAlign:\"center\"},width:\"40\",height:\"40\"})),/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"p\",{style:{width:\"100px\",textAlign:\"center\"}},item.label)));}):/*#__PURE__*/React.createElement(React.Fragment,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 make-payment-section\"},/*#__PURE__*/React.createElement(\"p\",{className:\"h6\"},t(\"List of Selections\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 mt-1 mb-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex payment\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-7 p-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap fs-14\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Subtotal\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.subtotal),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Discount ($)\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.discount),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Transac amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.trans_amt),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},t(\"Deposit\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.deposit_amt),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},responseData.tax_lable),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",responseData.tax_amt))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 fs-22 text-center\"},t(\"Billing Amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 fs-22 fw-700 text-center text-orenge\"},\"$ \",responseData.billable_amount),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 f-600 text-center mt-2\"},t(\"Balance Amount\"),\": \",Number(balance).toFixed(2))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 mt-2 payment-list\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fs-12\"},userAddedPayTableData)))),/*#__PURE__*/React.createElement(NormalModal,{className:\"payment-modal\",style:{minWidth:\"70%\"},modal:isOpenSubPayment,handleModal:this.handleDialog},/*#__PURE__*/React.createElement(\"img\",{onClick:this.handleDialog,className:\"close cursor-pointer\",src:closeIcon,alt:\"\"}),/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"fs-18 f-600\"},displayModelPaymentType)),/*#__PURE__*/React.createElement(\"br\",null),insideRadioButtonData));}}]);return ChangePaymentClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{appointmentDetail:state.appointment.appointmentDetail,selected_cstomer:state.common.selected_cstomer,tokenDetails:state.authStore.tokenDetails,CartPaymentDate:state.appointment.CartPaymentDate};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getPayment:getPayment,getCommonApi:getCommonApi,createPayment:createPayment,updateForm:updateForm},dispatch);};export var ChangePayment=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(ChangePaymentClass));","map":{"version":3,"sources":["F:/webfe/src/component/Admin/TransactionHistory/ChangePayment.js"],"names":["React","Component","NormalInput","NormalTextarea","NormalButton","NormalSelect","NormalDate","NormalModal","NormalDateTime","Button","Form","FormGroup","Label","Input","FormText","getPayment","createPayment","connect","bindActionCreators","history","getCommonApi","updateForm","dateFormat","SimpleReactValidator","closeIcon","helpers","Toast","withTranslation","moment","ChangePaymentClass","state","formFields","name","contact","address","searchStaff","payTableDropDownValue","responseData","premisesOption","selectedCards","selectedCardsPayAmount","cardOption","ewalletoptions","ewalletField","pay_typeid","pay_amt","credit_debit","cardField","pay_rem1","pay_rem2","pay_rem3","pay_rem4","App_code","balance","errorMessage","prepaidCustomerData","voucherCustomerData","creditNoteCustomerData","accountHeader","isMakePaymentButtonClicked","itemProductAmount","itemServiceAmount","itemProductServiceVoucherAmount","displayTablePrepaid","displayTableCreditNote","displayTableVoucher","paytableData","paytableFullData","payGroupData","selectPaymentGroup","selectPaymentGroupId","isSelectedPaymentType","displayModelPaymentType","txtUserPayAmount","isOpenSubPayment","DateofPay","Date","MinimumDate","is_paymentdate","isMakePaymentLoading","componentWillMount","validator","element","message","autoForceUpdate","TransactionId","props","then","res","console","log","data","status","pay_list","setState","Number","billable_amount","forEach","item","push","parseFloat","pay_premise","prepaid","pay_desc","gt_group","prepaid_ct","toFixed","handleMultiple","target","value","Object","assign","getPayGroup","key","label","pay_group_code","id","picturelocation","getFullPayTable","getPayTableNameBasedOnId","payTableId","test","filter","pay_description","handleChange","handleCreditChange","handleSubmit","sa_transacno","addCreditCard","fieldValid","showMessageFor","userPayAmount","checkPayTypeIdAlreadyExists","result","type","setBalanceToAllTextBoxes","addPrepaid","selectedPrepaid","prepaidExpDate","exp_date","format","todaysDate","isValid","isSameOrAfter","selectedRemainingPrepaidAmount","remain","conditiontype1","payTypeId","pp_no","line_no","pp_desc","setdisplayTablePrepaid","HidePrepaidTableData","addVoucher","selectedVoucher","selectedVoucherAmount","pay_amt_setup","voucher_no","setdisplayTableVoucher","HideVoucherTableData","addCreditNote","selectedCreditNote","selectedCreditNoteAmount","credit_code","transaction","setdisplayTableCreditNote","HideCreditNoteTableData","removeCards","idx","array","index","indexOf","splice","removedTerm","items","valueToRemove","filteredItems","getPrepaidAccountData","getCreditNoteAccountData","getVoucherData","addNewPaymentData","selPayTypeId","selPayTypeName","trim","length","handleDialog","handleChangeCard","handleDatePick","DatePayment","event","val","some","map","creditNote","voucher","cartData","stringifiedCartData","isTreatmentDoneButton","t","insideRadioButtonData","cursor","bind","issued_expiry_date","pp_total","Finaluse_amt","sa_date","amount","payGroupDataContent","i","width","padding","getUrl","textAlign","cartId","tokenDetails","userAddedPayTableData","handleChangeTextBox","handleChangeRemarkBox","subtotal","discount","trans_amt","deposit_amt","tax_lable","tax_amt","minWidth","mapStateToProps","appointmentDetail","appointment","selected_cstomer","common","authStore","CartPaymentDate","mapDispatchToProps","dispatch","ChangePayment"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  NormalInput,\r\n  NormalTextarea,\r\n  NormalButton,\r\n  NormalSelect,\r\n  NormalDate,\r\n  NormalModal,\r\n  NormalDateTime,\r\n} from \"component/common\";\r\nimport { Button, Form, FormGroup, Label, Input, FormText } from \"reactstrap\";\r\nimport { getPayment, createPayment } from \"redux/actions/payment\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { history } from \"helpers\";\r\nimport { getCommonApi, updateForm } from \"redux/actions/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport \"./style.scss\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\nimport closeIcon from \"assets/images/close.png\";\r\nimport helpers from \"../../../service/Helper\";\r\nimport { Toast } from \"service/toast\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport moment from \"moment\";\r\n\r\nexport class ChangePaymentClass extends Component {\r\n  state = {\r\n    formFields: {\r\n      name: \"\",\r\n      contact: \"\",\r\n      address: \"\",\r\n      searchStaff: \"\",\r\n      payTableDropDownValue: \"\",\r\n    },\r\n    responseData: {},\r\n\r\n    premisesOption: [],\r\n    selectedCards: [],\r\n    selectedCardsPayAmount: 0,\r\n    cardOption: [],\r\n    ewalletoptions: [],\r\n\r\n    ewalletField: {\r\n      pay_typeid: null,\r\n      pay_amt: \"\",\r\n      credit_debit: true,\r\n    },\r\n    cardField: {\r\n      pay_typeid: null,\r\n      pay_amt: \"\",\r\n      credit_debit: true,\r\n      pay_rem1: \"\",\r\n      pay_rem2: \"\",\r\n      pay_rem3: \"\",\r\n      pay_rem4: \"\",\r\n      App_code: \"\",\r\n    },\r\n    balance: 0,\r\n    errorMessage: \"123\",\r\n    prepaidCustomerData: [],\r\n    voucherCustomerData: [],\r\n    creditNoteCustomerData: [],\r\n    accountHeader: [],\r\n    isMakePaymentButtonClicked: \"false\",\r\n    itemProductAmount: 0,\r\n    itemServiceAmount: 0,\r\n    itemProductServiceVoucherAmount: 0,\r\n    displayTablePrepaid: [],\r\n    displayTableCreditNote: [],\r\n    displayTableVoucher: [],\r\n    paytableData: [],\r\n    paytableFullData: [],\r\n    payGroupData: [],\r\n    selectPaymentGroup: \"\",\r\n    selectPaymentGroupId: \"\",\r\n    isSelectedPaymentType: \"\",\r\n    displayModelPaymentType: \"\",\r\n    txtUserPayAmount: 0,\r\n    isOpenSubPayment: false,\r\n    pay_rem4: \"\",\r\n    DateofPay: new Date(),\r\n    MinimumDate: new Date(),\r\n    is_paymentdate: false,\r\n    isMakePaymentLoading: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getFullPayTable();\r\n    this.getPayGroup();\r\n    this.getPayment();\r\n  }\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n  };\r\n  // get method for payment detail against appointment\r\n  getPayment = () => {\r\n    let { TransactionId } = this.props;\r\n    let { selectedCards } = this.state;\r\n    this.props\r\n      .getPayment(`paymentlist/?sa_transacno=${TransactionId}`)\r\n      .then(res => {\r\n        console.log(\"Payment Details:\", res);\r\n        let { balance, selectedCards, txtUserPayAmount, isOpenSubPayment } =\r\n          this.state;\r\n        let { data, status, pay_list } = res;\r\n        if (status === 200) {\r\n          this.setState({\r\n            responseData: data,\r\n            balance: Number(data.billable_amount),\r\n            txtUserPayAmount: Number(data.billable_amount),\r\n          });\r\n          pay_list.forEach(item => {\r\n            if (Number(item.pay_typeid) == 2) {\r\n              selectedCards.push({\r\n                pay_typeid: item.pay_typeid,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                prepaid: item.prepaid,\r\n                credit_debit: item.credit_debit,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            } else if (Number(item.pay_typeid) == 4) {\r\n              selectedCards.push({\r\n                credit_debit: item.credit_debit,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                pay_rem1: item.pay_rem1,\r\n                pay_rem2: item.pay_rem2,\r\n                pay_rem3: item.pay_rem3,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_typeid: item.pay_typeid,\r\n                prepaid: item.prepaid,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            } else if (Number(item.pay_typeid) == 17) {\r\n              selectedCards.push({\r\n                credit_debit: item.credit_debit,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                pay_rem1: item.pay_rem1,\r\n                pay_rem2: item.pay_rem2,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_typeid: item.pay_typeid,\r\n                prepaid: item.prepaid,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            } else if (Number(item.pay_typeid) == 23) {\r\n              selectedCards.push({\r\n                credit_debit: item.credit_debit,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                pay_rem1: item.pay_rem1,\r\n                pay_rem2: item.pay_rem2,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_typeid: item.pay_typeid,\r\n                prepaid: item.prepaid,\r\n                prepaid_ct: item.prepaid_ct,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            } else if (Number(item.pay_typeid) == 9) {\r\n              selectedCards.push({\r\n                credit_debit: item.credit_debit,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                pay_rem1: item.pay_rem1,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_typeid: item.pay_typeid,\r\n                prepaid: item.prepaid,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            } else {\r\n              selectedCards.push({\r\n                credit_debit: item.credit_debit,\r\n                pay_amt: parseFloat(item.pay_amt),\r\n                pay_premise: item.pay_premise,\r\n                pay_rem1: item.pay_rem1,\r\n                pay_rem2: item.pay_rem2,\r\n                pay_rem3: item.pay_rem3,\r\n                pay_rem4: item.pay_rem4,\r\n                pay_typeid: item.pay_typeid,\r\n                prepaid: item.prepaid,\r\n                pay_desc: item.pay_desc,\r\n                gt_group: item.gt_group,\r\n              });\r\n            }\r\n            balance = parseFloat(balance - txtUserPayAmount).toFixed(2);\r\n            txtUserPayAmount = balance;\r\n            this.setState({ txtUserPayAmount, balance });\r\n          });\r\n        }\r\n      });\r\n  };\r\n\r\n  handleMultiple = ({ target: { value, name } }) => {\r\n    console.log(\"handleMultiple\", value, name);\r\n    let formFields = Object.assign({}, this.state.formFields);\r\n\r\n    formFields[name] = value;\r\n\r\n    this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n\r\n  getPayGroup = () => {\r\n    this.props.getCommonApi(`paygroup/?gt_group=GT1`).then(res => {\r\n      console.log(res, \"paygroupresponse\");\r\n      let { payGroupData } = this.state;\r\n      for (let key of res.data) {\r\n        payGroupData.push({\r\n          label: key.pay_group_code,\r\n          value: key.id,\r\n          picturelocation: key.picturelocation,\r\n        });\r\n      }\r\n      this.setState({\r\n        payGroupData,\r\n      });\r\n    });\r\n  };\r\n  getFullPayTable = () => {\r\n    this.props.getCommonApi(`paytablenew/`).then(async res => {\r\n      let { paytableFullData } = this.state;\r\n      paytableFullData = res.data;\r\n      console.log(res.data, \"responseforGetfullpaytable\");\r\n      await this.setState({\r\n        paytableFullData,\r\n      });\r\n    });\r\n  };\r\n\r\n  getPayTableNameBasedOnId = payTableId => {\r\n    debugger;\r\n    // gt_group: \"GT1\"\r\n    // id: 6\r\n    // pay_code: \"UOBPN\"\r\n    // pay_description: \"UOB PAYNOW\"\r\n    // pay_group_name: \"UOB\"\r\n    // pay_groupid: 22\r\n\r\n    // if (\r\n    //   isSelectedPaymentType == \"VOUCHER\" ||\r\n    //   isSelectedPaymentType == \"PREPAID\" ||\r\n    //   isSelectedPaymentType == \"Credit\" ||\r\n    //   isSelectedPaymentType == \"OLD BILL\"\r\n    // ) {\r\n    //   const test = paytableFullData.filter(\r\n    //     res => res.pay_group_name.trim() == isSelectedPaymentType.trim()\r\n    //   );\r\n    //   return test[0].pay_description;\r\n    // } else {\r\n    const test = this.state.paytableFullData.filter(\r\n      res => res.id == payTableId\r\n    );\r\n    console.log(test, \"Filtered payment data\");\r\n    return test[0].pay_description;\r\n\r\n    // }\r\n  };\r\n\r\n  handleChangeTextBox(event) {\r\n    this.setState({\r\n      txtUserPayAmount: event.target.value,\r\n    });\r\n  }\r\n  handleChangeRemarkBox(event) {\r\n    this.setState({\r\n      pay_rem4: event.target.value,\r\n    });\r\n  }\r\n  handleChange = ({ target: { value, name } }) => {\r\n    let formFields = Object.assign({}, this.state.formFields);\r\n\r\n    formFields[name] = value;\r\n    this.setState({\r\n      formFields,\r\n    });\r\n    let { balance, selectedCards, txtUserPayAmount, isOpenSubPayment } =\r\n      this.state;\r\n    isOpenSubPayment = false;\r\n    selectedCards.push({\r\n      pay_typeid: value,\r\n      pay_amt: parseFloat(txtUserPayAmount),\r\n      credit_debit: false,\r\n      pay_premise: true,\r\n      prepaid: false,\r\n      pay_rem4: this.state.pay_rem4,\r\n      gt_group: false,\r\n    });\r\n    balance = parseFloat(balance - txtUserPayAmount).toFixed(2);\r\n    txtUserPayAmount = balance;\r\n    this.setState({ txtUserPayAmount, balance, isOpenSubPayment });\r\n  };\r\n  handleCreditChange = ({ target: { value, name } }) => {\r\n    let cardField = Object.assign({}, this.state.cardField);\r\n\r\n    cardField[name] = value;\r\n    this.setState({\r\n      cardField,\r\n    });\r\n  };\r\n  // create payment detail\r\n  handleSubmit = () => {\r\n    this.setState({\r\n      isMakePaymentLoading: true,\r\n    });\r\n    let { selectedCards, DateofPay } = this.state;\r\n    this.setState({ isMakePaymentButtonClicked: \"true\" });\r\n\r\n    let data = selectedCards;\r\n    console.log(\"SubmitDatapayment\", data);\r\n    let { TransactionId } = this.props;\r\n    this.props\r\n      .createPayment(`changepayment/?sa_transacno=${TransactionId}`, data)\r\n      .then(res => {\r\n        this.setState({\r\n          isMakePaymentLoading: false,\r\n        });\r\n        history.push(`/admin/billing/print/bill/${res.data.sa_transacno}`);\r\n      });\r\n    this.setState({\r\n      isMakePaymentLoading: false,\r\n    });\r\n  };\r\n  checkPayTypeIdAlreadyExists(val) {\r\n    return this.state.selectedCards.some(item => val === item.pay_typeid);\r\n  }\r\n  addCreditCard = async () => {\r\n    if (!this.validator.fieldValid(\"cardFieldType\")) {\r\n      this.validator.showMessageFor(\"cardFieldType\");\r\n      return;\r\n    }\r\n\r\n    let { cardField, selectedCards, balance, responseData, txtUserPayAmount } =\r\n      this.state;\r\n    let userPayAmount = parseFloat(txtUserPayAmount);\r\n    if (parseFloat(this.state.responseData.billable_amount) > 0) {\r\n      if (userPayAmount == 0) {\r\n        return;\r\n      }\r\n    }\r\n    if (this.checkPayTypeIdAlreadyExists(cardField.pay_typeid)) {\r\n      let result =\r\n        this.getPayTableNameBasedOnId(cardField.pay_typeid) + \" already exists\";\r\n      Toast({\r\n        type: \"error\",\r\n        message: result,\r\n      });\r\n\r\n      return;\r\n    } else {\r\n      selectedCards.push({\r\n        pay_typeid: cardField.pay_typeid,\r\n        pay_amt: userPayAmount,\r\n        credit_debit: true,\r\n        pay_premise: false,\r\n        pay_rem1: cardField.pay_rem1,\r\n        pay_rem2: cardField.pay_rem2,\r\n        pay_rem3: cardField.pay_rem3,\r\n        pay_rem4: this.state.pay_rem4,\r\n        prepaid: false,\r\n        gt_group: false,\r\n      });\r\n    }\r\n\r\n    balance = parseFloat(balance - userPayAmount).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  addPrepaid = selectedPrepaid => {\r\n    const prepaidExpDate = moment(selectedPrepaid.exp_date).format(\r\n      \"YYYY-MM-DD\"\r\n    );\r\n    const todaysDate = moment(new Date()).format(\"YYYY-MM-DD\");\r\n    const isValid = moment(todaysDate).isSameOrAfter(prepaidExpDate);\r\n    let userPayAmount = 0;\r\n    let {\r\n      itemServiceAmount,\r\n      itemProductAmount,\r\n      itemProductServiceVoucherAmount,\r\n      txtUserPayAmount,\r\n    } = this.state;\r\n    console.log(txtUserPayAmount);\r\n    userPayAmount = parseFloat(txtUserPayAmount);\r\n    if (isValid) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Check Expiry Date\",\r\n      });\r\n      return;\r\n    }\r\n    if (userPayAmount <= 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Prepaid is Not allowed\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    let selectedRemainingPrepaidAmount = parseFloat(selectedPrepaid.remain);\r\n\r\n    if (selectedRemainingPrepaidAmount < userPayAmount) {\r\n      //return\r\n    } else if (selectedRemainingPrepaidAmount > userPayAmount) {\r\n      selectedRemainingPrepaidAmount = parseFloat(userPayAmount);\r\n    }\r\n\r\n    if (selectedPrepaid.conditiontype1 === \"Service Only\") {\r\n      //For Service\r\n      if (parseFloat(itemServiceAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is Not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (parseFloat(itemServiceAmount) <= selectedRemainingPrepaidAmount) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) < parseFloat(itemServiceAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemServiceAmount);\r\n        console.log(itemServiceAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemServiceAmount = itemServiceAmount - userPayAmount;\r\n      this.setState({ itemServiceAmount });\r\n    } else if (selectedPrepaid.conditiontype1 === \"Product Only\") {\r\n      //For Product\r\n      if (parseFloat(itemProductAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (parseFloat(itemProductAmount) <= selectedRemainingPrepaidAmount) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) < parseFloat(itemProductAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemProductAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemProductAmount = itemProductAmount - userPayAmount;\r\n      this.setState({ itemProductAmount });\r\n    } else {\r\n      if (parseFloat(itemProductServiceVoucherAmount) == 0) {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Prepaid is not allowed\",\r\n        });\r\n        return;\r\n      }\r\n      if (\r\n        parseFloat(itemProductServiceVoucherAmount) <=\r\n        selectedRemainingPrepaidAmount\r\n      ) {\r\n        userPayAmount =\r\n          parseFloat(txtUserPayAmount) <\r\n          parseFloat(itemProductServiceVoucherAmount)\r\n            ? parseFloat(txtUserPayAmount)\r\n            : parseFloat(itemProductServiceVoucherAmount);\r\n        console.log(userPayAmount);\r\n      } else {\r\n        userPayAmount = selectedRemainingPrepaidAmount;\r\n        console.log(userPayAmount);\r\n      }\r\n      itemProductServiceVoucherAmount =\r\n        itemProductServiceVoucherAmount - userPayAmount;\r\n      this.setState({ itemProductServiceVoucherAmount });\r\n    }\r\n    if (userPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Prepaid is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const payTypeId = 23;\r\n    let { cardField, ewalletField, balance, selectedCards, isOpenSubPayment } =\r\n      this.state;\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: true,\r\n      pay_amt: userPayAmount,\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1:\r\n        selectedPrepaid.pp_no +\r\n        \" - \" +\r\n        selectedPrepaid.line_no +\r\n        \" - \" +\r\n        selectedPrepaid.pp_desc,\r\n      pay_rem2: selectedPrepaid.id,\r\n      pay_rem4: this.state.pay_rem4,\r\n      prepaid_ct: selectedPrepaid.conditiontype1,\r\n      gt_group: false,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTablePrepaid\",\r\n      this.state.displayTablePrepaid\r\n    );\r\n    let setdisplayTablePrepaid = this.state.displayTablePrepaid;\r\n    setdisplayTablePrepaid.push(selectedPrepaid.id);\r\n    this.setState({ displayTablePrepaid: setdisplayTablePrepaid });\r\n    console.log(\"AfterAdd-displayTablePrepaid\", this.state.displayTablePrepaid);\r\n    this.HidePrepaidTableData();\r\n\r\n    balance = parseFloat(balance - userPayAmount).toFixed(2);\r\n    this.setBalanceToAllTextBoxes(balance);\r\n    console.log(balance);\r\n    this.setState({ isOpenSubPayment: false });\r\n  };\r\n  HidePrepaidTableData() {\r\n    let { prepaidCustomerData, displayTablePrepaid } = this.state;\r\n    displayTablePrepaid.map(item => {\r\n      var selectedPrepaid = prepaidCustomerData.filter(\r\n        prepaid => prepaid.id != item\r\n      );\r\n      this.setState({ prepaidCustomerData: selectedPrepaid });\r\n    });\r\n  }\r\n  HideCreditNoteTableData() {\r\n    let { creditNoteCustomerData, displayTableCreditNote } = this.state;\r\n    displayTableCreditNote.map(item => {\r\n      var selectedCreditNote = creditNoteCustomerData.filter(\r\n        creditNote => creditNote.credit_code != item\r\n      );\r\n      this.setState({ creditNoteCustomerData: selectedCreditNote });\r\n    });\r\n  }\r\n  HideVoucherTableData() {\r\n    let { voucherCustomerData, displayTableVoucher } = this.state;\r\n    displayTableVoucher.map(item => {\r\n      var selectedVoucher = voucherCustomerData.filter(\r\n        voucher => voucher.voucher_no != item\r\n      );\r\n      this.setState({ voucherCustomerData: selectedVoucher });\r\n    });\r\n  }\r\n  addVoucher = selectedVoucher => {\r\n    let {\r\n      cardField,\r\n      ewalletField,\r\n      balance,\r\n      txtUserPayAmount,\r\n      isOpenSubPayment,\r\n      selectedCards,\r\n    } = this.state;\r\n    if (txtUserPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Voucher is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const selectedVoucherAmount = parseFloat(selectedVoucher.value);\r\n    let pay_amt_setup = 0;\r\n    if (selectedVoucherAmount <= parseFloat(txtUserPayAmount)) {\r\n      pay_amt_setup = selectedVoucherAmount;\r\n    } else {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Partial Amount is not applicable in voucher\",\r\n      });\r\n      return;\r\n      // alert(\"Partial Amount is not applicable in voucher\");\r\n      // return;\r\n    }\r\n    const payTypeId = 9;\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: false,\r\n      pay_amt: parseFloat(pay_amt_setup),\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1: selectedVoucher.voucher_no,\r\n      pay_rem2: selectedVoucher.voucher_no,\r\n      pay_rem4: this.state.pay_rem4,\r\n      gt_group: false,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTableVoucher\",\r\n      this.state.displayTableVoucher\r\n    );\r\n    let setdisplayTableVoucher = this.state.displayTableVoucher;\r\n    setdisplayTableVoucher.push(selectedVoucher.voucher_no);\r\n    this.setState({ displayTableVoucher: setdisplayTableVoucher });\r\n    console.log(\r\n      \"AfterAdd-displayTableCreditNote\",\r\n      this.state.displayTableVoucher\r\n    );\r\n    this.HideVoucherTableData();\r\n\r\n    balance = parseFloat(balance - pay_amt_setup).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  addCreditNote = selectedCreditNote => {\r\n    console.log(selectedCreditNote);\r\n    let { cardField, ewalletField, balance, txtUserPayAmount, selectedCards } =\r\n      this.state;\r\n    if (txtUserPayAmount == 0) {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Credit Note is not allowed\",\r\n      });\r\n      return;\r\n    }\r\n    const selectedCreditNoteAmount = parseFloat(selectedCreditNote.balance);\r\n    console.log(selectedCreditNoteAmount);\r\n    let pay_amt_setup = 0;\r\n    if (selectedCreditNoteAmount <= parseFloat(txtUserPayAmount)) {\r\n      pay_amt_setup = selectedCreditNoteAmount;\r\n    } else {\r\n      pay_amt_setup = txtUserPayAmount;\r\n    }\r\n    const payTypeId = 17;\r\n\r\n    selectedCards.push({\r\n      pay_typeid: payTypeId,\r\n      prepaid: false,\r\n      pay_amt: parseFloat(pay_amt_setup),\r\n      credit_debit: false,\r\n      pay_premise: false,\r\n      pay_rem1: selectedCreditNote.credit_code,\r\n      pay_rem2: selectedCreditNote.transaction,\r\n      pay_rem4: this.state.pay_rem4,\r\n      gt_group: false,\r\n    });\r\n    console.log(\r\n      \"BeforeAdd-displayTableCreditNote\",\r\n      this.state.displayTableCreditNote\r\n    );\r\n    let setdisplayTableCreditNote = this.state.displayTableCreditNote;\r\n    setdisplayTableCreditNote.push(selectedCreditNote.credit_code);\r\n    this.setState({ displayTableCreditNote: setdisplayTableCreditNote });\r\n    console.log(\r\n      \"AfterAdd-displayTableCreditNote\",\r\n      this.state.displayTableCreditNote\r\n    );\r\n    this.HideCreditNoteTableData();\r\n\r\n    balance = parseFloat(balance - pay_amt_setup).toFixed(2);\r\n    this.setState({ isOpenSubPayment: false });\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n\r\n  setBalanceToAllTextBoxes(balance) {\r\n    this.setState({\r\n      balance: balance,\r\n      txtUserPayAmount: balance,\r\n    });\r\n  }\r\n  removeCards = idx => () => {\r\n    let {\r\n      selectedCards,\r\n      balance,\r\n      cardField,\r\n      ewalletField,\r\n      itemProductServiceVoucherAmount,\r\n      itemProductAmount,\r\n      itemServiceAmount,\r\n    } = this.state;\r\n    this.setState({ isMakePaymentButtonClicked: \"false\" });\r\n    balance = parseFloat(balance) + parseFloat(idx.pay_amt);\r\n    var array = [...selectedCards]; // make a separate copy of the array\r\n    var index = array.indexOf(idx);\r\n    if (idx.pay_typeid == 23) {\r\n      if (idx.prepaid_ct == \"Product Only\") {\r\n        itemProductAmount = itemProductAmount + idx.pay_amt;\r\n      } else if (idx.prepaid_ct == \"Service Only\") {\r\n        itemServiceAmount = itemServiceAmount + idx.pay_amt;\r\n      } else {\r\n        itemProductServiceVoucherAmount =\r\n          itemProductServiceVoucherAmount + idx.pay_amt;\r\n      }\r\n      this.setState({\r\n        itemProductServiceVoucherAmount,\r\n        itemProductAmount,\r\n        itemServiceAmount,\r\n      });\r\n    }\r\n    if (index !== -1) {\r\n      array.splice(index, 1);\r\n      this.setState({ selectedCards: array, balance });\r\n    }\r\n    //console.log(\"idx\", idx);\r\n    var removedTerm = idx.pay_typeid;\r\n    //console.log(\"removedTerm\", removedTerm);\r\n    //console.log(\"idx.pay_rem2\", idx.pay_rem2);\r\n    if (removedTerm == \"23\") {\r\n      const items = this.state.displayTablePrepaid;\r\n      console.log(\"BeforeRemove-displayTablePrepaid\", items);\r\n      const valueToRemove = idx.pay_rem2; //For Prepaid Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTablePrepaid: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTablePrepaid\",\r\n          this.state.displayTablePrepaid\r\n        );\r\n      });\r\n      this.getPrepaidAccountData(\"\");\r\n      // this.HidePrepaidTableData();\r\n    }\r\n    if (removedTerm == \"17\") {\r\n      const items = this.state.displayTableCreditNote;\r\n      console.log(\"BeforeRemove-displayTableCreditNote\", items);\r\n      const valueToRemove = idx.pay_rem1; //For Credit Note Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTableCreditNote: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTableCreditNote\",\r\n          this.state.displayTableCreditNote\r\n        );\r\n      });\r\n      this.getCreditNoteAccountData(\"\");\r\n      // this.HidePrepaidTableData();\r\n    }\r\n\r\n    if (removedTerm == \"9\") {\r\n      const items = this.state.displayTableVoucher;\r\n      console.log(\"BeforeRemove-displayTableVoucher\", items);\r\n      const valueToRemove = idx.pay_rem1; //For Credit Note Ony we have added unique id here\r\n      console.log(\"BeforeRemove-valueToRemove\", valueToRemove);\r\n      const filteredItems = items.filter(item => item !== valueToRemove);\r\n      this.setState({ displayTableVoucher: filteredItems }, () => {\r\n        console.log(\r\n          \"AfterRemove-displayTableVoucher\",\r\n          this.state.displayTableVoucher\r\n        );\r\n      });\r\n      this.getVoucherData(\"\");\r\n    }\r\n    cardField[\"pay_amt\"] = balance;\r\n    ewalletField[\"pay_amt\"] = balance;\r\n    this.setBalanceToAllTextBoxes(balance);\r\n  };\r\n  checkTypeOfCartItemContainsDeposit(cartData) {\r\n    let stringifiedCartData = cartData.data;\r\n    if (stringifiedCartData) {\r\n      stringifiedCartData.map(item => {\r\n        if (item.type === \"Deposit\" || item.type === \"Top Up\") {\r\n          this.state.isTreatmentDoneButton = false;\r\n        }\r\n      });\r\n    }\r\n  }\r\n  addNewPaymentData = async (selPayTypeId, selPayTypeName) => {\r\n    if (!this.validator.fieldValid(\"Amount\")) {\r\n      this.validator.showMessageFor(\"Amount\");\r\n      return;\r\n    }\r\n    if (!this.validator.fieldValid(\"Amount\")) {\r\n      this.validator.showMessageFor(\"Amount\");\r\n      return;\r\n    }\r\n\r\n    this.props\r\n      .getCommonApi(`paytablenew/?paygroupid=${selPayTypeId}`)\r\n      .then(res => {\r\n        this.setState({\r\n          paytableData: [],\r\n        });\r\n        let { paytableData, isSelectedPaymentType, displayModelPaymentType } =\r\n          this.state;\r\n        isSelectedPaymentType = selPayTypeName.trim();\r\n        displayModelPaymentType = selPayTypeName.trim();\r\n        for (let key of res.data) {\r\n          paytableData.push({ label: key.pay_description, value: key.id });\r\n        }\r\n        this.setState(\r\n          {\r\n            paytableData,\r\n          },\r\n          () => {\r\n            let { isOpenSubPayment } = this.state;\r\n            if (paytableData.length == 0) {\r\n              Toast({\r\n                type: \"error\",\r\n                message: \"Pay Table Not Exists\",\r\n              });\r\n              return;\r\n            } else if (selPayTypeName.trim() === \"VOUCHER\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"PREPAID\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"Credit\") {\r\n              isOpenSubPayment = true;\r\n            } else if (selPayTypeName.trim() === \"CARD\") {\r\n              isOpenSubPayment = true;\r\n            } else if (paytableData.length == 1) {\r\n              isOpenSubPayment = false;\r\n              let payTypeId = paytableData[0].value;\r\n              let { balance, selectedCards, txtUserPayAmount } = this.state;\r\n              if (parseFloat(this.state.responseData.billable_amount) > 0) {\r\n                if (parseFloat(txtUserPayAmount) == 0) {\r\n                  return;\r\n                }\r\n              }\r\n              if (this.checkPayTypeIdAlreadyExists(payTypeId)) {\r\n                let result =\r\n                  this.getPayTableNameBasedOnId(payTypeId) + \" already exists\";\r\n                Toast({\r\n                  type: \"error\",\r\n                  message: result,\r\n                });\r\n                //alert(\"Already Exists\");\r\n                return;\r\n              } else {\r\n                selectedCards.push({\r\n                  pay_typeid: payTypeId,\r\n                  pay_amt: parseFloat(txtUserPayAmount),\r\n                  credit_debit: false,\r\n                  pay_premise: true,\r\n                  prepaid: false,\r\n                  pay_rem4: this.state.pay_rem4,\r\n                  gt_group: false,\r\n                });\r\n                balance = parseFloat(balance - txtUserPayAmount).toFixed(2);\r\n                txtUserPayAmount = balance;\r\n                this.setState({ txtUserPayAmount, balance });\r\n                return;\r\n              }\r\n            } else if (paytableData.length >= 1) {\r\n              isOpenSubPayment = true;\r\n              isSelectedPaymentType = \"Multiple\";\r\n            }\r\n            this.setState({\r\n              isOpenSubPayment,\r\n              isSelectedPaymentType,\r\n              displayModelPaymentType,\r\n            });\r\n          }\r\n        );\r\n      });\r\n  };\r\n\r\n  handleDialog = async () => {\r\n    let { isOpenSubPayment } = this.state;\r\n    isOpenSubPayment = false;\r\n    await this.setState({\r\n      isOpenSubPayment,\r\n    });\r\n  };\r\n\r\n  handleChangeCard = async ({ target: { value, name } }) => {\r\n    let cardField = Object.assign({}, this.state.cardField);\r\n\r\n    cardField[name] = value;\r\n\r\n    await this.setState({\r\n      cardField,\r\n    });\r\n  };\r\n  handleDatePick = async ({ target: { value, name } }) => {\r\n    let { DateofPay } = this.state;\r\n    DateofPay = value;\r\n    await this.setState({\r\n      DateofPay,\r\n    });\r\n\r\n    let DatePayment = {};\r\n    DatePayment[\"DateofPayment\"] = value;\r\n    await this.props.updateForm(\"CartPaymentDate\", DatePayment);\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      responseData,\r\n      balance,\r\n      payGroupData,\r\n      paytableData,\r\n      isOpenSubPayment,\r\n      isSelectedPaymentType,\r\n      displayModelPaymentType,\r\n      cardField,\r\n      pay_rem4,\r\n      DateofPay,\r\n      MinimumDate,\r\n      is_paymentdate,\r\n      isMakePaymentLoading,\r\n    } = this.state;\r\n    let { t } = this.props;\r\n    let { payTableDropDownValue } = this.state.formFields;\r\n    console.log(payTableDropDownValue);\r\n    let insideRadioButtonData;\r\n    console.log(isSelectedPaymentType, \"selectedpaymenttype\");\r\n    if (isSelectedPaymentType == \"VOUCHER\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-bordered\">\r\n            <tr>\r\n              <td>{t(\"Vocucher No\")}</td>\r\n              <td>{t(\"Value\")}</td>\r\n              <td>{t(\"Exp. Date\")}</td>\r\n            </tr>\r\n            {this.state.voucherCustomerData.map((selectedVoucher, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addVoucher.bind(this, selectedVoucher)}\r\n              >\r\n                <td>{selectedVoucher.voucher_no}</td>\r\n                <td>{selectedVoucher.value}</td>\r\n                <td>{selectedVoucher.issued_expiry_date}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"PREPAID\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-striped\">\r\n            <tr>\r\n              <td>{t(\"Category\")}</td>\r\n              <td>{t(\"Amount\")}</td>\r\n              <td>{t(\"Remaining\")}</td>\r\n              <td>{t(\"Invoice No.\")}</td>\r\n              <td>{t(\"Exp. Date\")}</td>\r\n              <td>{t(\"Condition Type\")}</td>\r\n              <td>{t(\"Use Amount\")}</td>\r\n            </tr>\r\n            {this.state.prepaidCustomerData.map((selectedPrepaid, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addPrepaid.bind(this, selectedPrepaid)}\r\n              >\r\n                <td>{selectedPrepaid.pp_desc}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.pp_total}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.remain}</td>\r\n                <td>{selectedPrepaid.prepaid}</td>\r\n                <td>{selectedPrepaid.exp_date}</td>\r\n                <td>{selectedPrepaid.conditiontype1}</td>\r\n                <td className=\"text-right\">{selectedPrepaid.Finaluse_amt}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"Credit\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <table className=\"table table-striped\">\r\n            <tr>\r\n              <td>{t(\"Credit\")} #</td>\r\n              <td>{t(\"Date\")}</td>\r\n              <td>{t(\"Amount\")}</td>\r\n              <td>{t(\"Balance\")}</td>\r\n              <td>{t(\"Status\")}</td>\r\n            </tr>\r\n            {this.state.creditNoteCustomerData.map((creditNote, index) => (\r\n              <tr\r\n                key={index}\r\n                style={{ cursor: \"pointer\" }}\r\n                onClick={this.addCreditNote.bind(this, creditNote)}\r\n              >\r\n                <td>{creditNote.credit_code}</td>\r\n                <td>{creditNote.sa_date}</td>\r\n                <td>{creditNote.amount}</td>\r\n                <td>{creditNote.balance}</td>\r\n                <td>{creditNote.status}</td>\r\n              </tr>\r\n            ))}\r\n          </table>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"CARD\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <div className=\"d-flex flex-wrap justify-content-start\">\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Select Card\")}\r\n                <NormalSelect\r\n                  placeholder=\"Search type...\"\r\n                  options={paytableData}\r\n                  value={cardField.pay_typeid}\r\n                  name=\"pay_typeid\"\r\n                  onChange={this.handleCreditChange}\r\n                />\r\n              </div>\r\n              {this.validator.message(\r\n                \"cardFieldType\",\r\n                cardField.pay_typeid,\r\n                \"required\"\r\n              )}\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Card No.\")}\r\n                <NormalInput\r\n                  value={cardField.pay_rem1}\r\n                  name=\"pay_rem1\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Name\")}\r\n                <NormalInput\r\n                  value={cardField.pay_rem2}\r\n                  name=\"pay_rem2\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Exp Month\")} / {t(\"Year\")}\r\n                <NormalInput\r\n                  placeholder=\"mm/YYYY\"\r\n                  value={cardField.pay_rem3}\r\n                  name=\"pay_rem3\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                {t(\"Approval Code\")}\r\n                <NormalInput\r\n                  value={cardField.App_code}\r\n                  name=\"App_code\"\r\n                  onChange={this.handleChangeCard}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex justify-content-end\">\r\n            <div className=\"col-2\">\r\n              <div className=\"input-group\">\r\n                <NormalButton\r\n                  mainbg={false}\r\n                  className=\"col-12 mt-4 ml-2 btn-outline-success\"\r\n                  label=\"CONFIRM\"\r\n                  onClick={() => this.addCreditCard()}\r\n                />\r\n              </div>\r\n              <div className=\"col-1\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (isSelectedPaymentType == \"Multiple\") {\r\n      insideRadioButtonData = (\r\n        <div>\r\n          <div className=\"row\">\r\n            <div className=\"col-5\">\r\n              <div className=\"input-group\">\r\n                <Label className=\"col-12 fs-15\">{t(\"Choose Option\")}</Label>\r\n                <NormalSelect\r\n                  placeholder=\"Search type...\"\r\n                  options={paytableData}\r\n                  value={payTableDropDownValue}\r\n                  name=\"payTableDropDownValue\"\r\n                  onChange={this.handleChange}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      insideRadioButtonData = <div></div>;\r\n    }\r\n    let payGroupDataContent = [];\r\n    console.log(payGroupData);\r\n    payGroupData.forEach((item, i) => {\r\n      payGroupDataContent.push(\r\n        <div\r\n          className=\"col-md-3 col-4 payment-item cursor-pointer\"\r\n          style={{ width: \"50px\", padding: \"15px\" }}\r\n          key={i}\r\n          onClick={() => this.addNewPaymentData(item.value, item.label)}\r\n        >\r\n          <center>\r\n            <img\r\n              src={helpers.getUrl() + \"media/\" + item.picturelocation}\r\n              label={item.label}\r\n              style={{ textAlign: \"center\" }}\r\n              width=\"40\"\r\n              height=\"40\"\r\n            />\r\n          </center>\r\n          <center>\r\n            <p style={{ width: \"100px\", textAlign: \"center\" }}>{item.label}</p>\r\n          </center>\r\n        </div>\r\n      );\r\n    });\r\n\r\n    let { cartId, cartData, tokenDetails } = this.props;\r\n    console.log(cartId, tokenDetails, this.props.cartData);\r\n    //this.checkTypeOfCartItemContainsDeposit(cartData);\r\n\r\n    let userAddedPayTableData = (\r\n      <table className=\"table table-bordered\">\r\n        {this.state.selectedCards.map((selectedCards, index) => (\r\n          <tr key={index}>\r\n            <td className=\"fs-18\">\r\n              {selectedCards.pay_desc\r\n                ? selectedCards.pay_desc\r\n                : this.getPayTableNameBasedOnId(selectedCards.pay_typeid)}\r\n            </td>\r\n            <td className=\"fs-18\" style={{ textAlign: \"right\" }}>\r\n              {selectedCards.pay_amt.toFixed(2)}\r\n            </td>\r\n            <td>\r\n              {!selectedCards.gt_group ? (\r\n                <div\r\n                  className=\"col-4 p-0 fs-20 cursor-pointer\"\r\n                  onClick={this.removeCards(selectedCards)}\r\n                >\r\n                  <span className=\"icon-delete\"></span>\r\n                </div>\r\n              ) : null}\r\n            </td>\r\n          </tr>\r\n        ))}\r\n      </table>\r\n    );\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"d-flex flex-wrap\">\r\n          <div className=\"col-md-2 col-12 mb-2\">\r\n            <label className=\"text-left text-black common-label-text \">\r\n              {t(\"Enter Amount\")}\r\n            </label>\r\n\r\n            <div className=\"input-group mb-2\">\r\n              <NormalInput\r\n                value={this.state.txtUserPayAmount}\r\n                onChange={this.handleChangeTextBox.bind(this)}\r\n              />\r\n              {this.validator.message(\r\n                \"Amount\",\r\n                this.state.txtUserPayAmount,\r\n                \"required|numeric|min:0,num\"\r\n              )}\r\n              {this.validator.message(\r\n                \"Amount\",\r\n                this.state.txtUserPayAmount,\r\n                \"required|numeric|max:\" + this.state.balance + \",num\"\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"col-md-4 col-12 mb-2\">\r\n            <Label>{t(\"Remark\")}</Label>\r\n            <div className=\"input-group mb-2\">\r\n              <NormalInput\r\n                value={pay_rem4}\r\n                name=\"pay_rem4\"\r\n                onChange={this.handleChangeRemarkBox.bind(this)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"col-md-2 col-12 mb-2\">\r\n            {is_paymentdate ? (\r\n              <>\r\n                <Label>{t(\"Date\")}</Label>\r\n                <div className=\"input-group mb-2\">\r\n                  <NormalDate\r\n                    value={new Date(DateofPay)}\r\n                    name=\"DateofPay\"\r\n                    type=\"date\"\r\n                    onChange={this.handleDatePick}\r\n                    minDate={new Date(MinimumDate)}\r\n                    maxDate={new Date()}\r\n                    showDisabledMonthNavigation\r\n                  />\r\n                </div>\r\n              </>\r\n            ) : null}\r\n          </div>\r\n\r\n          <div className=\"col-md-4 col-12\">\r\n            <div className=\"d-flex justify-content-end\">\r\n              <div className=\"make-payment mt-3 text-center\">\r\n                {isMakePaymentLoading ? (\r\n                  <div class=\"d-flex align-items-center justify-content-center\">\r\n                    <div class=\"spinner-border\" role=\"status\">\r\n                      <span class=\"sr-only\">{t(\"Loading...\")}</span>\r\n                    </div>\r\n                  </div>\r\n                ) : this.state.isMakePaymentButtonClicked == \"true\" ? (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    disabled={true}\r\n                  />\r\n                ) : (\r\n                  <NormalButton\r\n                    submitBtn={true}\r\n                    className=\"col-12\"\r\n                    label=\"Make payment\"\r\n                    onClick={() => this.handleSubmit()}\r\n                    disabled={\r\n                      this.state.selectedCards.length <= 0 || balance > 0\r\n                    }\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <h4>{t(\"Select Payment Method\")}</h4>\r\n\r\n        <div className=\"row paymentGroup\">\r\n          <div className=\"col-md-6\">\r\n            <div className=\"d-flex flex-wrap\">\r\n              {payGroupData.length > 0 ? (\r\n                payGroupData.map((item, index) => {\r\n                  return (\r\n                    <div\r\n                      className=\"col-md-3 col-4 payment-item cursor-pointer\"\r\n                      style={{ width: \"50px\", padding: \"15px\" }}\r\n                      key={index}\r\n                      onClick={() =>\r\n                        this.addNewPaymentData(item.value, item.label)\r\n                      }\r\n                    >\r\n                      <center>\r\n                        <img\r\n                          src={\r\n                            helpers.getUrl() + \"media/\" + item.picturelocation\r\n                          }\r\n                          label={item.label}\r\n                          style={{ textAlign: \"center\" }}\r\n                          width=\"40\"\r\n                          height=\"40\"\r\n                        />\r\n                      </center>\r\n                      <center>\r\n                        <p style={{ width: \"100px\", textAlign: \"center\" }}>\r\n                          {item.label}\r\n                        </p>\r\n                      </center>\r\n                    </div>\r\n                  );\r\n                })\r\n              ) : (\r\n                <></>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"col-md-6 make-payment-section\">\r\n            <p className=\"h6\">{t(\"List of Selections\")}</p>\r\n            <div className=\"row\">\r\n              <div className=\"col-md-12 mt-1 mb-1\">\r\n                <div className=\"d-flex payment\">\r\n                  <div className=\"col-md-7 p-0\">\r\n                    <div className=\"d-flex flex-wrap fs-14\">\r\n                      <div className=\"col-6\">{t(\"Subtotal\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.subtotal}</div>\r\n                      <div className=\"col-6\">{t(\"Discount ($)\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.discount}</div>\r\n                      <div className=\"col-6\">{t(\"Transac amount\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.trans_amt}</div>\r\n                      <div className=\"col-6\">{t(\"Deposit\")}</div>\r\n                      <div className=\"col-6\">$ {responseData.deposit_amt}</div>\r\n                      <div className=\"col-6\">{responseData.tax_lable}</div>\r\n                      <div className=\"col-6\">$ {responseData.tax_amt}</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"col-md-5\">\r\n                    <div className=\"d-flex flex-wrap\">\r\n                      <div className=\"col-12 fs-22 text-center\">\r\n                        {t(\"Billing Amount\")}\r\n                      </div>\r\n                      <div className=\"col-12 fs-22 fw-700 text-center text-orenge\">\r\n                        $ {responseData.billable_amount}\r\n                      </div>\r\n                      <div className=\"col-12 f-600 text-center mt-2\">\r\n                        {t(\"Balance Amount\")}: {Number(balance).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-md-12 mt-2 payment-list\">\r\n              <div className=\"fs-12\">{userAddedPayTableData}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <NormalModal\r\n          className={\"payment-modal\"}\r\n          style={{ minWidth: \"70%\" }}\r\n          modal={isOpenSubPayment}\r\n          handleModal={this.handleDialog}\r\n        >\r\n          <img\r\n            onClick={this.handleDialog}\r\n            className=\"close cursor-pointer\"\r\n            src={closeIcon}\r\n            alt=\"\"\r\n          />\r\n          <center>\r\n            <p className=\"fs-18 f-600\">{displayModelPaymentType}</p>\r\n          </center>\r\n          <br />\r\n          {insideRadioButtonData}\r\n        </NormalModal>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  appointmentDetail: state.appointment.appointmentDetail,\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  tokenDetails: state.authStore.tokenDetails,\r\n  CartPaymentDate: state.appointment.CartPaymentDate,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getPayment,\r\n      getCommonApi,\r\n      createPayment,\r\n      updateForm,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const ChangePayment = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(ChangePaymentClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}