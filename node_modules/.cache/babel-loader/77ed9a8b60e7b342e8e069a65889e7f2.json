{"ast":null,"code":"/**\r\n * DevExtreme (ui/defer_rendering.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _transition_executor = require(\"../animation/transition_executor/transition_executor\");\n\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\n\nvar _dom_adapter = _interopRequireDefault(require(\"../core/dom_adapter\"));\n\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\n\nvar _common = require(\"../core/utils/common\");\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _window = require(\"../core/utils/window\");\n\nvar _events_engine = _interopRequireDefault(require(\"../events/core/events_engine\"));\n\nvar _visibility_change = require(\"../events/visibility_change\");\n\nvar _load_indicator = _interopRequireDefault(require(\"./load_indicator\"));\n\nvar _ui = _interopRequireDefault(require(\"./widget/ui.widget\"));\n\nvar _position = require(\"../core/utils/position\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar window = (0, _window.getWindow)();\nvar WIDGET_CLASS = \"dx-widget\";\nvar DEFER_RENDERING_CLASS = \"dx-deferrendering\";\nvar PENDING_RENDERING_CLASS = \"dx-pending-rendering\";\nvar PENDING_RENDERING_MANUAL_CLASS = \"dx-pending-rendering-manual\";\nvar PENDING_RENDERING_ACTIVE_CLASS = \"dx-pending-rendering-active\";\nvar VISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-visible-while-pending-rendering\";\nvar INVISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-invisible-while-pending-rendering\";\nvar LOADINDICATOR_CONTAINER_CLASS = \"dx-loadindicator-container\";\nvar DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS = \"dx-deferrendering-loadindicator-container\";\nvar DEFER_DEFER_RENDERING_LOAD_INDICATOR = \"dx-deferrendering-load-indicator\";\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\nvar ACTIONS = [\"onRendered\", \"onShown\"];\n\nvar DeferRendering = _ui.default.inherit({\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      showLoadIndicator: false,\n      renderWhen: void 0,\n      animation: void 0,\n      staggerItemSelector: void 0,\n      onRendered: null,\n      onShown: null\n    });\n  },\n  _getAnonymousTemplateName: function () {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _init: function () {\n    this.transitionExecutor = new _transition_executor.TransitionExecutor();\n\n    this._initElement();\n\n    this._initRender();\n\n    this._$initialContent = this.$element().clone().contents();\n\n    this._initActions();\n\n    this.callBase();\n  },\n  _initElement: function () {\n    this.$element().addClass(DEFER_RENDERING_CLASS);\n  },\n  _initRender: function () {\n    var that = this;\n    var $element = this.$element();\n    var renderWhen = this.option(\"renderWhen\");\n\n    var doRender = function () {\n      return that._renderDeferredContent();\n    };\n\n    if ((0, _type.isPromise)(renderWhen)) {\n      (0, _deferred.fromPromise)(renderWhen).done(doRender);\n    } else {\n      $element.data(\"dx-render-delegate\", doRender);\n\n      if (void 0 === renderWhen) {\n        $element.addClass(PENDING_RENDERING_MANUAL_CLASS);\n      }\n    }\n  },\n  _initActions: function () {\n    var _this = this;\n\n    this._actions = {};\n    (0, _iterator.each)(ACTIONS, function (_, action) {\n      _this._actions[action] = _this._createActionByOption(action) || _common.noop;\n    });\n  },\n  _initMarkup: function () {\n    this.callBase();\n\n    if (!this._initContent) {\n      this._initContent = this._renderContent;\n\n      this._renderContent = function () {};\n    }\n\n    this._initContent();\n  },\n  _renderContentImpl: function () {\n    this.$element().removeClass(WIDGET_CLASS);\n    this.$element().append(this._$initialContent);\n\n    this._setLoadingState();\n  },\n  _renderDeferredContent: function () {\n    var that = this;\n    var $element = this.$element();\n    var result = new _deferred.Deferred();\n    $element.removeClass(PENDING_RENDERING_MANUAL_CLASS);\n    $element.addClass(PENDING_RENDERING_ACTIVE_CLASS);\n\n    this._abortRenderTask();\n\n    this._renderTask = (0, _common.executeAsync)(function () {\n      that._renderImpl().done(function () {\n        var shownArgs = {\n          element: $element\n        };\n\n        that._actions.onShown([shownArgs]);\n\n        result.resolve(shownArgs);\n      }).fail(function () {\n        result.rejectWith(result, arguments);\n      });\n    });\n    return result.promise();\n  },\n  _isElementInViewport: function (element) {\n    var rect = (0, _position.getBoundingRect)(element);\n    return rect.bottom >= 0 && rect.right >= 0 && rect.top <= (window.innerHeight || _dom_adapter.default.getDocumentElement().clientHeight) && rect.left <= (window.innerWidth || _dom_adapter.default.getDocumentElement().clientWidth);\n  },\n  _animate: function () {\n    var that = this;\n    var $element = this.$element();\n    var animation = (0, _window.hasWindow)() && this.option(\"animation\");\n    var staggerItemSelector = this.option(\"staggerItemSelector\");\n    var animatePromise;\n    that.transitionExecutor.stop();\n\n    if (animation) {\n      if (staggerItemSelector) {\n        $element.find(staggerItemSelector).each(function () {\n          if (that._isElementInViewport(this)) {\n            that.transitionExecutor.enter((0, _renderer.default)(this), animation);\n          }\n        });\n      } else {\n        that.transitionExecutor.enter($element, animation);\n      }\n\n      animatePromise = that.transitionExecutor.start();\n    } else {\n      animatePromise = new _deferred.Deferred().resolve().promise();\n    }\n\n    return animatePromise;\n  },\n  _renderImpl: function () {\n    var $element = this.$element();\n    var renderedArgs = {\n      element: $element\n    };\n\n    var contentTemplate = this._getTemplate(this._templateManager.anonymousTemplateName);\n\n    if (contentTemplate) {\n      contentTemplate.render({\n        container: $element.empty(),\n        noModel: true\n      });\n    }\n\n    this._setRenderedState($element);\n\n    _events_engine.default.trigger($element, \"dxcontentrendered\");\n\n    this._actions.onRendered([renderedArgs]);\n\n    this._isRendered = true;\n    return this._animate();\n  },\n  _setLoadingState: function () {\n    var $element = this.$element();\n    var hasCustomLoadIndicator = !!$element.find(\".\" + VISIBLE_WHILE_PENDING_RENDERING_CLASS).length;\n    $element.addClass(PENDING_RENDERING_CLASS);\n\n    if (!hasCustomLoadIndicator) {\n      $element.children().addClass(INVISIBLE_WHILE_PENDING_RENDERING_CLASS);\n    }\n\n    if (this.option(\"showLoadIndicator\")) {\n      this._showLoadIndicator($element);\n    }\n  },\n  _showLoadIndicator: function ($container) {\n    this._$loadIndicator = new _load_indicator.default((0, _renderer.default)(\"<div>\"), {\n      visible: true\n    }).$element().addClass(DEFER_DEFER_RENDERING_LOAD_INDICATOR);\n    (0, _renderer.default)(\"<div>\").addClass(LOADINDICATOR_CONTAINER_CLASS).addClass(DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS).append(this._$loadIndicator).appendTo($container);\n  },\n  _setRenderedState: function () {\n    var $element = this.$element();\n\n    if (this._$loadIndicator) {\n      this._$loadIndicator.remove();\n    }\n\n    $element.removeClass(PENDING_RENDERING_CLASS);\n    $element.removeClass(PENDING_RENDERING_ACTIVE_CLASS);\n    (0, _visibility_change.triggerShownEvent)($element.children());\n  },\n  _optionChanged: function (args) {\n    var value = args.value;\n    var previousValue = args.previousValue;\n\n    switch (args.name) {\n      case \"renderWhen\":\n        if (false === previousValue && true === value) {\n          this._renderOrAnimate();\n        } else {\n          if (true === previousValue && false === value) {\n            this.transitionExecutor.stop();\n\n            this._setLoadingState();\n          }\n        }\n\n        break;\n\n      case \"showLoadIndicator\":\n      case \"onRendered\":\n      case \"onShown\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _renderOrAnimate: function () {\n    var result;\n\n    if (this._isRendered) {\n      this._setRenderedState();\n\n      result = this._animate();\n    } else {\n      result = this._renderDeferredContent();\n    }\n\n    return result;\n  },\n  renderContent: function () {\n    return this._renderOrAnimate();\n  },\n  _abortRenderTask: function () {\n    if (this._renderTask) {\n      this._renderTask.abort();\n\n      this._renderTask = void 0;\n    }\n  },\n  _dispose: function () {\n    this.transitionExecutor.stop(true);\n\n    this._abortRenderTask();\n\n    this._actions = void 0;\n    this._$initialContent = void 0;\n    this.callBase();\n  }\n});\n\n(0, _component_registrator.default)(\"dxDeferRendering\", DeferRendering);\nvar _default = DeferRendering;\nexports.default = _default;\nmodule.exports = exports.default;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/defer_rendering.js"],"names":["exports","default","_transition_executor","require","_component_registrator","_interopRequireDefault","_dom_adapter","_renderer","_common","_deferred","_extend","_iterator","_type","_window","_events_engine","_visibility_change","_load_indicator","_ui","_position","obj","__esModule","window","getWindow","WIDGET_CLASS","DEFER_RENDERING_CLASS","PENDING_RENDERING_CLASS","PENDING_RENDERING_MANUAL_CLASS","PENDING_RENDERING_ACTIVE_CLASS","VISIBLE_WHILE_PENDING_RENDERING_CLASS","INVISIBLE_WHILE_PENDING_RENDERING_CLASS","LOADINDICATOR_CONTAINER_CLASS","DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS","DEFER_DEFER_RENDERING_LOAD_INDICATOR","ANONYMOUS_TEMPLATE_NAME","ACTIONS","DeferRendering","inherit","_getDefaultOptions","extend","callBase","showLoadIndicator","renderWhen","animation","staggerItemSelector","onRendered","onShown","_getAnonymousTemplateName","_init","transitionExecutor","TransitionExecutor","_initElement","_initRender","_$initialContent","$element","clone","contents","_initActions","addClass","that","option","doRender","_renderDeferredContent","isPromise","fromPromise","done","data","_this","_actions","each","_","action","_createActionByOption","noop","_initMarkup","_initContent","_renderContent","_renderContentImpl","removeClass","append","_setLoadingState","result","Deferred","_abortRenderTask","_renderTask","executeAsync","_renderImpl","shownArgs","element","resolve","fail","rejectWith","arguments","promise","_isElementInViewport","rect","getBoundingRect","bottom","right","top","innerHeight","getDocumentElement","clientHeight","left","innerWidth","clientWidth","_animate","hasWindow","animatePromise","stop","find","enter","start","renderedArgs","contentTemplate","_getTemplate","_templateManager","anonymousTemplateName","render","container","empty","noModel","_setRenderedState","trigger","_isRendered","hasCustomLoadIndicator","length","children","_showLoadIndicator","$container","_$loadIndicator","visible","appendTo","remove","triggerShownEvent","_optionChanged","args","value","previousValue","name","_renderOrAnimate","renderContent","abort","_dispose","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/defer_rendering.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _transition_executor = require(\"../animation/transition_executor/transition_executor\");\r\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\r\nvar _dom_adapter = _interopRequireDefault(require(\"../core/dom_adapter\"));\r\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\r\nvar _common = require(\"../core/utils/common\");\r\nvar _deferred = require(\"../core/utils/deferred\");\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _window = require(\"../core/utils/window\");\r\nvar _events_engine = _interopRequireDefault(require(\"../events/core/events_engine\"));\r\nvar _visibility_change = require(\"../events/visibility_change\");\r\nvar _load_indicator = _interopRequireDefault(require(\"./load_indicator\"));\r\nvar _ui = _interopRequireDefault(require(\"./widget/ui.widget\"));\r\nvar _position = require(\"../core/utils/position\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar window = (0, _window.getWindow)();\r\nvar WIDGET_CLASS = \"dx-widget\";\r\nvar DEFER_RENDERING_CLASS = \"dx-deferrendering\";\r\nvar PENDING_RENDERING_CLASS = \"dx-pending-rendering\";\r\nvar PENDING_RENDERING_MANUAL_CLASS = \"dx-pending-rendering-manual\";\r\nvar PENDING_RENDERING_ACTIVE_CLASS = \"dx-pending-rendering-active\";\r\nvar VISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-visible-while-pending-rendering\";\r\nvar INVISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-invisible-while-pending-rendering\";\r\nvar LOADINDICATOR_CONTAINER_CLASS = \"dx-loadindicator-container\";\r\nvar DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS = \"dx-deferrendering-loadindicator-container\";\r\nvar DEFER_DEFER_RENDERING_LOAD_INDICATOR = \"dx-deferrendering-load-indicator\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\r\nvar ACTIONS = [\"onRendered\", \"onShown\"];\r\nvar DeferRendering = _ui.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            showLoadIndicator: false,\r\n            renderWhen: void 0,\r\n            animation: void 0,\r\n            staggerItemSelector: void 0,\r\n            onRendered: null,\r\n            onShown: null\r\n        })\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _init: function() {\r\n        this.transitionExecutor = new _transition_executor.TransitionExecutor;\r\n        this._initElement();\r\n        this._initRender();\r\n        this._$initialContent = this.$element().clone().contents();\r\n        this._initActions();\r\n        this.callBase()\r\n    },\r\n    _initElement: function() {\r\n        this.$element().addClass(DEFER_RENDERING_CLASS)\r\n    },\r\n    _initRender: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var renderWhen = this.option(\"renderWhen\");\r\n        var doRender = function() {\r\n            return that._renderDeferredContent()\r\n        };\r\n        if ((0, _type.isPromise)(renderWhen)) {\r\n            (0, _deferred.fromPromise)(renderWhen).done(doRender)\r\n        } else {\r\n            $element.data(\"dx-render-delegate\", doRender);\r\n            if (void 0 === renderWhen) {\r\n                $element.addClass(PENDING_RENDERING_MANUAL_CLASS)\r\n            }\r\n        }\r\n    },\r\n    _initActions: function() {\r\n        var _this = this;\r\n        this._actions = {};\r\n        (0, _iterator.each)(ACTIONS, function(_, action) {\r\n            _this._actions[action] = _this._createActionByOption(action) || _common.noop\r\n        })\r\n    },\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        if (!this._initContent) {\r\n            this._initContent = this._renderContent;\r\n            this._renderContent = function() {}\r\n        }\r\n        this._initContent()\r\n    },\r\n    _renderContentImpl: function() {\r\n        this.$element().removeClass(WIDGET_CLASS);\r\n        this.$element().append(this._$initialContent);\r\n        this._setLoadingState()\r\n    },\r\n    _renderDeferredContent: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var result = new _deferred.Deferred;\r\n        $element.removeClass(PENDING_RENDERING_MANUAL_CLASS);\r\n        $element.addClass(PENDING_RENDERING_ACTIVE_CLASS);\r\n        this._abortRenderTask();\r\n        this._renderTask = (0, _common.executeAsync)(function() {\r\n            that._renderImpl().done(function() {\r\n                var shownArgs = {\r\n                    element: $element\r\n                };\r\n                that._actions.onShown([shownArgs]);\r\n                result.resolve(shownArgs)\r\n            }).fail(function() {\r\n                result.rejectWith(result, arguments)\r\n            })\r\n        });\r\n        return result.promise()\r\n    },\r\n    _isElementInViewport: function(element) {\r\n        var rect = (0, _position.getBoundingRect)(element);\r\n        return rect.bottom >= 0 && rect.right >= 0 && rect.top <= (window.innerHeight || _dom_adapter.default.getDocumentElement().clientHeight) && rect.left <= (window.innerWidth || _dom_adapter.default.getDocumentElement().clientWidth)\r\n    },\r\n    _animate: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var animation = (0, _window.hasWindow)() && this.option(\"animation\");\r\n        var staggerItemSelector = this.option(\"staggerItemSelector\");\r\n        var animatePromise;\r\n        that.transitionExecutor.stop();\r\n        if (animation) {\r\n            if (staggerItemSelector) {\r\n                $element.find(staggerItemSelector).each(function() {\r\n                    if (that._isElementInViewport(this)) {\r\n                        that.transitionExecutor.enter((0, _renderer.default)(this), animation)\r\n                    }\r\n                })\r\n            } else {\r\n                that.transitionExecutor.enter($element, animation)\r\n            }\r\n            animatePromise = that.transitionExecutor.start()\r\n        } else {\r\n            animatePromise = (new _deferred.Deferred).resolve().promise()\r\n        }\r\n        return animatePromise\r\n    },\r\n    _renderImpl: function() {\r\n        var $element = this.$element();\r\n        var renderedArgs = {\r\n            element: $element\r\n        };\r\n        var contentTemplate = this._getTemplate(this._templateManager.anonymousTemplateName);\r\n        if (contentTemplate) {\r\n            contentTemplate.render({\r\n                container: $element.empty(),\r\n                noModel: true\r\n            })\r\n        }\r\n        this._setRenderedState($element);\r\n        _events_engine.default.trigger($element, \"dxcontentrendered\");\r\n        this._actions.onRendered([renderedArgs]);\r\n        this._isRendered = true;\r\n        return this._animate()\r\n    },\r\n    _setLoadingState: function() {\r\n        var $element = this.$element();\r\n        var hasCustomLoadIndicator = !!$element.find(\".\" + VISIBLE_WHILE_PENDING_RENDERING_CLASS).length;\r\n        $element.addClass(PENDING_RENDERING_CLASS);\r\n        if (!hasCustomLoadIndicator) {\r\n            $element.children().addClass(INVISIBLE_WHILE_PENDING_RENDERING_CLASS)\r\n        }\r\n        if (this.option(\"showLoadIndicator\")) {\r\n            this._showLoadIndicator($element)\r\n        }\r\n    },\r\n    _showLoadIndicator: function($container) {\r\n        this._$loadIndicator = new _load_indicator.default((0, _renderer.default)(\"<div>\"), {\r\n            visible: true\r\n        }).$element().addClass(DEFER_DEFER_RENDERING_LOAD_INDICATOR);\r\n        (0, _renderer.default)(\"<div>\").addClass(LOADINDICATOR_CONTAINER_CLASS).addClass(DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS).append(this._$loadIndicator).appendTo($container)\r\n    },\r\n    _setRenderedState: function() {\r\n        var $element = this.$element();\r\n        if (this._$loadIndicator) {\r\n            this._$loadIndicator.remove()\r\n        }\r\n        $element.removeClass(PENDING_RENDERING_CLASS);\r\n        $element.removeClass(PENDING_RENDERING_ACTIVE_CLASS);\r\n        (0, _visibility_change.triggerShownEvent)($element.children())\r\n    },\r\n    _optionChanged: function(args) {\r\n        var value = args.value;\r\n        var previousValue = args.previousValue;\r\n        switch (args.name) {\r\n            case \"renderWhen\":\r\n                if (false === previousValue && true === value) {\r\n                    this._renderOrAnimate()\r\n                } else {\r\n                    if (true === previousValue && false === value) {\r\n                        this.transitionExecutor.stop();\r\n                        this._setLoadingState()\r\n                    }\r\n                }\r\n                break;\r\n            case \"showLoadIndicator\":\r\n            case \"onRendered\":\r\n            case \"onShown\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _renderOrAnimate: function() {\r\n        var result;\r\n        if (this._isRendered) {\r\n            this._setRenderedState();\r\n            result = this._animate()\r\n        } else {\r\n            result = this._renderDeferredContent()\r\n        }\r\n        return result\r\n    },\r\n    renderContent: function() {\r\n        return this._renderOrAnimate()\r\n    },\r\n    _abortRenderTask: function() {\r\n        if (this._renderTask) {\r\n            this._renderTask.abort();\r\n            this._renderTask = void 0\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        this.transitionExecutor.stop(true);\r\n        this._abortRenderTask();\r\n        this._actions = void 0;\r\n        this._$initialContent = void 0;\r\n        this.callBase()\r\n    }\r\n});\r\n(0, _component_registrator.default)(\"dxDeferRendering\", DeferRendering);\r\nvar _default = DeferRendering;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}