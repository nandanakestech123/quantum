{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{TableWrapper,NormalSelect}from\"component/common\";import{updateForm,getCommonApi}from\"redux/actions/common\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import _ from\"lodash\";import{TreatmentUsagePopup}from\"./TreatmentUsagePopup\";import{withTranslation}from\"react-i18next\";export var ListTreatmentHistoryCartClass=/*#__PURE__*/function(_Component){_inherits(ListTreatmentHistoryCartClass,_Component);var _super=_createSuper(ListTreatmentHistoryCartClass);function ListTreatmentHistoryCartClass(){var _this;_classCallCheck(this,ListTreatmentHistoryCartClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Trans Date\"},{label:\"Purc Date\"},{label:\"Transac #\"},{label:\"Treatment ID\"},{label:\"Link Code\"},{label:\"Treatment\"},{label:\"Status\"},{label:\"Record Status\"},{label:\"Remarks\"},{label:\"Type\"}],TreatmentHistory:[],treatmentList:[],meta:{},customerNumber:0,yearList:[],selectedYear:new Date().getFullYear(),isTreatmentUsagePopup:false,TreatmentHistoryId:0,cust_data:{}};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.setState({customerNumber:_this.props.customerNumber});case 2:_this.props.getCommonApi(\"treatmentdone/Year/\").then(function(key){var status=key.status,data=key.data;var yearList=_this.state.yearList;var _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;yearList.push({value:value,label:value});}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({yearList:yearList});});_this.getTreatmentHistoryList({});case 4:case\"end\":return _context.stop();}}},_callee);}));_this.getTreatmentHistoryList=function(data){var _this$state=_this.state,customerNumber=_this$state.customerNumber,selectedYear=_this$state.selectedYear,TreatmentHistory=_this$state.TreatmentHistory;if(customerNumber>0){var _data$page=data.page,page=_data$page===void 0?1:_data$page,_data$limit=data.limit,limit=_data$limit===void 0?10:_data$limit,_data$search=data.search,search=_data$search===void 0?\"\":_data$search;_this.props.getCommonApi(\"treatmenthistory/?year=\".concat(selectedYear,\"&cust_id=\").concat(customerNumber,\"&page=\").concat(page,\"&limit=\").concat(limit)).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var data,status,cust;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this.setState({treatmentList:[],meta:{}});case 2:data=res.data,status=res.status,cust=res.cust;console.log(res,\"treatmenthistorycart\");if(status===200){if(data.dataList){_this.setState({treatmentList:data.dataList,meta:data.meta.pagination,cust_data:cust});}}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}());}};_this.handlehistoryYearChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref3){var _ref3$target,value,name,selectedYear;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref3$target=_ref3.target,value=_ref3$target.value,name=_ref3$target.name;selectedYear=_this.state.selectedYear;selectedYear=value;_context3.next=5;return _this.setState({selectedYear:selectedYear});case 5:_this.getTreatmentHistoryList({});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref4.apply(this,arguments);};}();_this.handlePagination=function(page){_this.getTreatmentHistoryList(page);};_this.treatmentUsagePopupclose=function(){_this.setState(function(prevState){return{isTreatmentUsagePopup:!prevState.isTreatmentUsagePopup};});};_this.treatmentUsagePopup=function(data){if(data.status==\"Done\"){_this.setState(function(prevState){return{TreatmentHistoryId:data.id,isTreatmentUsagePopup:!prevState.isTreatmentUsagePopup};});}};return _this;}_createClass(ListTreatmentHistoryCartClass,[{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,headerDetails=_this$state2.headerDetails,treatmentList=_this$state2.treatmentList,meta=_this$state2.meta,yearList=_this$state2.yearList,selectedYear=_this$state2.selectedYear,isTreatmentUsagePopup=_this$state2.isTreatmentUsagePopup,TreatmentHistoryId=_this$state2.TreatmentHistoryId,cust_data=_this$state2.cust_data;var t=this.props.t;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row treatment-done-new p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-10 header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex select-year\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pl-0 mb-2 name fs-16 py-2\"},t(\"Select Year\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalSelect// placeholder=\"Enter here\"\n,{options:yearList,value:selectedYear,name:\"selectedYear\",onChange:this.handlehistoryYearChange,className:\"selected-year mb-2 py-0\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Customer Name\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},cust_data.cust_name))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Reference\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},cust_data.cust_refer)))))),/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:meta},treatmentList&&treatmentList.length>0?treatmentList.map(function(item,index){var trasac_date=item.trasac_date,purchase_date=item.purchase_date,transac=item.transac,treatment_code=item.treatment_code,link_code=item.link_code,course=item.course,status=item.status,record_status=item.record_status,remarks=item.remarks,type=item.type;return/*#__PURE__*/React.createElement(\"tr\",{key:index,onClick:function onClick(){return _this2.treatmentUsagePopup(item);}},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},trasac_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},purchase_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},transac)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},treatment_code)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},link_code)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},course)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},status)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},record_status)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},remarks)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},type)));}):/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},t(\"No Data Available\")))))),isTreatmentUsagePopup?/*#__PURE__*/React.createElement(TreatmentUsagePopup,{isTreatmentUsagePopup:isTreatmentUsagePopup,treatmentUsagePopup:this.treatmentUsagePopup,treatmentUsagePopupclose:this.treatmentUsagePopupclose,TreatmentHistoryId:TreatmentHistoryId}):null);}}]);return ListTreatmentHistoryCartClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{// filter: state.dashboard\n};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({updateForm:updateForm,getCommonApi:getCommonApi},dispatch);};export var TreatmentHistoryCart=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(ListTreatmentHistoryCartClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/treatmentDone/TreatmentHistoryCart.js"],"names":["React","Component","TableWrapper","NormalSelect","updateForm","getCommonApi","connect","bindActionCreators","_","TreatmentUsagePopup","withTranslation","ListTreatmentHistoryCartClass","state","headerDetails","label","TreatmentHistory","treatmentList","meta","customerNumber","yearList","selectedYear","Date","getFullYear","isTreatmentUsagePopup","TreatmentHistoryId","cust_data","componentDidMount","setState","props","then","key","status","data","value","push","getTreatmentHistoryList","page","limit","search","res","cust","console","log","dataList","pagination","handlehistoryYearChange","target","name","handlePagination","treatmentUsagePopupclose","prevState","treatmentUsagePopup","id","t","cust_name","cust_refer","length","map","item","index","trasac_date","purchase_date","transac","treatment_code","link_code","course","record_status","remarks","type","mapStateToProps","mapDispatchToProps","dispatch","TreatmentHistoryCart"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { TableWrapper, NormalSelect } from \"component/common\";\r\nimport { updateForm, getCommonApi } from \"redux/actions/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport _ from \"lodash\";\r\nimport { TreatmentUsagePopup } from \"./TreatmentUsagePopup\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class ListTreatmentHistoryCartClass extends Component {\r\n  state = {\r\n    headerDetails: [\r\n      { label: \"Trans Date\" },\r\n      { label: \"Purc Date\" },\r\n      { label: \"Transac #\" },\r\n      { label: \"Treatment ID\" },\r\n      { label: \"Link Code\" },\r\n      { label: \"Treatment\" },\r\n      { label: \"Status\" },\r\n      { label: \"Record Status\" },\r\n      { label: \"Remarks\" },\r\n      { label: \"Type\" },\r\n    ],\r\n    TreatmentHistory: [],\r\n    treatmentList: [],\r\n    meta: {},\r\n    customerNumber: 0,\r\n    yearList: [],\r\n    selectedYear: new Date().getFullYear(),\r\n    isTreatmentUsagePopup: false,\r\n    TreatmentHistoryId: 0,\r\n    cust_data: {},\r\n  };\r\n\r\n  componentDidMount = async () => {\r\n    await this.setState({\r\n      customerNumber: this.props.customerNumber,\r\n    });\r\n    this.props.getCommonApi(\"treatmentdone/Year/\").then(key => {\r\n      let { status, data } = key;\r\n      let { yearList } = this.state;\r\n      for (let value of data) {\r\n        yearList.push({ value: value, label: value });\r\n      }\r\n      this.setState({ yearList });\r\n    });\r\n\r\n    this.getTreatmentHistoryList({});\r\n  };\r\n\r\n  getTreatmentHistoryList = data => {\r\n    let { customerNumber, selectedYear, TreatmentHistory } = this.state;\r\n    if (customerNumber > 0) {\r\n      let { page = 1, limit = 10, search = \"\" } = data;\r\n      this.props\r\n        .getCommonApi(\r\n          `treatmenthistory/?year=${selectedYear}&cust_id=${customerNumber}&page=${page}&limit=${limit}`\r\n        )\r\n        .then(async res => {\r\n          await this.setState({ treatmentList: [], meta: {} });\r\n          let { data, status, cust } = res;\r\n          console.log(res, \"treatmenthistorycart\");\r\n          if (status === 200) {\r\n            if (data.dataList) {\r\n              this.setState({\r\n                treatmentList: data.dataList,\r\n                meta: data.meta.pagination,\r\n                cust_data: cust,\r\n              });\r\n            }\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  handlehistoryYearChange = async ({ target: { value, name } }) => {\r\n    let { selectedYear } = this.state;\r\n    selectedYear = value;\r\n    await this.setState({\r\n      selectedYear,\r\n    });\r\n    this.getTreatmentHistoryList({});\r\n  };\r\n\r\n  handlePagination = page => {\r\n    this.getTreatmentHistoryList(page);\r\n  };\r\n\r\n  treatmentUsagePopupclose = () => {\r\n    this.setState(prevState => ({\r\n      isTreatmentUsagePopup: !prevState.isTreatmentUsagePopup,\r\n    }));\r\n  };\r\n  treatmentUsagePopup = data => {\r\n    if (data.status == \"Done\") {\r\n      this.setState(prevState => ({\r\n        TreatmentHistoryId: data.id,\r\n        isTreatmentUsagePopup: !prevState.isTreatmentUsagePopup,\r\n      }));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      headerDetails,\r\n      treatmentList,\r\n      meta,\r\n      yearList,\r\n      selectedYear,\r\n      isTreatmentUsagePopup,\r\n      TreatmentHistoryId,\r\n      cust_data,\r\n    } = this.state;\r\n    let { t } = this.props;\r\n    return (\r\n      <>\r\n        <div className=\"row treatment-done-new p-3\">\r\n          <div className=\"col-10 header\">\r\n            <div className=\"d-flex select-year\">\r\n              <div className=\"pl-0 mb-2 name fs-16 py-2\">\r\n                {t(\"Select Year\")}\r\n              </div>\r\n              <div className=\"input-group\">\r\n                <NormalSelect\r\n                  // placeholder=\"Enter here\"\r\n                  options={yearList}\r\n                  value={selectedYear}\r\n                  name=\"selectedYear\"\r\n                  onChange={this.handlehistoryYearChange}\r\n                  className=\"selected-year mb-2 py-0\"\r\n                />\r\n              </div>\r\n              <div className=\"col-3\">\r\n                <div className=\"col-12\">\r\n                  {t(\"Customer Name\")} :{\" \"}\r\n                  <span className=\"fw-500 h6\">{cust_data.cust_name}</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"col-3\">\r\n                <div className=\"col-12\">\r\n                  {t(\"Reference\")} :{\" \"}\r\n                  <span className=\"fw-500 h6\">{cust_data.cust_refer}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"table-container\">\r\n          <TableWrapper\r\n            headerDetails={headerDetails}\r\n            queryHandler={this.handlePagination}\r\n            pageMeta={meta}\r\n          >\r\n            {treatmentList && treatmentList.length > 0 ? (\r\n              treatmentList.map((item, index) => {\r\n                let {\r\n                  trasac_date,\r\n                  purchase_date,\r\n                  transac,\r\n                  treatment_code,\r\n                  link_code,\r\n                  course,\r\n                  status,\r\n                  record_status,\r\n                  remarks,\r\n                  type,\r\n                } = item;\r\n                return (\r\n                  <tr\r\n                    key={index}\r\n                    onClick={() => this.treatmentUsagePopup(item)}\r\n                  >\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {trasac_date}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {purchase_date}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {transac}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {treatment_code}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {link_code}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {course}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {status}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {record_status}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {remarks}\r\n                      </div>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {type}\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            ) : (\r\n              <tr>\r\n                <td>\r\n                  <div className=\"d-flex align-items-center justify-content-center\">\r\n                    {t(\"No Data Available\")}\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </TableWrapper>\r\n        </div>\r\n        {isTreatmentUsagePopup ? (\r\n          <TreatmentUsagePopup\r\n            isTreatmentUsagePopup={isTreatmentUsagePopup}\r\n            treatmentUsagePopup={this.treatmentUsagePopup}\r\n            treatmentUsagePopupclose={this.treatmentUsagePopupclose}\r\n            TreatmentHistoryId={TreatmentHistoryId}\r\n          />\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  // filter: state.dashboard\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      updateForm,\r\n      getCommonApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const TreatmentHistoryCart = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(ListTreatmentHistoryCartClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}