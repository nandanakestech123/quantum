{"ast":null,"code":"import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{Toast}from\"service/toast\";import\"./style.scss\";import SimpleReactValidator from\"simple-react-validator\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{getCommonApi,commonCreateApi}from\"redux/actions/common\";import{NormalButton,NormalDate,TableWrapper}from\"component/common\";import{dateFormat}from\"service/helperFunctions\";import{withTranslation}from\"react-i18next\";import{NormalInput,NormalDateTime}from\"component/common\";import{Link}from\"react-router-dom\";import{createActivity}from\"redux/actions/project\";import{getTokenDetails}from\"redux/actions/auth\";export var ActivitiesClass=/*#__PURE__*/function(_React$Component){_inherits(ActivitiesClass,_React$Component);var _super=_createSuper(ActivitiesClass);function ActivitiesClass(){var _this;_classCallCheck(this,ActivitiesClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Date\"},{label:\"Activity\"},{label:\"User\"}],formFields:{dateCreated:new Date(),activity:\"\"},activityList:[],pageMeta:{// chunk: 10,\n// page: 1,\n// total: 10,\n// totalPages: 2,\n// chunk: 2,\n// page: 1,\n// total: 8,\n// totalPages: 4,\n},// formFields: {\n//   date: \"\",\n//   activity:\"\",\n//   user:\"\",\n// },\nactive:false,currentIndex:-1,page:1,// limit: 10,\nlimit:3,isOpenvoidCheckout:false,isLoading:true,// is_loading: false,\nisMounted:true};_this.updateState=function(data){if(_this.state.isMounted)_this.setState(data);};_this.componentWillMount=function(){_this.validator=new SimpleReactValidator({validators:{},element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});};_this.getActivities=function(){_this.updateState({isLoading:true});// console.log(\"isLoading\", isLoading)\nvar _this$state=_this.state,activityList=_this$state.activityList,pageMeta=_this$state.pageMeta,page=_this$state.page,limit=_this$state.limit;console.log(\"this.prop.fk_id activity page\",_this.props.fk_id);_this.props.getCommonApi(\"activitylist/?searchprojectid=\".concat(_this.props.fk_id,\"&page=\").concat(page,\"&limit=\").concat(limit)).then(function(res){console.log(\"this.props.tokenDetail.username\",_this.props.tokenDetail.username);console.log(res,\"dsfdfaafg\");_this.setState({activityList:[]});activityList=res.data.dataList;// pageMeta = res.data.meta.pagination;\npageMeta=res.data.pagination;// pageMeta = {per_page:5, current_page:1, total:2, total_pages:4}\n_this.setState({activityList:activityList,pageMeta:pageMeta});// this.setState({ activityList });\nconsole.log('res.data',res.data);console.log('activityList',activityList);console.log('pageMeta',pageMeta);_this.updateState({isLoading:false});});};_this.addActivity=function(){try{if(_this.validator.allValid()){// this.updateState({ is_loading: true });\n//   let { formFields } = this.state;\n//   Object.keys(formFields).forEach((e) => {\n//     if (typeof formFields[e] === \"boolean\")\n//       formFields[e] = formFields[e] ? \"True\" : \"False\";\n//   });\n// this.updateState({isLoading: true});\nvar formFields=_this.state.formFields;var formData=new FormData();formData.append(\"title\",formFields.activity);formData.append(\"fk_project\",_this.props.fk_id);console.log(\"formFields.dateCreated dateFormat\",dateFormat(formFields.dateCreated)+\" 00:00:00\");// console.log(\"dateFormat(new Date())\",dateFormat(new Date()))\n// let date1 = new Date(dateFormat(new Date()));\n// var today = new Date();\n// console.log(\"today\",today)\n// console.log(\"formFields.dateCreated\",formFields.dateCreated)\n// var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\n// var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n// var dateTime = date+' '+time;\n// console.log(\"dateTime\",dateTime)\n// console.log(\"date1.getTime()\",date1.getTime())\n// console.log(\"123123\",formFields.dateCreated.getHours() + \":\" + formFields.dateCreated.getMinutes() + \":\" + formFields.dateCreated.getSeconds())\nformData.append(\"created_at\",dateFormat(formFields.dateCreated)+\" \"+formFields.dateCreated.getHours()+\":\"+formFields.dateCreated.getMinutes()+\":\"+formFields.dateCreated.getSeconds());formData.append(\"name\",_this.props.tokenDetail.username);console.log(\"this.props.tokenDetail.username\",_this.props.tokenDetail.username);console.log(\"formData\",formData);// if (this.props.match.params.id) {\nconsole.log(\"in if loop\");// var res = \n_this.props.createActivity(formData).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"res\",res);_context.next=3;return _this.getActivities();case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());// this.props\n//     .commonCreateApi(\n//       `activitylist/`,\n//       formData\n//     )\n//     .then(async res => {\n//       console.log(\"res\",res)\n//       await this.getActivities()\n//     })\n// console.log(res);\n// this.updateState({isLoading: false});\n}else{_this.validator.showMessages();}// this.updateState({ is_loading: false });\n}catch(e){_this.updateState({is_loading:false});}};_this.handlePagination=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(pageNo){var page;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:page=_this.state.page;page=pageNo.page;_context2.next=4;return _this.setState({page:page});case 4:_this.getActivities();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.handleClick=function(key){if(!_this.state.active){document.addEventListener(\"click\",_this.handleOutsideClick,false);}else{document.removeEventListener(\"click\",_this.handleOutsideClick,false);}_this.setState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.handleOutsideClick=function(e){if(_this.node!=null){if(_this.node.contains(e.target)){return;}}_this.handleClick();};_this.handleChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref3){var _ref3$target,value,name,formFields;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref3$target=_ref3.target,value=_ref3$target.value,name=_ref3$target.name;formFields=_this.state.formFields;formFields[name]=value;_context3.next=5;return _this.setState({formFields:formFields});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}();return _this;}_createClass(ActivitiesClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.getActivities();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.state.isMounted=false;}},{key:\"render\",value://   handleDatePick = async (name, value) => {\n//     let { formFields } = this.state;\n//     formFields[name] = value;\n//     await this.setState({\n//       formFields,\n//     });\n//   };\n// seach change with api call\n// handlesearch = event => {\n//   event.persist();\n//   if (!this.debouncedFn) {\n//     this.debouncedFn = _.debounce(() => {\n//       let searchString = event.target.value;\n//       let data = { search: searchString };\n//       this.queryHandler(data);\n//     }, 500);\n//   }\n//   this.debouncedFn();\n// };\n// getProject = async data => {\n//   this.updateState({ isLoading: true });\n//   let { search } = this.state;\n//   let { page = 1, limit = 10 } = data;\n//   await this.props\n//     .getProject(`?page=${page}&limit=${limit}&search=${search}`)\n//     .then(res => {\n//       let { data } = res;\n//       console.log(data);\n//       //  let { customerDetails } = this.props;\n//       this.updateState({\n//         customerList: data.dataList,\n//         meta: data.meta?.pagination,\n//         isLoading: false,\n//       });\n//     });\n// };\n// api call for staff\n// queryHandler = async data => {\n//   this.updateState({ is_loading: true });\n//   let { page = 1, limit = 10 } = data;\n//   await this.props.getProject(\n//     `?page=${page}&limit=${limit}`\n//   );\n//   let { projectDetails } = this.props;\n//   let { activityList, pageMeta } = this.state;\n//   activityList = projectDetails.data;\n//   pageMeta = projectDetails.meta?.pagination;\n//   this.updateState({\n//     activityList,\n//     pageMeta,\n//     is_loading: false,\n//   });\n// };\n// // delete api call for staff\n// handleDeleteProject = id => {\n//   this.props.deleteProject(`${id}/`).then(res => this.queryHandler({}));\n// };\nfunction render(){var _this$state2=this.state,headerDetails=_this$state2.headerDetails,pageMeta=_this$state2.pageMeta,activityList=_this$state2.activityList,formFields=_this$state2.formFields,isLoading=_this$state2.isLoading;var dateCreated=formFields.dateCreated,activity=formFields.activity;var t=this.props.t;return/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:pageMeta},isLoading?/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"7\"},/*#__PURE__*/React.createElement(\"div\",{class:\"d-flex mt-5 align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},t(\"Loading...\")))))):activityList?activityList.map(function(item,index){var created_at=item.created_at,title=item.title,name=item.name;return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},created_at)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},title)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},name)));}):null),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"}),/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text fs-17 pt-1 ml-2\"},t(\"Date\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(NormalDate// value={new Date()}\n,{showYearDropdown:true,value:dateCreated,name:\"dateCreated\"// type=\"date\"\n,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",null,this.validator.message(t(\"Date\"),dateCreated,t(\"required\"))),/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text fs-17 pt-1 \"},t(\"Activity\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(NormalInput,{placeholder:\"Enter here\",value:activity,name:\"activity\",onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",null,this.validator.message(t(\"Activity\"),activity,t(\"required\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2 mb-3\",mainbg:true,className:\"confirm\",label:\"Add\",outline:false,onClick:this.addActivity})))));}}]);return ActivitiesClass;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{tokenDetail:state.authStore.tokenDetails};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCommonApi:getCommonApi,createActivity:createActivity,getTokenDetails:getTokenDetails,commonCreateApi:commonCreateApi// getProject\n},dispatch);};export var Activities=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(ActivitiesClass));","map":{"version":3,"sources":["F:/webfe/src/component/Admin/Project/AddProject/activities.js"],"names":["React","Toast","SimpleReactValidator","connect","bindActionCreators","getCommonApi","commonCreateApi","NormalButton","NormalDate","TableWrapper","dateFormat","withTranslation","NormalInput","NormalDateTime","Link","createActivity","getTokenDetails","ActivitiesClass","state","headerDetails","label","formFields","dateCreated","Date","activity","activityList","pageMeta","active","currentIndex","page","limit","isOpenvoidCheckout","isLoading","isMounted","updateState","data","setState","componentWillMount","validator","validators","element","message","autoForceUpdate","getActivities","console","log","props","fk_id","then","res","tokenDetail","username","dataList","pagination","addActivity","allValid","formData","FormData","append","getHours","getMinutes","getSeconds","showMessages","e","is_loading","handlePagination","pageNo","handleClick","key","document","addEventListener","handleOutsideClick","removeEventListener","prevState","node","contains","target","handleChange","value","name","t","map","item","index","created_at","title","Component","mapStateToProps","authStore","tokenDetails","mapDispatchToProps","dispatch","Activities"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Toast } from \"service/toast\";\r\nimport \"./style.scss\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { getCommonApi, commonCreateApi } from \"redux/actions/common\";\r\nimport { NormalButton, NormalDate, TableWrapper } from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport { NormalInput, NormalDateTime } from \"component/common\";\r\nimport { Link } from \"react-router-dom\"; \r\nimport {\r\n  createActivity,\r\n  \r\n} from \"redux/actions/project\";\r\nimport { getTokenDetails } from \"redux/actions/auth\";\r\n\r\nexport class ActivitiesClass extends React.Component {\r\n  state = {\r\n    headerDetails: [\r\n      { label: \"Date\" },\r\n      { label: \"Activity\" },\r\n      { label: \"User\" },\r\n    ],\r\n\r\n    formFields: {\r\n      dateCreated: new Date(),\r\n      activity: \"\"\r\n    },\r\n    \r\n    activityList: [],\r\n    pageMeta: {\r\n      // chunk: 10,\r\n      // page: 1,\r\n      // total: 10,\r\n      // totalPages: 2,\r\n\r\n      // chunk: 2,\r\n      // page: 1,\r\n      // total: 8,\r\n      // totalPages: 4,\r\n    },\r\n\r\n    // formFields: {\r\n    //   date: \"\",\r\n    //   activity:\"\",\r\n    //   user:\"\",\r\n    // },\r\n    \r\n    active: false,\r\n    currentIndex: -1,\r\n    page: 1,\r\n    // limit: 10,\r\n    limit: 3,\r\n    isOpenvoidCheckout: false,\r\n    isLoading: true,\r\n    // is_loading: false,\r\n    isMounted: true,\r\n  };\r\n\r\n  updateState = data => {\r\n    if (this.state.isMounted) this.setState(data);\r\n  };\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      validators: {},\r\n      element: (message) => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n  };\r\n\r\n  componentDidMount() {\r\n    \r\n    this.getActivities();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.state.isMounted = false;\r\n  }\r\n\r\n  getActivities = () => {\r\n    this.updateState({isLoading: true});\r\n    // console.log(\"isLoading\", isLoading)\r\n    \r\n    let { activityList, pageMeta, page, limit } = this.state;\r\n    console.log(\"this.prop.fk_id activity page\", this.props.fk_id)\r\n\r\n    this.props\r\n    .getCommonApi(\r\n      `activitylist/?searchprojectid=${this.props.fk_id}&page=${page}&limit=${limit}`\r\n    )\r\n      .then( res => {\r\n        console.log(\"this.props.tokenDetail.username\",this.props.tokenDetail.username)\r\n        console.log(res, \"dsfdfaafg\");\r\n        this.setState({ activityList: [] });\r\n        activityList = res.data.dataList;\r\n        // pageMeta = res.data.meta.pagination;\r\n        pageMeta = res.data.pagination;\r\n        // pageMeta = {per_page:5, current_page:1, total:2, total_pages:4}\r\n        this.setState({ activityList, pageMeta });\r\n        // this.setState({ activityList });\r\n        console.log('res.data',res.data)\r\n        console.log('activityList',activityList)\r\n        console.log('pageMeta',pageMeta)\r\n        this.updateState({isLoading: false});\r\n        \r\n      });\r\n    \r\n  };\r\n\r\n  // getProjects = () => {\r\n  //   this.props\r\n  //     .getCommonApi(\r\n  //       `projectlist/?searchid=${this.props.fk_id}`\r\n  //     )\r\n  //     .then(async res => {\r\n  //       console.log(\"project dataList\", res.data.dataList);\r\n  //       console.log(\"project dataList cust name\", res.data.dataList[0].customer_name);\r\n  //     });\r\n  // };\r\n\r\n  addActivity = () => {\r\n    try {\r\n      if (this.validator.allValid()) {\r\n        // this.updateState({ is_loading: true });\r\n      //   let { formFields } = this.state;\r\n      //   Object.keys(formFields).forEach((e) => {\r\n      //     if (typeof formFields[e] === \"boolean\")\r\n      //       formFields[e] = formFields[e] ? \"True\" : \"False\";\r\n      //   });\r\n      \r\n      // this.updateState({isLoading: true});\r\n        let { formFields } = this.state;\r\n\r\n      \r\n\r\n        const formData = new FormData();\r\n        formData.append(\"title\", formFields.activity);\r\n        formData.append(\"fk_project\", this.props.fk_id);\r\n\r\n        console.log(\"formFields.dateCreated dateFormat\",dateFormat(formFields.dateCreated)+\" 00:00:00\")\r\n        // console.log(\"dateFormat(new Date())\",dateFormat(new Date()))\r\n        // let date1 = new Date(dateFormat(new Date()));\r\n\r\n        // var today = new Date();\r\n        // console.log(\"today\",today)\r\n        // console.log(\"formFields.dateCreated\",formFields.dateCreated)\r\n        // var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n        // var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n        // var dateTime = date+' '+time;\r\n        // console.log(\"dateTime\",dateTime)\r\n        // console.log(\"date1.getTime()\",date1.getTime())\r\n        // console.log(\"123123\",formFields.dateCreated.getHours() + \":\" + formFields.dateCreated.getMinutes() + \":\" + formFields.dateCreated.getSeconds())\r\n        formData.append(\"created_at\", dateFormat(formFields.dateCreated) + \" \"+formFields.dateCreated.getHours() + \":\" + formFields.dateCreated.getMinutes() + \":\" + formFields.dateCreated.getSeconds());\r\n\r\n        formData.append(\"name\", this.props.tokenDetail.username);\r\n        \r\n        console.log(\"this.props.tokenDetail.username\",this.props.tokenDetail.username)\r\n        console.log(\"formData\", formData)\r\n        // if (this.props.match.params.id) {\r\n          console.log(\"in if loop\")\r\n          // var res = \r\n          this.props.createActivity(\r\n            formData\r\n          ).then(async res => {\r\n            console.log(\"res\",res)\r\n            await this.getActivities()\r\n          })\r\n          // this.props\r\n          //     .commonCreateApi(\r\n          //       `activitylist/`,\r\n          //       formData\r\n          //     )\r\n          //     .then(async res => {\r\n          //       console.log(\"res\",res)\r\n          //       await this.getActivities()\r\n          //     })\r\n          // console.log(res);\r\n        // this.updateState({isLoading: false});\r\n        \r\n        \r\n      } else {\r\n        this.validator.showMessages();\r\n      }\r\n      // this.updateState({ is_loading: false });\r\n    } catch (e) {\r\n      this.updateState({ is_loading: false });\r\n    }\r\n  };\r\n\r\n  handlePagination = async pageNo => {\r\n    let { page } = this.state;\r\n    page = pageNo.page;\r\n    await this.setState({\r\n      page,\r\n    });\r\n    this.getActivities();\r\n  };\r\n  // pagination\r\n  // handlePagination = page => {\r\n  //   this.queryHandler(page);\r\n  // };\r\n\r\n  handleClick = key => {\r\n    if (!this.state.active) {\r\n      document.addEventListener(\"click\", this.handleOutsideClick, false);\r\n    } else {\r\n      document.removeEventListener(\"click\", this.handleOutsideClick, false);\r\n    }\r\n\r\n    this.setState(prevState => ({\r\n      active: !prevState.active,\r\n      currentIndex: key,\r\n    }));\r\n  };\r\n\r\n  handleOutsideClick = e => {\r\n    if (this.node != null) {\r\n      if (this.node.contains(e.target)) {\r\n        return;\r\n      }\r\n    }\r\n    this.handleClick();\r\n  };\r\n\r\n  handleChange = async ({ target: { value, name } }) => {\r\n    let { formFields } = this.state;\r\n    formFields[name] = value;\r\n    await this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n\r\n//   handleDatePick = async (name, value) => {\r\n//     let { formFields } = this.state;\r\n//     formFields[name] = value;\r\n//     await this.setState({\r\n//       formFields,\r\n//     });\r\n//   };\r\n\r\n\r\n  // seach change with api call\r\n  // handlesearch = event => {\r\n  //   event.persist();\r\n\r\n  //   if (!this.debouncedFn) {\r\n  //     this.debouncedFn = _.debounce(() => {\r\n  //       let searchString = event.target.value;\r\n  //       let data = { search: searchString };\r\n  //       this.queryHandler(data);\r\n  //     }, 500);\r\n  //   }\r\n  //   this.debouncedFn();\r\n  // };\r\n\r\n  // getProject = async data => {\r\n  //   this.updateState({ isLoading: true });\r\n  //   let { search } = this.state;\r\n  //   let { page = 1, limit = 10 } = data;\r\n  //   await this.props\r\n  //     .getProject(`?page=${page}&limit=${limit}&search=${search}`)\r\n  //     .then(res => {\r\n  //       let { data } = res;\r\n  //       console.log(data);\r\n  //       //  let { customerDetails } = this.props;\r\n  //       this.updateState({\r\n  //         customerList: data.dataList,\r\n  //         meta: data.meta?.pagination,\r\n  //         isLoading: false,\r\n  //       });\r\n  //     });\r\n  // };\r\n\r\n  // api call for staff\r\n  // queryHandler = async data => {\r\n  //   this.updateState({ is_loading: true });\r\n  //   let { page = 1, limit = 10 } = data;\r\n  //   await this.props.getProject(\r\n  //     `?page=${page}&limit=${limit}`\r\n  //   );\r\n  //   let { projectDetails } = this.props;\r\n  //   let { activityList, pageMeta } = this.state;\r\n  //   activityList = projectDetails.data;\r\n  //   pageMeta = projectDetails.meta?.pagination;\r\n  //   this.updateState({\r\n  //     activityList,\r\n  //     pageMeta,\r\n  //     is_loading: false,\r\n  //   });\r\n  // };\r\n\r\n  // // delete api call for staff\r\n  // handleDeleteProject = id => {\r\n  //   this.props.deleteProject(`${id}/`).then(res => this.queryHandler({}));\r\n  // };\r\n  \r\n  \r\n\r\n  render() {\r\n    let { headerDetails, pageMeta, activityList, formFields, isLoading} = \r\n      this.state;\r\n\r\n    let { dateCreated, activity } = formFields\r\n    \r\n    let {t} =this.props;\r\n    \r\n    return (\r\n          <div className=\"py-4\">\r\n            <div className=\"table-container\">\r\n              <TableWrapper\r\n                headerDetails={headerDetails}\r\n                queryHandler={this.handlePagination}\r\n                pageMeta={pageMeta}\r\n              >\r\n                {isLoading ? (\r\n                      <tr>\r\n                        <td colSpan=\"7\">\r\n                          <div class=\"d-flex mt-5 align-items-center justify-content-center\">\r\n                            <div class=\"spinner-border\" role=\"status\">\r\n                              <span class=\"sr-only\">{t(\"Loading...\")}</span>\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                \r\n                ) : activityList\r\n                  ? activityList.map((item, index) => {\r\n                      let {\r\n                        created_at,\r\n                        title,\r\n                        name\r\n                        \r\n                      } = item;\r\n                      return (\r\n                        <tr key={index}>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              { created_at }\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              { title }\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center justify-content-center\">\r\n                              { name }\r\n                            </div>\r\n                          </td>\r\n                          \r\n                                   \r\n                        </tr>\r\n                      );\r\n                    })\r\n                  : null}\r\n                \r\n              \r\n              </TableWrapper>\r\n\r\n              <div className=\"row mt-5\">\r\n\r\n                <div className=\"col-1\"></div>\r\n                \r\n                <label className=\"text-left text-black common-label-text fs-17 pt-1 ml-2\">\r\n                  {t(\"Date\")}\r\n                </label>\r\n                <div className=\"col-3\">\r\n                  <NormalDate\r\n                    // value={new Date()}\r\n                    showYearDropdown={true}\r\n                    value={dateCreated}\r\n                    name=\"dateCreated\"\r\n                    // type=\"date\"\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </div>\r\n                <div>\r\n                    {this.validator.message(\r\n                      t(\"Date\"),\r\n                      dateCreated,\r\n                      t(\"required\")\r\n                    )}\r\n                </div>\r\n\r\n                <label className=\"text-left text-black common-label-text fs-17 pt-1 \">\r\n                    {t(\"Activity\")}\r\n                </label>\r\n                <div className=\"col-4\">\r\n                  <NormalInput\r\n                    placeholder=\"Enter here\"\r\n                    value={activity}\r\n                    name=\"activity\"\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </div>\r\n                <div>\r\n                    {this.validator.message(\r\n                      t(\"Activity\"),\r\n                      activity,\r\n                      t(\"required\")\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"col-2\">\r\n                <NormalButton\r\n                  buttonClass={\"mx-2 mb-3\"}\r\n                  mainbg={true}\r\n                  className=\"confirm\"\r\n                  label=\"Add\"\r\n                  outline={false}\r\n                  onClick={this.addActivity}               \r\n                />\r\n              </div>\r\n                \r\n              </div>\r\n            </div>\r\n          </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  tokenDetail: state.authStore.tokenDetails,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      createActivity,\r\n      getTokenDetails,\r\n      commonCreateApi,\r\n      // getProject\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\n\r\n\r\nexport const Activities =withTranslation()( connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ActivitiesClass));\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}