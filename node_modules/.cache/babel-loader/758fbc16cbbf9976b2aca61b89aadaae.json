{"ast":null,"code":"import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import\"./style.scss\";import{Link}from'react-router-dom';import SimpleReactValidator from'simple-react-validator';import{NormalInput,NormalSelect,NormalButton,NormalDate}from'component/common';import{displayImg}from'service/helperFunctions';import{DragFileUpload}from'../../../common';import{CreateCustomer,getCustomer,updateCustomer}from'redux/actions/customer';import{connect}from'react-redux';import{bindActionCreators}from\"redux\";import{AddCustomerForm}from'./addCustomer';import{dateFormat}from'service/helperFunctions';import{getLoginSaloon}from'redux/actions/auth';import{updateForm}from'redux/actions/common';export var AddCustomerPlusClass=/*#__PURE__*/function(_Component){_inherits(AddCustomerPlusClass,_Component);var _super=_createSuper(AddCustomerPlusClass);function AddCustomerPlusClass(){var _this;_classCallCheck(this,AddCustomerPlusClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={formFields:{cust_name:'',cust_address:'',cust_dob:new Date(),cust_phone1:'',cust_phone2:'',cust_refer:'',cust_email:'',cust_title:'',cust_nric:'',cust_class:'',cust_source:'',Cust_sexes:'',Cust_sexesid:'',Site_Codeid:'',custallowsendsms:false,cust_maillist:false},sexOption:[{value:1,label:\"Male\"},{value:2,label:\"Female\"}],salonList:[]};_this.getCustomer=function(){_this.props.getCustomer(_this.props.match.params.id).then(function(res){_this.getDataFromStore();});};_this.getDataFromStore=function(){var formFields=_this.state.formFields;var customerDetail=_this.props.customerDetail;formFields['cust_name']=customerDetail.cust_name;formFields['cust_address']=customerDetail.cust_address;formFields['cust_dob']=new Date(customerDetail.cust_dob);formFields['cust_phone2']=customerDetail.cust_phone2;formFields['cust_phone1']=customerDetail.cust_phone1;formFields['cust_refer']=customerDetail.cust_refer;formFields['cust_nric']=customerDetail.cust_nric;formFields['cust_class']=customerDetail.cust_class;formFields['cust_source']=customerDetail.cust_source;formFields['cust_title']=customerDetail.cust_title;formFields['cust_email']=customerDetail.cust_email;formFields['Cust_sexes']=customerDetail.Cust_sexes;formFields['Cust_sexesid']=customerDetail.Cust_sexesid;formFields['Site_Codeid']=customerDetail.Site_Codeid;formFields['Site_Code']=customerDetail.Site_Code;formFields['custallowsendsms']=customerDetail.custallowsendsms;formFields['cust_maillist']=customerDetail.cust_maillist;_this.setState({formFields:formFields});console.log(formFields,customerDetail,\"sfsdfhsdfsdfg\");};_this.handleChange=function(_ref){var _ref$target=_ref.target,value=_ref$target.value,name=_ref$target.name;var formFields=Object.assign({},_this.state.formFields);formFields[name]=value;_this.setState({formFields:formFields});};_this.handleChangeBox=function(event){var formFields=Object.assign({},_this.state.formFields);formFields[event.target.name]=event.target.checked;_this.setState({formFields:formFields});};_this.handleInput=function(_ref2){var _ref2$target=_ref2.target,name=_ref2$target.name,value=_ref2$target.value;var formFields=Object.assign({},_this.state.formFields);formFields[name]=value===true?1:value;_this.setState({formFields:formFields});};_this.handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var formFields,type,date,d,day,a,month,year;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formFields=_this.state.formFields;type=data;console.log(type,\"====\",data,\"sdfasdfasdf\");date=new Date(formFields.cust_dob);d=date.getDate();day=d<10?\"0\"+d:d;a=date.getMonth()+1;month=a<10?\"0\"+a:a;year=date.getFullYear();formFields[\"cust_dob\"]=\"\".concat(year,\"-\").concat(month,\"-\").concat(day);if(!_this.props.match.params.id){_context2.next=15;break;}_context2.next=13;return _this.props.updateCustomer(\"\".concat(_this.props.match.params.id,\"/\"),formFields).then(function(data){if(data.status===200){_this.resetData();if(_this.props.match.params.id){_this.props.history.push(\"/admin/customerplus/\".concat(_this.props.match.params.id,\"/details\"));}}});case 13:_context2.next=17;break;case 15:_context2.next=17;return _this.props.CreateCustomer(formFields).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formFields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(data.status===201)){_context.next=12;break;}_this.resetData();if(!_this.props.match.params.id){_context.next=6;break;}_this.props.history.push(\"/admin/cart/\".concat(_this.props.match.params.id,\"/details\"));_context.next=12;break;case 6:_formFields={};_formFields[\"custId\"]=data.data.id;_formFields[\"custName\"]=data.data.cust_name;_context.next=11;return _this.props.updateForm('basicApptDetail',_formFields);case 11:if(type===\"catalog\"){_this.props.history.push(\"/admin/cart\");}else if(data){_this.props.history.push(\"/admin/customerplus\");}else{_this.props.history.push(\"/admin/cart\");}case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref4.apply(this,arguments);};}());case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.handleCancel=function(){if(_this.props.match.params.id){_this.props.history.push(\"/admin/customerplus/\".concat(_this.props.match.params.id,\"/details\"));}else{_this.props.history.push(\"/admin/customerplus\");}};_this.handleDatePick=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name,value){var formFields;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(name,value,\"sdfgdfhfshg\",dateFormat(new Date()));// dateFormat(new Date())\nformFields=_this.state.formFields;formFields[name]=value;// formFields[name] = value;\n_context3.next=5;return _this.setState({formFields:formFields});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3,_x4){return _ref5.apply(this,arguments);};}();_this.resetData=function(){var formFields=_this.state.formFields;formFields['cust_name']=\"\";formFields['cust_address']=\"\";formFields['cust_dob']=new Date();formFields['cust_phone1']=\"\";formFields['cust_phone2']=\"\";formFields['cust_refer']=\"\";formFields['cust_email']=\"\";formFields['cust_nric']=\"\";formFields['cust_title']=\"\";formFields['cust_class']=\"\";formFields['cust_source']=\"\";formFields['Cust_sexesid']=\"\";formFields['Site_Codeid']=\"\";formFields['Cust_sexes']=\"\";formFields['Site_Code']=\"\";_this.setState(formFields);};return _this;}_createClass(AddCustomerPlusClass,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;if(this.props.match.params.id){this.getCustomer();}var salonList=this.state.salonList;this.props.getLoginSaloon().then(function(res){var _iterator=_createForOfIteratorHelper(res.data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;salonList.push({value:key.id,label:key.itemsite_desc});}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this2.setState({salonList:salonList});});}},{key:\"render\",value:function render(){var _this$state=this.state,formFields=_this$state.formFields,sexOption=_this$state.sexOption,salonList=_this$state.salonList;var cust_name=formFields.cust_name;return/*#__PURE__*/React.createElement(\"div\",{className:\"create-customer-section container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"create-customer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"head-label-nav\"},/*#__PURE__*/React.createElement(\"p\",{className:\"category\"},\"Customer Plus\"),/*#__PURE__*/React.createElement(\"i\",{className:\"icon-right mx-md-3\"}),/*#__PURE__*/React.createElement(\"p\",{className:\"sub-category\"},this.props.match.params.id?\"Edit\":\"Add\",\" New Customer\")),/*#__PURE__*/React.createElement(\"div\",{className:\"customer-detail\"},/*#__PURE__*/React.createElement(AddCustomerForm,{formFields:formFields,salonList:salonList,handleDatePick:this.handleDatePick,sexOption:sexOption,handleChange:this.handleChange,handleSubmit:this.handleSubmit,handleCancel:this.handleCancel,handleChangeBox:this.handleChangeBox}))));}}]);return AddCustomerPlusClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{customerDetail:state.customer.customerDetail};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({CreateCustomer:CreateCustomer,getCustomer:getCustomer,updateCustomer:updateCustomer,getLoginSaloon:getLoginSaloon,updateForm:updateForm},dispatch);};export var AddCustomerPlus=connect(mapStateToProps,mapDispatchToProps)(AddCustomerPlusClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/CustomerPlus/AddCustomerPlus/index.js"],"names":["React","Component","Link","SimpleReactValidator","NormalInput","NormalSelect","NormalButton","NormalDate","displayImg","DragFileUpload","CreateCustomer","getCustomer","updateCustomer","connect","bindActionCreators","AddCustomerForm","dateFormat","getLoginSaloon","updateForm","AddCustomerPlusClass","state","formFields","cust_name","cust_address","cust_dob","Date","cust_phone1","cust_phone2","cust_refer","cust_email","cust_title","cust_nric","cust_class","cust_source","Cust_sexes","Cust_sexesid","Site_Codeid","custallowsendsms","cust_maillist","sexOption","value","label","salonList","props","match","params","id","then","res","getDataFromStore","customerDetail","Site_Code","setState","console","log","handleChange","target","name","Object","assign","handleChangeBox","event","checked","handleInput","handleSubmit","data","type","date","d","getDate","day","a","getMonth","month","year","getFullYear","status","resetData","history","push","handleCancel","handleDatePick","key","itemsite_desc","mapStateToProps","customer","mapDispatchToProps","dispatch","AddCustomerPlus"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport \"./style.scss\";\r\nimport { Link } from 'react-router-dom';\r\nimport SimpleReactValidator from 'simple-react-validator';\r\nimport { NormalInput, NormalSelect, NormalButton, NormalDate } from 'component/common';\r\nimport { displayImg } from 'service/helperFunctions';\r\nimport { DragFileUpload } from '../../../common';\r\nimport { CreateCustomer, getCustomer, updateCustomer } from 'redux/actions/customer'\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from \"redux\";\r\nimport { AddCustomerForm } from './addCustomer';\r\nimport { dateFormat } from 'service/helperFunctions';\r\nimport { getLoginSaloon } from 'redux/actions/auth';\r\nimport { updateForm } from 'redux/actions/common';\r\n\r\nexport class AddCustomerPlusClass extends Component {\r\n    state = {\r\n        formFields: {\r\n            cust_name: '',\r\n            cust_address: '',\r\n            cust_dob: new Date(),\r\n            cust_phone1: '',\r\n            cust_phone2: '',\r\n            cust_refer: '',\r\n            cust_email: '',\r\n            cust_title: '',\r\n            cust_nric: '',\r\n            cust_class: '',\r\n            cust_source: '',\r\n            Cust_sexes: '',\r\n            Cust_sexesid: '',\r\n            Site_Codeid: '',\r\n            custallowsendsms: false,\r\n            cust_maillist: false\r\n        },\r\n        sexOption: [\r\n            { value: 1, label: \"Male\" },\r\n            { value: 2, label: \"Female\" }\r\n        ],\r\n        salonList: []\r\n    };\r\n\r\n    componentWillMount() {\r\n        if (this.props.match.params.id) {\r\n            this.getCustomer();\r\n        }\r\n        let { salonList } = this.state;\r\n        this.props.getLoginSaloon().then((res) => {\r\n            for (let key of res.data) {\r\n                salonList.push({ value: key.id, label: key.itemsite_desc })\r\n            }\r\n            this.setState({ salonList })\r\n        })\r\n    }\r\n\r\n    getCustomer = () => {\r\n        this.props.getCustomer(this.props.match.params.id).then((res) => {\r\n            this.getDataFromStore();\r\n        })\r\n    }\r\n\r\n    getDataFromStore = () => {\r\n        let { formFields } = this.state;\r\n        let { customerDetail } = this.props\r\n        formFields['cust_name'] = customerDetail.cust_name;\r\n        formFields['cust_address'] = customerDetail.cust_address;\r\n        formFields['cust_dob'] = new Date(customerDetail.cust_dob);\r\n        formFields['cust_phone2'] = customerDetail.cust_phone2;\r\n        formFields['cust_phone1'] = customerDetail.cust_phone1;\r\n        formFields['cust_refer'] = customerDetail.cust_refer;\r\n        formFields['cust_nric'] = customerDetail.cust_nric;\r\n        formFields['cust_class'] = customerDetail.cust_class;\r\n        formFields['cust_source'] = customerDetail.cust_source;\r\n        formFields['cust_title'] = customerDetail.cust_title;\r\n        formFields['cust_email'] = customerDetail.cust_email;\r\n        formFields['Cust_sexes'] = customerDetail.Cust_sexes;\r\n        formFields['Cust_sexesid'] = customerDetail.Cust_sexesid;\r\n        formFields['Site_Codeid'] = customerDetail.Site_Codeid;\r\n        formFields['Site_Code'] = customerDetail.Site_Code;\r\n        formFields['custallowsendsms'] = customerDetail.custallowsendsms;\r\n        formFields['cust_maillist'] = customerDetail.cust_maillist;\r\n        this.setState({ formFields })\r\n        console.log(formFields, customerDetail, \"sfsdfhsdfsdfg\")\r\n    }\r\n\r\n    handleChange = ({ target: { value, name } }) => {\r\n        let formFields = Object.assign({}, this.state.formFields);\r\n\r\n        formFields[name] = value;\r\n\r\n\r\n        this.setState({\r\n            formFields,\r\n        });\r\n    };\r\n\r\n    handleChangeBox = (event) => {\r\n        let formFields = Object.assign({}, this.state.formFields);\r\n\r\n        formFields[event.target.name] = event.target.checked;\r\n\r\n\r\n        this.setState({\r\n            formFields,\r\n        });\r\n    };\r\n\r\n\r\n    handleInput = ({ target: { name, value } }) => {\r\n\r\n        let formFields = Object.assign({}, this.state.formFields)\r\n        formFields[name] = (value === true ? 1 : value);\r\n        this.setState({\r\n            formFields\r\n        })\r\n\r\n    }\r\n\r\n    handleSubmit = async (data) => {\r\n        let { formFields } = this.state;\r\n        let type = data;\r\n        console.log(type, \"====\", data, \"sdfasdfasdf\")\r\n       \r\n        let date = new Date(formFields.cust_dob)\r\n        let d = date.getDate();\r\n        let day = (d < 10 ? (\"0\" + d) : (d));\r\n        let a = date.getMonth() + 1;\r\n        let month = (a < 10 ? (\"0\" + a) : (a));\r\n        let year = date.getFullYear();\r\n        formFields[\"cust_dob\"] =`${year}-${month}-${day}`;\r\n\r\n        if (this.props.match.params.id) {\r\n            await this.props.updateCustomer(`${this.props.match.params.id}/`, formFields).then((data) => {\r\n                if (data.status === 200) {\r\n                    this.resetData();\r\n                    if (this.props.match.params.id) {\r\n                        this.props.history.push(`/admin/customerplus/${this.props.match.params.id}/details`)\r\n                    }\r\n                }\r\n               \r\n            })\r\n            \r\n        } else {\r\n            await this.props.CreateCustomer(formFields).then(async (data) => {\r\n                if (data.status === 201) {\r\n                    this.resetData();\r\n                    if (this.props.match.params.id) {\r\n                        this.props.history.push(`/admin/cart/${this.props.match.params.id}/details`)\r\n                    } else {\r\n                        let formFields = {};\r\n                        formFields[\"custId\"] = data.data.id;\r\n                        formFields[\"custName\"] = data.data.cust_name;\r\n                        await this.props.updateForm('basicApptDetail', formFields)\r\n                        if (type === \"catalog\") {\r\n                            this.props.history.push(`/admin/cart`);\r\n                        } else if (data) {\r\n                            this.props.history.push(`/admin/customerplus`);\r\n                        } else {\r\n                            this.props.history.push(`/admin/cart`);\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            \r\n        }\r\n    };\r\n\r\n    handleCancel = () => {\r\n        if (this.props.match.params.id) {\r\n            this.props.history.push(`/admin/customerplus/${this.props.match.params.id}/details`)\r\n        } else {\r\n            this.props.history.push(`/admin/customerplus`);\r\n        }\r\n    }\r\n\r\n    handleDatePick = async (name, value) => {\r\n        console.log(name, value, \"sdfgdfhfshg\", dateFormat(new Date()))\r\n        // dateFormat(new Date())\r\n        let { formFields } = this.state;\r\n        formFields[name] = value;\r\n        // formFields[name] = value;\r\n        await this.setState({\r\n            formFields,\r\n        });\r\n    };\r\n\r\n    resetData = () => {\r\n        let { formFields } = this.state;\r\n        formFields['cust_name'] = \"\";\r\n        formFields['cust_address'] = \"\";\r\n        formFields['cust_dob'] = new Date();\r\n        formFields['cust_phone1'] = \"\";\r\n        formFields['cust_phone2'] = \"\";\r\n        formFields['cust_refer'] = \"\";\r\n        formFields['cust_email'] = \"\";\r\n        formFields['cust_nric'] = \"\";\r\n        formFields['cust_title'] = \"\";\r\n        formFields['cust_class'] = \"\";\r\n        formFields['cust_source'] = \"\";\r\n        formFields['Cust_sexesid'] = \"\";\r\n        formFields['Site_Codeid'] = \"\";\r\n        formFields['Cust_sexes'] = \"\";\r\n        formFields['Site_Code'] = \"\";\r\n        this.setState(formFields)\r\n    }\r\n\r\n    render() {\r\n        let { formFields, sexOption, salonList } = this.state;\r\n        let { cust_name } = formFields;\r\n        return (\r\n            <div className=\"create-customer-section container\">\r\n                {/* <p className=\"list-heading pb-4\"> {id ? \"Edit\" : \"Add\"} Customer</p> */}\r\n                <div className=\"create-customer\">\r\n                    <div className=\"head-label-nav\">\r\n                        <p className=\"category\">Customer Plus</p>\r\n                        <i className=\"icon-right mx-md-3\"></i>\r\n                        <p className=\"sub-category\">{this.props.match.params.id ? \"Edit\" : \"Add\"} New Customer</p>\r\n                    </div>\r\n                    <div className=\"customer-detail\">\r\n                        <AddCustomerForm formFields={formFields} salonList={salonList} handleDatePick={this.handleDatePick} sexOption={sexOption} handleChange={this.handleChange} handleSubmit={this.handleSubmit} handleCancel={this.handleCancel} handleChangeBox={this.handleChangeBox}></AddCustomerForm>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n    customerDetail: state.customer.customerDetail\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return bindActionCreators({\r\n        CreateCustomer,\r\n        getCustomer,\r\n        updateCustomer,\r\n        getLoginSaloon,\r\n        updateForm\r\n    }, dispatch)\r\n}\r\n\r\nexport const AddCustomerPlus = connect(mapStateToProps, mapDispatchToProps)(AddCustomerPlusClass)\r\n"]},"metadata":{},"sourceType":"module"}