{"ast":null,"code":"/**\r\n * DevExtreme (ui/sortable.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../events/core/events_engine\"));\n\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _draggable = _interopRequireDefault(require(\"./draggable\"));\n\nvar _element = require(\"../core/element\");\n\nvar _window = require(\"../core/utils/window\");\n\nvar _position = require(\"../core/utils/position\");\n\nvar _translator = require(\"../animation/translator\");\n\nvar _fx = _interopRequireDefault(require(\"../animation/fx\"));\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar SORTABLE = \"dxSortable\";\nvar PLACEHOLDER_CLASS = \"placeholder\";\nvar CLONE_CLASS = \"clone\";\n\nvar isElementVisible = function (itemElement) {\n  return (0, _renderer.default)(itemElement).is(\":visible\");\n};\n\nvar animate = function (element, config) {\n  var _config$to, _config$to2;\n\n  if (!element) {\n    return;\n  }\n\n  var left = (null === (_config$to = config.to) || void 0 === _config$to ? void 0 : _config$to.left) || 0;\n  var top = (null === (_config$to2 = config.to) || void 0 === _config$to2 ? void 0 : _config$to2.top) || 0;\n  element.style.transform = \"translate(\".concat(left, \"px,\").concat(top, \"px)\");\n  element.style.transition = _fx.default.off ? \"\" : \"transform \".concat(config.duration, \"ms \").concat(config.easing);\n};\n\nvar stopAnimation = function (element) {\n  if (!element) {\n    return;\n  }\n\n  element.style.transform = \"\";\n  element.style.transition = \"\";\n};\n\nvar Sortable = _draggable.default.inherit({\n  _init: function () {\n    this.callBase();\n    this._sourceScrollHandler = this._handleSourceScroll.bind(this);\n    this._sourceScrollableInfo = null;\n  },\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      clone: true,\n      filter: \"> *\",\n      itemOrientation: \"vertical\",\n      dropFeedbackMode: \"push\",\n      allowDropInsideItem: false,\n      allowReordering: true,\n      moveItemOnDrop: false,\n      onDragChange: null,\n      onAdd: null,\n      onRemove: null,\n      onReorder: null,\n      onPlaceholderPrepared: null,\n      animation: {\n        type: \"slide\",\n        duration: 300,\n        easing: \"ease\"\n      },\n      fromIndex: null,\n      toIndex: null,\n      dropInsideItem: false,\n      itemPoints: null,\n      fromIndexOffset: 0,\n      offset: 0,\n      autoUpdate: false,\n      draggableElementSize: 0\n    });\n  },\n  reset: function () {\n    this.option({\n      dropInsideItem: false,\n      toIndex: null,\n      fromIndex: null,\n      itemPoints: null,\n      fromIndexOffset: 0,\n      draggableElementSize: 0\n    });\n\n    if (this._$placeholderElement) {\n      this._$placeholderElement.remove();\n    }\n\n    this._$placeholderElement = null;\n\n    if (!this._isIndicateMode() && this._$modifiedItem) {\n      this._$modifiedItem.css(\"marginBottom\", this._modifiedItemMargin);\n\n      this._$modifiedItem = null;\n    }\n  },\n  _getPrevVisibleItem: function (items, index) {\n    return items.slice(0, index).reverse().filter(isElementVisible)[0];\n  },\n  _dragStartHandler: function (e) {\n    this.callBase.apply(this, arguments);\n\n    if (true === e.cancel) {\n      return;\n    }\n\n    var $sourceElement = this._getSourceElement();\n\n    this._updateItemPoints();\n\n    this._subscribeToSourceScroll(e);\n\n    this.option(\"fromIndex\", this._getElementIndex($sourceElement));\n    this.option(\"fromIndexOffset\", this.option(\"offset\"));\n  },\n  _dragEndHandler: function () {\n    this.callBase.apply(this, arguments);\n\n    this._unsubscribeFromSourceScroll();\n  },\n  _subscribeToSourceScroll: function (e) {\n    var $scrollable = this._getScrollable((0, _renderer.default)(e.target));\n\n    if ($scrollable) {\n      this._sourceScrollableInfo = {\n        element: $scrollable,\n        scrollLeft: $scrollable.scrollLeft(),\n        scrollTop: $scrollable.scrollTop()\n      };\n\n      _events_engine.default.on($scrollable, \"scroll\", this._sourceScrollHandler);\n    }\n  },\n  _unsubscribeFromSourceScroll: function () {\n    if (this._sourceScrollableInfo) {\n      _events_engine.default.off(this._sourceScrollableInfo.element, \"scroll\", this._sourceScrollHandler);\n\n      this._sourceScrollableInfo = null;\n    }\n  },\n  _handleSourceScroll: function (e) {\n    var _this = this;\n\n    var sourceScrollableInfo = this._sourceScrollableInfo;\n\n    if (sourceScrollableInfo) {\n      [\"scrollLeft\", \"scrollTop\"].forEach(function (scrollProp) {\n        if (e.target[scrollProp] !== sourceScrollableInfo[scrollProp]) {\n          var scrollBy = e.target[scrollProp] - sourceScrollableInfo[scrollProp];\n\n          _this._correctItemPoints(scrollBy);\n\n          sourceScrollableInfo[scrollProp] = e.target[scrollProp];\n        }\n      });\n    }\n  },\n  _dragEnterHandler: function () {\n    this.callBase.apply(this, arguments);\n\n    if (this === this._getSourceDraggable()) {\n      return;\n    }\n\n    this._updateItemPoints();\n\n    this.option(\"fromIndex\", -1);\n\n    if (!this._isIndicateMode()) {\n      var itemPoints = this.option(\"itemPoints\");\n      var lastItemPoint = itemPoints[itemPoints.length - 1];\n\n      if (lastItemPoint) {\n        var $element = this.$element();\n\n        var $sourceElement = this._getSourceElement();\n\n        var isVertical = this._isVerticalOrientation();\n\n        var sourceElementSize = isVertical ? $sourceElement.outerHeight(true) : $sourceElement.outerWidth(true);\n        var scrollSize = $element.get(0)[isVertical ? \"scrollHeight\" : \"scrollWidth\"];\n        var scrollPosition = $element.get(0)[isVertical ? \"scrollTop\" : \"scrollLeft\"];\n        var positionProp = isVertical ? \"top\" : \"left\";\n        var lastPointPosition = lastItemPoint[positionProp];\n        var elementPosition = $element.offset()[positionProp];\n        var freeSize = elementPosition + scrollSize - scrollPosition - lastPointPosition;\n\n        if (freeSize < sourceElementSize) {\n          if (isVertical) {\n            var items = this._getItems();\n\n            var $lastItem = (0, _renderer.default)(this._getPrevVisibleItem(items));\n            this._$modifiedItem = $lastItem;\n            this._modifiedItemMargin = $lastItem.get(0).style.marginBottom;\n            $lastItem.css(\"marginBottom\", sourceElementSize - freeSize);\n            var $sortable = $lastItem.closest(\".dx-sortable\");\n            var sortable = $sortable.data(\"dxScrollable\") || $sortable.data(\"dxScrollView\");\n            sortable && sortable.update();\n          }\n        }\n      }\n    }\n  },\n  dragEnter: function () {\n    if (this !== this._getTargetDraggable()) {\n      this.option(\"toIndex\", -1);\n    }\n  },\n  dragLeave: function () {\n    if (this !== this._getTargetDraggable()) {\n      this.option(\"toIndex\", this.option(\"fromIndex\"));\n    }\n  },\n  _isInsideTargetDraggable: function (event) {\n    var $targetDraggable = this._getTargetDraggable().$element();\n\n    var $scrollable = this._getScrollable($targetDraggable);\n\n    if ($scrollable) {\n      var offset = $scrollable.offset();\n      var validY = offset.top + $scrollable.height() >= event.pageY && offset.top <= event.pageY;\n      var validX = offset.left + $scrollable.width() >= event.pageX && offset.left <= event.pageX;\n      return validY && validX;\n    }\n\n    return true;\n  },\n  dragEnd: function (sourceEvent) {\n    var $sourceElement = this._getSourceElement();\n\n    var sourceDraggable = this._getSourceDraggable();\n\n    var isSourceDraggable = sourceDraggable.NAME !== this.NAME;\n    var toIndex = this.option(\"toIndex\");\n\n    var isInsideTargetDraggable = this._isInsideTargetDraggable(sourceEvent.event);\n\n    if (null !== toIndex && toIndex >= 0 && isInsideTargetDraggable) {\n      var cancelAdd;\n      var cancelRemove;\n\n      if (sourceDraggable !== this) {\n        cancelAdd = this._fireAddEvent(sourceEvent);\n\n        if (!cancelAdd) {\n          cancelRemove = this._fireRemoveEvent(sourceEvent);\n        }\n      }\n\n      if (isSourceDraggable) {\n        (0, _translator.resetPosition)($sourceElement);\n      }\n\n      if (this.option(\"moveItemOnDrop\")) {\n        !cancelAdd && this._moveItem($sourceElement, toIndex, cancelRemove);\n      }\n\n      if (sourceDraggable === this) {\n        return this._fireReorderEvent(sourceEvent);\n      }\n    }\n\n    return new _deferred.Deferred().resolve();\n  },\n  dragMove: function (e) {\n    var itemPoints = this.option(\"itemPoints\");\n\n    if (!itemPoints) {\n      return;\n    }\n\n    var isVertical = this._isVerticalOrientation();\n\n    var axisName = isVertical ? \"top\" : \"left\";\n    var cursorPosition = isVertical ? e.pageY : e.pageX;\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    var itemPoint;\n\n    for (var i = itemPoints.length - 1; i >= 0; i--) {\n      var centerPosition = itemPoints[i + 1] && (itemPoints[i][axisName] + itemPoints[i + 1][axisName]) / 2;\n\n      if ((!isVertical && rtlEnabled ? cursorPosition > centerPosition : centerPosition > cursorPosition) || void 0 === centerPosition) {\n        itemPoint = itemPoints[i];\n      } else {\n        break;\n      }\n    }\n\n    if (itemPoint) {\n      this._updatePlaceholderPosition(e, itemPoint);\n\n      if (this._verticalScrollHelper.isScrolling() && this._isIndicateMode()) {\n        this._movePlaceholder();\n      }\n    }\n  },\n  _isIndicateMode: function () {\n    return \"indicate\" === this.option(\"dropFeedbackMode\") || this.option(\"allowDropInsideItem\");\n  },\n  _createPlaceholder: function () {\n    var $placeholderContainer;\n\n    if (this._isIndicateMode()) {\n      $placeholderContainer = (0, _renderer.default)(\"<div>\").addClass(this._addWidgetPrefix(PLACEHOLDER_CLASS)).insertBefore(this._getSourceDraggable()._$dragElement);\n    }\n\n    this._$placeholderElement = $placeholderContainer;\n    return $placeholderContainer;\n  },\n  _getItems: function () {\n    var itemsSelector = this._getItemsSelector();\n\n    return this._$content().find(itemsSelector).not(\".\" + this._addWidgetPrefix(PLACEHOLDER_CLASS)).not(\".\" + this._addWidgetPrefix(CLONE_CLASS)).toArray();\n  },\n  _allowReordering: function () {\n    var sourceDraggable = this._getSourceDraggable();\n\n    var targetDraggable = this._getTargetDraggable();\n\n    return sourceDraggable !== targetDraggable || this.option(\"allowReordering\");\n  },\n  _isValidPoint: function (visibleIndex, draggableVisibleIndex, dropInsideItem) {\n    var allowDropInsideItem = this.option(\"allowDropInsideItem\");\n\n    var allowReordering = dropInsideItem || this._allowReordering();\n\n    if (!allowReordering && (0 !== visibleIndex || !allowDropInsideItem)) {\n      return false;\n    }\n\n    if (!this._isIndicateMode()) {\n      return true;\n    }\n\n    return draggableVisibleIndex === -1 || visibleIndex !== draggableVisibleIndex && (dropInsideItem || visibleIndex !== draggableVisibleIndex + 1);\n  },\n  _getItemPoints: function () {\n    var that = this;\n    var result = [];\n    var $item;\n    var offset;\n    var itemWidth;\n    var rtlEnabled = that.option(\"rtlEnabled\");\n\n    var isVertical = that._isVerticalOrientation();\n\n    var itemElements = that._getItems();\n\n    var visibleItemElements = itemElements.filter(isElementVisible);\n    var visibleItemCount = visibleItemElements.length;\n\n    var $draggableItem = this._getDraggableElement();\n\n    var draggableVisibleIndex = visibleItemElements.indexOf($draggableItem.get(0));\n\n    if (visibleItemCount) {\n      for (var i = 0; i <= visibleItemCount; i++) {\n        var needCorrectLeftPosition = !isVertical && rtlEnabled ^ i === visibleItemCount;\n        var needCorrectTopPosition = isVertical && i === visibleItemCount;\n\n        if (i < visibleItemCount) {\n          $item = (0, _renderer.default)(visibleItemElements[i]);\n          offset = $item.offset();\n          itemWidth = $item.outerWidth();\n        }\n\n        result.push({\n          dropInsideItem: false,\n          left: offset.left + (needCorrectLeftPosition ? itemWidth : 0),\n          top: offset.top + (needCorrectTopPosition ? result[i - 1].height : 0),\n          index: i === visibleItemCount ? itemElements.length : itemElements.indexOf($item.get(0)),\n          $item: $item,\n          width: $item.outerWidth(),\n          height: $item.outerHeight(),\n          isValid: that._isValidPoint(i, draggableVisibleIndex)\n        });\n      }\n\n      if (this.option(\"allowDropInsideItem\")) {\n        var points = result;\n        result = [];\n\n        for (var _i = 0; _i < points.length; _i++) {\n          result.push(points[_i]);\n\n          if (points[_i + 1]) {\n            result.push((0, _extend.extend)({}, points[_i], {\n              dropInsideItem: true,\n              top: Math.floor((points[_i].top + points[_i + 1].top) / 2),\n              left: Math.floor((points[_i].left + points[_i + 1].left) / 2),\n              isValid: this._isValidPoint(_i, draggableVisibleIndex, true)\n            }));\n          }\n        }\n      }\n    } else {\n      result.push({\n        dropInsideItem: false,\n        index: 0,\n        isValid: true\n      });\n    }\n\n    return result;\n  },\n  _updateItemPoints: function (forceUpdate) {\n    if (forceUpdate || this.option(\"autoUpdate\") || !this.option(\"itemPoints\")) {\n      this.option(\"itemPoints\", this._getItemPoints());\n    }\n  },\n  _correctItemPoints: function (scrollBy) {\n    var itemPoints = this.option(\"itemPoints\");\n\n    if (scrollBy && itemPoints && !this.option(\"autoUpdate\")) {\n      var isVertical = this._isVerticalOrientation();\n\n      var positionPropName = isVertical ? \"top\" : \"left\";\n      itemPoints.forEach(function (itemPoint) {\n        itemPoint[positionPropName] -= scrollBy;\n      });\n    }\n  },\n  _getElementIndex: function ($itemElement) {\n    return this._getItems().indexOf($itemElement.get(0));\n  },\n  _getDragTemplateArgs: function ($element) {\n    var args = this.callBase.apply(this, arguments);\n    args.model.fromIndex = this._getElementIndex($element);\n    return args;\n  },\n  _togglePlaceholder: function (value) {\n    this._$placeholderElement && this._$placeholderElement.toggle(value);\n  },\n  _isVerticalOrientation: function () {\n    return \"vertical\" === this.option(\"itemOrientation\");\n  },\n  _normalizeToIndex: function (toIndex, dropInsideItem) {\n    var isAnotherDraggable = this._getSourceDraggable() !== this._getTargetDraggable();\n\n    var fromIndex = this.option(\"fromIndex\");\n\n    if (null === toIndex) {\n      return fromIndex;\n    }\n\n    return Math.max(isAnotherDraggable || fromIndex >= toIndex || dropInsideItem ? toIndex : toIndex - 1, 0);\n  },\n  _updatePlaceholderPosition: function (e, itemPoint) {\n    var sourceDraggable = this._getSourceDraggable();\n\n    var toIndex = this._normalizeToIndex(itemPoint.index, itemPoint.dropInsideItem);\n\n    var eventArgs = (0, _extend.extend)(this._getEventArgs(e), {\n      toIndex: toIndex,\n      dropInsideItem: itemPoint.dropInsideItem\n    });\n    itemPoint.isValid && this._getAction(\"onDragChange\")(eventArgs);\n\n    if (eventArgs.cancel || !itemPoint.isValid) {\n      if (!itemPoint.isValid) {\n        this.option({\n          dropInsideItem: false,\n          toIndex: null\n        });\n      }\n\n      return;\n    }\n\n    this.option({\n      dropInsideItem: itemPoint.dropInsideItem,\n      toIndex: itemPoint.index\n    });\n\n    this._getAction(\"onPlaceholderPrepared\")((0, _extend.extend)(this._getEventArgs(e), {\n      placeholderElement: (0, _element.getPublicElement)(this._$placeholderElement),\n      dragElement: (0, _element.getPublicElement)(sourceDraggable._$dragElement)\n    }));\n\n    this._updateItemPoints();\n  },\n  _makeWidthCorrection: function ($item, width) {\n    this._$scrollable = this._getScrollable($item);\n\n    if (this._$scrollable && this._$scrollable.width() < width) {\n      var scrollableWidth = this._$scrollable.width();\n\n      var offsetLeft = $item.offset().left - this._$scrollable.offset().left;\n\n      var offsetRight = scrollableWidth - $item.outerWidth() - offsetLeft;\n\n      if (offsetLeft > 0) {\n        width = scrollableWidth - offsetLeft;\n      } else {\n        if (offsetRight > 0) {\n          width = scrollableWidth - offsetRight;\n        } else {\n          width = scrollableWidth;\n        }\n      }\n    }\n\n    return width;\n  },\n  _updatePlaceholderSizes: function ($placeholderElement, itemElement) {\n    var that = this;\n    var dropInsideItem = that.option(\"dropInsideItem\");\n    var $item = (0, _renderer.default)(itemElement);\n\n    var isVertical = that._isVerticalOrientation();\n\n    var width = \"\";\n    var height = \"\";\n    $placeholderElement.toggleClass(that._addWidgetPrefix(\"placeholder-inside\"), dropInsideItem);\n\n    if (isVertical || dropInsideItem) {\n      width = $item.outerWidth();\n    }\n\n    if (!isVertical || dropInsideItem) {\n      height = $item.outerHeight();\n    }\n\n    width = that._makeWidthCorrection($item, width);\n    $placeholderElement.css({\n      width: width,\n      height: height\n    });\n  },\n  _moveItem: function ($itemElement, index, cancelRemove) {\n    var $prevTargetItemElement;\n\n    var $itemElements = this._getItems();\n\n    var $targetItemElement = $itemElements[index];\n\n    var sourceDraggable = this._getSourceDraggable();\n\n    if (cancelRemove) {\n      $itemElement = $itemElement.clone();\n\n      sourceDraggable._toggleDragSourceClass(false, $itemElement);\n    }\n\n    if (!$targetItemElement) {\n      $prevTargetItemElement = $itemElements[index - 1];\n    }\n\n    this._moveItemCore($itemElement, $targetItemElement, $prevTargetItemElement);\n  },\n  _moveItemCore: function ($targetItem, item, prevItem) {\n    if (!item && !prevItem) {\n      $targetItem.appendTo(this.$element());\n    } else {\n      if (prevItem) {\n        $targetItem.insertAfter((0, _renderer.default)(prevItem));\n      } else {\n        $targetItem.insertBefore((0, _renderer.default)(item));\n      }\n    }\n  },\n  _getDragStartArgs: function (e, $itemElement) {\n    return (0, _extend.extend)(this.callBase.apply(this, arguments), {\n      fromIndex: this._getElementIndex($itemElement)\n    });\n  },\n  _getEventArgs: function (e) {\n    var sourceDraggable = this._getSourceDraggable();\n\n    var targetDraggable = this._getTargetDraggable();\n\n    var dropInsideItem = targetDraggable.option(\"dropInsideItem\");\n    return (0, _extend.extend)(this.callBase.apply(this, arguments), {\n      fromIndex: sourceDraggable.option(\"fromIndex\"),\n      toIndex: this._normalizeToIndex(targetDraggable.option(\"toIndex\"), dropInsideItem),\n      dropInsideItem: dropInsideItem\n    });\n  },\n  _optionChanged: function (args) {\n    var _this2 = this;\n\n    var name = args.name;\n\n    switch (name) {\n      case \"onDragChange\":\n      case \"onPlaceholderPrepared\":\n      case \"onAdd\":\n      case \"onRemove\":\n      case \"onReorder\":\n        this[\"_\" + name + \"Action\"] = this._createActionByOption(name);\n        break;\n\n      case \"itemOrientation\":\n      case \"allowDropInsideItem\":\n      case \"moveItemOnDrop\":\n      case \"dropFeedbackMode\":\n      case \"itemPoints\":\n      case \"animation\":\n      case \"allowReordering\":\n      case \"fromIndexOffset\":\n      case \"offset\":\n      case \"draggableElementSize\":\n      case \"autoUpdate\":\n        break;\n\n      case \"fromIndex\":\n        [false, true].forEach(function (isDragSource) {\n          var fromIndex = isDragSource ? args.value : args.previousValue;\n\n          if (null !== fromIndex) {\n            var $fromElement = (0, _renderer.default)(_this2._getItems()[fromIndex]);\n\n            _this2._toggleDragSourceClass(isDragSource, $fromElement);\n          }\n        });\n        break;\n\n      case \"dropInsideItem\":\n        this._optionChangedDropInsideItem(args);\n\n        break;\n\n      case \"toIndex\":\n        this._optionChangedToIndex(args);\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _optionChangedDropInsideItem: function () {\n    if (this._isIndicateMode() && this._$placeholderElement) {\n      this._movePlaceholder();\n    }\n  },\n  _isPositionVisible: function (position) {\n    var $element = this.$element();\n    var scrollContainer;\n\n    if (\"hidden\" !== $element.css(\"overflow\")) {\n      scrollContainer = $element.get(0);\n    } else {\n      $element.parents().each(function () {\n        if (\"visible\" !== (0, _renderer.default)(this).css(\"overflow\")) {\n          scrollContainer = this;\n          return false;\n        }\n      });\n    }\n\n    if (scrollContainer) {\n      var clientRect = (0, _position.getBoundingRect)(scrollContainer);\n\n      var isVerticalOrientation = this._isVerticalOrientation();\n\n      var start = isVerticalOrientation ? \"top\" : \"left\";\n      var end = isVerticalOrientation ? \"bottom\" : \"right\";\n      var window = (0, _window.getWindow)();\n      var pageOffset = isVerticalOrientation ? window.pageYOffset : window.pageXOffset;\n\n      if (position[start] < clientRect[start] + pageOffset || position[start] > clientRect[end] + pageOffset) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n  _optionChangedToIndex: function (args) {\n    var toIndex = args.value;\n\n    if (this._isIndicateMode()) {\n      var showPlaceholder = null !== toIndex && toIndex >= 0;\n\n      this._togglePlaceholder(showPlaceholder);\n\n      if (showPlaceholder) {\n        this._movePlaceholder();\n      }\n    } else {\n      this._moveItems(args.previousValue, args.value, args.fullUpdate);\n    }\n  },\n  update: function () {\n    if (null === this.option(\"fromIndex\") && null === this.option(\"toIndex\")) {\n      return;\n    }\n\n    this._updateItemPoints(true);\n\n    this._updateDragSourceClass();\n\n    var toIndex = this.option(\"toIndex\");\n\n    this._optionChangedToIndex({\n      value: toIndex,\n      fullUpdate: true\n    });\n  },\n  _updateDragSourceClass: function () {\n    var fromIndex = this._getActualFromIndex();\n\n    var $fromElement = (0, _renderer.default)(this._getItems()[fromIndex]);\n\n    if ($fromElement.length) {\n      this._$sourceElement = $fromElement;\n\n      this._toggleDragSourceClass(true, $fromElement);\n    }\n  },\n  _makeLeftCorrection: function (left, leftMargin) {\n    var that = this;\n    var $scrollable = that._$scrollable;\n\n    if ($scrollable && that._isVerticalOrientation() && $scrollable.scrollLeft() > leftMargin) {\n      left += $scrollable.scrollLeft() - leftMargin;\n    }\n\n    return left;\n  },\n  _movePlaceholder: function () {\n    var that = this;\n\n    var $placeholderElement = that._$placeholderElement || that._createPlaceholder();\n\n    var items = that._getItems();\n\n    var toIndex = that.option(\"toIndex\");\n\n    var isVerticalOrientation = that._isVerticalOrientation();\n\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    var dropInsideItem = that.option(\"dropInsideItem\");\n    var position = null;\n    var leftMargin = 0;\n    var itemElement = items[toIndex];\n\n    if (itemElement) {\n      var $itemElement = (0, _renderer.default)(itemElement);\n      position = $itemElement.offset();\n      leftMargin = parseFloat($itemElement.css(\"marginLeft\"));\n\n      if (!isVerticalOrientation && rtlEnabled && !dropInsideItem) {\n        position.left += $itemElement.outerWidth(true);\n      }\n    } else {\n      var prevVisibleItemElement = itemElement = this._getPrevVisibleItem(items, toIndex);\n\n      if (prevVisibleItemElement) {\n        position = (0, _renderer.default)(prevVisibleItemElement).offset();\n\n        if (isVerticalOrientation) {\n          position.top += (0, _renderer.default)(prevVisibleItemElement).outerHeight(true);\n        } else {\n          if (!rtlEnabled) {\n            position.left += (0, _renderer.default)(prevVisibleItemElement).outerWidth(true);\n          }\n        }\n      }\n    }\n\n    that._updatePlaceholderSizes($placeholderElement, itemElement);\n\n    if (position && !that._isPositionVisible(position)) {\n      position = null;\n    }\n\n    if (position) {\n      position.left = that._makeLeftCorrection(position.left, leftMargin);\n\n      that._move(position, $placeholderElement);\n    }\n\n    $placeholderElement.toggle(!!position);\n  },\n  _getPositions: function (items, elementSize, fromIndex, toIndex) {\n    var positions = [];\n\n    for (var i = 0; i < items.length; i++) {\n      var position = 0;\n\n      if (null === toIndex || null === fromIndex) {\n        positions.push(position);\n        continue;\n      }\n\n      if (fromIndex === -1) {\n        if (i >= toIndex) {\n          position = elementSize;\n        }\n      } else {\n        if (toIndex === -1) {\n          if (i > fromIndex) {\n            position = -elementSize;\n          }\n        } else {\n          if (fromIndex < toIndex) {\n            if (i > fromIndex && i < toIndex) {\n              position = -elementSize;\n            }\n          } else {\n            if (fromIndex > toIndex) {\n              if (i >= toIndex && i < fromIndex) {\n                position = elementSize;\n              }\n            }\n          }\n        }\n      }\n\n      positions.push(position);\n    }\n\n    return positions;\n  },\n  _getDraggableElementSize: function (isVerticalOrientation) {\n    var $draggableItem = this._getDraggableElement();\n\n    var size = this.option(\"draggableElementSize\");\n\n    if (!size) {\n      size = isVerticalOrientation ? ($draggableItem.outerHeight() + $draggableItem.outerHeight(true)) / 2 : ($draggableItem.outerWidth() + $draggableItem.outerWidth(true)) / 2;\n\n      if (!this.option(\"autoUpdate\")) {\n        this.option(\"draggableElementSize\", size);\n      }\n    }\n\n    return size;\n  },\n  _getActualFromIndex: function () {\n    var _this$option = this.option(),\n        fromIndex = _this$option.fromIndex,\n        fromIndexOffset = _this$option.fromIndexOffset,\n        offset = _this$option.offset;\n\n    return null == fromIndex ? null : fromIndex + fromIndexOffset - offset;\n  },\n  _moveItems: function (prevToIndex, toIndex, fullUpdate) {\n    var fromIndex = this._getActualFromIndex();\n\n    var isVerticalOrientation = this._isVerticalOrientation();\n\n    var positionPropName = isVerticalOrientation ? \"top\" : \"left\";\n\n    var elementSize = this._getDraggableElementSize(isVerticalOrientation);\n\n    var items = this._getItems();\n\n    var prevPositions = this._getPositions(items, elementSize, fromIndex, prevToIndex);\n\n    var positions = this._getPositions(items, elementSize, fromIndex, toIndex);\n\n    var animationConfig = this.option(\"animation\");\n    var rtlEnabled = this.option(\"rtlEnabled\");\n\n    for (var i = 0; i < items.length; i++) {\n      var itemElement = items[i];\n      var prevPosition = prevPositions[i];\n      var position = positions[i];\n\n      if (null === toIndex || null === fromIndex) {\n        stopAnimation(itemElement);\n      } else {\n        if (prevPosition !== position || fullUpdate && position) {\n          animate(itemElement, (0, _extend.extend)({}, animationConfig, {\n            to: _defineProperty({}, positionPropName, !isVerticalOrientation && rtlEnabled ? -position : position)\n          }));\n        }\n      }\n    }\n  },\n  _toggleDragSourceClass: function (value, $element) {\n    var $sourceElement = $element || this._$sourceElement;\n    this.callBase.apply(this, arguments);\n\n    if (!this._isIndicateMode()) {\n      $sourceElement && $sourceElement.toggleClass(this._addWidgetPrefix(\"source-hidden\"), value);\n    }\n  },\n  _dispose: function () {\n    this.reset();\n    this.callBase();\n  },\n  _fireAddEvent: function (sourceEvent) {\n    var args = this._getEventArgs(sourceEvent);\n\n    this._getAction(\"onAdd\")(args);\n\n    return args.cancel;\n  },\n  _fireRemoveEvent: function (sourceEvent) {\n    var sourceDraggable = this._getSourceDraggable();\n\n    var args = this._getEventArgs(sourceEvent);\n\n    sourceDraggable._getAction(\"onRemove\")(args);\n\n    return args.cancel;\n  },\n  _fireReorderEvent: function (sourceEvent) {\n    var args = this._getEventArgs(sourceEvent);\n\n    this._getAction(\"onReorder\")(args);\n\n    return args.promise || new _deferred.Deferred().resolve();\n  }\n});\n\n(0, _component_registrator.default)(SORTABLE, Sortable);\nvar _default = Sortable;\nexports.default = _default;\nmodule.exports = exports.default;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["F:/webfe/node_modules/devextreme/ui/sortable.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_events_engine","_component_registrator","_extend","_draggable","_element","_window","_position","_translator","_fx","_deferred","obj","__esModule","_defineProperty","key","value","Object","defineProperty","enumerable","configurable","writable","SORTABLE","PLACEHOLDER_CLASS","CLONE_CLASS","isElementVisible","itemElement","is","animate","element","config","_config$to","_config$to2","left","to","top","style","transform","concat","transition","off","duration","easing","stopAnimation","Sortable","inherit","_init","callBase","_sourceScrollHandler","_handleSourceScroll","bind","_sourceScrollableInfo","_getDefaultOptions","extend","clone","filter","itemOrientation","dropFeedbackMode","allowDropInsideItem","allowReordering","moveItemOnDrop","onDragChange","onAdd","onRemove","onReorder","onPlaceholderPrepared","animation","type","fromIndex","toIndex","dropInsideItem","itemPoints","fromIndexOffset","offset","autoUpdate","draggableElementSize","reset","option","_$placeholderElement","remove","_isIndicateMode","_$modifiedItem","css","_modifiedItemMargin","_getPrevVisibleItem","items","index","slice","reverse","_dragStartHandler","e","apply","arguments","cancel","$sourceElement","_getSourceElement","_updateItemPoints","_subscribeToSourceScroll","_getElementIndex","_dragEndHandler","_unsubscribeFromSourceScroll","$scrollable","_getScrollable","target","scrollLeft","scrollTop","on","_this","sourceScrollableInfo","forEach","scrollProp","scrollBy","_correctItemPoints","_dragEnterHandler","_getSourceDraggable","lastItemPoint","length","$element","isVertical","_isVerticalOrientation","sourceElementSize","outerHeight","outerWidth","scrollSize","get","scrollPosition","positionProp","lastPointPosition","elementPosition","freeSize","_getItems","$lastItem","marginBottom","$sortable","closest","sortable","data","update","dragEnter","_getTargetDraggable","dragLeave","_isInsideTargetDraggable","event","$targetDraggable","validY","height","pageY","validX","width","pageX","dragEnd","sourceEvent","sourceDraggable","isSourceDraggable","NAME","isInsideTargetDraggable","cancelAdd","cancelRemove","_fireAddEvent","_fireRemoveEvent","resetPosition","_moveItem","_fireReorderEvent","Deferred","resolve","dragMove","axisName","cursorPosition","rtlEnabled","itemPoint","i","centerPosition","_updatePlaceholderPosition","_verticalScrollHelper","isScrolling","_movePlaceholder","_createPlaceholder","$placeholderContainer","addClass","_addWidgetPrefix","insertBefore","_$dragElement","itemsSelector","_getItemsSelector","_$content","find","not","toArray","_allowReordering","targetDraggable","_isValidPoint","visibleIndex","draggableVisibleIndex","_getItemPoints","that","result","$item","itemWidth","itemElements","visibleItemElements","visibleItemCount","$draggableItem","_getDraggableElement","indexOf","needCorrectLeftPosition","needCorrectTopPosition","push","isValid","points","_i","Math","floor","forceUpdate","positionPropName","$itemElement","_getDragTemplateArgs","args","model","_togglePlaceholder","toggle","_normalizeToIndex","isAnotherDraggable","max","eventArgs","_getEventArgs","_getAction","placeholderElement","getPublicElement","dragElement","_makeWidthCorrection","_$scrollable","scrollableWidth","offsetLeft","offsetRight","_updatePlaceholderSizes","$placeholderElement","toggleClass","$prevTargetItemElement","$itemElements","$targetItemElement","_toggleDragSourceClass","_moveItemCore","$targetItem","item","prevItem","appendTo","insertAfter","_getDragStartArgs","_optionChanged","_this2","name","_createActionByOption","isDragSource","previousValue","$fromElement","_optionChangedDropInsideItem","_optionChangedToIndex","_isPositionVisible","position","scrollContainer","parents","each","clientRect","getBoundingRect","isVerticalOrientation","start","end","window","getWindow","pageOffset","pageYOffset","pageXOffset","showPlaceholder","_moveItems","fullUpdate","_updateDragSourceClass","_getActualFromIndex","_$sourceElement","_makeLeftCorrection","leftMargin","parseFloat","prevVisibleItemElement","_move","_getPositions","elementSize","positions","_getDraggableElementSize","size","_this$option","prevToIndex","prevPositions","animationConfig","prevPosition","_dispose","promise","_default","module"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAA,OAAO,CAACC,OAAR,GAAkB,KAAK,CAAvB;;AACA,IAAIC,SAAS,GAAGC,sBAAsB,CAACC,OAAO,CAAC,kBAAD,CAAR,CAAtC;;AACA,IAAIC,cAAc,GAAGF,sBAAsB,CAACC,OAAO,CAAC,8BAAD,CAAR,CAA3C;;AACA,IAAIE,sBAAsB,GAAGH,sBAAsB,CAACC,OAAO,CAAC,+BAAD,CAAR,CAAnD;;AACA,IAAIG,OAAO,GAAGH,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAII,UAAU,GAAGL,sBAAsB,CAACC,OAAO,CAAC,aAAD,CAAR,CAAvC;;AACA,IAAIK,QAAQ,GAAGL,OAAO,CAAC,iBAAD,CAAtB;;AACA,IAAIM,OAAO,GAAGN,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAIO,SAAS,GAAGP,OAAO,CAAC,wBAAD,CAAvB;;AACA,IAAIQ,WAAW,GAAGR,OAAO,CAAC,yBAAD,CAAzB;;AACA,IAAIS,GAAG,GAAGV,sBAAsB,CAACC,OAAO,CAAC,iBAAD,CAAR,CAAhC;;AACA,IAAIU,SAAS,GAAGV,OAAO,CAAC,wBAAD,CAAvB;;AAEA,SAASD,sBAAT,CAAgCY,GAAhC,EAAqC;AACjC,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AACjC,eAAWA;AADsB,GAArC;AAGH;;AAED,SAASE,eAAT,CAAyBF,GAAzB,EAA8BG,GAA9B,EAAmCC,KAAnC,EAA0C;AACtC,MAAID,GAAG,IAAIH,GAAX,EAAgB;AACZK,IAAAA,MAAM,CAACC,cAAP,CAAsBN,GAAtB,EAA2BG,GAA3B,EAAgC;AAC5BC,MAAAA,KAAK,EAAEA,KADqB;AAE5BG,MAAAA,UAAU,EAAE,IAFgB;AAG5BC,MAAAA,YAAY,EAAE,IAHc;AAI5BC,MAAAA,QAAQ,EAAE;AAJkB,KAAhC;AAMH,GAPD,MAOO;AACHT,IAAAA,GAAG,CAACG,GAAD,CAAH,GAAWC,KAAX;AACH;;AACD,SAAOJ,GAAP;AACH;;AACD,IAAIU,QAAQ,GAAG,YAAf;AACA,IAAIC,iBAAiB,GAAG,aAAxB;AACA,IAAIC,WAAW,GAAG,OAAlB;;AACA,IAAIC,gBAAgB,GAAG,UAASC,WAAT,EAAsB;AACzC,SAAO,CAAC,GAAG3B,SAAS,CAACD,OAAd,EAAuB4B,WAAvB,EAAoCC,EAApC,CAAuC,UAAvC,CAAP;AACH,CAFD;;AAGA,IAAIC,OAAO,GAAG,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AACpC,MAAIC,UAAJ,EAAgBC,WAAhB;;AACA,MAAI,CAACH,OAAL,EAAc;AACV;AACH;;AACD,MAAII,IAAI,GAAG,CAAC,UAAUF,UAAU,GAAGD,MAAM,CAACI,EAA9B,KAAqC,KAAK,CAAL,KAAWH,UAAhD,GAA6D,KAAK,CAAlE,GAAsEA,UAAU,CAACE,IAAlF,KAA2F,CAAtG;AACA,MAAIE,GAAG,GAAG,CAAC,UAAUH,WAAW,GAAGF,MAAM,CAACI,EAA/B,KAAsC,KAAK,CAAL,KAAWF,WAAjD,GAA+D,KAAK,CAApE,GAAwEA,WAAW,CAACG,GAArF,KAA6F,CAAvG;AACAN,EAAAA,OAAO,CAACO,KAAR,CAAcC,SAAd,GAA0B,aAAaC,MAAb,CAAoBL,IAApB,EAA0B,KAA1B,EAAiCK,MAAjC,CAAwCH,GAAxC,EAA6C,KAA7C,CAA1B;AACAN,EAAAA,OAAO,CAACO,KAAR,CAAcG,UAAd,GAA2B7B,GAAG,CAACZ,OAAJ,CAAY0C,GAAZ,GAAkB,EAAlB,GAAuB,aAAaF,MAAb,CAAoBR,MAAM,CAACW,QAA3B,EAAqC,KAArC,EAA4CH,MAA5C,CAAmDR,MAAM,CAACY,MAA1D,CAAlD;AACH,CATD;;AAUA,IAAIC,aAAa,GAAG,UAASd,OAAT,EAAkB;AAClC,MAAI,CAACA,OAAL,EAAc;AACV;AACH;;AACDA,EAAAA,OAAO,CAACO,KAAR,CAAcC,SAAd,GAA0B,EAA1B;AACAR,EAAAA,OAAO,CAACO,KAAR,CAAcG,UAAd,GAA2B,EAA3B;AACH,CAND;;AAOA,IAAIK,QAAQ,GAAGvC,UAAU,CAACP,OAAX,CAAmB+C,OAAnB,CAA2B;AACtCC,EAAAA,KAAK,EAAE,YAAW;AACd,SAAKC,QAAL;AACA,SAAKC,oBAAL,GAA4B,KAAKC,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAA5B;AACA,SAAKC,qBAAL,GAA6B,IAA7B;AACH,GALqC;AAMtCC,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,WAAO,CAAC,GAAGhD,OAAO,CAACiD,MAAZ,EAAoB,KAAKN,QAAL,EAApB,EAAqC;AACxCO,MAAAA,KAAK,EAAE,IADiC;AAExCC,MAAAA,MAAM,EAAE,KAFgC;AAGxCC,MAAAA,eAAe,EAAE,UAHuB;AAIxCC,MAAAA,gBAAgB,EAAE,MAJsB;AAKxCC,MAAAA,mBAAmB,EAAE,KALmB;AAMxCC,MAAAA,eAAe,EAAE,IANuB;AAOxCC,MAAAA,cAAc,EAAE,KAPwB;AAQxCC,MAAAA,YAAY,EAAE,IAR0B;AASxCC,MAAAA,KAAK,EAAE,IATiC;AAUxCC,MAAAA,QAAQ,EAAE,IAV8B;AAWxCC,MAAAA,SAAS,EAAE,IAX6B;AAYxCC,MAAAA,qBAAqB,EAAE,IAZiB;AAaxCC,MAAAA,SAAS,EAAE;AACPC,QAAAA,IAAI,EAAE,OADC;AAEP1B,QAAAA,QAAQ,EAAE,GAFH;AAGPC,QAAAA,MAAM,EAAE;AAHD,OAb6B;AAkBxC0B,MAAAA,SAAS,EAAE,IAlB6B;AAmBxCC,MAAAA,OAAO,EAAE,IAnB+B;AAoBxCC,MAAAA,cAAc,EAAE,KApBwB;AAqBxCC,MAAAA,UAAU,EAAE,IArB4B;AAsBxCC,MAAAA,eAAe,EAAE,CAtBuB;AAuBxCC,MAAAA,MAAM,EAAE,CAvBgC;AAwBxCC,MAAAA,UAAU,EAAE,KAxB4B;AAyBxCC,MAAAA,oBAAoB,EAAE;AAzBkB,KAArC,CAAP;AA2BH,GAlCqC;AAmCtCC,EAAAA,KAAK,EAAE,YAAW;AACd,SAAKC,MAAL,CAAY;AACRP,MAAAA,cAAc,EAAE,KADR;AAERD,MAAAA,OAAO,EAAE,IAFD;AAGRD,MAAAA,SAAS,EAAE,IAHH;AAIRG,MAAAA,UAAU,EAAE,IAJJ;AAKRC,MAAAA,eAAe,EAAE,CALT;AAMRG,MAAAA,oBAAoB,EAAE;AANd,KAAZ;;AAQA,QAAI,KAAKG,oBAAT,EAA+B;AAC3B,WAAKA,oBAAL,CAA0BC,MAA1B;AACH;;AACD,SAAKD,oBAAL,GAA4B,IAA5B;;AACA,QAAI,CAAC,KAAKE,eAAL,EAAD,IAA2B,KAAKC,cAApC,EAAoD;AAChD,WAAKA,cAAL,CAAoBC,GAApB,CAAwB,cAAxB,EAAwC,KAAKC,mBAA7C;;AACA,WAAKF,cAAL,GAAsB,IAAtB;AACH;AACJ,GApDqC;AAqDtCG,EAAAA,mBAAmB,EAAE,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AACxC,WAAOD,KAAK,CAACE,KAAN,CAAY,CAAZ,EAAeD,KAAf,EAAsBE,OAAtB,GAAgCjC,MAAhC,CAAuC9B,gBAAvC,EAAyD,CAAzD,CAAP;AACH,GAvDqC;AAwDtCgE,EAAAA,iBAAiB,EAAE,UAASC,CAAT,EAAY;AAC3B,SAAK3C,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;;AACA,QAAI,SAASF,CAAC,CAACG,MAAf,EAAuB;AACnB;AACH;;AACD,QAAIC,cAAc,GAAG,KAAKC,iBAAL,EAArB;;AACA,SAAKC,iBAAL;;AACA,SAAKC,wBAAL,CAA8BP,CAA9B;;AACA,SAAKb,MAAL,CAAY,WAAZ,EAAyB,KAAKqB,gBAAL,CAAsBJ,cAAtB,CAAzB;AACA,SAAKjB,MAAL,CAAY,iBAAZ,EAA+B,KAAKA,MAAL,CAAY,QAAZ,CAA/B;AACH,GAlEqC;AAmEtCsB,EAAAA,eAAe,EAAE,YAAW;AACxB,SAAKpD,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;;AACA,SAAKQ,4BAAL;AACH,GAtEqC;AAuEtCH,EAAAA,wBAAwB,EAAE,UAASP,CAAT,EAAY;AAClC,QAAIW,WAAW,GAAG,KAAKC,cAAL,CAAoB,CAAC,GAAGvG,SAAS,CAACD,OAAd,EAAuB4F,CAAC,CAACa,MAAzB,CAApB,CAAlB;;AACA,QAAIF,WAAJ,EAAiB;AACb,WAAKlD,qBAAL,GAA6B;AACzBtB,QAAAA,OAAO,EAAEwE,WADgB;AAEzBG,QAAAA,UAAU,EAAEH,WAAW,CAACG,UAAZ,EAFa;AAGzBC,QAAAA,SAAS,EAAEJ,WAAW,CAACI,SAAZ;AAHc,OAA7B;;AAKAvG,MAAAA,cAAc,CAACJ,OAAf,CAAuB4G,EAAvB,CAA0BL,WAA1B,EAAuC,QAAvC,EAAiD,KAAKrD,oBAAtD;AACH;AACJ,GAjFqC;AAkFtCoD,EAAAA,4BAA4B,EAAE,YAAW;AACrC,QAAI,KAAKjD,qBAAT,EAAgC;AAC5BjD,MAAAA,cAAc,CAACJ,OAAf,CAAuB0C,GAAvB,CAA2B,KAAKW,qBAAL,CAA2BtB,OAAtD,EAA+D,QAA/D,EAAyE,KAAKmB,oBAA9E;;AACA,WAAKG,qBAAL,GAA6B,IAA7B;AACH;AACJ,GAvFqC;AAwFtCF,EAAAA,mBAAmB,EAAE,UAASyC,CAAT,EAAY;AAC7B,QAAIiB,KAAK,GAAG,IAAZ;;AACA,QAAIC,oBAAoB,GAAG,KAAKzD,qBAAhC;;AACA,QAAIyD,oBAAJ,EAA0B;AACtB,OAAC,YAAD,EAAe,WAAf,EAA4BC,OAA5B,CAAoC,UAASC,UAAT,EAAqB;AACrD,YAAIpB,CAAC,CAACa,MAAF,CAASO,UAAT,MAAyBF,oBAAoB,CAACE,UAAD,CAAjD,EAA+D;AAC3D,cAAIC,QAAQ,GAAGrB,CAAC,CAACa,MAAF,CAASO,UAAT,IAAuBF,oBAAoB,CAACE,UAAD,CAA1D;;AACAH,UAAAA,KAAK,CAACK,kBAAN,CAAyBD,QAAzB;;AACAH,UAAAA,oBAAoB,CAACE,UAAD,CAApB,GAAmCpB,CAAC,CAACa,MAAF,CAASO,UAAT,CAAnC;AACH;AACJ,OAND;AAOH;AACJ,GApGqC;AAqGtCG,EAAAA,iBAAiB,EAAE,YAAW;AAC1B,SAAKlE,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;;AACA,QAAI,SAAS,KAAKsB,mBAAL,EAAb,EAAyC;AACrC;AACH;;AACD,SAAKlB,iBAAL;;AACA,SAAKnB,MAAL,CAAY,WAAZ,EAAyB,CAAC,CAA1B;;AACA,QAAI,CAAC,KAAKG,eAAL,EAAL,EAA6B;AACzB,UAAIT,UAAU,GAAG,KAAKM,MAAL,CAAY,YAAZ,CAAjB;AACA,UAAIsC,aAAa,GAAG5C,UAAU,CAACA,UAAU,CAAC6C,MAAX,GAAoB,CAArB,CAA9B;;AACA,UAAID,aAAJ,EAAmB;AACf,YAAIE,QAAQ,GAAG,KAAKA,QAAL,EAAf;;AACA,YAAIvB,cAAc,GAAG,KAAKC,iBAAL,EAArB;;AACA,YAAIuB,UAAU,GAAG,KAAKC,sBAAL,EAAjB;;AACA,YAAIC,iBAAiB,GAAGF,UAAU,GAAGxB,cAAc,CAAC2B,WAAf,CAA2B,IAA3B,CAAH,GAAsC3B,cAAc,CAAC4B,UAAf,CAA0B,IAA1B,CAAxE;AACA,YAAIC,UAAU,GAAGN,QAAQ,CAACO,GAAT,CAAa,CAAb,EAAgBN,UAAU,GAAG,cAAH,GAAoB,aAA9C,CAAjB;AACA,YAAIO,cAAc,GAAGR,QAAQ,CAACO,GAAT,CAAa,CAAb,EAAgBN,UAAU,GAAG,WAAH,GAAiB,YAA3C,CAArB;AACA,YAAIQ,YAAY,GAAGR,UAAU,GAAG,KAAH,GAAW,MAAxC;AACA,YAAIS,iBAAiB,GAAGZ,aAAa,CAACW,YAAD,CAArC;AACA,YAAIE,eAAe,GAAGX,QAAQ,CAAC5C,MAAT,GAAkBqD,YAAlB,CAAtB;AACA,YAAIG,QAAQ,GAAGD,eAAe,GAAGL,UAAlB,GAA+BE,cAA/B,GAAgDE,iBAA/D;;AACA,YAAIE,QAAQ,GAAGT,iBAAf,EAAkC;AAC9B,cAAIF,UAAJ,EAAgB;AACZ,gBAAIjC,KAAK,GAAG,KAAK6C,SAAL,EAAZ;;AACA,gBAAIC,SAAS,GAAG,CAAC,GAAGpI,SAAS,CAACD,OAAd,EAAuB,KAAKsF,mBAAL,CAAyBC,KAAzB,CAAvB,CAAhB;AACA,iBAAKJ,cAAL,GAAsBkD,SAAtB;AACA,iBAAKhD,mBAAL,GAA2BgD,SAAS,CAACP,GAAV,CAAc,CAAd,EAAiBxF,KAAjB,CAAuBgG,YAAlD;AACAD,YAAAA,SAAS,CAACjD,GAAV,CAAc,cAAd,EAA8BsC,iBAAiB,GAAGS,QAAlD;AACA,gBAAII,SAAS,GAAGF,SAAS,CAACG,OAAV,CAAkB,cAAlB,CAAhB;AACA,gBAAIC,QAAQ,GAAGF,SAAS,CAACG,IAAV,CAAe,cAAf,KAAkCH,SAAS,CAACG,IAAV,CAAe,cAAf,CAAjD;AACAD,YAAAA,QAAQ,IAAIA,QAAQ,CAACE,MAAT,EAAZ;AACH;AACJ;AACJ;AACJ;AACJ,GAxIqC;AAyItCC,EAAAA,SAAS,EAAE,YAAW;AAClB,QAAI,SAAS,KAAKC,mBAAL,EAAb,EAAyC;AACrC,WAAK9D,MAAL,CAAY,SAAZ,EAAuB,CAAC,CAAxB;AACH;AACJ,GA7IqC;AA8ItC+D,EAAAA,SAAS,EAAE,YAAW;AAClB,QAAI,SAAS,KAAKD,mBAAL,EAAb,EAAyC;AACrC,WAAK9D,MAAL,CAAY,SAAZ,EAAuB,KAAKA,MAAL,CAAY,WAAZ,CAAvB;AACH;AACJ,GAlJqC;AAmJtCgE,EAAAA,wBAAwB,EAAE,UAASC,KAAT,EAAgB;AACtC,QAAIC,gBAAgB,GAAG,KAAKJ,mBAAL,GAA2BtB,QAA3B,EAAvB;;AACA,QAAIhB,WAAW,GAAG,KAAKC,cAAL,CAAoByC,gBAApB,CAAlB;;AACA,QAAI1C,WAAJ,EAAiB;AACb,UAAI5B,MAAM,GAAG4B,WAAW,CAAC5B,MAAZ,EAAb;AACA,UAAIuE,MAAM,GAAGvE,MAAM,CAACtC,GAAP,GAAakE,WAAW,CAAC4C,MAAZ,EAAb,IAAqCH,KAAK,CAACI,KAA3C,IAAoDzE,MAAM,CAACtC,GAAP,IAAc2G,KAAK,CAACI,KAArF;AACA,UAAIC,MAAM,GAAG1E,MAAM,CAACxC,IAAP,GAAcoE,WAAW,CAAC+C,KAAZ,EAAd,IAAqCN,KAAK,CAACO,KAA3C,IAAoD5E,MAAM,CAACxC,IAAP,IAAe6G,KAAK,CAACO,KAAtF;AACA,aAAOL,MAAM,IAAIG,MAAjB;AACH;;AACD,WAAO,IAAP;AACH,GA7JqC;AA8JtCG,EAAAA,OAAO,EAAE,UAASC,WAAT,EAAsB;AAC3B,QAAIzD,cAAc,GAAG,KAAKC,iBAAL,EAArB;;AACA,QAAIyD,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAIuC,iBAAiB,GAAGD,eAAe,CAACE,IAAhB,KAAyB,KAAKA,IAAtD;AACA,QAAIrF,OAAO,GAAG,KAAKQ,MAAL,CAAY,SAAZ,CAAd;;AACA,QAAI8E,uBAAuB,GAAG,KAAKd,wBAAL,CAA8BU,WAAW,CAACT,KAA1C,CAA9B;;AACA,QAAI,SAASzE,OAAT,IAAoBA,OAAO,IAAI,CAA/B,IAAoCsF,uBAAxC,EAAiE;AAC7D,UAAIC,SAAJ;AACA,UAAIC,YAAJ;;AACA,UAAIL,eAAe,KAAK,IAAxB,EAA8B;AAC1BI,QAAAA,SAAS,GAAG,KAAKE,aAAL,CAAmBP,WAAnB,CAAZ;;AACA,YAAI,CAACK,SAAL,EAAgB;AACZC,UAAAA,YAAY,GAAG,KAAKE,gBAAL,CAAsBR,WAAtB,CAAf;AACH;AACJ;;AACD,UAAIE,iBAAJ,EAAuB;AACnB,SAAC,GAAGhJ,WAAW,CAACuJ,aAAhB,EAA+BlE,cAA/B;AACH;;AACD,UAAI,KAAKjB,MAAL,CAAY,gBAAZ,CAAJ,EAAmC;AAC/B,SAAC+E,SAAD,IAAc,KAAKK,SAAL,CAAenE,cAAf,EAA+BzB,OAA/B,EAAwCwF,YAAxC,CAAd;AACH;;AACD,UAAIL,eAAe,KAAK,IAAxB,EAA8B;AAC1B,eAAO,KAAKU,iBAAL,CAAuBX,WAAvB,CAAP;AACH;AACJ;;AACD,WAAQ,IAAI5I,SAAS,CAACwJ,QAAd,EAAD,CAAyBC,OAAzB,EAAP;AACH,GAxLqC;AAyLtCC,EAAAA,QAAQ,EAAE,UAAS3E,CAAT,EAAY;AAClB,QAAInB,UAAU,GAAG,KAAKM,MAAL,CAAY,YAAZ,CAAjB;;AACA,QAAI,CAACN,UAAL,EAAiB;AACb;AACH;;AACD,QAAI+C,UAAU,GAAG,KAAKC,sBAAL,EAAjB;;AACA,QAAI+C,QAAQ,GAAGhD,UAAU,GAAG,KAAH,GAAW,MAApC;AACA,QAAIiD,cAAc,GAAGjD,UAAU,GAAG5B,CAAC,CAACwD,KAAL,GAAaxD,CAAC,CAAC2D,KAA9C;AACA,QAAImB,UAAU,GAAG,KAAK3F,MAAL,CAAY,YAAZ,CAAjB;AACA,QAAI4F,SAAJ;;AACA,SAAK,IAAIC,CAAC,GAAGnG,UAAU,CAAC6C,MAAX,GAAoB,CAAjC,EAAoCsD,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C,EAAiD;AAC7C,UAAIC,cAAc,GAAGpG,UAAU,CAACmG,CAAC,GAAG,CAAL,CAAV,IAAqB,CAACnG,UAAU,CAACmG,CAAD,CAAV,CAAcJ,QAAd,IAA0B/F,UAAU,CAACmG,CAAC,GAAG,CAAL,CAAV,CAAkBJ,QAAlB,CAA3B,IAA0D,CAApG;;AACA,UAAI,CAAC,CAAChD,UAAD,IAAekD,UAAf,GAA4BD,cAAc,GAAGI,cAA7C,GAA8DA,cAAc,GAAGJ,cAAhF,KAAmG,KAAK,CAAL,KAAWI,cAAlH,EAAkI;AAC9HF,QAAAA,SAAS,GAAGlG,UAAU,CAACmG,CAAD,CAAtB;AACH,OAFD,MAEO;AACH;AACH;AACJ;;AACD,QAAID,SAAJ,EAAe;AACX,WAAKG,0BAAL,CAAgClF,CAAhC,EAAmC+E,SAAnC;;AACA,UAAI,KAAKI,qBAAL,CAA2BC,WAA3B,MAA4C,KAAK9F,eAAL,EAAhD,EAAwE;AACpE,aAAK+F,gBAAL;AACH;AACJ;AACJ,GAjNqC;AAkNtC/F,EAAAA,eAAe,EAAE,YAAW;AACxB,WAAO,eAAe,KAAKH,MAAL,CAAY,kBAAZ,CAAf,IAAkD,KAAKA,MAAL,CAAY,qBAAZ,CAAzD;AACH,GApNqC;AAqNtCmG,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAIC,qBAAJ;;AACA,QAAI,KAAKjG,eAAL,EAAJ,EAA4B;AACxBiG,MAAAA,qBAAqB,GAAG,CAAC,GAAGlL,SAAS,CAACD,OAAd,EAAuB,OAAvB,EAAgCoL,QAAhC,CAAyC,KAAKC,gBAAL,CAAsB5J,iBAAtB,CAAzC,EAAmF6J,YAAnF,CAAgG,KAAKlE,mBAAL,GAA2BmE,aAA3H,CAAxB;AACH;;AACD,SAAKvG,oBAAL,GAA4BmG,qBAA5B;AACA,WAAOA,qBAAP;AACH,GA5NqC;AA6NtC/C,EAAAA,SAAS,EAAE,YAAW;AAClB,QAAIoD,aAAa,GAAG,KAAKC,iBAAL,EAApB;;AACA,WAAO,KAAKC,SAAL,GAAiBC,IAAjB,CAAsBH,aAAtB,EAAqCI,GAArC,CAAyC,MAAM,KAAKP,gBAAL,CAAsB5J,iBAAtB,CAA/C,EAAyFmK,GAAzF,CAA6F,MAAM,KAAKP,gBAAL,CAAsB3J,WAAtB,CAAnG,EAAuImK,OAAvI,EAAP;AACH,GAhOqC;AAiOtCC,EAAAA,gBAAgB,EAAE,YAAW;AACzB,QAAIpC,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAI2E,eAAe,GAAG,KAAKlD,mBAAL,EAAtB;;AACA,WAAOa,eAAe,KAAKqC,eAApB,IAAuC,KAAKhH,MAAL,CAAY,iBAAZ,CAA9C;AACH,GArOqC;AAsOtCiH,EAAAA,aAAa,EAAE,UAASC,YAAT,EAAuBC,qBAAvB,EAA8C1H,cAA9C,EAA8D;AACzE,QAAIZ,mBAAmB,GAAG,KAAKmB,MAAL,CAAY,qBAAZ,CAA1B;;AACA,QAAIlB,eAAe,GAAGW,cAAc,IAAI,KAAKsH,gBAAL,EAAxC;;AACA,QAAI,CAACjI,eAAD,KAAqB,MAAMoI,YAAN,IAAsB,CAACrI,mBAA5C,CAAJ,EAAsE;AAClE,aAAO,KAAP;AACH;;AACD,QAAI,CAAC,KAAKsB,eAAL,EAAL,EAA6B;AACzB,aAAO,IAAP;AACH;;AACD,WAAOgH,qBAAqB,KAAK,CAAC,CAA3B,IAAgCD,YAAY,KAAKC,qBAAjB,KAA2C1H,cAAc,IAAIyH,YAAY,KAAKC,qBAAqB,GAAG,CAAtG,CAAvC;AACH,GAhPqC;AAiPtCC,EAAAA,cAAc,EAAE,YAAW;AACvB,QAAIC,IAAI,GAAG,IAAX;AACA,QAAIC,MAAM,GAAG,EAAb;AACA,QAAIC,KAAJ;AACA,QAAI3H,MAAJ;AACA,QAAI4H,SAAJ;AACA,QAAI7B,UAAU,GAAG0B,IAAI,CAACrH,MAAL,CAAY,YAAZ,CAAjB;;AACA,QAAIyC,UAAU,GAAG4E,IAAI,CAAC3E,sBAAL,EAAjB;;AACA,QAAI+E,YAAY,GAAGJ,IAAI,CAAChE,SAAL,EAAnB;;AACA,QAAIqE,mBAAmB,GAAGD,YAAY,CAAC/I,MAAb,CAAoB9B,gBAApB,CAA1B;AACA,QAAI+K,gBAAgB,GAAGD,mBAAmB,CAACnF,MAA3C;;AACA,QAAIqF,cAAc,GAAG,KAAKC,oBAAL,EAArB;;AACA,QAAIV,qBAAqB,GAAGO,mBAAmB,CAACI,OAApB,CAA4BF,cAAc,CAAC7E,GAAf,CAAmB,CAAnB,CAA5B,CAA5B;;AACA,QAAI4E,gBAAJ,EAAsB;AAClB,WAAK,IAAI9B,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI8B,gBAArB,EAAuC9B,CAAC,EAAxC,EAA4C;AACxC,YAAIkC,uBAAuB,GAAG,CAACtF,UAAD,IAAekD,UAAU,GAAGE,CAAC,KAAK8B,gBAAhE;AACA,YAAIK,sBAAsB,GAAGvF,UAAU,IAAIoD,CAAC,KAAK8B,gBAAjD;;AACA,YAAI9B,CAAC,GAAG8B,gBAAR,EAA0B;AACtBJ,UAAAA,KAAK,GAAG,CAAC,GAAGrM,SAAS,CAACD,OAAd,EAAuByM,mBAAmB,CAAC7B,CAAD,CAA1C,CAAR;AACAjG,UAAAA,MAAM,GAAG2H,KAAK,CAAC3H,MAAN,EAAT;AACA4H,UAAAA,SAAS,GAAGD,KAAK,CAAC1E,UAAN,EAAZ;AACH;;AACDyE,QAAAA,MAAM,CAACW,IAAP,CAAY;AACRxI,UAAAA,cAAc,EAAE,KADR;AAERrC,UAAAA,IAAI,EAAEwC,MAAM,CAACxC,IAAP,IAAe2K,uBAAuB,GAAGP,SAAH,GAAe,CAArD,CAFE;AAGRlK,UAAAA,GAAG,EAAEsC,MAAM,CAACtC,GAAP,IAAc0K,sBAAsB,GAAGV,MAAM,CAACzB,CAAC,GAAG,CAAL,CAAN,CAAczB,MAAjB,GAA0B,CAA9D,CAHG;AAIR3D,UAAAA,KAAK,EAAEoF,CAAC,KAAK8B,gBAAN,GAAyBF,YAAY,CAAClF,MAAtC,GAA+CkF,YAAY,CAACK,OAAb,CAAqBP,KAAK,CAACxE,GAAN,CAAU,CAAV,CAArB,CAJ9C;AAKRwE,UAAAA,KAAK,EAAEA,KALC;AAMRhD,UAAAA,KAAK,EAAEgD,KAAK,CAAC1E,UAAN,EANC;AAORuB,UAAAA,MAAM,EAAEmD,KAAK,CAAC3E,WAAN,EAPA;AAQRsF,UAAAA,OAAO,EAAEb,IAAI,CAACJ,aAAL,CAAmBpB,CAAnB,EAAsBsB,qBAAtB;AARD,SAAZ;AAUH;;AACD,UAAI,KAAKnH,MAAL,CAAY,qBAAZ,CAAJ,EAAwC;AACpC,YAAImI,MAAM,GAAGb,MAAb;AACAA,QAAAA,MAAM,GAAG,EAAT;;AACA,aAAK,IAAIc,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGD,MAAM,CAAC5F,MAA7B,EAAqC6F,EAAE,EAAvC,EAA2C;AACvCd,UAAAA,MAAM,CAACW,IAAP,CAAYE,MAAM,CAACC,EAAD,CAAlB;;AACA,cAAID,MAAM,CAACC,EAAE,GAAG,CAAN,CAAV,EAAoB;AAChBd,YAAAA,MAAM,CAACW,IAAP,CAAY,CAAC,GAAG1M,OAAO,CAACiD,MAAZ,EAAoB,EAApB,EAAwB2J,MAAM,CAACC,EAAD,CAA9B,EAAoC;AAC5C3I,cAAAA,cAAc,EAAE,IAD4B;AAE5CnC,cAAAA,GAAG,EAAE+K,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACC,EAAD,CAAN,CAAW9K,GAAX,GAAiB6K,MAAM,CAACC,EAAE,GAAG,CAAN,CAAN,CAAe9K,GAAjC,IAAwC,CAAnD,CAFuC;AAG5CF,cAAAA,IAAI,EAAEiL,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACC,EAAD,CAAN,CAAWhL,IAAX,GAAkB+K,MAAM,CAACC,EAAE,GAAG,CAAN,CAAN,CAAehL,IAAlC,IAA0C,CAArD,CAHsC;AAI5C8K,cAAAA,OAAO,EAAE,KAAKjB,aAAL,CAAmBmB,EAAnB,EAAuBjB,qBAAvB,EAA8C,IAA9C;AAJmC,aAApC,CAAZ;AAMH;AACJ;AACJ;AACJ,KAnCD,MAmCO;AACHG,MAAAA,MAAM,CAACW,IAAP,CAAY;AACRxI,QAAAA,cAAc,EAAE,KADR;AAERgB,QAAAA,KAAK,EAAE,CAFC;AAGRyH,QAAAA,OAAO,EAAE;AAHD,OAAZ;AAKH;;AACD,WAAOZ,MAAP;AACH,GAzSqC;AA0StCnG,EAAAA,iBAAiB,EAAE,UAASoH,WAAT,EAAsB;AACrC,QAAIA,WAAW,IAAI,KAAKvI,MAAL,CAAY,YAAZ,CAAf,IAA4C,CAAC,KAAKA,MAAL,CAAY,YAAZ,CAAjD,EAA4E;AACxE,WAAKA,MAAL,CAAY,YAAZ,EAA0B,KAAKoH,cAAL,EAA1B;AACH;AACJ,GA9SqC;AA+StCjF,EAAAA,kBAAkB,EAAE,UAASD,QAAT,EAAmB;AACnC,QAAIxC,UAAU,GAAG,KAAKM,MAAL,CAAY,YAAZ,CAAjB;;AACA,QAAIkC,QAAQ,IAAIxC,UAAZ,IAA0B,CAAC,KAAKM,MAAL,CAAY,YAAZ,CAA/B,EAA0D;AACtD,UAAIyC,UAAU,GAAG,KAAKC,sBAAL,EAAjB;;AACA,UAAI8F,gBAAgB,GAAG/F,UAAU,GAAG,KAAH,GAAW,MAA5C;AACA/C,MAAAA,UAAU,CAACsC,OAAX,CAAmB,UAAS4D,SAAT,EAAoB;AACnCA,QAAAA,SAAS,CAAC4C,gBAAD,CAAT,IAA+BtG,QAA/B;AACH,OAFD;AAGH;AACJ,GAxTqC;AAyTtCb,EAAAA,gBAAgB,EAAE,UAASoH,YAAT,EAAuB;AACrC,WAAO,KAAKpF,SAAL,GAAiByE,OAAjB,CAAyBW,YAAY,CAAC1F,GAAb,CAAiB,CAAjB,CAAzB,CAAP;AACH,GA3TqC;AA4TtC2F,EAAAA,oBAAoB,EAAE,UAASlG,QAAT,EAAmB;AACrC,QAAImG,IAAI,GAAG,KAAKzK,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B,CAAX;AACA4H,IAAAA,IAAI,CAACC,KAAL,CAAWrJ,SAAX,GAAuB,KAAK8B,gBAAL,CAAsBmB,QAAtB,CAAvB;AACA,WAAOmG,IAAP;AACH,GAhUqC;AAiUtCE,EAAAA,kBAAkB,EAAE,UAAS1M,KAAT,EAAgB;AAChC,SAAK8D,oBAAL,IAA6B,KAAKA,oBAAL,CAA0B6I,MAA1B,CAAiC3M,KAAjC,CAA7B;AACH,GAnUqC;AAoUtCuG,EAAAA,sBAAsB,EAAE,YAAW;AAC/B,WAAO,eAAe,KAAK1C,MAAL,CAAY,iBAAZ,CAAtB;AACH,GAtUqC;AAuUtC+I,EAAAA,iBAAiB,EAAE,UAASvJ,OAAT,EAAkBC,cAAlB,EAAkC;AACjD,QAAIuJ,kBAAkB,GAAG,KAAK3G,mBAAL,OAA+B,KAAKyB,mBAAL,EAAxD;;AACA,QAAIvE,SAAS,GAAG,KAAKS,MAAL,CAAY,WAAZ,CAAhB;;AACA,QAAI,SAASR,OAAb,EAAsB;AAClB,aAAOD,SAAP;AACH;;AACD,WAAO8I,IAAI,CAACY,GAAL,CAASD,kBAAkB,IAAIzJ,SAAS,IAAIC,OAAnC,IAA8CC,cAA9C,GAA+DD,OAA/D,GAAyEA,OAAO,GAAG,CAA5F,EAA+F,CAA/F,CAAP;AACH,GA9UqC;AA+UtCuG,EAAAA,0BAA0B,EAAE,UAASlF,CAAT,EAAY+E,SAAZ,EAAuB;AAC/C,QAAIjB,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAI7C,OAAO,GAAG,KAAKuJ,iBAAL,CAAuBnD,SAAS,CAACnF,KAAjC,EAAwCmF,SAAS,CAACnG,cAAlD,CAAd;;AACA,QAAIyJ,SAAS,GAAG,CAAC,GAAG3N,OAAO,CAACiD,MAAZ,EAAoB,KAAK2K,aAAL,CAAmBtI,CAAnB,CAApB,EAA2C;AACvDrB,MAAAA,OAAO,EAAEA,OAD8C;AAEvDC,MAAAA,cAAc,EAAEmG,SAAS,CAACnG;AAF6B,KAA3C,CAAhB;AAIAmG,IAAAA,SAAS,CAACsC,OAAV,IAAqB,KAAKkB,UAAL,CAAgB,cAAhB,EAAgCF,SAAhC,CAArB;;AACA,QAAIA,SAAS,CAAClI,MAAV,IAAoB,CAAC4E,SAAS,CAACsC,OAAnC,EAA4C;AACxC,UAAI,CAACtC,SAAS,CAACsC,OAAf,EAAwB;AACpB,aAAKlI,MAAL,CAAY;AACRP,UAAAA,cAAc,EAAE,KADR;AAERD,UAAAA,OAAO,EAAE;AAFD,SAAZ;AAIH;;AACD;AACH;;AACD,SAAKQ,MAAL,CAAY;AACRP,MAAAA,cAAc,EAAEmG,SAAS,CAACnG,cADlB;AAERD,MAAAA,OAAO,EAAEoG,SAAS,CAACnF;AAFX,KAAZ;;AAIA,SAAK2I,UAAL,CAAgB,uBAAhB,EAAyC,CAAC,GAAG7N,OAAO,CAACiD,MAAZ,EAAoB,KAAK2K,aAAL,CAAmBtI,CAAnB,CAApB,EAA2C;AAChFwI,MAAAA,kBAAkB,EAAE,CAAC,GAAG5N,QAAQ,CAAC6N,gBAAb,EAA+B,KAAKrJ,oBAApC,CAD4D;AAEhFsJ,MAAAA,WAAW,EAAE,CAAC,GAAG9N,QAAQ,CAAC6N,gBAAb,EAA+B3E,eAAe,CAAC6B,aAA/C;AAFmE,KAA3C,CAAzC;;AAIA,SAAKrF,iBAAL;AACH,GAzWqC;AA0WtCqI,EAAAA,oBAAoB,EAAE,UAASjC,KAAT,EAAgBhD,KAAhB,EAAuB;AACzC,SAAKkF,YAAL,GAAoB,KAAKhI,cAAL,CAAoB8F,KAApB,CAApB;;AACA,QAAI,KAAKkC,YAAL,IAAqB,KAAKA,YAAL,CAAkBlF,KAAlB,KAA4BA,KAArD,EAA4D;AACxD,UAAImF,eAAe,GAAG,KAAKD,YAAL,CAAkBlF,KAAlB,EAAtB;;AACA,UAAIoF,UAAU,GAAGpC,KAAK,CAAC3H,MAAN,GAAexC,IAAf,GAAsB,KAAKqM,YAAL,CAAkB7J,MAAlB,GAA2BxC,IAAlE;;AACA,UAAIwM,WAAW,GAAGF,eAAe,GAAGnC,KAAK,CAAC1E,UAAN,EAAlB,GAAuC8G,UAAzD;;AACA,UAAIA,UAAU,GAAG,CAAjB,EAAoB;AAChBpF,QAAAA,KAAK,GAAGmF,eAAe,GAAGC,UAA1B;AACH,OAFD,MAEO;AACH,YAAIC,WAAW,GAAG,CAAlB,EAAqB;AACjBrF,UAAAA,KAAK,GAAGmF,eAAe,GAAGE,WAA1B;AACH,SAFD,MAEO;AACHrF,UAAAA,KAAK,GAAGmF,eAAR;AACH;AACJ;AACJ;;AACD,WAAOnF,KAAP;AACH,GA3XqC;AA4XtCsF,EAAAA,uBAAuB,EAAE,UAASC,mBAAT,EAA8BjN,WAA9B,EAA2C;AAChE,QAAIwK,IAAI,GAAG,IAAX;AACA,QAAI5H,cAAc,GAAG4H,IAAI,CAACrH,MAAL,CAAY,gBAAZ,CAArB;AACA,QAAIuH,KAAK,GAAG,CAAC,GAAGrM,SAAS,CAACD,OAAd,EAAuB4B,WAAvB,CAAZ;;AACA,QAAI4F,UAAU,GAAG4E,IAAI,CAAC3E,sBAAL,EAAjB;;AACA,QAAI6B,KAAK,GAAG,EAAZ;AACA,QAAIH,MAAM,GAAG,EAAb;AACA0F,IAAAA,mBAAmB,CAACC,WAApB,CAAgC1C,IAAI,CAACf,gBAAL,CAAsB,oBAAtB,CAAhC,EAA6E7G,cAA7E;;AACA,QAAIgD,UAAU,IAAIhD,cAAlB,EAAkC;AAC9B8E,MAAAA,KAAK,GAAGgD,KAAK,CAAC1E,UAAN,EAAR;AACH;;AACD,QAAI,CAACJ,UAAD,IAAehD,cAAnB,EAAmC;AAC/B2E,MAAAA,MAAM,GAAGmD,KAAK,CAAC3E,WAAN,EAAT;AACH;;AACD2B,IAAAA,KAAK,GAAG8C,IAAI,CAACmC,oBAAL,CAA0BjC,KAA1B,EAAiChD,KAAjC,CAAR;AACAuF,IAAAA,mBAAmB,CAACzJ,GAApB,CAAwB;AACpBkE,MAAAA,KAAK,EAAEA,KADa;AAEpBH,MAAAA,MAAM,EAAEA;AAFY,KAAxB;AAIH,GA/YqC;AAgZtCgB,EAAAA,SAAS,EAAE,UAASqD,YAAT,EAAuBhI,KAAvB,EAA8BuE,YAA9B,EAA4C;AACnD,QAAIgF,sBAAJ;;AACA,QAAIC,aAAa,GAAG,KAAK5G,SAAL,EAApB;;AACA,QAAI6G,kBAAkB,GAAGD,aAAa,CAACxJ,KAAD,CAAtC;;AACA,QAAIkE,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAI2C,YAAJ,EAAkB;AACdyD,MAAAA,YAAY,GAAGA,YAAY,CAAChK,KAAb,EAAf;;AACAkG,MAAAA,eAAe,CAACwF,sBAAhB,CAAuC,KAAvC,EAA8C1B,YAA9C;AACH;;AACD,QAAI,CAACyB,kBAAL,EAAyB;AACrBF,MAAAA,sBAAsB,GAAGC,aAAa,CAACxJ,KAAK,GAAG,CAAT,CAAtC;AACH;;AACD,SAAK2J,aAAL,CAAmB3B,YAAnB,EAAiCyB,kBAAjC,EAAqDF,sBAArD;AACH,GA7ZqC;AA8ZtCI,EAAAA,aAAa,EAAE,UAASC,WAAT,EAAsBC,IAAtB,EAA4BC,QAA5B,EAAsC;AACjD,QAAI,CAACD,IAAD,IAAS,CAACC,QAAd,EAAwB;AACpBF,MAAAA,WAAW,CAACG,QAAZ,CAAqB,KAAKhI,QAAL,EAArB;AACH,KAFD,MAEO;AACH,UAAI+H,QAAJ,EAAc;AACVF,QAAAA,WAAW,CAACI,WAAZ,CAAwB,CAAC,GAAGvP,SAAS,CAACD,OAAd,EAAuBsP,QAAvB,CAAxB;AACH,OAFD,MAEO;AACHF,QAAAA,WAAW,CAAC9D,YAAZ,CAAyB,CAAC,GAAGrL,SAAS,CAACD,OAAd,EAAuBqP,IAAvB,CAAzB;AACH;AACJ;AACJ,GAxaqC;AAyatCI,EAAAA,iBAAiB,EAAE,UAAS7J,CAAT,EAAY4H,YAAZ,EAA0B;AACzC,WAAO,CAAC,GAAGlN,OAAO,CAACiD,MAAZ,EAAoB,KAAKN,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B,CAApB,EAA0D;AAC7DxB,MAAAA,SAAS,EAAE,KAAK8B,gBAAL,CAAsBoH,YAAtB;AADkD,KAA1D,CAAP;AAGH,GA7aqC;AA8atCU,EAAAA,aAAa,EAAE,UAAStI,CAAT,EAAY;AACvB,QAAI8D,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAI2E,eAAe,GAAG,KAAKlD,mBAAL,EAAtB;;AACA,QAAIrE,cAAc,GAAGuH,eAAe,CAAChH,MAAhB,CAAuB,gBAAvB,CAArB;AACA,WAAO,CAAC,GAAGzE,OAAO,CAACiD,MAAZ,EAAoB,KAAKN,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B,CAApB,EAA0D;AAC7DxB,MAAAA,SAAS,EAAEoF,eAAe,CAAC3E,MAAhB,CAAuB,WAAvB,CADkD;AAE7DR,MAAAA,OAAO,EAAE,KAAKuJ,iBAAL,CAAuB/B,eAAe,CAAChH,MAAhB,CAAuB,SAAvB,CAAvB,EAA0DP,cAA1D,CAFoD;AAG7DA,MAAAA,cAAc,EAAEA;AAH6C,KAA1D,CAAP;AAKH,GAvbqC;AAwbtCkL,EAAAA,cAAc,EAAE,UAAShC,IAAT,EAAe;AAC3B,QAAIiC,MAAM,GAAG,IAAb;;AACA,QAAIC,IAAI,GAAGlC,IAAI,CAACkC,IAAhB;;AACA,YAAQA,IAAR;AACI,WAAK,cAAL;AACA,WAAK,uBAAL;AACA,WAAK,OAAL;AACA,WAAK,UAAL;AACA,WAAK,WAAL;AACI,aAAK,MAAMA,IAAN,GAAa,QAAlB,IAA8B,KAAKC,qBAAL,CAA2BD,IAA3B,CAA9B;AACA;;AACJ,WAAK,iBAAL;AACA,WAAK,qBAAL;AACA,WAAK,gBAAL;AACA,WAAK,kBAAL;AACA,WAAK,YAAL;AACA,WAAK,WAAL;AACA,WAAK,iBAAL;AACA,WAAK,iBAAL;AACA,WAAK,QAAL;AACA,WAAK,sBAAL;AACA,WAAK,YAAL;AACI;;AACJ,WAAK,WAAL;AACI,SAAC,KAAD,EAAQ,IAAR,EAAc7I,OAAd,CAAsB,UAAS+I,YAAT,EAAuB;AACzC,cAAIxL,SAAS,GAAGwL,YAAY,GAAGpC,IAAI,CAACxM,KAAR,GAAgBwM,IAAI,CAACqC,aAAjD;;AACA,cAAI,SAASzL,SAAb,EAAwB;AACpB,gBAAI0L,YAAY,GAAG,CAAC,GAAG/P,SAAS,CAACD,OAAd,EAAuB2P,MAAM,CAACvH,SAAP,GAAmB9D,SAAnB,CAAvB,CAAnB;;AACAqL,YAAAA,MAAM,CAACT,sBAAP,CAA8BY,YAA9B,EAA4CE,YAA5C;AACH;AACJ,SAND;AAOA;;AACJ,WAAK,gBAAL;AACI,aAAKC,4BAAL,CAAkCvC,IAAlC;;AACA;;AACJ,WAAK,SAAL;AACI,aAAKwC,qBAAL,CAA2BxC,IAA3B;;AACA;;AACJ;AACI,aAAKzK,QAAL,CAAcyK,IAAd;AApCR;AAsCH,GAjeqC;AAketCuC,EAAAA,4BAA4B,EAAE,YAAW;AACrC,QAAI,KAAK/K,eAAL,MAA0B,KAAKF,oBAAnC,EAAyD;AACrD,WAAKiG,gBAAL;AACH;AACJ,GAteqC;AAuetCkF,EAAAA,kBAAkB,EAAE,UAASC,QAAT,EAAmB;AACnC,QAAI7I,QAAQ,GAAG,KAAKA,QAAL,EAAf;AACA,QAAI8I,eAAJ;;AACA,QAAI,aAAa9I,QAAQ,CAACnC,GAAT,CAAa,UAAb,CAAjB,EAA2C;AACvCiL,MAAAA,eAAe,GAAG9I,QAAQ,CAACO,GAAT,CAAa,CAAb,CAAlB;AACH,KAFD,MAEO;AACHP,MAAAA,QAAQ,CAAC+I,OAAT,GAAmBC,IAAnB,CAAwB,YAAW;AAC/B,YAAI,cAAc,CAAC,GAAGtQ,SAAS,CAACD,OAAd,EAAuB,IAAvB,EAA6BoF,GAA7B,CAAiC,UAAjC,CAAlB,EAAgE;AAC5DiL,UAAAA,eAAe,GAAG,IAAlB;AACA,iBAAO,KAAP;AACH;AACJ,OALD;AAMH;;AACD,QAAIA,eAAJ,EAAqB;AACjB,UAAIG,UAAU,GAAG,CAAC,GAAG9P,SAAS,CAAC+P,eAAd,EAA+BJ,eAA/B,CAAjB;;AACA,UAAIK,qBAAqB,GAAG,KAAKjJ,sBAAL,EAA5B;;AACA,UAAIkJ,KAAK,GAAGD,qBAAqB,GAAG,KAAH,GAAW,MAA5C;AACA,UAAIE,GAAG,GAAGF,qBAAqB,GAAG,QAAH,GAAc,OAA7C;AACA,UAAIG,MAAM,GAAG,CAAC,GAAGpQ,OAAO,CAACqQ,SAAZ,GAAb;AACA,UAAIC,UAAU,GAAGL,qBAAqB,GAAGG,MAAM,CAACG,WAAV,GAAwBH,MAAM,CAACI,WAArE;;AACA,UAAIb,QAAQ,CAACO,KAAD,CAAR,GAAkBH,UAAU,CAACG,KAAD,CAAV,GAAoBI,UAAtC,IAAoDX,QAAQ,CAACO,KAAD,CAAR,GAAkBH,UAAU,CAACI,GAAD,CAAV,GAAkBG,UAA5F,EAAwG;AACpG,eAAO,KAAP;AACH;AACJ;;AACD,WAAO,IAAP;AACH,GAhgBqC;AAigBtCb,EAAAA,qBAAqB,EAAE,UAASxC,IAAT,EAAe;AAClC,QAAInJ,OAAO,GAAGmJ,IAAI,CAACxM,KAAnB;;AACA,QAAI,KAAKgE,eAAL,EAAJ,EAA4B;AACxB,UAAIgM,eAAe,GAAG,SAAS3M,OAAT,IAAoBA,OAAO,IAAI,CAArD;;AACA,WAAKqJ,kBAAL,CAAwBsD,eAAxB;;AACA,UAAIA,eAAJ,EAAqB;AACjB,aAAKjG,gBAAL;AACH;AACJ,KAND,MAMO;AACH,WAAKkG,UAAL,CAAgBzD,IAAI,CAACqC,aAArB,EAAoCrC,IAAI,CAACxM,KAAzC,EAAgDwM,IAAI,CAAC0D,UAArD;AACH;AACJ,GA5gBqC;AA6gBtCzI,EAAAA,MAAM,EAAE,YAAW;AACf,QAAI,SAAS,KAAK5D,MAAL,CAAY,WAAZ,CAAT,IAAqC,SAAS,KAAKA,MAAL,CAAY,SAAZ,CAAlD,EAA0E;AACtE;AACH;;AACD,SAAKmB,iBAAL,CAAuB,IAAvB;;AACA,SAAKmL,sBAAL;;AACA,QAAI9M,OAAO,GAAG,KAAKQ,MAAL,CAAY,SAAZ,CAAd;;AACA,SAAKmL,qBAAL,CAA2B;AACvBhP,MAAAA,KAAK,EAAEqD,OADgB;AAEvB6M,MAAAA,UAAU,EAAE;AAFW,KAA3B;AAIH,GAxhBqC;AAyhBtCC,EAAAA,sBAAsB,EAAE,YAAW;AAC/B,QAAI/M,SAAS,GAAG,KAAKgN,mBAAL,EAAhB;;AACA,QAAItB,YAAY,GAAG,CAAC,GAAG/P,SAAS,CAACD,OAAd,EAAuB,KAAKoI,SAAL,GAAiB9D,SAAjB,CAAvB,CAAnB;;AACA,QAAI0L,YAAY,CAAC1I,MAAjB,EAAyB;AACrB,WAAKiK,eAAL,GAAuBvB,YAAvB;;AACA,WAAKd,sBAAL,CAA4B,IAA5B,EAAkCc,YAAlC;AACH;AACJ,GAhiBqC;AAiiBtCwB,EAAAA,mBAAmB,EAAE,UAASrP,IAAT,EAAesP,UAAf,EAA2B;AAC5C,QAAIrF,IAAI,GAAG,IAAX;AACA,QAAI7F,WAAW,GAAG6F,IAAI,CAACoC,YAAvB;;AACA,QAAIjI,WAAW,IAAI6F,IAAI,CAAC3E,sBAAL,EAAf,IAAgDlB,WAAW,CAACG,UAAZ,KAA2B+K,UAA/E,EAA2F;AACvFtP,MAAAA,IAAI,IAAIoE,WAAW,CAACG,UAAZ,KAA2B+K,UAAnC;AACH;;AACD,WAAOtP,IAAP;AACH,GAxiBqC;AAyiBtC8I,EAAAA,gBAAgB,EAAE,YAAW;AACzB,QAAImB,IAAI,GAAG,IAAX;;AACA,QAAIyC,mBAAmB,GAAGzC,IAAI,CAACpH,oBAAL,IAA6BoH,IAAI,CAAClB,kBAAL,EAAvD;;AACA,QAAI3F,KAAK,GAAG6G,IAAI,CAAChE,SAAL,EAAZ;;AACA,QAAI7D,OAAO,GAAG6H,IAAI,CAACrH,MAAL,CAAY,SAAZ,CAAd;;AACA,QAAI2L,qBAAqB,GAAGtE,IAAI,CAAC3E,sBAAL,EAA5B;;AACA,QAAIiD,UAAU,GAAG,KAAK3F,MAAL,CAAY,YAAZ,CAAjB;AACA,QAAIP,cAAc,GAAG4H,IAAI,CAACrH,MAAL,CAAY,gBAAZ,CAArB;AACA,QAAIqL,QAAQ,GAAG,IAAf;AACA,QAAIqB,UAAU,GAAG,CAAjB;AACA,QAAI7P,WAAW,GAAG2D,KAAK,CAAChB,OAAD,CAAvB;;AACA,QAAI3C,WAAJ,EAAiB;AACb,UAAI4L,YAAY,GAAG,CAAC,GAAGvN,SAAS,CAACD,OAAd,EAAuB4B,WAAvB,CAAnB;AACAwO,MAAAA,QAAQ,GAAG5C,YAAY,CAAC7I,MAAb,EAAX;AACA8M,MAAAA,UAAU,GAAGC,UAAU,CAAClE,YAAY,CAACpI,GAAb,CAAiB,YAAjB,CAAD,CAAvB;;AACA,UAAI,CAACsL,qBAAD,IAA0BhG,UAA1B,IAAwC,CAAClG,cAA7C,EAA6D;AACzD4L,QAAAA,QAAQ,CAACjO,IAAT,IAAiBqL,YAAY,CAAC5F,UAAb,CAAwB,IAAxB,CAAjB;AACH;AACJ,KAPD,MAOO;AACH,UAAI+J,sBAAsB,GAAG/P,WAAW,GAAG,KAAK0D,mBAAL,CAAyBC,KAAzB,EAAgChB,OAAhC,CAA3C;;AACA,UAAIoN,sBAAJ,EAA4B;AACxBvB,QAAAA,QAAQ,GAAG,CAAC,GAAGnQ,SAAS,CAACD,OAAd,EAAuB2R,sBAAvB,EAA+ChN,MAA/C,EAAX;;AACA,YAAI+L,qBAAJ,EAA2B;AACvBN,UAAAA,QAAQ,CAAC/N,GAAT,IAAgB,CAAC,GAAGpC,SAAS,CAACD,OAAd,EAAuB2R,sBAAvB,EAA+ChK,WAA/C,CAA2D,IAA3D,CAAhB;AACH,SAFD,MAEO;AACH,cAAI,CAAC+C,UAAL,EAAiB;AACb0F,YAAAA,QAAQ,CAACjO,IAAT,IAAiB,CAAC,GAAGlC,SAAS,CAACD,OAAd,EAAuB2R,sBAAvB,EAA+C/J,UAA/C,CAA0D,IAA1D,CAAjB;AACH;AACJ;AACJ;AACJ;;AACDwE,IAAAA,IAAI,CAACwC,uBAAL,CAA6BC,mBAA7B,EAAkDjN,WAAlD;;AACA,QAAIwO,QAAQ,IAAI,CAAChE,IAAI,CAAC+D,kBAAL,CAAwBC,QAAxB,CAAjB,EAAoD;AAChDA,MAAAA,QAAQ,GAAG,IAAX;AACH;;AACD,QAAIA,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAACjO,IAAT,GAAgBiK,IAAI,CAACoF,mBAAL,CAAyBpB,QAAQ,CAACjO,IAAlC,EAAwCsP,UAAxC,CAAhB;;AACArF,MAAAA,IAAI,CAACwF,KAAL,CAAWxB,QAAX,EAAqBvB,mBAArB;AACH;;AACDA,IAAAA,mBAAmB,CAAChB,MAApB,CAA2B,CAAC,CAACuC,QAA7B;AACH,GAjlBqC;AAklBtCyB,EAAAA,aAAa,EAAE,UAAStM,KAAT,EAAgBuM,WAAhB,EAA6BxN,SAA7B,EAAwCC,OAAxC,EAAiD;AAC5D,QAAIwN,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAInH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrF,KAAK,CAAC+B,MAA1B,EAAkCsD,CAAC,EAAnC,EAAuC;AACnC,UAAIwF,QAAQ,GAAG,CAAf;;AACA,UAAI,SAAS7L,OAAT,IAAoB,SAASD,SAAjC,EAA4C;AACxCyN,QAAAA,SAAS,CAAC/E,IAAV,CAAeoD,QAAf;AACA;AACH;;AACD,UAAI9L,SAAS,KAAK,CAAC,CAAnB,EAAsB;AAClB,YAAIsG,CAAC,IAAIrG,OAAT,EAAkB;AACd6L,UAAAA,QAAQ,GAAG0B,WAAX;AACH;AACJ,OAJD,MAIO;AACH,YAAIvN,OAAO,KAAK,CAAC,CAAjB,EAAoB;AAChB,cAAIqG,CAAC,GAAGtG,SAAR,EAAmB;AACf8L,YAAAA,QAAQ,GAAG,CAAC0B,WAAZ;AACH;AACJ,SAJD,MAIO;AACH,cAAIxN,SAAS,GAAGC,OAAhB,EAAyB;AACrB,gBAAIqG,CAAC,GAAGtG,SAAJ,IAAiBsG,CAAC,GAAGrG,OAAzB,EAAkC;AAC9B6L,cAAAA,QAAQ,GAAG,CAAC0B,WAAZ;AACH;AACJ,WAJD,MAIO;AACH,gBAAIxN,SAAS,GAAGC,OAAhB,EAAyB;AACrB,kBAAIqG,CAAC,IAAIrG,OAAL,IAAgBqG,CAAC,GAAGtG,SAAxB,EAAmC;AAC/B8L,gBAAAA,QAAQ,GAAG0B,WAAX;AACH;AACJ;AACJ;AACJ;AACJ;;AACDC,MAAAA,SAAS,CAAC/E,IAAV,CAAeoD,QAAf;AACH;;AACD,WAAO2B,SAAP;AACH,GApnBqC;AAqnBtCC,EAAAA,wBAAwB,EAAE,UAAStB,qBAAT,EAAgC;AACtD,QAAI/D,cAAc,GAAG,KAAKC,oBAAL,EAArB;;AACA,QAAIqF,IAAI,GAAG,KAAKlN,MAAL,CAAY,sBAAZ,CAAX;;AACA,QAAI,CAACkN,IAAL,EAAW;AACPA,MAAAA,IAAI,GAAGvB,qBAAqB,GAAG,CAAC/D,cAAc,CAAChF,WAAf,KAA+BgF,cAAc,CAAChF,WAAf,CAA2B,IAA3B,CAAhC,IAAoE,CAAvE,GAA2E,CAACgF,cAAc,CAAC/E,UAAf,KAA8B+E,cAAc,CAAC/E,UAAf,CAA0B,IAA1B,CAA/B,IAAkE,CAAzK;;AACA,UAAI,CAAC,KAAK7C,MAAL,CAAY,YAAZ,CAAL,EAAgC;AAC5B,aAAKA,MAAL,CAAY,sBAAZ,EAAoCkN,IAApC;AACH;AACJ;;AACD,WAAOA,IAAP;AACH,GA/nBqC;AAgoBtCX,EAAAA,mBAAmB,EAAE,YAAW;AAC5B,QAAIY,YAAY,GAAG,KAAKnN,MAAL,EAAnB;AAAA,QACIT,SAAS,GAAG4N,YAAY,CAAC5N,SAD7B;AAAA,QAEII,eAAe,GAAGwN,YAAY,CAACxN,eAFnC;AAAA,QAGIC,MAAM,GAAGuN,YAAY,CAACvN,MAH1B;;AAIA,WAAO,QAAQL,SAAR,GAAoB,IAApB,GAA2BA,SAAS,GAAGI,eAAZ,GAA8BC,MAAhE;AACH,GAtoBqC;AAuoBtCwM,EAAAA,UAAU,EAAE,UAASgB,WAAT,EAAsB5N,OAAtB,EAA+B6M,UAA/B,EAA2C;AACnD,QAAI9M,SAAS,GAAG,KAAKgN,mBAAL,EAAhB;;AACA,QAAIZ,qBAAqB,GAAG,KAAKjJ,sBAAL,EAA5B;;AACA,QAAI8F,gBAAgB,GAAGmD,qBAAqB,GAAG,KAAH,GAAW,MAAvD;;AACA,QAAIoB,WAAW,GAAG,KAAKE,wBAAL,CAA8BtB,qBAA9B,CAAlB;;AACA,QAAInL,KAAK,GAAG,KAAK6C,SAAL,EAAZ;;AACA,QAAIgK,aAAa,GAAG,KAAKP,aAAL,CAAmBtM,KAAnB,EAA0BuM,WAA1B,EAAuCxN,SAAvC,EAAkD6N,WAAlD,CAApB;;AACA,QAAIJ,SAAS,GAAG,KAAKF,aAAL,CAAmBtM,KAAnB,EAA0BuM,WAA1B,EAAuCxN,SAAvC,EAAkDC,OAAlD,CAAhB;;AACA,QAAI8N,eAAe,GAAG,KAAKtN,MAAL,CAAY,WAAZ,CAAtB;AACA,QAAI2F,UAAU,GAAG,KAAK3F,MAAL,CAAY,YAAZ,CAAjB;;AACA,SAAK,IAAI6F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrF,KAAK,CAAC+B,MAA1B,EAAkCsD,CAAC,EAAnC,EAAuC;AACnC,UAAIhJ,WAAW,GAAG2D,KAAK,CAACqF,CAAD,CAAvB;AACA,UAAI0H,YAAY,GAAGF,aAAa,CAACxH,CAAD,CAAhC;AACA,UAAIwF,QAAQ,GAAG2B,SAAS,CAACnH,CAAD,CAAxB;;AACA,UAAI,SAASrG,OAAT,IAAoB,SAASD,SAAjC,EAA4C;AACxCzB,QAAAA,aAAa,CAACjB,WAAD,CAAb;AACH,OAFD,MAEO;AACH,YAAI0Q,YAAY,KAAKlC,QAAjB,IAA6BgB,UAAU,IAAIhB,QAA/C,EAAyD;AACrDtO,UAAAA,OAAO,CAACF,WAAD,EAAc,CAAC,GAAGtB,OAAO,CAACiD,MAAZ,EAAoB,EAApB,EAAwB8O,eAAxB,EAAyC;AAC1DjQ,YAAAA,EAAE,EAAEpB,eAAe,CAAC,EAAD,EAAKuM,gBAAL,EAAuB,CAACmD,qBAAD,IAA0BhG,UAA1B,GAAuC,CAAC0F,QAAxC,GAAmDA,QAA1E;AADuC,WAAzC,CAAd,CAAP;AAGH;AACJ;AACJ;AACJ,GA/pBqC;AAgqBtClB,EAAAA,sBAAsB,EAAE,UAAShO,KAAT,EAAgBqG,QAAhB,EAA0B;AAC9C,QAAIvB,cAAc,GAAGuB,QAAQ,IAAI,KAAKgK,eAAtC;AACA,SAAKtO,QAAL,CAAc4C,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;;AACA,QAAI,CAAC,KAAKZ,eAAL,EAAL,EAA6B;AACzBc,MAAAA,cAAc,IAAIA,cAAc,CAAC8I,WAAf,CAA2B,KAAKzD,gBAAL,CAAsB,eAAtB,CAA3B,EAAmEnK,KAAnE,CAAlB;AACH;AACJ,GAtqBqC;AAuqBtCqR,EAAAA,QAAQ,EAAE,YAAW;AACjB,SAAKzN,KAAL;AACA,SAAK7B,QAAL;AACH,GA1qBqC;AA2qBtC+G,EAAAA,aAAa,EAAE,UAASP,WAAT,EAAsB;AACjC,QAAIiE,IAAI,GAAG,KAAKQ,aAAL,CAAmBzE,WAAnB,CAAX;;AACA,SAAK0E,UAAL,CAAgB,OAAhB,EAAyBT,IAAzB;;AACA,WAAOA,IAAI,CAAC3H,MAAZ;AACH,GA/qBqC;AAgrBtCkE,EAAAA,gBAAgB,EAAE,UAASR,WAAT,EAAsB;AACpC,QAAIC,eAAe,GAAG,KAAKtC,mBAAL,EAAtB;;AACA,QAAIsG,IAAI,GAAG,KAAKQ,aAAL,CAAmBzE,WAAnB,CAAX;;AACAC,IAAAA,eAAe,CAACyE,UAAhB,CAA2B,UAA3B,EAAuCT,IAAvC;;AACA,WAAOA,IAAI,CAAC3H,MAAZ;AACH,GArrBqC;AAsrBtCqE,EAAAA,iBAAiB,EAAE,UAASX,WAAT,EAAsB;AACrC,QAAIiE,IAAI,GAAG,KAAKQ,aAAL,CAAmBzE,WAAnB,CAAX;;AACA,SAAK0E,UAAL,CAAgB,WAAhB,EAA6BT,IAA7B;;AACA,WAAOA,IAAI,CAAC8E,OAAL,IAAiB,IAAI3R,SAAS,CAACwJ,QAAd,EAAD,CAAyBC,OAAzB,EAAvB;AACH;AA1rBqC,CAA3B,CAAf;;AA4rBA,CAAC,GAAGjK,sBAAsB,CAACL,OAA3B,EAAoCwB,QAApC,EAA8CsB,QAA9C;AACA,IAAI2P,QAAQ,GAAG3P,QAAf;AACA/C,OAAO,CAACC,OAAR,GAAkByS,QAAlB;AACAC,MAAM,CAAC3S,OAAP,GAAiBA,OAAO,CAACC,OAAzB;AACA0S,MAAM,CAAC3S,OAAP,CAAeC,OAAf,GAAyB0S,MAAM,CAAC3S,OAAhC","sourcesContent":["/**\r\n * DevExtreme (ui/sortable.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../events/core/events_engine\"));\r\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _draggable = _interopRequireDefault(require(\"./draggable\"));\r\nvar _element = require(\"../core/element\");\r\nvar _window = require(\"../core/utils/window\");\r\nvar _position = require(\"../core/utils/position\");\r\nvar _translator = require(\"../animation/translator\");\r\nvar _fx = _interopRequireDefault(require(\"../animation/fx\"));\r\nvar _deferred = require(\"../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n    if (key in obj) {\r\n        Object.defineProperty(obj, key, {\r\n            value: value,\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true\r\n        })\r\n    } else {\r\n        obj[key] = value\r\n    }\r\n    return obj\r\n}\r\nvar SORTABLE = \"dxSortable\";\r\nvar PLACEHOLDER_CLASS = \"placeholder\";\r\nvar CLONE_CLASS = \"clone\";\r\nvar isElementVisible = function(itemElement) {\r\n    return (0, _renderer.default)(itemElement).is(\":visible\")\r\n};\r\nvar animate = function(element, config) {\r\n    var _config$to, _config$to2;\r\n    if (!element) {\r\n        return\r\n    }\r\n    var left = (null === (_config$to = config.to) || void 0 === _config$to ? void 0 : _config$to.left) || 0;\r\n    var top = (null === (_config$to2 = config.to) || void 0 === _config$to2 ? void 0 : _config$to2.top) || 0;\r\n    element.style.transform = \"translate(\".concat(left, \"px,\").concat(top, \"px)\");\r\n    element.style.transition = _fx.default.off ? \"\" : \"transform \".concat(config.duration, \"ms \").concat(config.easing)\r\n};\r\nvar stopAnimation = function(element) {\r\n    if (!element) {\r\n        return\r\n    }\r\n    element.style.transform = \"\";\r\n    element.style.transition = \"\"\r\n};\r\nvar Sortable = _draggable.default.inherit({\r\n    _init: function() {\r\n        this.callBase();\r\n        this._sourceScrollHandler = this._handleSourceScroll.bind(this);\r\n        this._sourceScrollableInfo = null\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            clone: true,\r\n            filter: \"> *\",\r\n            itemOrientation: \"vertical\",\r\n            dropFeedbackMode: \"push\",\r\n            allowDropInsideItem: false,\r\n            allowReordering: true,\r\n            moveItemOnDrop: false,\r\n            onDragChange: null,\r\n            onAdd: null,\r\n            onRemove: null,\r\n            onReorder: null,\r\n            onPlaceholderPrepared: null,\r\n            animation: {\r\n                type: \"slide\",\r\n                duration: 300,\r\n                easing: \"ease\"\r\n            },\r\n            fromIndex: null,\r\n            toIndex: null,\r\n            dropInsideItem: false,\r\n            itemPoints: null,\r\n            fromIndexOffset: 0,\r\n            offset: 0,\r\n            autoUpdate: false,\r\n            draggableElementSize: 0\r\n        })\r\n    },\r\n    reset: function() {\r\n        this.option({\r\n            dropInsideItem: false,\r\n            toIndex: null,\r\n            fromIndex: null,\r\n            itemPoints: null,\r\n            fromIndexOffset: 0,\r\n            draggableElementSize: 0\r\n        });\r\n        if (this._$placeholderElement) {\r\n            this._$placeholderElement.remove()\r\n        }\r\n        this._$placeholderElement = null;\r\n        if (!this._isIndicateMode() && this._$modifiedItem) {\r\n            this._$modifiedItem.css(\"marginBottom\", this._modifiedItemMargin);\r\n            this._$modifiedItem = null\r\n        }\r\n    },\r\n    _getPrevVisibleItem: function(items, index) {\r\n        return items.slice(0, index).reverse().filter(isElementVisible)[0]\r\n    },\r\n    _dragStartHandler: function(e) {\r\n        this.callBase.apply(this, arguments);\r\n        if (true === e.cancel) {\r\n            return\r\n        }\r\n        var $sourceElement = this._getSourceElement();\r\n        this._updateItemPoints();\r\n        this._subscribeToSourceScroll(e);\r\n        this.option(\"fromIndex\", this._getElementIndex($sourceElement));\r\n        this.option(\"fromIndexOffset\", this.option(\"offset\"))\r\n    },\r\n    _dragEndHandler: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._unsubscribeFromSourceScroll()\r\n    },\r\n    _subscribeToSourceScroll: function(e) {\r\n        var $scrollable = this._getScrollable((0, _renderer.default)(e.target));\r\n        if ($scrollable) {\r\n            this._sourceScrollableInfo = {\r\n                element: $scrollable,\r\n                scrollLeft: $scrollable.scrollLeft(),\r\n                scrollTop: $scrollable.scrollTop()\r\n            };\r\n            _events_engine.default.on($scrollable, \"scroll\", this._sourceScrollHandler)\r\n        }\r\n    },\r\n    _unsubscribeFromSourceScroll: function() {\r\n        if (this._sourceScrollableInfo) {\r\n            _events_engine.default.off(this._sourceScrollableInfo.element, \"scroll\", this._sourceScrollHandler);\r\n            this._sourceScrollableInfo = null\r\n        }\r\n    },\r\n    _handleSourceScroll: function(e) {\r\n        var _this = this;\r\n        var sourceScrollableInfo = this._sourceScrollableInfo;\r\n        if (sourceScrollableInfo) {\r\n            [\"scrollLeft\", \"scrollTop\"].forEach(function(scrollProp) {\r\n                if (e.target[scrollProp] !== sourceScrollableInfo[scrollProp]) {\r\n                    var scrollBy = e.target[scrollProp] - sourceScrollableInfo[scrollProp];\r\n                    _this._correctItemPoints(scrollBy);\r\n                    sourceScrollableInfo[scrollProp] = e.target[scrollProp]\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _dragEnterHandler: function() {\r\n        this.callBase.apply(this, arguments);\r\n        if (this === this._getSourceDraggable()) {\r\n            return\r\n        }\r\n        this._updateItemPoints();\r\n        this.option(\"fromIndex\", -1);\r\n        if (!this._isIndicateMode()) {\r\n            var itemPoints = this.option(\"itemPoints\");\r\n            var lastItemPoint = itemPoints[itemPoints.length - 1];\r\n            if (lastItemPoint) {\r\n                var $element = this.$element();\r\n                var $sourceElement = this._getSourceElement();\r\n                var isVertical = this._isVerticalOrientation();\r\n                var sourceElementSize = isVertical ? $sourceElement.outerHeight(true) : $sourceElement.outerWidth(true);\r\n                var scrollSize = $element.get(0)[isVertical ? \"scrollHeight\" : \"scrollWidth\"];\r\n                var scrollPosition = $element.get(0)[isVertical ? \"scrollTop\" : \"scrollLeft\"];\r\n                var positionProp = isVertical ? \"top\" : \"left\";\r\n                var lastPointPosition = lastItemPoint[positionProp];\r\n                var elementPosition = $element.offset()[positionProp];\r\n                var freeSize = elementPosition + scrollSize - scrollPosition - lastPointPosition;\r\n                if (freeSize < sourceElementSize) {\r\n                    if (isVertical) {\r\n                        var items = this._getItems();\r\n                        var $lastItem = (0, _renderer.default)(this._getPrevVisibleItem(items));\r\n                        this._$modifiedItem = $lastItem;\r\n                        this._modifiedItemMargin = $lastItem.get(0).style.marginBottom;\r\n                        $lastItem.css(\"marginBottom\", sourceElementSize - freeSize);\r\n                        var $sortable = $lastItem.closest(\".dx-sortable\");\r\n                        var sortable = $sortable.data(\"dxScrollable\") || $sortable.data(\"dxScrollView\");\r\n                        sortable && sortable.update()\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    dragEnter: function() {\r\n        if (this !== this._getTargetDraggable()) {\r\n            this.option(\"toIndex\", -1)\r\n        }\r\n    },\r\n    dragLeave: function() {\r\n        if (this !== this._getTargetDraggable()) {\r\n            this.option(\"toIndex\", this.option(\"fromIndex\"))\r\n        }\r\n    },\r\n    _isInsideTargetDraggable: function(event) {\r\n        var $targetDraggable = this._getTargetDraggable().$element();\r\n        var $scrollable = this._getScrollable($targetDraggable);\r\n        if ($scrollable) {\r\n            var offset = $scrollable.offset();\r\n            var validY = offset.top + $scrollable.height() >= event.pageY && offset.top <= event.pageY;\r\n            var validX = offset.left + $scrollable.width() >= event.pageX && offset.left <= event.pageX;\r\n            return validY && validX\r\n        }\r\n        return true\r\n    },\r\n    dragEnd: function(sourceEvent) {\r\n        var $sourceElement = this._getSourceElement();\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var isSourceDraggable = sourceDraggable.NAME !== this.NAME;\r\n        var toIndex = this.option(\"toIndex\");\r\n        var isInsideTargetDraggable = this._isInsideTargetDraggable(sourceEvent.event);\r\n        if (null !== toIndex && toIndex >= 0 && isInsideTargetDraggable) {\r\n            var cancelAdd;\r\n            var cancelRemove;\r\n            if (sourceDraggable !== this) {\r\n                cancelAdd = this._fireAddEvent(sourceEvent);\r\n                if (!cancelAdd) {\r\n                    cancelRemove = this._fireRemoveEvent(sourceEvent)\r\n                }\r\n            }\r\n            if (isSourceDraggable) {\r\n                (0, _translator.resetPosition)($sourceElement)\r\n            }\r\n            if (this.option(\"moveItemOnDrop\")) {\r\n                !cancelAdd && this._moveItem($sourceElement, toIndex, cancelRemove)\r\n            }\r\n            if (sourceDraggable === this) {\r\n                return this._fireReorderEvent(sourceEvent)\r\n            }\r\n        }\r\n        return (new _deferred.Deferred).resolve()\r\n    },\r\n    dragMove: function(e) {\r\n        var itemPoints = this.option(\"itemPoints\");\r\n        if (!itemPoints) {\r\n            return\r\n        }\r\n        var isVertical = this._isVerticalOrientation();\r\n        var axisName = isVertical ? \"top\" : \"left\";\r\n        var cursorPosition = isVertical ? e.pageY : e.pageX;\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var itemPoint;\r\n        for (var i = itemPoints.length - 1; i >= 0; i--) {\r\n            var centerPosition = itemPoints[i + 1] && (itemPoints[i][axisName] + itemPoints[i + 1][axisName]) / 2;\r\n            if ((!isVertical && rtlEnabled ? cursorPosition > centerPosition : centerPosition > cursorPosition) || void 0 === centerPosition) {\r\n                itemPoint = itemPoints[i]\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n        if (itemPoint) {\r\n            this._updatePlaceholderPosition(e, itemPoint);\r\n            if (this._verticalScrollHelper.isScrolling() && this._isIndicateMode()) {\r\n                this._movePlaceholder()\r\n            }\r\n        }\r\n    },\r\n    _isIndicateMode: function() {\r\n        return \"indicate\" === this.option(\"dropFeedbackMode\") || this.option(\"allowDropInsideItem\")\r\n    },\r\n    _createPlaceholder: function() {\r\n        var $placeholderContainer;\r\n        if (this._isIndicateMode()) {\r\n            $placeholderContainer = (0, _renderer.default)(\"<div>\").addClass(this._addWidgetPrefix(PLACEHOLDER_CLASS)).insertBefore(this._getSourceDraggable()._$dragElement)\r\n        }\r\n        this._$placeholderElement = $placeholderContainer;\r\n        return $placeholderContainer\r\n    },\r\n    _getItems: function() {\r\n        var itemsSelector = this._getItemsSelector();\r\n        return this._$content().find(itemsSelector).not(\".\" + this._addWidgetPrefix(PLACEHOLDER_CLASS)).not(\".\" + this._addWidgetPrefix(CLONE_CLASS)).toArray()\r\n    },\r\n    _allowReordering: function() {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var targetDraggable = this._getTargetDraggable();\r\n        return sourceDraggable !== targetDraggable || this.option(\"allowReordering\")\r\n    },\r\n    _isValidPoint: function(visibleIndex, draggableVisibleIndex, dropInsideItem) {\r\n        var allowDropInsideItem = this.option(\"allowDropInsideItem\");\r\n        var allowReordering = dropInsideItem || this._allowReordering();\r\n        if (!allowReordering && (0 !== visibleIndex || !allowDropInsideItem)) {\r\n            return false\r\n        }\r\n        if (!this._isIndicateMode()) {\r\n            return true\r\n        }\r\n        return draggableVisibleIndex === -1 || visibleIndex !== draggableVisibleIndex && (dropInsideItem || visibleIndex !== draggableVisibleIndex + 1)\r\n    },\r\n    _getItemPoints: function() {\r\n        var that = this;\r\n        var result = [];\r\n        var $item;\r\n        var offset;\r\n        var itemWidth;\r\n        var rtlEnabled = that.option(\"rtlEnabled\");\r\n        var isVertical = that._isVerticalOrientation();\r\n        var itemElements = that._getItems();\r\n        var visibleItemElements = itemElements.filter(isElementVisible);\r\n        var visibleItemCount = visibleItemElements.length;\r\n        var $draggableItem = this._getDraggableElement();\r\n        var draggableVisibleIndex = visibleItemElements.indexOf($draggableItem.get(0));\r\n        if (visibleItemCount) {\r\n            for (var i = 0; i <= visibleItemCount; i++) {\r\n                var needCorrectLeftPosition = !isVertical && rtlEnabled ^ i === visibleItemCount;\r\n                var needCorrectTopPosition = isVertical && i === visibleItemCount;\r\n                if (i < visibleItemCount) {\r\n                    $item = (0, _renderer.default)(visibleItemElements[i]);\r\n                    offset = $item.offset();\r\n                    itemWidth = $item.outerWidth()\r\n                }\r\n                result.push({\r\n                    dropInsideItem: false,\r\n                    left: offset.left + (needCorrectLeftPosition ? itemWidth : 0),\r\n                    top: offset.top + (needCorrectTopPosition ? result[i - 1].height : 0),\r\n                    index: i === visibleItemCount ? itemElements.length : itemElements.indexOf($item.get(0)),\r\n                    $item: $item,\r\n                    width: $item.outerWidth(),\r\n                    height: $item.outerHeight(),\r\n                    isValid: that._isValidPoint(i, draggableVisibleIndex)\r\n                })\r\n            }\r\n            if (this.option(\"allowDropInsideItem\")) {\r\n                var points = result;\r\n                result = [];\r\n                for (var _i = 0; _i < points.length; _i++) {\r\n                    result.push(points[_i]);\r\n                    if (points[_i + 1]) {\r\n                        result.push((0, _extend.extend)({}, points[_i], {\r\n                            dropInsideItem: true,\r\n                            top: Math.floor((points[_i].top + points[_i + 1].top) / 2),\r\n                            left: Math.floor((points[_i].left + points[_i + 1].left) / 2),\r\n                            isValid: this._isValidPoint(_i, draggableVisibleIndex, true)\r\n                        }))\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            result.push({\r\n                dropInsideItem: false,\r\n                index: 0,\r\n                isValid: true\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _updateItemPoints: function(forceUpdate) {\r\n        if (forceUpdate || this.option(\"autoUpdate\") || !this.option(\"itemPoints\")) {\r\n            this.option(\"itemPoints\", this._getItemPoints())\r\n        }\r\n    },\r\n    _correctItemPoints: function(scrollBy) {\r\n        var itemPoints = this.option(\"itemPoints\");\r\n        if (scrollBy && itemPoints && !this.option(\"autoUpdate\")) {\r\n            var isVertical = this._isVerticalOrientation();\r\n            var positionPropName = isVertical ? \"top\" : \"left\";\r\n            itemPoints.forEach(function(itemPoint) {\r\n                itemPoint[positionPropName] -= scrollBy\r\n            })\r\n        }\r\n    },\r\n    _getElementIndex: function($itemElement) {\r\n        return this._getItems().indexOf($itemElement.get(0))\r\n    },\r\n    _getDragTemplateArgs: function($element) {\r\n        var args = this.callBase.apply(this, arguments);\r\n        args.model.fromIndex = this._getElementIndex($element);\r\n        return args\r\n    },\r\n    _togglePlaceholder: function(value) {\r\n        this._$placeholderElement && this._$placeholderElement.toggle(value)\r\n    },\r\n    _isVerticalOrientation: function() {\r\n        return \"vertical\" === this.option(\"itemOrientation\")\r\n    },\r\n    _normalizeToIndex: function(toIndex, dropInsideItem) {\r\n        var isAnotherDraggable = this._getSourceDraggable() !== this._getTargetDraggable();\r\n        var fromIndex = this.option(\"fromIndex\");\r\n        if (null === toIndex) {\r\n            return fromIndex\r\n        }\r\n        return Math.max(isAnotherDraggable || fromIndex >= toIndex || dropInsideItem ? toIndex : toIndex - 1, 0)\r\n    },\r\n    _updatePlaceholderPosition: function(e, itemPoint) {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var toIndex = this._normalizeToIndex(itemPoint.index, itemPoint.dropInsideItem);\r\n        var eventArgs = (0, _extend.extend)(this._getEventArgs(e), {\r\n            toIndex: toIndex,\r\n            dropInsideItem: itemPoint.dropInsideItem\r\n        });\r\n        itemPoint.isValid && this._getAction(\"onDragChange\")(eventArgs);\r\n        if (eventArgs.cancel || !itemPoint.isValid) {\r\n            if (!itemPoint.isValid) {\r\n                this.option({\r\n                    dropInsideItem: false,\r\n                    toIndex: null\r\n                })\r\n            }\r\n            return\r\n        }\r\n        this.option({\r\n            dropInsideItem: itemPoint.dropInsideItem,\r\n            toIndex: itemPoint.index\r\n        });\r\n        this._getAction(\"onPlaceholderPrepared\")((0, _extend.extend)(this._getEventArgs(e), {\r\n            placeholderElement: (0, _element.getPublicElement)(this._$placeholderElement),\r\n            dragElement: (0, _element.getPublicElement)(sourceDraggable._$dragElement)\r\n        }));\r\n        this._updateItemPoints()\r\n    },\r\n    _makeWidthCorrection: function($item, width) {\r\n        this._$scrollable = this._getScrollable($item);\r\n        if (this._$scrollable && this._$scrollable.width() < width) {\r\n            var scrollableWidth = this._$scrollable.width();\r\n            var offsetLeft = $item.offset().left - this._$scrollable.offset().left;\r\n            var offsetRight = scrollableWidth - $item.outerWidth() - offsetLeft;\r\n            if (offsetLeft > 0) {\r\n                width = scrollableWidth - offsetLeft\r\n            } else {\r\n                if (offsetRight > 0) {\r\n                    width = scrollableWidth - offsetRight\r\n                } else {\r\n                    width = scrollableWidth\r\n                }\r\n            }\r\n        }\r\n        return width\r\n    },\r\n    _updatePlaceholderSizes: function($placeholderElement, itemElement) {\r\n        var that = this;\r\n        var dropInsideItem = that.option(\"dropInsideItem\");\r\n        var $item = (0, _renderer.default)(itemElement);\r\n        var isVertical = that._isVerticalOrientation();\r\n        var width = \"\";\r\n        var height = \"\";\r\n        $placeholderElement.toggleClass(that._addWidgetPrefix(\"placeholder-inside\"), dropInsideItem);\r\n        if (isVertical || dropInsideItem) {\r\n            width = $item.outerWidth()\r\n        }\r\n        if (!isVertical || dropInsideItem) {\r\n            height = $item.outerHeight()\r\n        }\r\n        width = that._makeWidthCorrection($item, width);\r\n        $placeholderElement.css({\r\n            width: width,\r\n            height: height\r\n        })\r\n    },\r\n    _moveItem: function($itemElement, index, cancelRemove) {\r\n        var $prevTargetItemElement;\r\n        var $itemElements = this._getItems();\r\n        var $targetItemElement = $itemElements[index];\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        if (cancelRemove) {\r\n            $itemElement = $itemElement.clone();\r\n            sourceDraggable._toggleDragSourceClass(false, $itemElement)\r\n        }\r\n        if (!$targetItemElement) {\r\n            $prevTargetItemElement = $itemElements[index - 1]\r\n        }\r\n        this._moveItemCore($itemElement, $targetItemElement, $prevTargetItemElement)\r\n    },\r\n    _moveItemCore: function($targetItem, item, prevItem) {\r\n        if (!item && !prevItem) {\r\n            $targetItem.appendTo(this.$element())\r\n        } else {\r\n            if (prevItem) {\r\n                $targetItem.insertAfter((0, _renderer.default)(prevItem))\r\n            } else {\r\n                $targetItem.insertBefore((0, _renderer.default)(item))\r\n            }\r\n        }\r\n    },\r\n    _getDragStartArgs: function(e, $itemElement) {\r\n        return (0, _extend.extend)(this.callBase.apply(this, arguments), {\r\n            fromIndex: this._getElementIndex($itemElement)\r\n        })\r\n    },\r\n    _getEventArgs: function(e) {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var targetDraggable = this._getTargetDraggable();\r\n        var dropInsideItem = targetDraggable.option(\"dropInsideItem\");\r\n        return (0, _extend.extend)(this.callBase.apply(this, arguments), {\r\n            fromIndex: sourceDraggable.option(\"fromIndex\"),\r\n            toIndex: this._normalizeToIndex(targetDraggable.option(\"toIndex\"), dropInsideItem),\r\n            dropInsideItem: dropInsideItem\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        var _this2 = this;\r\n        var name = args.name;\r\n        switch (name) {\r\n            case \"onDragChange\":\r\n            case \"onPlaceholderPrepared\":\r\n            case \"onAdd\":\r\n            case \"onRemove\":\r\n            case \"onReorder\":\r\n                this[\"_\" + name + \"Action\"] = this._createActionByOption(name);\r\n                break;\r\n            case \"itemOrientation\":\r\n            case \"allowDropInsideItem\":\r\n            case \"moveItemOnDrop\":\r\n            case \"dropFeedbackMode\":\r\n            case \"itemPoints\":\r\n            case \"animation\":\r\n            case \"allowReordering\":\r\n            case \"fromIndexOffset\":\r\n            case \"offset\":\r\n            case \"draggableElementSize\":\r\n            case \"autoUpdate\":\r\n                break;\r\n            case \"fromIndex\":\r\n                [false, true].forEach(function(isDragSource) {\r\n                    var fromIndex = isDragSource ? args.value : args.previousValue;\r\n                    if (null !== fromIndex) {\r\n                        var $fromElement = (0, _renderer.default)(_this2._getItems()[fromIndex]);\r\n                        _this2._toggleDragSourceClass(isDragSource, $fromElement)\r\n                    }\r\n                });\r\n                break;\r\n            case \"dropInsideItem\":\r\n                this._optionChangedDropInsideItem(args);\r\n                break;\r\n            case \"toIndex\":\r\n                this._optionChangedToIndex(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _optionChangedDropInsideItem: function() {\r\n        if (this._isIndicateMode() && this._$placeholderElement) {\r\n            this._movePlaceholder()\r\n        }\r\n    },\r\n    _isPositionVisible: function(position) {\r\n        var $element = this.$element();\r\n        var scrollContainer;\r\n        if (\"hidden\" !== $element.css(\"overflow\")) {\r\n            scrollContainer = $element.get(0)\r\n        } else {\r\n            $element.parents().each(function() {\r\n                if (\"visible\" !== (0, _renderer.default)(this).css(\"overflow\")) {\r\n                    scrollContainer = this;\r\n                    return false\r\n                }\r\n            })\r\n        }\r\n        if (scrollContainer) {\r\n            var clientRect = (0, _position.getBoundingRect)(scrollContainer);\r\n            var isVerticalOrientation = this._isVerticalOrientation();\r\n            var start = isVerticalOrientation ? \"top\" : \"left\";\r\n            var end = isVerticalOrientation ? \"bottom\" : \"right\";\r\n            var window = (0, _window.getWindow)();\r\n            var pageOffset = isVerticalOrientation ? window.pageYOffset : window.pageXOffset;\r\n            if (position[start] < clientRect[start] + pageOffset || position[start] > clientRect[end] + pageOffset) {\r\n                return false\r\n            }\r\n        }\r\n        return true\r\n    },\r\n    _optionChangedToIndex: function(args) {\r\n        var toIndex = args.value;\r\n        if (this._isIndicateMode()) {\r\n            var showPlaceholder = null !== toIndex && toIndex >= 0;\r\n            this._togglePlaceholder(showPlaceholder);\r\n            if (showPlaceholder) {\r\n                this._movePlaceholder()\r\n            }\r\n        } else {\r\n            this._moveItems(args.previousValue, args.value, args.fullUpdate)\r\n        }\r\n    },\r\n    update: function() {\r\n        if (null === this.option(\"fromIndex\") && null === this.option(\"toIndex\")) {\r\n            return\r\n        }\r\n        this._updateItemPoints(true);\r\n        this._updateDragSourceClass();\r\n        var toIndex = this.option(\"toIndex\");\r\n        this._optionChangedToIndex({\r\n            value: toIndex,\r\n            fullUpdate: true\r\n        })\r\n    },\r\n    _updateDragSourceClass: function() {\r\n        var fromIndex = this._getActualFromIndex();\r\n        var $fromElement = (0, _renderer.default)(this._getItems()[fromIndex]);\r\n        if ($fromElement.length) {\r\n            this._$sourceElement = $fromElement;\r\n            this._toggleDragSourceClass(true, $fromElement)\r\n        }\r\n    },\r\n    _makeLeftCorrection: function(left, leftMargin) {\r\n        var that = this;\r\n        var $scrollable = that._$scrollable;\r\n        if ($scrollable && that._isVerticalOrientation() && $scrollable.scrollLeft() > leftMargin) {\r\n            left += $scrollable.scrollLeft() - leftMargin\r\n        }\r\n        return left\r\n    },\r\n    _movePlaceholder: function() {\r\n        var that = this;\r\n        var $placeholderElement = that._$placeholderElement || that._createPlaceholder();\r\n        var items = that._getItems();\r\n        var toIndex = that.option(\"toIndex\");\r\n        var isVerticalOrientation = that._isVerticalOrientation();\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var dropInsideItem = that.option(\"dropInsideItem\");\r\n        var position = null;\r\n        var leftMargin = 0;\r\n        var itemElement = items[toIndex];\r\n        if (itemElement) {\r\n            var $itemElement = (0, _renderer.default)(itemElement);\r\n            position = $itemElement.offset();\r\n            leftMargin = parseFloat($itemElement.css(\"marginLeft\"));\r\n            if (!isVerticalOrientation && rtlEnabled && !dropInsideItem) {\r\n                position.left += $itemElement.outerWidth(true)\r\n            }\r\n        } else {\r\n            var prevVisibleItemElement = itemElement = this._getPrevVisibleItem(items, toIndex);\r\n            if (prevVisibleItemElement) {\r\n                position = (0, _renderer.default)(prevVisibleItemElement).offset();\r\n                if (isVerticalOrientation) {\r\n                    position.top += (0, _renderer.default)(prevVisibleItemElement).outerHeight(true)\r\n                } else {\r\n                    if (!rtlEnabled) {\r\n                        position.left += (0, _renderer.default)(prevVisibleItemElement).outerWidth(true)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        that._updatePlaceholderSizes($placeholderElement, itemElement);\r\n        if (position && !that._isPositionVisible(position)) {\r\n            position = null\r\n        }\r\n        if (position) {\r\n            position.left = that._makeLeftCorrection(position.left, leftMargin);\r\n            that._move(position, $placeholderElement)\r\n        }\r\n        $placeholderElement.toggle(!!position)\r\n    },\r\n    _getPositions: function(items, elementSize, fromIndex, toIndex) {\r\n        var positions = [];\r\n        for (var i = 0; i < items.length; i++) {\r\n            var position = 0;\r\n            if (null === toIndex || null === fromIndex) {\r\n                positions.push(position);\r\n                continue\r\n            }\r\n            if (fromIndex === -1) {\r\n                if (i >= toIndex) {\r\n                    position = elementSize\r\n                }\r\n            } else {\r\n                if (toIndex === -1) {\r\n                    if (i > fromIndex) {\r\n                        position = -elementSize\r\n                    }\r\n                } else {\r\n                    if (fromIndex < toIndex) {\r\n                        if (i > fromIndex && i < toIndex) {\r\n                            position = -elementSize\r\n                        }\r\n                    } else {\r\n                        if (fromIndex > toIndex) {\r\n                            if (i >= toIndex && i < fromIndex) {\r\n                                position = elementSize\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            positions.push(position)\r\n        }\r\n        return positions\r\n    },\r\n    _getDraggableElementSize: function(isVerticalOrientation) {\r\n        var $draggableItem = this._getDraggableElement();\r\n        var size = this.option(\"draggableElementSize\");\r\n        if (!size) {\r\n            size = isVerticalOrientation ? ($draggableItem.outerHeight() + $draggableItem.outerHeight(true)) / 2 : ($draggableItem.outerWidth() + $draggableItem.outerWidth(true)) / 2;\r\n            if (!this.option(\"autoUpdate\")) {\r\n                this.option(\"draggableElementSize\", size)\r\n            }\r\n        }\r\n        return size\r\n    },\r\n    _getActualFromIndex: function() {\r\n        var _this$option = this.option(),\r\n            fromIndex = _this$option.fromIndex,\r\n            fromIndexOffset = _this$option.fromIndexOffset,\r\n            offset = _this$option.offset;\r\n        return null == fromIndex ? null : fromIndex + fromIndexOffset - offset\r\n    },\r\n    _moveItems: function(prevToIndex, toIndex, fullUpdate) {\r\n        var fromIndex = this._getActualFromIndex();\r\n        var isVerticalOrientation = this._isVerticalOrientation();\r\n        var positionPropName = isVerticalOrientation ? \"top\" : \"left\";\r\n        var elementSize = this._getDraggableElementSize(isVerticalOrientation);\r\n        var items = this._getItems();\r\n        var prevPositions = this._getPositions(items, elementSize, fromIndex, prevToIndex);\r\n        var positions = this._getPositions(items, elementSize, fromIndex, toIndex);\r\n        var animationConfig = this.option(\"animation\");\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemElement = items[i];\r\n            var prevPosition = prevPositions[i];\r\n            var position = positions[i];\r\n            if (null === toIndex || null === fromIndex) {\r\n                stopAnimation(itemElement)\r\n            } else {\r\n                if (prevPosition !== position || fullUpdate && position) {\r\n                    animate(itemElement, (0, _extend.extend)({}, animationConfig, {\r\n                        to: _defineProperty({}, positionPropName, !isVerticalOrientation && rtlEnabled ? -position : position)\r\n                    }))\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _toggleDragSourceClass: function(value, $element) {\r\n        var $sourceElement = $element || this._$sourceElement;\r\n        this.callBase.apply(this, arguments);\r\n        if (!this._isIndicateMode()) {\r\n            $sourceElement && $sourceElement.toggleClass(this._addWidgetPrefix(\"source-hidden\"), value)\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        this.reset();\r\n        this.callBase()\r\n    },\r\n    _fireAddEvent: function(sourceEvent) {\r\n        var args = this._getEventArgs(sourceEvent);\r\n        this._getAction(\"onAdd\")(args);\r\n        return args.cancel\r\n    },\r\n    _fireRemoveEvent: function(sourceEvent) {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var args = this._getEventArgs(sourceEvent);\r\n        sourceDraggable._getAction(\"onRemove\")(args);\r\n        return args.cancel\r\n    },\r\n    _fireReorderEvent: function(sourceEvent) {\r\n        var args = this._getEventArgs(sourceEvent);\r\n        this._getAction(\"onReorder\")(args);\r\n        return args.promise || (new _deferred.Deferred).resolve()\r\n    }\r\n});\r\n(0, _component_registrator.default)(SORTABLE, Sortable);\r\nvar _default = Sortable;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}