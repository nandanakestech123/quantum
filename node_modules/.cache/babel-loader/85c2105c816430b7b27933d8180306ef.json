{"ast":null,"code":"/**\r\n * DevExtreme (viz/vector_map/projection.main.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.projection = exports.Projection = void 0;\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _event_emitter = require(\"./event_emitter\");\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _e = void 0;\n\n  try {\n    for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) {\n        break;\n      }\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && null != _i.return) {\n        _i.return();\n      }\n    } finally {\n      if (_d) {\n        throw _e;\n      }\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) {\n    return arr;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar _Number = Number;\nvar _min = Math.min;\nvar _max = Math.max;\nvar _abs = Math.abs;\nvar _round = Math.round;\nvar _ln = Math.log;\nvar _pow = Math.pow;\nvar TWO_TO_LN2 = 2 / Math.LN2;\nvar MIN_BOUNDS_RANGE = 1 / 3600 / 180 / 10;\nvar DEFAULT_MIN_ZOOM = 1;\nvar DEFAULT_MAX_ZOOM = 256;\nvar DEFAULT_CENTER = [NaN, NaN];\nvar DEFAULT_ENGINE_NAME = \"mercator\";\n\nfunction floatsEqual(f1, f2) {\n  return _abs(f1 - f2) < 1e-8;\n}\n\nfunction arraysEqual(a1, a2) {\n  return floatsEqual(a1[0], a2[0]) && floatsEqual(a1[1], a2[1]);\n}\n\nfunction parseAndClamp(value, minValue, maxValue, defaultValue) {\n  var val = _Number(value);\n\n  return isFinite(val) ? _min(_max(val, minValue), maxValue) : defaultValue;\n}\n\nfunction parseAndClampArray(value, minValue, maxValue, defaultValue) {\n  return [parseAndClamp(value[0], minValue[0], maxValue[0], defaultValue[0]), parseAndClamp(value[1], minValue[1], maxValue[1], defaultValue[1])];\n}\n\nfunction getEngine(engine) {\n  return engine instanceof Engine && engine || projection.get(engine) || projection(engine) || projection.get(DEFAULT_ENGINE_NAME);\n}\n\nvar Projection = function (parameters) {\n  var that = this;\n\n  that._initEvents();\n\n  that._params = parameters;\n  that._engine = getEngine();\n  that._center = that._engine.center();\n\n  that._adjustCenter();\n};\n\nexports.Projection = Projection;\nProjection.prototype = {\n  constructor: Projection,\n  _minZoom: DEFAULT_MIN_ZOOM,\n  _maxZoom: DEFAULT_MAX_ZOOM,\n  _zoom: DEFAULT_MIN_ZOOM,\n  _center: DEFAULT_CENTER,\n  _canvas: {},\n  _scale: [],\n  dispose: function () {\n    this._disposeEvents();\n  },\n  setEngine: function (value) {\n    var that = this;\n    var engine = getEngine(value);\n\n    if (that._engine !== engine) {\n      that._engine = engine;\n\n      that._fire(\"engine\");\n\n      if (that._changeCenter(engine.center())) {\n        that._triggerCenterChanged();\n      }\n\n      if (that._changeZoom(that._minZoom)) {\n        that._triggerZoomChanged();\n      }\n\n      that._adjustCenter();\n\n      that._setupScreen();\n    }\n  },\n  setBounds: function (bounds) {\n    if (void 0 !== bounds) {\n      this.setEngine(this._engine.original().bounds(bounds));\n    }\n  },\n  _setupScreen: function () {\n    var that = this;\n    var canvas = that._canvas;\n    var width = canvas.width;\n    var height = canvas.height;\n    var engine = that._engine;\n    var aspectRatio = engine.ar();\n    that._x0 = canvas.left + width / 2;\n    that._y0 = canvas.top + height / 2;\n    var min = [that.project([engine.min()[0], 0])[0], that.project([0, engine.min()[1]])[1]];\n    var max = [that.project([engine.max()[0], 0])[0], that.project([0, engine.max()[1]])[1]];\n    var screenAR = width / height;\n\n    var boundsAR = _abs(max[0] - min[0]) / _abs(max[1] - min[1]);\n\n    var correction;\n\n    if (isNaN(boundsAR) || 0 === boundsAR || _min(screenAR, aspectRatio) <= aspectRatio * boundsAR && aspectRatio * boundsAR <= _max(screenAR, aspectRatio)) {\n      correction = 1;\n    } else {\n      correction = boundsAR > 1 ? boundsAR : 1 / boundsAR;\n    }\n\n    if (aspectRatio * boundsAR >= screenAR) {\n      that._xRadius = width / 2 / correction;\n      that._yRadius = width / 2 / (aspectRatio * correction);\n    } else {\n      that._xRadius = height / 2 * (aspectRatio / correction);\n      that._yRadius = height / 2 / correction;\n    }\n\n    that._fire(\"screen\");\n  },\n  setSize: function (canvas) {\n    this._canvas = canvas;\n\n    this._setupScreen();\n  },\n  getCanvas: function () {\n    return this._canvas;\n  },\n  _toScreen: function (coordinates) {\n    return [this._x0 + this._xRadius * coordinates[0], this._y0 + this._yRadius * coordinates[1]];\n  },\n  _fromScreen: function (coordinates) {\n    return [(coordinates[0] - this._x0) / this._xRadius, (coordinates[1] - this._y0) / this._yRadius];\n  },\n  _toTransformed: function (coordinates) {\n    return [coordinates[0] * this._zoom + this._xCenter, coordinates[1] * this._zoom + this._yCenter];\n  },\n  _toTransformedFast: function (coordinates) {\n    return [coordinates[0] * this._zoom, coordinates[1] * this._zoom];\n  },\n  _fromTransformed: function (coordinates) {\n    return [(coordinates[0] - this._xCenter) / this._zoom, (coordinates[1] - this._yCenter) / this._zoom];\n  },\n  _adjustCenter: function () {\n    var that = this;\n\n    var center = that._engine.project(that._center);\n\n    that._xCenter = -center[0] * that._zoom || 0;\n    that._yCenter = -center[1] * that._zoom || 0;\n  },\n  project: function (coordinates) {\n    return this._engine.project(coordinates);\n  },\n  transform: function (coordinates) {\n    return this._toScreen(this._toTransformedFast(coordinates));\n  },\n  isInvertible: function () {\n    return this._engine.isInvertible();\n  },\n  getSquareSize: function (size) {\n    return [size[0] * this._zoom * this._xRadius, size[1] * this._zoom * this._yRadius];\n  },\n  getZoom: function () {\n    return this._zoom;\n  },\n  _changeZoom: function (value) {\n    var that = this;\n    var oldZoom = that._zoom;\n    var newZoom = that._zoom = parseAndClamp(value, that._minZoom, that._maxZoom, that._minZoom);\n    var isChanged = !floatsEqual(oldZoom, newZoom);\n\n    if (isChanged) {\n      that._adjustCenter();\n\n      that._fire(\"zoom\");\n    }\n\n    return isChanged;\n  },\n  setZoom: function (value) {\n    if (this._engine.isInvertible() && this._changeZoom(value)) {\n      this._triggerZoomChanged();\n    }\n  },\n  getScaledZoom: function () {\n    return _round((this._scale.length - 1) * _ln(this._zoom) / _ln(this._maxZoom));\n  },\n  setScaledZoom: function (scaledZoom) {\n    this.setZoom(this._scale[_round(scaledZoom)]);\n  },\n  changeScaledZoom: function (deltaZoom) {\n    this.setZoom(this._scale[_max(_min(_round(this.getScaledZoom() + deltaZoom), this._scale.length - 1), 0)]);\n  },\n  getZoomScalePartition: function () {\n    return this._scale.length - 1;\n  },\n  _setupScaling: function () {\n    var that = this;\n\n    var k = _max(_round(TWO_TO_LN2 * _ln(that._maxZoom)), 4);\n\n    var step = _pow(that._maxZoom, 1 / k);\n\n    var zoom = that._minZoom;\n    that._scale = [zoom];\n\n    for (var i = 1; i <= k; ++i) {\n      that._scale.push(zoom *= step);\n    }\n  },\n  setMaxZoom: function (maxZoom) {\n    var that = this;\n    that._minZoom = DEFAULT_MIN_ZOOM;\n    that._maxZoom = parseAndClamp(maxZoom, that._minZoom, _Number.MAX_VALUE, DEFAULT_MAX_ZOOM);\n\n    that._setupScaling();\n\n    if (that._zoom > that._maxZoom) {\n      that.setZoom(that._maxZoom);\n    }\n\n    that._fire(\"max-zoom\");\n  },\n  getCenter: function () {\n    return this._center.slice();\n  },\n  setCenter: function (value) {\n    if (this._engine.isInvertible() && this._changeCenter(value || [])) {\n      this._triggerCenterChanged();\n    }\n  },\n  _changeCenter: function (value) {\n    var that = this;\n    var engine = that._engine;\n    var oldCenter = that._center;\n    var newCenter = that._center = parseAndClampArray(value, engine.min(), engine.max(), engine.center());\n    var isChanged = !arraysEqual(oldCenter, newCenter);\n\n    if (isChanged) {\n      that._adjustCenter();\n\n      that._fire(\"center\");\n    }\n\n    return isChanged;\n  },\n  _triggerCenterChanged: function () {\n    this._params.centerChanged(this.getCenter());\n  },\n  _triggerZoomChanged: function () {\n    this._params.zoomChanged(this.getZoom());\n  },\n  setCenterByPoint: function (coordinates, screenPosition) {\n    var that = this;\n\n    var p = that._engine.project(coordinates);\n\n    var q = that._fromScreen(screenPosition);\n\n    that.setCenter(that._engine.unproject([-q[0] / that._zoom + p[0], -q[1] / that._zoom + p[1]]));\n  },\n  beginMoveCenter: function () {\n    if (this._engine.isInvertible()) {\n      this._moveCenter = this._center;\n    }\n  },\n  endMoveCenter: function () {\n    var that = this;\n\n    if (that._moveCenter) {\n      if (!arraysEqual(that._moveCenter, that._center)) {\n        that._triggerCenterChanged();\n      }\n\n      that._moveCenter = null;\n    }\n  },\n  moveCenter: function (shift) {\n    var that = this;\n\n    if (that._moveCenter) {\n      var current = that.toScreenPoint(that._center);\n\n      that._changeCenter(that.fromScreenPoint([current[0] + shift[0], current[1] + shift[1]]));\n    }\n  },\n  getViewport: function () {\n    var that = this;\n    var unproject = that._engine.unproject;\n    var lt = unproject(that._fromTransformed([-1, -1]));\n    var lb = unproject(that._fromTransformed([-1, 1]));\n    var rt = unproject(that._fromTransformed([1, -1]));\n    var rb = unproject(that._fromTransformed([1, 1]));\n    var minMax = findMinMax([selectFarthestPoint(lt[0], lb[0], rt[0], rb[0]), selectFarthestPoint(lt[1], rt[1], lb[1], rb[1])], [selectFarthestPoint(rt[0], rb[0], lt[0], lb[0]), selectFarthestPoint(lb[1], rb[1], lt[1], rt[1])]);\n    return [].concat(minMax.min, minMax.max);\n  },\n  setViewport: function (viewport) {\n    var engine = this._engine;\n    var data = viewport ? getZoomAndCenterFromViewport(engine.project, engine.unproject, viewport) : [this._minZoom, engine.center()];\n    this.setZoom(data[0]);\n    this.setCenter(data[1]);\n  },\n  getTransform: function () {\n    return {\n      translateX: this._xCenter * this._xRadius,\n      translateY: this._yCenter * this._yRadius\n    };\n  },\n  fromScreenPoint: function (coordinates) {\n    return this._engine.unproject(this._fromTransformed(this._fromScreen(coordinates)));\n  },\n  toScreenPoint: function (coordinates) {\n    return this._toScreen(this._toTransformed(this._engine.project(coordinates)));\n  },\n  _eventNames: [\"engine\", \"screen\", \"center\", \"zoom\", \"max-zoom\"]\n};\n(0, _event_emitter.makeEventEmitter)(Projection);\n\nfunction selectFarthestPoint(point1, point2, basePoint1, basePoint2) {\n  var basePoint = (basePoint1 + basePoint2) / 2;\n  return _abs(point1 - basePoint) > _abs(point2 - basePoint) ? point1 : point2;\n}\n\nfunction selectClosestPoint(point1, point2, basePoint1, basePoint2) {\n  var basePoint = (basePoint1 + basePoint2) / 2;\n  return _abs(point1 - basePoint) < _abs(point2 - basePoint) ? point1 : point2;\n}\n\nfunction getZoomAndCenterFromViewport(project, unproject, viewport) {\n  var lt = project([viewport[0], viewport[3]]);\n  var lb = project([viewport[0], viewport[1]]);\n  var rt = project([viewport[2], viewport[3]]);\n  var rb = project([viewport[2], viewport[1]]);\n  var l = selectClosestPoint(lt[0], lb[0], rt[0], rb[0]);\n  var r = selectClosestPoint(rt[0], rb[0], lt[0], lb[0]);\n  var t = selectClosestPoint(lt[1], rt[1], lb[1], rb[1]);\n  var b = selectClosestPoint(lb[1], rb[1], lt[1], rt[1]);\n  return [2 / _max(_abs(l - r), _abs(t - b)), unproject([(l + r) / 2, (t + b) / 2])];\n}\n\nfunction setMinMax(engine, p1, p2) {\n  var _findMinMax = findMinMax(p1, p2),\n      min = _findMinMax.min,\n      max = _findMinMax.max;\n\n  engine.min = returnArray(min);\n  engine.max = returnArray(max);\n}\n\nvar Engine = function () {\n  function Engine(parameters) {\n    _classCallCheck(this, Engine);\n\n    var that = this;\n    var project = createProjectMethod(parameters.to);\n    var unproject = parameters.from ? createUnprojectMethod(parameters.from) : returnValue(DEFAULT_CENTER);\n    that.project = project;\n    that.unproject = unproject;\n    that.original = returnValue(that);\n\n    that.source = function () {\n      return (0, _extend.extend)({}, parameters);\n    };\n\n    that.isInvertible = returnValue(!!parameters.from);\n    that.ar = returnValue(parameters.aspectRatio > 0 ? _Number(parameters.aspectRatio) : 1);\n    that.center = returnArray(unproject([0, 0]));\n    setMinMax(that, [unproject([-1, 0])[0], unproject([0, 1])[1]], [unproject([1, 0])[0], unproject([0, -1])[1]]);\n  }\n\n  _createClass(Engine, [{\n    key: \"aspectRatio\",\n    value: function (_aspectRatio) {\n      var engine = new Engine((0, _extend.extend)(this.source(), {\n        aspectRatio: _aspectRatio\n      }));\n      engine.original = this.original;\n      engine.min = this.min;\n      engine.max = this.max;\n      return engine;\n    }\n  }, {\n    key: \"bounds\",\n    value: function (_bounds) {\n      _bounds = _bounds || [];\n      var parameters = this.source();\n      var min = this.min();\n      var max = this.max();\n      var b1 = parseAndClampArray([_bounds[0], _bounds[1]], min, max, min);\n      var b2 = parseAndClampArray([_bounds[2], _bounds[3]], min, max, max);\n      var p1 = parameters.to(b1);\n      var p2 = parameters.to(b2);\n\n      var delta = _min(_abs(p2[0] - p1[0]) > MIN_BOUNDS_RANGE ? _abs(p2[0] - p1[0]) : 2, _abs(p2[1] - p1[1]) > MIN_BOUNDS_RANGE ? _abs(p2[1] - p1[1]) : 2);\n\n      if (delta < 2) {\n        (0, _extend.extend)(parameters, createProjectUnprojectMethods(parameters.to, parameters.from, p1, p2, delta));\n      }\n\n      var engine = new Engine(parameters);\n      engine.original = this.original;\n      setMinMax(engine, b1, b2);\n      return engine;\n    }\n  }]);\n\n  return Engine;\n}();\n\nfunction invertVerticalAxis(pair) {\n  return [pair[0], -pair[1]];\n}\n\nfunction createProjectMethod(method) {\n  return function (arg) {\n    return invertVerticalAxis(method(arg));\n  };\n}\n\nfunction createUnprojectMethod(method) {\n  return function (arg) {\n    return method(invertVerticalAxis(arg));\n  };\n}\n\nfunction returnValue(value) {\n  return function () {\n    return value;\n  };\n}\n\nfunction returnArray(value) {\n  return function () {\n    return value.slice();\n  };\n}\n\nfunction findMinMax(p1, p2) {\n  return {\n    min: [_min(p1[0], p2[0]), _min(p1[1], p2[1])],\n    max: [_max(p1[0], p2[0]), _max(p1[1], p2[1])]\n  };\n}\n\nvar projection = function (parameters) {\n  return parameters && parameters.to ? new Engine(parameters) : null;\n};\n\nexports.projection = projection;\nvar projectionsCache = {};\n\nprojection.get = function (name) {\n  return projectionsCache[name] || null;\n};\n\nprojection.add = function (name, engine) {\n  engine = engine instanceof Engine && engine || projection(engine);\n\n  if (!projectionsCache[name] && engine) {\n    projectionsCache[name] = engine;\n  }\n\n  return projection;\n};\n\nfunction createProjectUnprojectMethods(project, unproject, p1, p2, delta) {\n  var x0 = (p1[0] + p2[0]) / 2 - delta / 2;\n  var y0 = (p1[1] + p2[1]) / 2 - delta / 2;\n  var k = 2 / delta;\n  return {\n    to: function (coordinates) {\n      var _project = project(coordinates),\n          _project2 = _slicedToArray(_project, 2),\n          p0 = _project2[0],\n          p1 = _project2[1];\n\n      return [-1 + (p0 - x0) * k, -1 + (p1 - y0) * k];\n    },\n    from: function (coordinates) {\n      return unproject([x0 + (coordinates[0] + 1) / k, y0 + (coordinates[1] + 1) / k]);\n    }\n  };\n}","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/viz/vector_map/projection.main.js"],"names":["exports","projection","Projection","_extend","require","_event_emitter","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","push","value","err","return","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_Number","Number","_min","Math","min","_max","max","_abs","abs","_round","round","_ln","log","_pow","pow","TWO_TO_LN2","LN2","MIN_BOUNDS_RANGE","DEFAULT_MIN_ZOOM","DEFAULT_MAX_ZOOM","DEFAULT_CENTER","NaN","DEFAULT_ENGINE_NAME","floatsEqual","f1","f2","arraysEqual","a1","a2","parseAndClamp","minValue","maxValue","defaultValue","val","isFinite","parseAndClampArray","getEngine","engine","Engine","get","parameters","that","_initEvents","_params","_engine","_center","center","_adjustCenter","_minZoom","_maxZoom","_zoom","_canvas","_scale","dispose","_disposeEvents","setEngine","_fire","_changeCenter","_triggerCenterChanged","_changeZoom","_triggerZoomChanged","_setupScreen","setBounds","bounds","original","canvas","width","height","aspectRatio","ar","_x0","left","_y0","top","project","screenAR","boundsAR","correction","isNaN","_xRadius","_yRadius","setSize","getCanvas","_toScreen","coordinates","_fromScreen","_toTransformed","_xCenter","_yCenter","_toTransformedFast","_fromTransformed","transform","isInvertible","getSquareSize","size","getZoom","oldZoom","newZoom","isChanged","setZoom","getScaledZoom","setScaledZoom","scaledZoom","changeScaledZoom","deltaZoom","getZoomScalePartition","_setupScaling","k","step","zoom","setMaxZoom","maxZoom","MAX_VALUE","getCenter","setCenter","oldCenter","newCenter","centerChanged","zoomChanged","setCenterByPoint","screenPosition","p","q","unproject","beginMoveCenter","_moveCenter","endMoveCenter","moveCenter","shift","current","toScreenPoint","fromScreenPoint","getViewport","lt","lb","rt","rb","minMax","findMinMax","selectFarthestPoint","concat","setViewport","viewport","data","getZoomAndCenterFromViewport","getTransform","translateX","translateY","_eventNames","makeEventEmitter","point1","point2","basePoint1","basePoint2","basePoint","selectClosestPoint","l","r","t","b","setMinMax","p1","p2","_findMinMax","returnArray","createProjectMethod","to","createUnprojectMethod","returnValue","source","extend","_aspectRatio","_bounds","b1","b2","delta","createProjectUnprojectMethods","invertVerticalAxis","pair","method","arg","projectionsCache","add","x0","y0","_project","_project2","p0"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/vector_map/projection.main.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.projection = exports.Projection = void 0;\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _event_emitter = require(\"./event_emitter\");\r\n\r\nfunction _slicedToArray(arr, i) {\r\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest()\r\n}\r\n\r\nfunction _nonIterableRest() {\r\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(o)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\n\r\nfunction _iterableToArrayLimit(arr, i) {\r\n    if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\r\n        return\r\n    }\r\n    var _arr = [];\r\n    var _n = true;\r\n    var _d = false;\r\n    var _e = void 0;\r\n    try {\r\n        for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\r\n            _arr.push(_s.value);\r\n            if (i && _arr.length === i) {\r\n                break\r\n            }\r\n        }\r\n    } catch (err) {\r\n        _d = true;\r\n        _e = err\r\n    } finally {\r\n        try {\r\n            if (!_n && null != _i.return) {\r\n                _i.return()\r\n            }\r\n        } finally {\r\n            if (_d) {\r\n                throw _e\r\n            }\r\n        }\r\n    }\r\n    return _arr\r\n}\r\n\r\nfunction _arrayWithHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return arr\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar _Number = Number;\r\nvar _min = Math.min;\r\nvar _max = Math.max;\r\nvar _abs = Math.abs;\r\nvar _round = Math.round;\r\nvar _ln = Math.log;\r\nvar _pow = Math.pow;\r\nvar TWO_TO_LN2 = 2 / Math.LN2;\r\nvar MIN_BOUNDS_RANGE = 1 / 3600 / 180 / 10;\r\nvar DEFAULT_MIN_ZOOM = 1;\r\nvar DEFAULT_MAX_ZOOM = 256;\r\nvar DEFAULT_CENTER = [NaN, NaN];\r\nvar DEFAULT_ENGINE_NAME = \"mercator\";\r\n\r\nfunction floatsEqual(f1, f2) {\r\n    return _abs(f1 - f2) < 1e-8\r\n}\r\n\r\nfunction arraysEqual(a1, a2) {\r\n    return floatsEqual(a1[0], a2[0]) && floatsEqual(a1[1], a2[1])\r\n}\r\n\r\nfunction parseAndClamp(value, minValue, maxValue, defaultValue) {\r\n    var val = _Number(value);\r\n    return isFinite(val) ? _min(_max(val, minValue), maxValue) : defaultValue\r\n}\r\n\r\nfunction parseAndClampArray(value, minValue, maxValue, defaultValue) {\r\n    return [parseAndClamp(value[0], minValue[0], maxValue[0], defaultValue[0]), parseAndClamp(value[1], minValue[1], maxValue[1], defaultValue[1])]\r\n}\r\n\r\nfunction getEngine(engine) {\r\n    return engine instanceof Engine && engine || projection.get(engine) || projection(engine) || projection.get(DEFAULT_ENGINE_NAME)\r\n}\r\nvar Projection = function(parameters) {\r\n    var that = this;\r\n    that._initEvents();\r\n    that._params = parameters;\r\n    that._engine = getEngine();\r\n    that._center = that._engine.center();\r\n    that._adjustCenter()\r\n};\r\nexports.Projection = Projection;\r\nProjection.prototype = {\r\n    constructor: Projection,\r\n    _minZoom: DEFAULT_MIN_ZOOM,\r\n    _maxZoom: DEFAULT_MAX_ZOOM,\r\n    _zoom: DEFAULT_MIN_ZOOM,\r\n    _center: DEFAULT_CENTER,\r\n    _canvas: {},\r\n    _scale: [],\r\n    dispose: function() {\r\n        this._disposeEvents()\r\n    },\r\n    setEngine: function(value) {\r\n        var that = this;\r\n        var engine = getEngine(value);\r\n        if (that._engine !== engine) {\r\n            that._engine = engine;\r\n            that._fire(\"engine\");\r\n            if (that._changeCenter(engine.center())) {\r\n                that._triggerCenterChanged()\r\n            }\r\n            if (that._changeZoom(that._minZoom)) {\r\n                that._triggerZoomChanged()\r\n            }\r\n            that._adjustCenter();\r\n            that._setupScreen()\r\n        }\r\n    },\r\n    setBounds: function(bounds) {\r\n        if (void 0 !== bounds) {\r\n            this.setEngine(this._engine.original().bounds(bounds))\r\n        }\r\n    },\r\n    _setupScreen: function() {\r\n        var that = this;\r\n        var canvas = that._canvas;\r\n        var width = canvas.width;\r\n        var height = canvas.height;\r\n        var engine = that._engine;\r\n        var aspectRatio = engine.ar();\r\n        that._x0 = canvas.left + width / 2;\r\n        that._y0 = canvas.top + height / 2;\r\n        var min = [that.project([engine.min()[0], 0])[0], that.project([0, engine.min()[1]])[1]];\r\n        var max = [that.project([engine.max()[0], 0])[0], that.project([0, engine.max()[1]])[1]];\r\n        var screenAR = width / height;\r\n        var boundsAR = _abs(max[0] - min[0]) / _abs(max[1] - min[1]);\r\n        var correction;\r\n        if (isNaN(boundsAR) || 0 === boundsAR || _min(screenAR, aspectRatio) <= aspectRatio * boundsAR && aspectRatio * boundsAR <= _max(screenAR, aspectRatio)) {\r\n            correction = 1\r\n        } else {\r\n            correction = boundsAR > 1 ? boundsAR : 1 / boundsAR\r\n        }\r\n        if (aspectRatio * boundsAR >= screenAR) {\r\n            that._xRadius = width / 2 / correction;\r\n            that._yRadius = width / 2 / (aspectRatio * correction)\r\n        } else {\r\n            that._xRadius = height / 2 * (aspectRatio / correction);\r\n            that._yRadius = height / 2 / correction\r\n        }\r\n        that._fire(\"screen\")\r\n    },\r\n    setSize: function(canvas) {\r\n        this._canvas = canvas;\r\n        this._setupScreen()\r\n    },\r\n    getCanvas: function() {\r\n        return this._canvas\r\n    },\r\n    _toScreen: function(coordinates) {\r\n        return [this._x0 + this._xRadius * coordinates[0], this._y0 + this._yRadius * coordinates[1]]\r\n    },\r\n    _fromScreen: function(coordinates) {\r\n        return [(coordinates[0] - this._x0) / this._xRadius, (coordinates[1] - this._y0) / this._yRadius]\r\n    },\r\n    _toTransformed: function(coordinates) {\r\n        return [coordinates[0] * this._zoom + this._xCenter, coordinates[1] * this._zoom + this._yCenter]\r\n    },\r\n    _toTransformedFast: function(coordinates) {\r\n        return [coordinates[0] * this._zoom, coordinates[1] * this._zoom]\r\n    },\r\n    _fromTransformed: function(coordinates) {\r\n        return [(coordinates[0] - this._xCenter) / this._zoom, (coordinates[1] - this._yCenter) / this._zoom]\r\n    },\r\n    _adjustCenter: function() {\r\n        var that = this;\r\n        var center = that._engine.project(that._center);\r\n        that._xCenter = -center[0] * that._zoom || 0;\r\n        that._yCenter = -center[1] * that._zoom || 0\r\n    },\r\n    project: function(coordinates) {\r\n        return this._engine.project(coordinates)\r\n    },\r\n    transform: function(coordinates) {\r\n        return this._toScreen(this._toTransformedFast(coordinates))\r\n    },\r\n    isInvertible: function() {\r\n        return this._engine.isInvertible()\r\n    },\r\n    getSquareSize: function(size) {\r\n        return [size[0] * this._zoom * this._xRadius, size[1] * this._zoom * this._yRadius]\r\n    },\r\n    getZoom: function() {\r\n        return this._zoom\r\n    },\r\n    _changeZoom: function(value) {\r\n        var that = this;\r\n        var oldZoom = that._zoom;\r\n        var newZoom = that._zoom = parseAndClamp(value, that._minZoom, that._maxZoom, that._minZoom);\r\n        var isChanged = !floatsEqual(oldZoom, newZoom);\r\n        if (isChanged) {\r\n            that._adjustCenter();\r\n            that._fire(\"zoom\")\r\n        }\r\n        return isChanged\r\n    },\r\n    setZoom: function(value) {\r\n        if (this._engine.isInvertible() && this._changeZoom(value)) {\r\n            this._triggerZoomChanged()\r\n        }\r\n    },\r\n    getScaledZoom: function() {\r\n        return _round((this._scale.length - 1) * _ln(this._zoom) / _ln(this._maxZoom))\r\n    },\r\n    setScaledZoom: function(scaledZoom) {\r\n        this.setZoom(this._scale[_round(scaledZoom)])\r\n    },\r\n    changeScaledZoom: function(deltaZoom) {\r\n        this.setZoom(this._scale[_max(_min(_round(this.getScaledZoom() + deltaZoom), this._scale.length - 1), 0)])\r\n    },\r\n    getZoomScalePartition: function() {\r\n        return this._scale.length - 1\r\n    },\r\n    _setupScaling: function() {\r\n        var that = this;\r\n        var k = _max(_round(TWO_TO_LN2 * _ln(that._maxZoom)), 4);\r\n        var step = _pow(that._maxZoom, 1 / k);\r\n        var zoom = that._minZoom;\r\n        that._scale = [zoom];\r\n        for (var i = 1; i <= k; ++i) {\r\n            that._scale.push(zoom *= step)\r\n        }\r\n    },\r\n    setMaxZoom: function(maxZoom) {\r\n        var that = this;\r\n        that._minZoom = DEFAULT_MIN_ZOOM;\r\n        that._maxZoom = parseAndClamp(maxZoom, that._minZoom, _Number.MAX_VALUE, DEFAULT_MAX_ZOOM);\r\n        that._setupScaling();\r\n        if (that._zoom > that._maxZoom) {\r\n            that.setZoom(that._maxZoom)\r\n        }\r\n        that._fire(\"max-zoom\")\r\n    },\r\n    getCenter: function() {\r\n        return this._center.slice()\r\n    },\r\n    setCenter: function(value) {\r\n        if (this._engine.isInvertible() && this._changeCenter(value || [])) {\r\n            this._triggerCenterChanged()\r\n        }\r\n    },\r\n    _changeCenter: function(value) {\r\n        var that = this;\r\n        var engine = that._engine;\r\n        var oldCenter = that._center;\r\n        var newCenter = that._center = parseAndClampArray(value, engine.min(), engine.max(), engine.center());\r\n        var isChanged = !arraysEqual(oldCenter, newCenter);\r\n        if (isChanged) {\r\n            that._adjustCenter();\r\n            that._fire(\"center\")\r\n        }\r\n        return isChanged\r\n    },\r\n    _triggerCenterChanged: function() {\r\n        this._params.centerChanged(this.getCenter())\r\n    },\r\n    _triggerZoomChanged: function() {\r\n        this._params.zoomChanged(this.getZoom())\r\n    },\r\n    setCenterByPoint: function(coordinates, screenPosition) {\r\n        var that = this;\r\n        var p = that._engine.project(coordinates);\r\n        var q = that._fromScreen(screenPosition);\r\n        that.setCenter(that._engine.unproject([-q[0] / that._zoom + p[0], -q[1] / that._zoom + p[1]]))\r\n    },\r\n    beginMoveCenter: function() {\r\n        if (this._engine.isInvertible()) {\r\n            this._moveCenter = this._center\r\n        }\r\n    },\r\n    endMoveCenter: function() {\r\n        var that = this;\r\n        if (that._moveCenter) {\r\n            if (!arraysEqual(that._moveCenter, that._center)) {\r\n                that._triggerCenterChanged()\r\n            }\r\n            that._moveCenter = null\r\n        }\r\n    },\r\n    moveCenter: function(shift) {\r\n        var that = this;\r\n        if (that._moveCenter) {\r\n            var current = that.toScreenPoint(that._center);\r\n            that._changeCenter(that.fromScreenPoint([current[0] + shift[0], current[1] + shift[1]]))\r\n        }\r\n    },\r\n    getViewport: function() {\r\n        var that = this;\r\n        var unproject = that._engine.unproject;\r\n        var lt = unproject(that._fromTransformed([-1, -1]));\r\n        var lb = unproject(that._fromTransformed([-1, 1]));\r\n        var rt = unproject(that._fromTransformed([1, -1]));\r\n        var rb = unproject(that._fromTransformed([1, 1]));\r\n        var minMax = findMinMax([selectFarthestPoint(lt[0], lb[0], rt[0], rb[0]), selectFarthestPoint(lt[1], rt[1], lb[1], rb[1])], [selectFarthestPoint(rt[0], rb[0], lt[0], lb[0]), selectFarthestPoint(lb[1], rb[1], lt[1], rt[1])]);\r\n        return [].concat(minMax.min, minMax.max)\r\n    },\r\n    setViewport: function(viewport) {\r\n        var engine = this._engine;\r\n        var data = viewport ? getZoomAndCenterFromViewport(engine.project, engine.unproject, viewport) : [this._minZoom, engine.center()];\r\n        this.setZoom(data[0]);\r\n        this.setCenter(data[1])\r\n    },\r\n    getTransform: function() {\r\n        return {\r\n            translateX: this._xCenter * this._xRadius,\r\n            translateY: this._yCenter * this._yRadius\r\n        }\r\n    },\r\n    fromScreenPoint: function(coordinates) {\r\n        return this._engine.unproject(this._fromTransformed(this._fromScreen(coordinates)))\r\n    },\r\n    toScreenPoint: function(coordinates) {\r\n        return this._toScreen(this._toTransformed(this._engine.project(coordinates)))\r\n    },\r\n    _eventNames: [\"engine\", \"screen\", \"center\", \"zoom\", \"max-zoom\"]\r\n};\r\n(0, _event_emitter.makeEventEmitter)(Projection);\r\n\r\nfunction selectFarthestPoint(point1, point2, basePoint1, basePoint2) {\r\n    var basePoint = (basePoint1 + basePoint2) / 2;\r\n    return _abs(point1 - basePoint) > _abs(point2 - basePoint) ? point1 : point2\r\n}\r\n\r\nfunction selectClosestPoint(point1, point2, basePoint1, basePoint2) {\r\n    var basePoint = (basePoint1 + basePoint2) / 2;\r\n    return _abs(point1 - basePoint) < _abs(point2 - basePoint) ? point1 : point2\r\n}\r\n\r\nfunction getZoomAndCenterFromViewport(project, unproject, viewport) {\r\n    var lt = project([viewport[0], viewport[3]]);\r\n    var lb = project([viewport[0], viewport[1]]);\r\n    var rt = project([viewport[2], viewport[3]]);\r\n    var rb = project([viewport[2], viewport[1]]);\r\n    var l = selectClosestPoint(lt[0], lb[0], rt[0], rb[0]);\r\n    var r = selectClosestPoint(rt[0], rb[0], lt[0], lb[0]);\r\n    var t = selectClosestPoint(lt[1], rt[1], lb[1], rb[1]);\r\n    var b = selectClosestPoint(lb[1], rb[1], lt[1], rt[1]);\r\n    return [2 / _max(_abs(l - r), _abs(t - b)), unproject([(l + r) / 2, (t + b) / 2])]\r\n}\r\n\r\nfunction setMinMax(engine, p1, p2) {\r\n    var _findMinMax = findMinMax(p1, p2),\r\n        min = _findMinMax.min,\r\n        max = _findMinMax.max;\r\n    engine.min = returnArray(min);\r\n    engine.max = returnArray(max)\r\n}\r\nvar Engine = function() {\r\n    function Engine(parameters) {\r\n        _classCallCheck(this, Engine);\r\n        var that = this;\r\n        var project = createProjectMethod(parameters.to);\r\n        var unproject = parameters.from ? createUnprojectMethod(parameters.from) : returnValue(DEFAULT_CENTER);\r\n        that.project = project;\r\n        that.unproject = unproject;\r\n        that.original = returnValue(that);\r\n        that.source = function() {\r\n            return (0, _extend.extend)({}, parameters)\r\n        };\r\n        that.isInvertible = returnValue(!!parameters.from);\r\n        that.ar = returnValue(parameters.aspectRatio > 0 ? _Number(parameters.aspectRatio) : 1);\r\n        that.center = returnArray(unproject([0, 0]));\r\n        setMinMax(that, [unproject([-1, 0])[0], unproject([0, 1])[1]], [unproject([1, 0])[0], unproject([0, -1])[1]])\r\n    }\r\n    _createClass(Engine, [{\r\n        key: \"aspectRatio\",\r\n        value: function(_aspectRatio) {\r\n            var engine = new Engine((0, _extend.extend)(this.source(), {\r\n                aspectRatio: _aspectRatio\r\n            }));\r\n            engine.original = this.original;\r\n            engine.min = this.min;\r\n            engine.max = this.max;\r\n            return engine\r\n        }\r\n    }, {\r\n        key: \"bounds\",\r\n        value: function(_bounds) {\r\n            _bounds = _bounds || [];\r\n            var parameters = this.source();\r\n            var min = this.min();\r\n            var max = this.max();\r\n            var b1 = parseAndClampArray([_bounds[0], _bounds[1]], min, max, min);\r\n            var b2 = parseAndClampArray([_bounds[2], _bounds[3]], min, max, max);\r\n            var p1 = parameters.to(b1);\r\n            var p2 = parameters.to(b2);\r\n            var delta = _min(_abs(p2[0] - p1[0]) > MIN_BOUNDS_RANGE ? _abs(p2[0] - p1[0]) : 2, _abs(p2[1] - p1[1]) > MIN_BOUNDS_RANGE ? _abs(p2[1] - p1[1]) : 2);\r\n            if (delta < 2) {\r\n                (0, _extend.extend)(parameters, createProjectUnprojectMethods(parameters.to, parameters.from, p1, p2, delta))\r\n            }\r\n            var engine = new Engine(parameters);\r\n            engine.original = this.original;\r\n            setMinMax(engine, b1, b2);\r\n            return engine\r\n        }\r\n    }]);\r\n    return Engine\r\n}();\r\n\r\nfunction invertVerticalAxis(pair) {\r\n    return [pair[0], -pair[1]]\r\n}\r\n\r\nfunction createProjectMethod(method) {\r\n    return function(arg) {\r\n        return invertVerticalAxis(method(arg))\r\n    }\r\n}\r\n\r\nfunction createUnprojectMethod(method) {\r\n    return function(arg) {\r\n        return method(invertVerticalAxis(arg))\r\n    }\r\n}\r\n\r\nfunction returnValue(value) {\r\n    return function() {\r\n        return value\r\n    }\r\n}\r\n\r\nfunction returnArray(value) {\r\n    return function() {\r\n        return value.slice()\r\n    }\r\n}\r\n\r\nfunction findMinMax(p1, p2) {\r\n    return {\r\n        min: [_min(p1[0], p2[0]), _min(p1[1], p2[1])],\r\n        max: [_max(p1[0], p2[0]), _max(p1[1], p2[1])]\r\n    }\r\n}\r\nvar projection = function(parameters) {\r\n    return parameters && parameters.to ? new Engine(parameters) : null\r\n};\r\nexports.projection = projection;\r\nvar projectionsCache = {};\r\nprojection.get = function(name) {\r\n    return projectionsCache[name] || null\r\n};\r\nprojection.add = function(name, engine) {\r\n    engine = engine instanceof Engine && engine || projection(engine);\r\n    if (!projectionsCache[name] && engine) {\r\n        projectionsCache[name] = engine\r\n    }\r\n    return projection\r\n};\r\n\r\nfunction createProjectUnprojectMethods(project, unproject, p1, p2, delta) {\r\n    var x0 = (p1[0] + p2[0]) / 2 - delta / 2;\r\n    var y0 = (p1[1] + p2[1]) / 2 - delta / 2;\r\n    var k = 2 / delta;\r\n    return {\r\n        to: function(coordinates) {\r\n            var _project = project(coordinates),\r\n                _project2 = _slicedToArray(_project, 2),\r\n                p0 = _project2[0],\r\n                p1 = _project2[1];\r\n            return [-1 + (p0 - x0) * k, -1 + (p1 - y0) * k]\r\n        },\r\n        from: function(coordinates) {\r\n            return unproject([x0 + (coordinates[0] + 1) / k, y0 + (coordinates[1] + 1) / k])\r\n        }\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"script"}