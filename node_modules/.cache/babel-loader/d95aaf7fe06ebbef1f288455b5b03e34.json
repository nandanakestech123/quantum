{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"./style.scss\";import{NormalButton,NormalInput,NormalTextarea,NormalRadio,NormalSelect}from\"component/common\";import{dateFormat}from\"service/helperFunctions\";import _ from\"lodash\";import{history}from\"helpers\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{getCommonApi,updateForm,commonCreateApi,commonDeleteApi,commonPatchApi}from\"redux/actions/common\";import SimpleReactValidator from\"simple-react-validator\";// import { Treatment, Payment, EditCart } from './cart/index';\nimport service from\"assets/images/make-up-brush.png\";// import Discount from './cart/discount';\nimport{FormGroup,Label,Input}from\"reactstrap\";export var ReversalClass=/*#__PURE__*/function(_Component){_inherits(ReversalClass,_Component);var _super=_createSuper(ReversalClass);function ReversalClass(){var _this;_classCallCheck(this,ReversalClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={tstaffList:[],cartData:{},formFields:{type:\"\",adj_value:\"\",reason:\"\",remark:\"\"},headerDetails:{},isShowBalance:false,transactioRecord:[],reasonOption:[],afterAdjustment:\"\"};_this.componentWillMount=function(){// this.getCart();\n_this.validator=new SimpleReactValidator({element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});_this.props.getCommonApi(\"reversereason/\").then(function(key){var data=key.data;var reasonOption=_this.state.reasonOption;var _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;reasonOption.push({value:value.id,label:value.rev_desc});}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({reasonOption:reasonOption});});_this.getCart();};_this.getCart=function(){var _this$state=_this.state,cartData=_this$state.cartData,tstaffList=_this$state.tstaffList,headerDetails=_this$state.headerDetails,afterAdjustment=_this$state.afterAdjustment;_this.props.getCommonApi(\"reversal/?treatment_id=\".concat(_this.props.reversalId)).then(function(key){cartData=key;tstaffList=key.data;headerDetails=key.header_data;afterAdjustment=key.header_data.total;_this.setState({cartData:cartData,tstaffList:tstaffList,headerDetails:headerDetails,afterAdjustment:afterAdjustment});});};_this.handleShowBalance=function(){var transactioRecord=_this.state.transactioRecord;_this.props.getCommonApi(\"showbalance/?treatment_id=\".concat(_this.props.reversalId)).then(function(key){transactioRecord=key.data;_this.setState({transactioRecord:transactioRecord});});};_this.handleSubmit=function(id){};_this.handleDialog=function(){};_this.handleAddReversal=function(item){//debugger;\nvar formFields=_this.state.formFields;if(_this.validator.allValid()){_this.props.commonCreateApi(\"reversal/?treatment_id=\".concat(_this.props.reversalId,\"&adjustment_value=\").concat(formFields.type+formFields.adj_value,\"&reason_id=\").concat(formFields.reason,\"&remark=\").concat(formFields.remark)).then(function(res){window.open(res.data);_this.props.handleModal();});}else{_this.validator.showMessages();}};_this.handleChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var _ref$target,value,name,formFields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$target=_ref.target,value=_ref$target.value,name=_ref$target.name;formFields=_this.state.formFields;formFields[name]=value;_context.next=5;return _this.setState({formFields:formFields});case 5:_this.getAfterAdjustment();case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleClearLine=function(){};_this.handleClearAll=function(){};_this.getAfterAdjustment=function(){var _this$state2=_this.state,afterAdjustment=_this$state2.afterAdjustment,formFields=_this$state2.formFields,headerDetails=_this$state2.headerDetails;if(formFields.type===\"-\"){afterAdjustment=Number(headerDetails.total)-Number(formFields.adj_value);}if(formFields.type===\"+\"){afterAdjustment=Number(headerDetails.total)+Number(formFields.adj_value);}afterAdjustment=afterAdjustment.toFixed(2);console.log(\"adsfasdfasdfasdf\",afterAdjustment,headerDetails.total,typeof afterAdjustment);_this.setState({afterAdjustment:afterAdjustment});};return _this;}_createClass(ReversalClass,[{key:\"render\",value:function render(){var _this$state3=this.state,_this$state3$tstaffLi=_this$state3.tstaffList,tstaffList=_this$state3$tstaffLi===void 0?[]:_this$state3$tstaffLi,Room=_this$state3.Room,new_remark=_this$state3.new_remark,headerDetails=_this$state3.headerDetails,transactioRecord=_this$state3.transactioRecord,reasonOption=_this$state3.reasonOption,reason=_this$state3.reason,formFields=_this$state3.formFields,afterAdjustment=_this$state3.afterAdjustment;return/*#__PURE__*/React.createElement(\"div\",{className:\"row new-cart treatment-done\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"p\",{className:\"fs-18 font-700 mb-3 title\"},\"Treatment Reversal\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 fs-14\"},/*#__PURE__*/React.createElement(\"p\",{className:\"fs-14\"},\"Reverse Treatment List\"),/*#__PURE__*/React.createElement(\"p\",{className:\"fs-14\"},\"Reverse No: \",/*#__PURE__*/React.createElement(\"b\",null,headerDetails?headerDetails.reverse_no:\"\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"},\"S.No\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},\"Treatment #\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},\"Content\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},\"Value\")),tstaffList.length>0?tstaffList.map(function(item,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-1\"},index+1),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},item.treatment_code),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},item.course),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},item.unit_amount));}):\"\",/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8 text-right\"},\"Total\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},headerDetails?headerDetails.total:\"\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8 text-right\"},\"Total deposit or Balance\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},headerDetails?headerDetails.total_depobalance:\"\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8 text-right\"},\"Adjustment Value\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},formFields.adj_value)),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8 text-right\"},\"Total credit Note after adjustment\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},Number(afterAdjustment))),/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2 mb-2\",mainbg:true,className:\"fs-15\",label:\"Show Balance\",outline:false,onClick:this.handleShowBalance})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 fs-14\"},/*#__PURE__*/React.createElement(\"p\",null,\"Transaction Record\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},\"Treatment #\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},\"Balance/Deposit\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 d-flex align-items-center justify-content-center\"},\"Total Reverse Price\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},\"Outstanding\")),transactioRecord.length>0?transactioRecord.map(function(item,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},item.treatment_parentcode),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},item.balance),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},item.reverse_price),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 text-center\"},item.outstanding));}):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 fs-14 adjustment\"},/*#__PURE__*/React.createElement(\"p\",null,\"Adjustment Proceedure\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},\"Adjustmet\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 pr-0 \"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(NormalSelect// placeholder=\"Enter here\"\n,{options:[{value:\"-\",label:\"-\"},{value:\"+\",label:\"+\"}],value:formFields.type,name:\"type\",onChange:this.handleChange,className:\"customer-name py-0\",disabled:Room}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(NormalInput,{value:formFields.adj_value,name:\"adj_value\",onChange:this.handleChange,className:\"customer-name\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row mb-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},\"Reason\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 \"},/*#__PURE__*/React.createElement(NormalSelect,{options:reasonOption,value:formFields.reason,name:\"reason\",onChange:this.handleChange,className:\"customer-name py-0\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},\"Remark\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(NormalTextarea,{placeholder:\"\",value:formFields.remark,name:\"remark\",onChange:this.handleChange})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 fs-14 pt-4 action-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 d-flex\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 text-right\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 text-right\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",mainbg:true,className:\" fs-15 confirm\",label:\"Confirm\",outline:false,onClick:this.handleAddReversal})))));}}]);return ReversalClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{selected_cstomer:state.common.selected_cstomer,basicApptDetail:state.appointment.basicApptDetail};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({// getCustomer,\ngetCommonApi:getCommonApi,updateForm:updateForm,commonCreateApi:commonCreateApi,commonPatchApi:commonPatchApi,commonDeleteApi:commonDeleteApi},dispatch);};export var Reversal=connect(mapStateToProps,mapDispatchToProps)(ReversalClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/treatmentDone/reversal.js"],"names":["React","Component","NormalButton","NormalInput","NormalTextarea","NormalRadio","NormalSelect","dateFormat","_","history","connect","bindActionCreators","getCommonApi","updateForm","commonCreateApi","commonDeleteApi","commonPatchApi","SimpleReactValidator","service","FormGroup","Label","Input","ReversalClass","state","tstaffList","cartData","formFields","type","adj_value","reason","remark","headerDetails","isShowBalance","transactioRecord","reasonOption","afterAdjustment","componentWillMount","validator","element","message","autoForceUpdate","props","then","key","data","value","push","id","label","rev_desc","setState","getCart","reversalId","header_data","total","handleShowBalance","handleSubmit","handleDialog","handleAddReversal","item","allValid","res","window","open","handleModal","showMessages","handleChange","target","name","getAfterAdjustment","handleClearLine","handleClearAll","Number","toFixed","console","log","Room","new_remark","reverse_no","length","map","index","treatment_code","course","unit_amount","total_depobalance","treatment_parentcode","balance","reverse_price","outstanding","mapStateToProps","selected_cstomer","common","basicApptDetail","appointment","mapDispatchToProps","dispatch","Reversal"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport {\r\n  NormalButton,\r\n  NormalInput,\r\n  NormalTextarea,\r\n  NormalRadio,\r\n  NormalSelect,\r\n} from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport _ from \"lodash\";\r\nimport { history } from \"helpers\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonCreateApi,\r\n  commonDeleteApi,\r\n  commonPatchApi,\r\n} from \"redux/actions/common\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\n// import { Treatment, Payment, EditCart } from './cart/index';\r\nimport service from \"assets/images/make-up-brush.png\";\r\n// import Discount from './cart/discount';\r\nimport { FormGroup, Label, Input } from \"reactstrap\";\r\n\r\nexport class ReversalClass extends Component {\r\n  state = {\r\n    tstaffList: [],\r\n    cartData: {},\r\n    formFields: {\r\n      type: \"\",\r\n      adj_value: \"\",\r\n      reason: \"\",\r\n      remark: \"\",\r\n    },\r\n    headerDetails: {},\r\n    isShowBalance: false,\r\n    transactioRecord: [],\r\n    reasonOption: [],\r\n    afterAdjustment: \"\",\r\n  };\r\n\r\n  componentWillMount = () => {\r\n    // this.getCart();\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n    this.props.getCommonApi(\"reversereason/\").then(key => {\r\n      let { data } = key;\r\n      let { reasonOption } = this.state;\r\n      for (let value of data) {\r\n        reasonOption.push({ value: value.id, label: value.rev_desc });\r\n      }\r\n      this.setState({ reasonOption });\r\n    });\r\n    this.getCart();\r\n  };\r\n\r\n  getCart = () => {\r\n    let { cartData, tstaffList, headerDetails, afterAdjustment } = this.state;\r\n    this.props\r\n      .getCommonApi(`reversal/?treatment_id=${this.props.reversalId}`)\r\n      .then(key => {\r\n        cartData = key;\r\n        tstaffList = key.data;\r\n        headerDetails = key.header_data;\r\n        afterAdjustment = key.header_data.total;\r\n        this.setState({ cartData, tstaffList, headerDetails, afterAdjustment });\r\n      });\r\n  };\r\n\r\n  handleShowBalance = () => {\r\n    let { transactioRecord } = this.state;\r\n\r\n    this.props\r\n      .getCommonApi(`showbalance/?treatment_id=${this.props.reversalId}`)\r\n      .then(key => {\r\n        transactioRecord = key.data;\r\n        this.setState({ transactioRecord });\r\n      });\r\n  };\r\n\r\n  handleSubmit = id => {};\r\n\r\n  handleDialog = () => {};\r\n\r\n  handleAddReversal = item => {\r\n    //debugger;\r\n    let { formFields } = this.state;\r\n    if (this.validator.allValid()) {\r\n      this.props\r\n        .commonCreateApi(\r\n          `reversal/?treatment_id=${this.props.reversalId}&adjustment_value=${\r\n            formFields.type + formFields.adj_value\r\n          }&reason_id=${formFields.reason}&remark=${formFields.remark}`\r\n        )\r\n        .then(res => {\r\n          window.open(res.data);\r\n          this.props.handleModal();\r\n        });\r\n    } else {\r\n      this.validator.showMessages();\r\n    }\r\n  };\r\n\r\n  handleChange = async ({ target: { value, name } }) => {\r\n    let { formFields } = this.state;\r\n    formFields[name] = value;\r\n    await this.setState({\r\n      formFields,\r\n    });\r\n    this.getAfterAdjustment();\r\n  };\r\n\r\n  handleClearLine = () => {};\r\n\r\n  handleClearAll = () => {};\r\n\r\n  getAfterAdjustment = () => {\r\n    let { afterAdjustment, formFields, headerDetails } = this.state;\r\n    if (formFields.type === \"-\") {\r\n      afterAdjustment =\r\n        Number(headerDetails.total) - Number(formFields.adj_value);\r\n    }\r\n    if (formFields.type === \"+\") {\r\n      afterAdjustment =\r\n        Number(headerDetails.total) + Number(formFields.adj_value);\r\n    }\r\n    afterAdjustment = afterAdjustment.toFixed(2);\r\n    console.log(\r\n      \"adsfasdfasdfasdf\",\r\n      afterAdjustment,\r\n      headerDetails.total,\r\n      typeof afterAdjustment\r\n    );\r\n    this.setState({\r\n      afterAdjustment,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      tstaffList = [],\r\n      Room,\r\n      new_remark,\r\n      headerDetails,\r\n      transactioRecord,\r\n      reasonOption,\r\n      reason,\r\n      formFields,\r\n      afterAdjustment,\r\n    } = this.state;\r\n    return (\r\n      <div className=\"row new-cart treatment-done\">\r\n        <div className=\"col-12\">\r\n          <p className=\"fs-18 font-700 mb-3 title\">Treatment Reversal</p>\r\n        </div>\r\n\r\n        <div className=\"col-6 fs-14\">\r\n          <p className=\"fs-14\">Reverse Treatment List</p>\r\n          <p className=\"fs-14\">\r\n            Reverse No: <b>{headerDetails ? headerDetails.reverse_no : \"\"}</b>\r\n          </p>\r\n          <div className=\"row\">\r\n            <div className=\"col-1\">S.No</div>\r\n            <div className=\"col-3\">Treatment #</div>\r\n            <div className=\"col-4\">Content</div>\r\n            <div className=\"col-3 text-center\">Value</div>\r\n          </div>\r\n          {tstaffList.length > 0\r\n            ? tstaffList.map((item, index) => {\r\n                return (\r\n                  <div className=\"row\">\r\n                    <div className=\"col-1\">{index + 1}</div>\r\n                    <div className=\"col-3\">{item.treatment_code}</div>\r\n                    <div className=\"col-4\">{item.course}</div>\r\n                    <div className=\"col-3 text-center\">{item.unit_amount}</div>\r\n                  </div>\r\n                );\r\n              })\r\n            : \"\"}\r\n          <div className=\"row\">\r\n            <div className=\"col-8 text-right\">Total</div>\r\n            <div className=\"col-3 text-center\">\r\n              {headerDetails ? headerDetails.total : \"\"}\r\n            </div>\r\n          </div>\r\n          <div className=\"row mb-2\">\r\n            <div className=\"col-8 text-right\">Total deposit or Balance</div>\r\n            <div className=\"col-3 text-center\">\r\n              {headerDetails ? headerDetails.total_depobalance : \"\"}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"row mb-3\">\r\n            <div className=\"col-8 text-right\">Adjustment Value</div>\r\n            <div className=\"col-3 text-center\">{formFields.adj_value}</div>\r\n          </div>\r\n          <div className=\"row mb-3\">\r\n            <div className=\"col-8 text-right\">\r\n              Total credit Note after adjustment\r\n            </div>\r\n            <div className=\"col-3 text-center\">{Number(afterAdjustment)}</div>\r\n          </div>\r\n          <NormalButton\r\n            buttonClass={\"mx-2 mb-2\"}\r\n            mainbg={true}\r\n            className=\"fs-15\"\r\n            label=\"Show Balance\"\r\n            outline={false}\r\n            onClick={this.handleShowBalance}\r\n          />\r\n        </div>\r\n        <div className=\"col-6 fs-14\">\r\n          <p>Transaction Record</p>\r\n          <div className=\"row\">\r\n            <div className=\"col-3\">Treatment #</div>\r\n            <div className=\"col-3\">Balance/Deposit</div>\r\n            <div className=\"col-3 d-flex align-items-center justify-content-center\">Total Reverse Price</div>\r\n            <div className=\"col-3\">Outstanding</div>\r\n          </div>\r\n\r\n          {transactioRecord.length > 0\r\n            ? transactioRecord.map((item, index) => {\r\n                return (\r\n                  <div className=\"row\">\r\n                    <div className=\"col-3\">{item.treatment_parentcode}</div>\r\n                    <div className=\"col-3\">{item.balance}</div>\r\n                    <div className=\"col-3\">{item.reverse_price}</div>\r\n                    <div className=\"col-3 text-center\">{item.outstanding}</div>\r\n                  </div>\r\n                );\r\n              })\r\n            : \"\"}\r\n        </div>\r\n\r\n        <div className=\"col-6 fs-14 adjustment\">\r\n          <p>Adjustment Proceedure</p>\r\n          <div className=\"row mb-1\">\r\n            <div className=\"col-2\">Adjustmet</div>\r\n            <div className=\"col-3 pr-0 \">\r\n              <div>\r\n                <NormalSelect\r\n                  // placeholder=\"Enter here\"\r\n                  options={[\r\n                    { value: \"-\", label: \"-\" },\r\n                    { value: \"+\", label: \"+\" },\r\n                  ]}\r\n                  value={formFields.type}\r\n                  name=\"type\"\r\n                  onChange={this.handleChange}\r\n                  className=\"customer-name py-0\"\r\n                  disabled={Room}\r\n                />\r\n              </div>\r\n              {/* {this.validator.message('Adjustment type', formFields.type, 'required')} */}\r\n            </div>\r\n            <div className=\"col-6\">\r\n              <div>\r\n                <NormalInput\r\n                  value={formFields.adj_value}\r\n                  name=\"adj_value\"\r\n                  onChange={this.handleChange}\r\n                  className=\"customer-name\"\r\n                />\r\n              </div>\r\n              {/* {this.validator.message('Adjustment value', formFields.adj_value, 'required')} */}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"row mb-1\">\r\n            <div className=\"col-2\">Reason</div>\r\n\r\n            <div className=\"col-6 \">\r\n              <NormalSelect\r\n                options={reasonOption}\r\n                value={formFields.reason}\r\n                name=\"reason\"\r\n                onChange={this.handleChange}\r\n                className=\"customer-name py-0\"\r\n              />\r\n              {/* {this.validator.message('reason', formFields.reason, 'required')} */}\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-2\">Remark</div>\r\n\r\n            <div className=\"col-6\">\r\n              <NormalTextarea\r\n                placeholder=\"\"\r\n                value={formFields.remark}\r\n                name=\"remark\"\r\n                onChange={this.handleChange}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"col-12 fs-14 pt-4 action-bar\">\r\n          <div className=\"row\">\r\n            <div className=\"col-6 d-flex\">\r\n              {/* <NormalButton\r\n                                buttonClass={\"mx-2\"}\r\n                                mainbg={true}\r\n                                className=\"fs-15 clear-line\"\r\n                                label=\"Update\"\r\n                                outline={false}\r\n                                onClick={this.handleClearLine}\r\n                            />\r\n                            <NormalButton\r\n                                buttonClass={\"mx-2\"}\r\n                                mainbg={true}\r\n                                className=\"fs-15 clear-all\"\r\n                                label=\"Undo\"\r\n                                outline={false}\r\n                                onClick={this.handleClearAll}\r\n                            /> */}\r\n            </div>\r\n            <div className=\"col-4 text-right\"></div>\r\n            <div className=\"col-2 text-right\">\r\n              <NormalButton\r\n                buttonClass={\"mx-2\"}\r\n                mainbg={true}\r\n                className=\" fs-15 confirm\"\r\n                label=\"Confirm\"\r\n                outline={false}\r\n                onClick={this.handleAddReversal}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      // getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonCreateApi,\r\n      commonPatchApi,\r\n      commonDeleteApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Reversal = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ReversalClass);\r\n"]},"metadata":{},"sourceType":"module"}