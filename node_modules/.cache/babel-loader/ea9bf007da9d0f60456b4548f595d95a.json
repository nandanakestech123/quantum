{"ast":null,"code":"import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{InputSearch,TableWrapper}from\"component/common\";import{updateForm,getCommonApi}from\"redux/actions/common\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{NormalModal}from\"component/common\";import closeIcon from\"assets/images/close.png\";import _ from\"lodash\";import{Toast}from\"service/toast\";import{withTranslation}from\"react-i18next\";export var ListTreatmentPackageClass=/*#__PURE__*/function(_React$Component){_inherits(ListTreatmentPackageClass,_React$Component);var _super=_createSuper(ListTreatmentPackageClass);function ListTreatmentPackageClass(){var _this;_classCallCheck(this,ListTreatmentPackageClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Course\"},{label:\"Tr. #\"},{label:\"Total\"},{label:\"Price\"},{label:\"Expiry Date\"},{label:\"Balance\"},{label:\"Outstanding\"}],treatmentPackageList:[],meta:{},active:false,currentIndex:-1,isTreatementModal:false,formFields:{},cust_data:{}};_this.componentDidMount=function(){_this.getPackageList({});};_this.handleClick=function(key){if(!_this.state.active){document.addEventListener(\"click\",_this.handleOutsideClick,false);}else{document.removeEventListener(\"click\",_this.handleOutsideClick,false);}_this.setState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.handleOutsideClick=function(e){if(_this.node!=null){if(_this.node.contains(e.target)){return;}}_this.handleClick();};_this.getPackageList=function(data){var _data$page=data.page,page=_data$page===void 0?1:_data$page,_data$limit=data.limit,limit=_data$limit===void 0?10:_data$limit,_data$search=data.search,search=_data$search===void 0?\"\":_data$search;_this.props.getCommonApi(\"treatmentpackages/?cust_id=\".concat(_this.props.customerNumber,\"&page=\").concat(page,\"&limit=\").concat(limit)).then(function(res){console.log(res,\"treatmentpackagelistresponse\");var status=res.status,data=res.data,cust_name=res.cust_name,cust_refer=res.cust_refer;if(status===200){if(data){var cust={};cust[\"cust_name\"]=cust_name;cust[\"cust_refer\"]=cust_refer;_this.setState({treatmentPackageList:res.data.dataList,meta:res.data.meta.pagination,cust_data:cust});}}});};_this.handlePagination=function(page){console.log(page,\"dsfsdfsdfsdf\");_this.getPackageList(page);};_this.handleDialog=function(){var isTreatementModal=_this.state.isTreatementModal;isTreatementModal=!isTreatementModal;_this.setState({isTreatementModal:isTreatementModal});};_this.handleSelectTreatmentPackage=function(item){if(String(item.type).toUpperCase()==\"TD\"){var formFields=_this.state.formFields;formFields[\"id\"]=item.stock_id;formFields[\"item_desc\"]=item.item_name;formFields[\"add_duration\"]=item.add_duration;formFields[\"Item_CodeName\"]=item.item_name;formFields[\"treatment_parentcode\"]=item.treatment_parentcode;_this.setState({formFields:formFields});console.log(formFields);_this.props.handleSelectPackage(formFields);_this.props.handleTreatementmodal();}else{Toast({type:\"error\",message:\"This Package is not allowed\"});}};return _this;}_createClass(ListTreatmentPackageClass,[{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,headerDetails=_this$state.headerDetails,treatmentPackageList=_this$state.treatmentPackageList,meta=_this$state.meta,currentIndex=_this$state.currentIndex,active=_this$state.active,isTreatementModal=_this$state.isTreatementModal,formFields=_this$state.formFields,cust_data=_this$state.cust_data;var t=this.props.t;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NormalModal,{className:\"multiple-appointment select-category\",style:{minWidth:\"70%\"},modal:this.props.isTreatementModal,handleModal:this.props.handleTreatementmodal},/*#__PURE__*/React.createElement(\"img\",{onClick:this.props.handleTreatementmodal,className:\"close\",src:closeIcon,alt:\"\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"customer-list container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tab-table-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 p-2\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"fw-500\"},t(\"Treatment\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-noWrap mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Name\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},cust_data.cust_name))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Reference\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},cust_data.cust_refer))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Phone\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},this.props.custPhone))),this.props.CustomerRemarkFlag?/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},t(\"Permanent Remark\"),\" :\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fw-500 h6\"},this.props.CustomerRemark))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:meta},treatmentPackageList&&treatmentPackageList.length>0?treatmentPackageList.map(function(item,index){var item_name=item.item_name,tr_open=item.tr_open,tr_done=item.tr_done,stock_id=item.stock_id,price=item.price,expiry=item.expiry,add_duration=item.add_duration,treatment_parentcode=item.treatment_parentcode,balance=item.balance,outstanding=item.outstanding;return/*#__PURE__*/React.createElement(\"tr\",{onClick:function onClick(){return _this2.handleSelectTreatmentPackage(item,index);},key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},item_name)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},tr_open)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},tr_done)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},price)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},expiry)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},balance)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},outstanding)));}):/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},t(\"No data available\")))))))))));}}]);return ListTreatmentPackageClass;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{// filter: state.dashboard\n};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({updateForm:updateForm,getCommonApi:getCommonApi},dispatch);};export var TreatmentPackage=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(ListTreatmentPackageClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/NewAppointment/NewCreateAppointment/modal/TreatmentPackage.js"],"names":["React","InputSearch","TableWrapper","updateForm","getCommonApi","connect","bindActionCreators","NormalModal","closeIcon","_","Toast","withTranslation","ListTreatmentPackageClass","state","headerDetails","label","treatmentPackageList","meta","active","currentIndex","isTreatementModal","formFields","cust_data","componentDidMount","getPackageList","handleClick","key","document","addEventListener","handleOutsideClick","removeEventListener","setState","prevState","e","node","contains","target","data","page","limit","search","props","customerNumber","then","res","console","log","status","cust_name","cust_refer","cust","dataList","pagination","handlePagination","handleDialog","handleSelectTreatmentPackage","item","String","type","toUpperCase","stock_id","item_name","add_duration","treatment_parentcode","handleSelectPackage","handleTreatementmodal","message","t","minWidth","custPhone","CustomerRemarkFlag","CustomerRemark","length","map","index","tr_open","tr_done","price","expiry","balance","outstanding","Component","mapStateToProps","mapDispatchToProps","dispatch","TreatmentPackage"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { InputSearch, TableWrapper } from \"component/common\";\r\nimport { updateForm, getCommonApi } from \"redux/actions/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { NormalModal } from \"component/common\";\r\nimport closeIcon from \"assets/images/close.png\";\r\nimport _ from \"lodash\";\r\nimport { Toast } from \"service/toast\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class ListTreatmentPackageClass extends React.Component {\r\n  state = {\r\n    headerDetails: [\r\n      { label: \"Course\" },\r\n      { label: \"Tr. #\" },\r\n      { label: \"Total\" },\r\n      { label: \"Price\" },\r\n      { label: \"Expiry Date\" },\r\n      { label: \"Balance\" },\r\n      { label: \"Outstanding\" },\r\n    ],\r\n    treatmentPackageList: [],\r\n    meta: {},\r\n    active: false,\r\n    currentIndex: -1,\r\n    isTreatementModal: false,\r\n    formFields: {},\r\n    cust_data: {},\r\n  };\r\n\r\n  componentDidMount = () => {\r\n    this.getPackageList({});\r\n  };\r\n\r\n  handleClick = key => {\r\n    if (!this.state.active) {\r\n      document.addEventListener(\"click\", this.handleOutsideClick, false);\r\n    } else {\r\n      document.removeEventListener(\"click\", this.handleOutsideClick, false);\r\n    }\r\n\r\n    this.setState(prevState => ({\r\n      active: !prevState.active,\r\n      currentIndex: key,\r\n    }));\r\n  };\r\n\r\n  handleOutsideClick = e => {\r\n    if (this.node != null) {\r\n      if (this.node.contains(e.target)) {\r\n        return;\r\n      }\r\n    }\r\n    this.handleClick();\r\n  };\r\n\r\n  getPackageList = data => {\r\n    let { page = 1, limit = 10, search = \"\" } = data;\r\n    this.props\r\n      .getCommonApi(\r\n        `treatmentpackages/?cust_id=${this.props.customerNumber}&page=${page}&limit=${limit}`\r\n      )\r\n      .then(res => {\r\n        console.log(res, \"treatmentpackagelistresponse\");\r\n        let { status, data, cust_name, cust_refer } = res;\r\n        if (status === 200) {\r\n          if (data) {\r\n            let cust = {};\r\n            cust[\"cust_name\"] = cust_name;\r\n            cust[\"cust_refer\"] = cust_refer;\r\n            this.setState({\r\n              treatmentPackageList: res.data.dataList,\r\n              meta: res.data.meta.pagination,\r\n              cust_data: cust,\r\n            });\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  handlePagination = page => {\r\n    console.log(page, \"dsfsdfsdfsdf\");\r\n    this.getPackageList(page);\r\n  };\r\n\r\n  // handlesearch = (event) => {\r\n  //     console.log(\"sadfasdfasdf\", event.target.value)\r\n  //     event.persist();\r\n\r\n  //     if (!this.debouncedFn) {\r\n  //         this.debouncedFn = _.debounce(() => {\r\n  //             let searchString = event.target.value;\r\n  //             let data = { search: searchString }\r\n  //             this.getPackageList(data)\r\n  //         }, 500);\r\n  //     }\r\n  //     this.debouncedFn();\r\n  // }\r\n\r\n  handleDialog = () => {\r\n    let { isTreatementModal } = this.state;\r\n    isTreatementModal = !isTreatementModal;\r\n    this.setState({\r\n      isTreatementModal,\r\n    });\r\n  };\r\n\r\n  handleSelectTreatmentPackage = item => {\r\n    if (String(item.type).toUpperCase() == \"TD\") {\r\n      let { formFields } = this.state;\r\n      formFields[\"id\"] = item.stock_id;\r\n      formFields[\"item_desc\"] = item.item_name;\r\n      formFields[\"add_duration\"] = item.add_duration;\r\n      formFields[\"Item_CodeName\"] = item.item_name;\r\n      formFields[\"treatment_parentcode\"] = item.treatment_parentcode;\r\n\r\n      this.setState({\r\n        formFields,\r\n      });\r\n      console.log(formFields);\r\n      this.props.handleSelectPackage(formFields);\r\n      this.props.handleTreatementmodal();\r\n    } else {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"This Package is not allowed\",\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      headerDetails,\r\n      treatmentPackageList,\r\n      meta,\r\n      currentIndex,\r\n      active,\r\n      isTreatementModal,\r\n      formFields,\r\n      cust_data,\r\n    } = this.state;\r\n    let { t } = this.props;\r\n    return (\r\n      <>\r\n        <NormalModal\r\n          className={\"multiple-appointment select-category\"}\r\n          style={{ minWidth: \"70%\" }}\r\n          modal={this.props.isTreatementModal}\r\n          handleModal={this.props.handleTreatementmodal}\r\n        >\r\n          <img\r\n            onClick={this.props.handleTreatementmodal}\r\n            className=\"close\"\r\n            src={closeIcon}\r\n            alt=\"\"\r\n          />\r\n          <div className=\"customer-list container\">\r\n            <div className=\"tab-table-content\">\r\n              <div className=\"py-4\">\r\n                <div className=\"col-12 p-2\">\r\n                  <h5 className=\"fw-500\">{t(\"Treatment\")}</h5>\r\n                </div>\r\n                <div className=\"d-flex flex-noWrap mb-2\">\r\n                  <div className=\"col-3\">\r\n                    <div className=\"col-12\">\r\n                      {t(\"Name\")} :{\" \"}\r\n                      <span className=\"fw-500 h6\">{cust_data.cust_name}</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-3\">\r\n                    <div className=\"col-12\">\r\n                      {t(\"Reference\")} :{\" \"}\r\n                      <span className=\"fw-500 h6\">{cust_data.cust_refer}</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-3\">\r\n                    <div className=\"col-12\">\r\n                      {t(\"Phone\")} :{\" \"}\r\n                      <span className=\"fw-500 h6\">{this.props.custPhone}</span>\r\n                    </div>\r\n                  </div>\r\n                  {this.props.CustomerRemarkFlag ? (\r\n                    <div className=\"col-3\">\r\n                      <div className=\"col-12\">\r\n                        {t(\"Permanent Remark\")} :{\" \"}\r\n                        <span className=\"fw-500 h6\">\r\n                          {this.props.CustomerRemark}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  ) : null}\r\n                </div>\r\n                <div className=\"table-container\">\r\n                  <TableWrapper\r\n                    headerDetails={headerDetails}\r\n                    queryHandler={this.handlePagination}\r\n                    pageMeta={meta}\r\n                  >\r\n                    {treatmentPackageList && treatmentPackageList.length > 0 ? (\r\n                      treatmentPackageList.map((item, index) => {\r\n                        let {\r\n                          item_name,\r\n                          tr_open,\r\n                          tr_done,\r\n                          stock_id,\r\n                          price,\r\n                          expiry,\r\n                          add_duration,\r\n                          treatment_parentcode,\r\n                          balance,\r\n                          outstanding,\r\n                        } = item;\r\n                        return (\r\n                          <tr\r\n                            onClick={() =>\r\n                              this.handleSelectTreatmentPackage(item, index)\r\n                            }\r\n                            key={index}\r\n                          >\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {item_name}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {tr_open}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {tr_done}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {price}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {expiry}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {balance}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {outstanding}\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })\r\n                    ) : (\r\n                      <tr>\r\n                        <td>\r\n                          <div className=\"d-flex align-items-center justify-content-center\">\r\n                            {t(\"No data available\")}\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                  </TableWrapper>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </NormalModal>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  // filter: state.dashboard\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      updateForm,\r\n      getCommonApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const TreatmentPackage = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(ListTreatmentPackageClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}