{"ast":null,"code":"/**\r\n * DevExtreme (ui/diagram/diagram.items_option.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _component = _interopRequireDefault(require(\"../../core/component\"));\n\nvar _data_helper = _interopRequireDefault(require(\"../../data_helper\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var result,\n        Super = _getPrototypeOf(Derived);\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (\"undefined\" === typeof Reflect || !Reflect.construct) {\n    return false;\n  }\n\n  if (Reflect.construct.sham) {\n    return false;\n  }\n\n  if (\"function\" === typeof Proxy) {\n    return true;\n  }\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar ItemsOption = function (_Component) {\n  _inherits(ItemsOption, _Component);\n\n  var _super = _createSuper(ItemsOption);\n\n  function ItemsOption(diagramWidget) {\n    var _this;\n\n    _classCallCheck(this, ItemsOption);\n\n    _this = _super.call(this);\n    _this._diagramWidget = diagramWidget;\n\n    _this._resetCache();\n\n    return _this;\n  }\n\n  _createClass(ItemsOption, [{\n    key: \"_dataSourceChangedHandler\",\n    value: function (newItems, e) {\n      this._resetCache();\n\n      this._items = newItems.map(function (item) {\n        return (0, _extend.extend)(true, {}, item);\n      });\n      this._dataSourceItems = newItems.slice();\n\n      if (e && e.changes) {\n        var changes = e.changes.filter(function (change) {\n          return !change.internalChange;\n        });\n\n        if (changes.length) {\n          this._reloadContentByChanges(changes, true);\n        }\n      } else {\n        this._diagramWidget._onDataSourceChanged();\n      }\n    }\n  }, {\n    key: \"_dataSourceLoadingChangedHandler\",\n    value: function (isLoading) {\n      if (isLoading && !this._dataSource.isLoaded()) {\n        this._diagramWidget._showLoadingIndicator();\n      } else {\n        this._diagramWidget._hideLoadingIndicator();\n      }\n    }\n  }, {\n    key: \"_prepareData\",\n    value: function (dataObj) {\n      for (var key in dataObj) {\n        if (!Object.prototype.hasOwnProperty.call(dataObj, key)) {\n          continue;\n        }\n\n        if (void 0 === dataObj[key]) {\n          dataObj[key] = null;\n        }\n      }\n\n      return dataObj;\n    }\n  }, {\n    key: \"insert\",\n    value: function (data, callback, errorCallback) {\n      var _this2 = this;\n\n      this._resetCache();\n\n      var store = this._getStore();\n\n      store.insert(this._prepareData(data)).done(function (data, key) {\n        var changes = [{\n          type: \"insert\",\n          key: key,\n          data: data,\n          internalChange: true\n        }];\n        store.push(changes);\n\n        _this2._reloadContentByChanges(changes, false);\n\n        if (callback) {\n          callback(data);\n        }\n\n        _this2._resetCache();\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n\n        _this2._resetCache();\n      });\n    }\n  }, {\n    key: \"update\",\n    value: function (key, data, callback, errorCallback) {\n      var _this3 = this;\n\n      var store = this._getStore();\n\n      var storeKey = this._getStoreKey(store, key, data);\n\n      store.update(storeKey, this._prepareData(data)).done(function (data, key) {\n        var changes = [{\n          type: \"update\",\n          key: key,\n          data: data,\n          internalChange: true\n        }];\n        store.push(changes);\n\n        _this3._reloadContentByChanges(changes, false);\n\n        if (callback) {\n          callback(key, data);\n        }\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n      });\n    }\n  }, {\n    key: \"remove\",\n    value: function (key, data, callback, errorCallback) {\n      var _this4 = this;\n\n      this._resetCache();\n\n      var store = this._getStore();\n\n      var storeKey = this._getStoreKey(store, key, data);\n\n      store.remove(storeKey).done(function (key) {\n        var changes = [{\n          type: \"remove\",\n          key: key,\n          internalChange: true\n        }];\n        store.push(changes);\n\n        _this4._reloadContentByChanges(changes, false);\n\n        if (callback) {\n          callback(key);\n        }\n\n        _this4._resetCache();\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n\n        _this4._resetCache();\n      });\n    }\n  }, {\n    key: \"findItem\",\n    value: function (itemKey) {\n      if (!this._items) {\n        return null;\n      }\n\n      return this._getItemByKey(itemKey);\n    }\n  }, {\n    key: \"getItems\",\n    value: function () {\n      return this._items;\n    }\n  }, {\n    key: \"hasItems\",\n    value: function () {\n      return !!this._items;\n    }\n  }, {\n    key: \"_reloadContentByChanges\",\n    value: function (changes, isExternalChanges) {\n      var _this5 = this;\n\n      changes = changes.map(function (change) {\n        return (0, _extend.extend)(change, {\n          internalKey: _this5._getInternalKey(change.key)\n        });\n      });\n\n      this._diagramWidget._reloadContentByChanges(changes, isExternalChanges);\n    }\n  }, {\n    key: \"_getItemByKey\",\n    value: function (key) {\n      this._ensureCache();\n\n      var cache = this._cache;\n\n      var index = this._getIndexByKey(key);\n\n      return cache.items[index];\n    }\n  }, {\n    key: \"_getIndexByKey\",\n    value: function (key) {\n      this._ensureCache();\n\n      var cache = this._cache;\n\n      if (\"object\" === _typeof(key)) {\n        for (var i = 0, length = cache.keys.length; i < length; i++) {\n          if (cache.keys[i] === key) {\n            return i;\n          }\n        }\n      } else {\n        var keySet = cache.keySet || cache.keys.reduce(function (accumulator, key, index) {\n          accumulator[key] = index;\n          return accumulator;\n        }, {});\n\n        if (!cache.keySet) {\n          cache.keySet = keySet;\n        }\n\n        return keySet[key];\n      }\n\n      return -1;\n    }\n  }, {\n    key: \"_ensureCache\",\n    value: function () {\n      var cache = this._cache;\n\n      if (!cache.keys) {\n        cache.keys = [];\n        cache.items = [];\n\n        this._fillCache(cache, this._items);\n      }\n    }\n  }, {\n    key: \"_fillCache\",\n    value: function (cache, items) {\n      var _this6 = this;\n\n      if (!items || !items.length) {\n        return;\n      }\n\n      var keyExpr = this._getKeyExpr();\n\n      if (keyExpr) {\n        items.forEach(function (item) {\n          cache.keys.push(keyExpr(item));\n          cache.items.push(item);\n        });\n      }\n\n      var itemsExpr = this._getItemsExpr();\n\n      if (itemsExpr) {\n        items.forEach(function (item) {\n          return _this6._fillCache(cache, itemsExpr(item));\n        });\n      }\n\n      var containerChildrenExpr = this._getContainerChildrenExpr();\n\n      if (containerChildrenExpr) {\n        items.forEach(function (item) {\n          return _this6._fillCache(cache, containerChildrenExpr(item));\n        });\n      }\n    }\n  }, {\n    key: \"_getKeyExpr\",\n    value: function () {\n      throw \"Not Implemented\";\n    }\n  }, {\n    key: \"_getItemsExpr\",\n    value: function () {}\n  }, {\n    key: \"_getContainerChildrenExpr\",\n    value: function () {}\n  }, {\n    key: \"_dataSourceOptions\",\n    value: function () {\n      return {\n        paginate: false\n      };\n    }\n  }, {\n    key: \"_getStore\",\n    value: function () {\n      return this._dataSource && this._dataSource.store();\n    }\n  }, {\n    key: \"_getStoreKey\",\n    value: function (store, internalKey, data) {\n      var storeKey = store.keyOf(data);\n\n      if (storeKey === data) {\n        var keyExpr = this._getKeyExpr();\n\n        this._dataSourceItems.forEach(function (item) {\n          if (keyExpr(item) === internalKey) {\n            storeKey = item;\n          }\n        });\n      }\n\n      return storeKey;\n    }\n  }, {\n    key: \"_getInternalKey\",\n    value: function (storeKey) {\n      if (\"object\" === _typeof(storeKey)) {\n        var keyExpr = this._getKeyExpr();\n\n        return keyExpr(storeKey);\n      }\n\n      return storeKey;\n    }\n  }, {\n    key: \"_resetCache\",\n    value: function () {\n      this._cache = {};\n    }\n  }]);\n\n  return ItemsOption;\n}(_component.default);\n\nItemsOption.include(_data_helper.default);\nvar _default = ItemsOption;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/diagram/diagram.items_option.js"],"names":["exports","default","_extend","require","_component","_interopRequireDefault","_data_helper","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","ItemsOption","_Component","_super","diagramWidget","_this","_diagramWidget","_resetCache","newItems","_items","map","item","extend","_dataSourceItems","slice","changes","filter","change","internalChange","_reloadContentByChanges","_onDataSourceChanged","isLoading","_dataSource","isLoaded","_showLoadingIndicator","_hideLoadingIndicator","dataObj","hasOwnProperty","data","callback","errorCallback","_this2","store","_getStore","insert","_prepareData","done","type","push","fail","error","_this3","storeKey","_getStoreKey","update","_this4","remove","itemKey","_getItemByKey","isExternalChanges","_this5","internalKey","_getInternalKey","_ensureCache","cache","_cache","index","_getIndexByKey","items","keys","keySet","reduce","accumulator","_fillCache","_this6","keyExpr","_getKeyExpr","forEach","itemsExpr","_getItemsExpr","containerChildrenExpr","_getContainerChildrenExpr","paginate","keyOf","include","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/diagram/diagram.items_option.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _component = _interopRequireDefault(require(\"../../core/component\"));\r\nvar _data_helper = _interopRequireDefault(require(\"../../data_helper\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n    if (\"function\" !== typeof superClass && null !== superClass) {\r\n        throw new TypeError(\"Super expression must either be null or a function\")\r\n    }\r\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n        constructor: {\r\n            value: subClass,\r\n            writable: true,\r\n            configurable: true\r\n        }\r\n    });\r\n    if (superClass) {\r\n        _setPrototypeOf(subClass, superClass)\r\n    }\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n    return function() {\r\n        var result, Super = _getPrototypeOf(Derived);\r\n        if (hasNativeReflectConstruct) {\r\n            var NewTarget = _getPrototypeOf(this).constructor;\r\n            result = Reflect.construct(Super, arguments, NewTarget)\r\n        } else {\r\n            result = Super.apply(this, arguments)\r\n        }\r\n        return _possibleConstructorReturn(this, result)\r\n    }\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n    if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\r\n        return call\r\n    }\r\n    return _assertThisInitialized(self)\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n    if (void 0 === self) {\r\n        throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\")\r\n    }\r\n    return self\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n    if (\"undefined\" === typeof Reflect || !Reflect.construct) {\r\n        return false\r\n    }\r\n    if (Reflect.construct.sham) {\r\n        return false\r\n    }\r\n    if (\"function\" === typeof Proxy) {\r\n        return true\r\n    }\r\n    try {\r\n        Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\r\n        return true\r\n    } catch (e) {\r\n        return false\r\n    }\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o)\r\n    };\r\n    return _getPrototypeOf(o)\r\n}\r\nvar ItemsOption = function(_Component) {\r\n    _inherits(ItemsOption, _Component);\r\n    var _super = _createSuper(ItemsOption);\r\n\r\n    function ItemsOption(diagramWidget) {\r\n        var _this;\r\n        _classCallCheck(this, ItemsOption);\r\n        _this = _super.call(this);\r\n        _this._diagramWidget = diagramWidget;\r\n        _this._resetCache();\r\n        return _this\r\n    }\r\n    _createClass(ItemsOption, [{\r\n        key: \"_dataSourceChangedHandler\",\r\n        value: function(newItems, e) {\r\n            this._resetCache();\r\n            this._items = newItems.map(function(item) {\r\n                return (0, _extend.extend)(true, {}, item)\r\n            });\r\n            this._dataSourceItems = newItems.slice();\r\n            if (e && e.changes) {\r\n                var changes = e.changes.filter(function(change) {\r\n                    return !change.internalChange\r\n                });\r\n                if (changes.length) {\r\n                    this._reloadContentByChanges(changes, true)\r\n                }\r\n            } else {\r\n                this._diagramWidget._onDataSourceChanged()\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_dataSourceLoadingChangedHandler\",\r\n        value: function(isLoading) {\r\n            if (isLoading && !this._dataSource.isLoaded()) {\r\n                this._diagramWidget._showLoadingIndicator()\r\n            } else {\r\n                this._diagramWidget._hideLoadingIndicator()\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_prepareData\",\r\n        value: function(dataObj) {\r\n            for (var key in dataObj) {\r\n                if (!Object.prototype.hasOwnProperty.call(dataObj, key)) {\r\n                    continue\r\n                }\r\n                if (void 0 === dataObj[key]) {\r\n                    dataObj[key] = null\r\n                }\r\n            }\r\n            return dataObj\r\n        }\r\n    }, {\r\n        key: \"insert\",\r\n        value: function(data, callback, errorCallback) {\r\n            var _this2 = this;\r\n            this._resetCache();\r\n            var store = this._getStore();\r\n            store.insert(this._prepareData(data)).done(function(data, key) {\r\n                var changes = [{\r\n                    type: \"insert\",\r\n                    key: key,\r\n                    data: data,\r\n                    internalChange: true\r\n                }];\r\n                store.push(changes);\r\n                _this2._reloadContentByChanges(changes, false);\r\n                if (callback) {\r\n                    callback(data)\r\n                }\r\n                _this2._resetCache()\r\n            }).fail(function(error) {\r\n                if (errorCallback) {\r\n                    errorCallback(error)\r\n                }\r\n                _this2._resetCache()\r\n            })\r\n        }\r\n    }, {\r\n        key: \"update\",\r\n        value: function(key, data, callback, errorCallback) {\r\n            var _this3 = this;\r\n            var store = this._getStore();\r\n            var storeKey = this._getStoreKey(store, key, data);\r\n            store.update(storeKey, this._prepareData(data)).done(function(data, key) {\r\n                var changes = [{\r\n                    type: \"update\",\r\n                    key: key,\r\n                    data: data,\r\n                    internalChange: true\r\n                }];\r\n                store.push(changes);\r\n                _this3._reloadContentByChanges(changes, false);\r\n                if (callback) {\r\n                    callback(key, data)\r\n                }\r\n            }).fail(function(error) {\r\n                if (errorCallback) {\r\n                    errorCallback(error)\r\n                }\r\n            })\r\n        }\r\n    }, {\r\n        key: \"remove\",\r\n        value: function(key, data, callback, errorCallback) {\r\n            var _this4 = this;\r\n            this._resetCache();\r\n            var store = this._getStore();\r\n            var storeKey = this._getStoreKey(store, key, data);\r\n            store.remove(storeKey).done(function(key) {\r\n                var changes = [{\r\n                    type: \"remove\",\r\n                    key: key,\r\n                    internalChange: true\r\n                }];\r\n                store.push(changes);\r\n                _this4._reloadContentByChanges(changes, false);\r\n                if (callback) {\r\n                    callback(key)\r\n                }\r\n                _this4._resetCache()\r\n            }).fail(function(error) {\r\n                if (errorCallback) {\r\n                    errorCallback(error)\r\n                }\r\n                _this4._resetCache()\r\n            })\r\n        }\r\n    }, {\r\n        key: \"findItem\",\r\n        value: function(itemKey) {\r\n            if (!this._items) {\r\n                return null\r\n            }\r\n            return this._getItemByKey(itemKey)\r\n        }\r\n    }, {\r\n        key: \"getItems\",\r\n        value: function() {\r\n            return this._items\r\n        }\r\n    }, {\r\n        key: \"hasItems\",\r\n        value: function() {\r\n            return !!this._items\r\n        }\r\n    }, {\r\n        key: \"_reloadContentByChanges\",\r\n        value: function(changes, isExternalChanges) {\r\n            var _this5 = this;\r\n            changes = changes.map(function(change) {\r\n                return (0, _extend.extend)(change, {\r\n                    internalKey: _this5._getInternalKey(change.key)\r\n                })\r\n            });\r\n            this._diagramWidget._reloadContentByChanges(changes, isExternalChanges)\r\n        }\r\n    }, {\r\n        key: \"_getItemByKey\",\r\n        value: function(key) {\r\n            this._ensureCache();\r\n            var cache = this._cache;\r\n            var index = this._getIndexByKey(key);\r\n            return cache.items[index]\r\n        }\r\n    }, {\r\n        key: \"_getIndexByKey\",\r\n        value: function(key) {\r\n            this._ensureCache();\r\n            var cache = this._cache;\r\n            if (\"object\" === _typeof(key)) {\r\n                for (var i = 0, length = cache.keys.length; i < length; i++) {\r\n                    if (cache.keys[i] === key) {\r\n                        return i\r\n                    }\r\n                }\r\n            } else {\r\n                var keySet = cache.keySet || cache.keys.reduce(function(accumulator, key, index) {\r\n                    accumulator[key] = index;\r\n                    return accumulator\r\n                }, {});\r\n                if (!cache.keySet) {\r\n                    cache.keySet = keySet\r\n                }\r\n                return keySet[key]\r\n            }\r\n            return -1\r\n        }\r\n    }, {\r\n        key: \"_ensureCache\",\r\n        value: function() {\r\n            var cache = this._cache;\r\n            if (!cache.keys) {\r\n                cache.keys = [];\r\n                cache.items = [];\r\n                this._fillCache(cache, this._items)\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_fillCache\",\r\n        value: function(cache, items) {\r\n            var _this6 = this;\r\n            if (!items || !items.length) {\r\n                return\r\n            }\r\n            var keyExpr = this._getKeyExpr();\r\n            if (keyExpr) {\r\n                items.forEach(function(item) {\r\n                    cache.keys.push(keyExpr(item));\r\n                    cache.items.push(item)\r\n                })\r\n            }\r\n            var itemsExpr = this._getItemsExpr();\r\n            if (itemsExpr) {\r\n                items.forEach(function(item) {\r\n                    return _this6._fillCache(cache, itemsExpr(item))\r\n                })\r\n            }\r\n            var containerChildrenExpr = this._getContainerChildrenExpr();\r\n            if (containerChildrenExpr) {\r\n                items.forEach(function(item) {\r\n                    return _this6._fillCache(cache, containerChildrenExpr(item))\r\n                })\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getKeyExpr\",\r\n        value: function() {\r\n            throw \"Not Implemented\"\r\n        }\r\n    }, {\r\n        key: \"_getItemsExpr\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_getContainerChildrenExpr\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_dataSourceOptions\",\r\n        value: function() {\r\n            return {\r\n                paginate: false\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getStore\",\r\n        value: function() {\r\n            return this._dataSource && this._dataSource.store()\r\n        }\r\n    }, {\r\n        key: \"_getStoreKey\",\r\n        value: function(store, internalKey, data) {\r\n            var storeKey = store.keyOf(data);\r\n            if (storeKey === data) {\r\n                var keyExpr = this._getKeyExpr();\r\n                this._dataSourceItems.forEach(function(item) {\r\n                    if (keyExpr(item) === internalKey) {\r\n                        storeKey = item\r\n                    }\r\n                })\r\n            }\r\n            return storeKey\r\n        }\r\n    }, {\r\n        key: \"_getInternalKey\",\r\n        value: function(storeKey) {\r\n            if (\"object\" === _typeof(storeKey)) {\r\n                var keyExpr = this._getKeyExpr();\r\n                return keyExpr(storeKey)\r\n            }\r\n            return storeKey\r\n        }\r\n    }, {\r\n        key: \"_resetCache\",\r\n        value: function() {\r\n            this._cache = {}\r\n        }\r\n    }]);\r\n    return ItemsOption\r\n}(_component.default);\r\nItemsOption.include(_data_helper.default);\r\nvar _default = ItemsOption;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}