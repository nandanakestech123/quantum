{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/virtual_selection_state.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _date = _interopRequireDefault(require(\"../../../core/utils/date\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    return _arrayLikeToArray(arr);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar VirtualSelectionState = function () {\n  function VirtualSelectionState(viewDataProvider) {\n    _classCallCheck(this, VirtualSelectionState);\n\n    this._viewDataProvider = viewDataProvider;\n    this._focusedCell = null;\n    this._selectedCells = null;\n    this._firstSelectedCell = null;\n  }\n\n  _createClass(VirtualSelectionState, [{\n    key: \"setFocusedCell\",\n    value: function (rowIndex, columnIndex, isAllDay) {\n      if (rowIndex >= 0) {\n        var cell = this._viewDataProvider.getCellData(rowIndex, columnIndex, isAllDay);\n\n        this._focusedCell = cell;\n      }\n    }\n  }, {\n    key: \"getFocusedCell\",\n    value: function (isVerticalGroupOrientation) {\n      var _focusedCell = this._focusedCell;\n\n      if (!_focusedCell) {\n        return;\n      }\n\n      var columnIndex = this._getColumnIndexByCellData(_focusedCell, isVerticalGroupOrientation);\n\n      var rowIndex = this._getRowIndexByColumnAndData(_focusedCell, columnIndex, isVerticalGroupOrientation);\n\n      return {\n        coordinates: {\n          cellIndex: columnIndex,\n          rowIndex: rowIndex\n        },\n        cellData: _focusedCell\n      };\n    }\n  }, {\n    key: \"setSelectedCells\",\n    value: function (lastCellCoordinates) {\n      var _this = this;\n\n      var firstCellCoordinates = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0;\n      var viewDataProvider = this._viewDataProvider;\n      var lastRowIndex = lastCellCoordinates.rowIndex,\n          lastColumnIndex = lastCellCoordinates.columnIndex,\n          isLastCellAllDay = lastCellCoordinates.allDay;\n\n      if (lastRowIndex < 0) {\n        return;\n      }\n\n      var firstCell = firstCellCoordinates ? viewDataProvider.getCellData(firstCellCoordinates.rowIndex, firstCellCoordinates.columnIndex, firstCellCoordinates.allDay) : this._firstSelectedCell;\n      var lastCell = viewDataProvider.getCellData(lastRowIndex, lastColumnIndex, isLastCellAllDay);\n      this._firstSelectedCell = firstCell;\n\n      if (firstCell.startDate.getTime() > lastCell.startDate.getTime()) {\n        var _ref = [lastCell, firstCell];\n        firstCell = _ref[0];\n        lastCell = _ref[1];\n      }\n\n      var _firstCell = firstCell,\n          firstStartDate = _firstCell.startDate,\n          firstGroupIndex = _firstCell.groupIndex;\n      var _lastCell = lastCell,\n          lastStartDate = _lastCell.startDate;\n      var cells = viewDataProvider.getCellsByGroupIndexAndAllDay(firstGroupIndex, isLastCellAllDay);\n      var filteredCells = cells.reduce(function (selectedCells, cellsRow) {\n        var filteredRow = _this._filterCellsByDate(cellsRow, firstStartDate, lastStartDate);\n\n        selectedCells.push.apply(selectedCells, _toConsumableArray(filteredRow));\n        return selectedCells;\n      }, []);\n      this._selectedCells = filteredCells.sort(function (firstCell, secondCell) {\n        return firstCell.startDate.getTime() - secondCell.startDate.getTime();\n      });\n    }\n  }, {\n    key: \"getSelectedCells\",\n    value: function () {\n      return this._selectedCells;\n    }\n  }, {\n    key: \"releaseSelectedAndFocusedCells\",\n    value: function () {\n      this.releaseSelectedCells();\n      this.releaseFocusedCell();\n    }\n  }, {\n    key: \"releaseSelectedCells\",\n    value: function () {\n      this._selectedCells = null;\n      this._firstSelectedCell = null;\n    }\n  }, {\n    key: \"releaseFocusedCell\",\n    value: function () {\n      this._focusedCell = null;\n    }\n  }, {\n    key: \"isValidFocusedCell\",\n    value: function (nextFocusedCellData) {\n      var focusedCell = this._focusedCell;\n\n      if (!focusedCell) {\n        return true;\n      }\n\n      var groupIndex = focusedCell.groupIndex,\n          allDay = focusedCell.allDay;\n      var nextGroupIndex = nextFocusedCellData.groupIndex,\n          nextAllDay = nextFocusedCellData.allDay;\n      return groupIndex === nextGroupIndex && allDay === nextAllDay;\n    }\n  }, {\n    key: \"_getColumnIndexByCellData\",\n    value: function (cellData, isVerticalGroupOrientation) {\n      var viewDataMap = this._viewDataProvider.viewDataMap;\n      var startDate = cellData.startDate,\n          groupIndex = cellData.groupIndex;\n      var firstRow = viewDataMap[0];\n\n      var startTime = _date.default.trimTime(startDate).getTime();\n\n      for (var columnIndex = 0; columnIndex < firstRow.length; columnIndex += 1) {\n        var _firstRow$columnIndex = firstRow[columnIndex].cellData,\n            currentStartDate = _firstRow$columnIndex.startDate,\n            currentGroupIndex = _firstRow$columnIndex.groupIndex;\n\n        if (startTime === _date.default.trimTime(currentStartDate).getTime() && (groupIndex === currentGroupIndex || isVerticalGroupOrientation)) {\n          return columnIndex;\n        }\n      }\n    }\n  }, {\n    key: \"_getRowIndexByColumnAndData\",\n    value: function (cellData, columnIndex, isVerticalGroupOrientation) {\n      var viewDataMap = this._viewDataProvider.viewDataMap;\n      var startDate = cellData.startDate,\n          groupIndex = cellData.groupIndex,\n          allDay = cellData.allDay;\n\n      if (allDay && !isVerticalGroupOrientation) {\n        return 0;\n      }\n\n      for (var rowIndex = 0; rowIndex < viewDataMap.length; rowIndex += 1) {\n        var currentCellData = viewDataMap[rowIndex][columnIndex].cellData;\n        var currentStartDate = currentCellData.startDate,\n            currentGroupIndex = currentCellData.groupIndex,\n            currentAllDay = currentCellData.allDay;\n\n        if (startDate.getTime() === currentStartDate.getTime() && groupIndex === currentGroupIndex && allDay === currentAllDay) {\n          return rowIndex;\n        }\n      }\n    }\n  }, {\n    key: \"_filterCellsByDate\",\n    value: function (cellsRow, firstDate, lastDate) {\n      var firstTime = firstDate.getTime();\n      var lastTime = lastDate.getTime();\n      return cellsRow.filter(function (cell) {\n        var startDate = cell.startDate;\n        var time = startDate.getTime();\n        return firstTime <= time && time <= lastTime;\n      });\n    }\n  }]);\n\n  return VirtualSelectionState;\n}();\n\nexports.default = VirtualSelectionState;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/scheduler/workspaces/virtual_selection_state.js"],"names":["exports","default","_date","_interopRequireDefault","require","obj","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","VirtualSelectionState","viewDataProvider","_viewDataProvider","_focusedCell","_selectedCells","_firstSelectedCell","value","rowIndex","columnIndex","isAllDay","cell","getCellData","isVerticalGroupOrientation","_getColumnIndexByCellData","_getRowIndexByColumnAndData","coordinates","cellIndex","cellData","lastCellCoordinates","_this","firstCellCoordinates","arguments","lastRowIndex","lastColumnIndex","isLastCellAllDay","allDay","firstCell","lastCell","startDate","getTime","_ref","_firstCell","firstStartDate","firstGroupIndex","groupIndex","_lastCell","lastStartDate","cells","getCellsByGroupIndexAndAllDay","filteredCells","reduce","selectedCells","cellsRow","filteredRow","_filterCellsByDate","push","apply","sort","secondCell","releaseSelectedCells","releaseFocusedCell","nextFocusedCellData","focusedCell","nextGroupIndex","nextAllDay","viewDataMap","firstRow","startTime","trimTime","_firstRow$columnIndex","currentStartDate","currentGroupIndex","currentCellData","currentAllDay","firstDate","lastDate","firstTime","lastTime","filter","time","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/virtual_selection_state.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _date = _interopRequireDefault(require(\"../../../core/utils/date\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(o)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return _arrayLikeToArray(arr)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar VirtualSelectionState = function() {\r\n    function VirtualSelectionState(viewDataProvider) {\r\n        _classCallCheck(this, VirtualSelectionState);\r\n        this._viewDataProvider = viewDataProvider;\r\n        this._focusedCell = null;\r\n        this._selectedCells = null;\r\n        this._firstSelectedCell = null\r\n    }\r\n    _createClass(VirtualSelectionState, [{\r\n        key: \"setFocusedCell\",\r\n        value: function(rowIndex, columnIndex, isAllDay) {\r\n            if (rowIndex >= 0) {\r\n                var cell = this._viewDataProvider.getCellData(rowIndex, columnIndex, isAllDay);\r\n                this._focusedCell = cell\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getFocusedCell\",\r\n        value: function(isVerticalGroupOrientation) {\r\n            var _focusedCell = this._focusedCell;\r\n            if (!_focusedCell) {\r\n                return\r\n            }\r\n            var columnIndex = this._getColumnIndexByCellData(_focusedCell, isVerticalGroupOrientation);\r\n            var rowIndex = this._getRowIndexByColumnAndData(_focusedCell, columnIndex, isVerticalGroupOrientation);\r\n            return {\r\n                coordinates: {\r\n                    cellIndex: columnIndex,\r\n                    rowIndex: rowIndex\r\n                },\r\n                cellData: _focusedCell\r\n            }\r\n        }\r\n    }, {\r\n        key: \"setSelectedCells\",\r\n        value: function(lastCellCoordinates) {\r\n            var _this = this;\r\n            var firstCellCoordinates = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0;\r\n            var viewDataProvider = this._viewDataProvider;\r\n            var lastRowIndex = lastCellCoordinates.rowIndex,\r\n                lastColumnIndex = lastCellCoordinates.columnIndex,\r\n                isLastCellAllDay = lastCellCoordinates.allDay;\r\n            if (lastRowIndex < 0) {\r\n                return\r\n            }\r\n            var firstCell = firstCellCoordinates ? viewDataProvider.getCellData(firstCellCoordinates.rowIndex, firstCellCoordinates.columnIndex, firstCellCoordinates.allDay) : this._firstSelectedCell;\r\n            var lastCell = viewDataProvider.getCellData(lastRowIndex, lastColumnIndex, isLastCellAllDay);\r\n            this._firstSelectedCell = firstCell;\r\n            if (firstCell.startDate.getTime() > lastCell.startDate.getTime()) {\r\n                var _ref = [lastCell, firstCell];\r\n                firstCell = _ref[0];\r\n                lastCell = _ref[1]\r\n            }\r\n            var _firstCell = firstCell,\r\n                firstStartDate = _firstCell.startDate,\r\n                firstGroupIndex = _firstCell.groupIndex;\r\n            var _lastCell = lastCell,\r\n                lastStartDate = _lastCell.startDate;\r\n            var cells = viewDataProvider.getCellsByGroupIndexAndAllDay(firstGroupIndex, isLastCellAllDay);\r\n            var filteredCells = cells.reduce(function(selectedCells, cellsRow) {\r\n                var filteredRow = _this._filterCellsByDate(cellsRow, firstStartDate, lastStartDate);\r\n                selectedCells.push.apply(selectedCells, _toConsumableArray(filteredRow));\r\n                return selectedCells\r\n            }, []);\r\n            this._selectedCells = filteredCells.sort(function(firstCell, secondCell) {\r\n                return firstCell.startDate.getTime() - secondCell.startDate.getTime()\r\n            })\r\n        }\r\n    }, {\r\n        key: \"getSelectedCells\",\r\n        value: function() {\r\n            return this._selectedCells\r\n        }\r\n    }, {\r\n        key: \"releaseSelectedAndFocusedCells\",\r\n        value: function() {\r\n            this.releaseSelectedCells();\r\n            this.releaseFocusedCell()\r\n        }\r\n    }, {\r\n        key: \"releaseSelectedCells\",\r\n        value: function() {\r\n            this._selectedCells = null;\r\n            this._firstSelectedCell = null\r\n        }\r\n    }, {\r\n        key: \"releaseFocusedCell\",\r\n        value: function() {\r\n            this._focusedCell = null\r\n        }\r\n    }, {\r\n        key: \"isValidFocusedCell\",\r\n        value: function(nextFocusedCellData) {\r\n            var focusedCell = this._focusedCell;\r\n            if (!focusedCell) {\r\n                return true\r\n            }\r\n            var groupIndex = focusedCell.groupIndex,\r\n                allDay = focusedCell.allDay;\r\n            var nextGroupIndex = nextFocusedCellData.groupIndex,\r\n                nextAllDay = nextFocusedCellData.allDay;\r\n            return groupIndex === nextGroupIndex && allDay === nextAllDay\r\n        }\r\n    }, {\r\n        key: \"_getColumnIndexByCellData\",\r\n        value: function(cellData, isVerticalGroupOrientation) {\r\n            var viewDataMap = this._viewDataProvider.viewDataMap;\r\n            var startDate = cellData.startDate,\r\n                groupIndex = cellData.groupIndex;\r\n            var firstRow = viewDataMap[0];\r\n            var startTime = _date.default.trimTime(startDate).getTime();\r\n            for (var columnIndex = 0; columnIndex < firstRow.length; columnIndex += 1) {\r\n                var _firstRow$columnIndex = firstRow[columnIndex].cellData,\r\n                    currentStartDate = _firstRow$columnIndex.startDate,\r\n                    currentGroupIndex = _firstRow$columnIndex.groupIndex;\r\n                if (startTime === _date.default.trimTime(currentStartDate).getTime() && (groupIndex === currentGroupIndex || isVerticalGroupOrientation)) {\r\n                    return columnIndex\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getRowIndexByColumnAndData\",\r\n        value: function(cellData, columnIndex, isVerticalGroupOrientation) {\r\n            var viewDataMap = this._viewDataProvider.viewDataMap;\r\n            var startDate = cellData.startDate,\r\n                groupIndex = cellData.groupIndex,\r\n                allDay = cellData.allDay;\r\n            if (allDay && !isVerticalGroupOrientation) {\r\n                return 0\r\n            }\r\n            for (var rowIndex = 0; rowIndex < viewDataMap.length; rowIndex += 1) {\r\n                var currentCellData = viewDataMap[rowIndex][columnIndex].cellData;\r\n                var currentStartDate = currentCellData.startDate,\r\n                    currentGroupIndex = currentCellData.groupIndex,\r\n                    currentAllDay = currentCellData.allDay;\r\n                if (startDate.getTime() === currentStartDate.getTime() && groupIndex === currentGroupIndex && allDay === currentAllDay) {\r\n                    return rowIndex\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_filterCellsByDate\",\r\n        value: function(cellsRow, firstDate, lastDate) {\r\n            var firstTime = firstDate.getTime();\r\n            var lastTime = lastDate.getTime();\r\n            return cellsRow.filter(function(cell) {\r\n                var startDate = cell.startDate;\r\n                var time = startDate.getTime();\r\n                return firstTime <= time && time <= lastTime\r\n            })\r\n        }\r\n    }]);\r\n    return VirtualSelectionState\r\n}();\r\nexports.default = VirtualSelectionState;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}