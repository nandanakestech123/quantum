{"ast":null,"code":"import _createForOfIteratorHelper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _defineProperty from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{NormalButton,NormalInput,NormalSelect,InputSearch,NormalModal,TableWrapper,NormalCheckbox}from\"component/common\";import{dateFormat}from\"service/helperFunctions\";import _ from\"lodash\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{getCommonApi,updateForm,commonCreateApi,commonDeleteApi,commonPatchApi}from\"redux/actions/common\";import{withTranslation}from\"react-i18next\";import SimpleReactValidator from\"simple-react-validator\";import{Toast}from\"service/toast\";export var CombineTopupClass=/*#__PURE__*/function(_Component){_inherits(CombineTopupClass,_Component);var _super=_createSuper(CombineTopupClass);function CombineTopupClass(){var _this;_classCallCheck(this,CombineTopupClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={treatmentList:[],formFields:{customer_name:\"\",new_outstanding:\"\",old_outstanding:\"\",topup_amount:\"\"},headerDetails:[{label:\"Date\",sortKey:false,width:\"120px\",divClass:\"justify-content-end text-right\"},{label:\"Invoice No\",sortKey:false,width:\"120px\"},{label:\"Treatment Name\",sortKey:false,width:\"120px\"},{label:\"Qty\",sortKey:false,width:\"50px\",divClass:\"justify-content-end text-right\"},{label:\"Total Amount\",width:\"120px\",divClass:\"justify-content-end text-right\"},{label:\"Deposit Balance\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Outstanding\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Pay amount\",width:\"60px\",divClass:\"justify-content-center\"},{label:\"Staff\",width:\"120px\"}],headerDetailsAuto:[{label:\"Date\",sortKey:false,width:\"120px\",divClass:\"justify-content-end text-right\"},{label:\"Invoice No\",sortKey:false,width:\"120px\"},{label:\"Treatment Name\",sortKey:false,width:\"120px\"},{label:\"Qty\",sortKey:false,width:\"50px\",divClass:\"justify-content-end text-right\"},{label:\"Total Amount\",width:\"120px\",divClass:\"justify-content-end text-right\"},{label:\"Deposit Balance\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Outstanding\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Pay amount\",width:\"60px\",divClass:\"justify-content-center\"},{label:\"Auto\",width:\"50px\",divClass:\"justify-content-center\"},{label:\"Staff\",width:\"120px\"}],typeofSelection:{service:true,product:true,prepaid:true},is_fullpay:false,is_auto:false,page:1,limit:10,pageMeta:{},settingData:{}};_this.componentWillMount=function(){_this.validator=new SimpleReactValidator({element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});};_this.handleItemSettings=function(){var settingData=_this.state.settingData;_this.props.getCommonApi(\"userlist/\").then(function(key){var status=key.status,data=key.data;console.log(key,\"settingsData appointmentCreate\");if(status===200){settingData=data;_this.setState({settingData:settingData});}});};_this.getCart=function(){var _this$state=_this.state,typeofSelection=_this$state.typeofSelection,treatmentList=_this$state.treatmentList,pageMeta=_this$state.pageMeta,is_auto=_this$state.is_auto,is_fullpay=_this$state.is_fullpay;try{var dataType=[];if(typeofSelection.service){dataType.push(\"service\");}if(typeofSelection.prepaid){dataType.push(\"prepaid\");}if(typeofSelection.product){dataType.push(\"product\");}_this.props.getCommonApi(\"topupcombinedlist/?cust_id=\".concat(_this.props.id,\"&type=\").concat(dataType)).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(key){var status,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:status=key.status,data=key.data;if(!(status===200)){_context.next=7;break;}treatmentList=[];_context.next=5;return _this.setState({treatmentList:treatmentList});case 5:_this.getDataFromRes(key);if(data){if(data.dataList){data.dataList.forEach(function(item){var itemData=item;itemData[\"Autokey\"]=false;treatmentList.push(itemData);});pageMeta=data.meta.pagination;is_auto=false;is_fullpay=false;_this.setState({treatmentList:treatmentList,pageMeta:pageMeta,is_auto:is_auto,is_fullpay:is_fullpay});}}case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}catch(e){console.log(e,\"topupgetcombinelog\");}};_this.getDataFromRes=function(data){var header_data=data.header_data;var formFields=_this.state.formFields;formFields[\"customer_name\"]=header_data?header_data.customer_name:\"\";formFields[\"new_outstanding\"]=header_data?header_data.new_outstanding:\"\";formFields[\"old_outstanding\"]=header_data?header_data.old_outstanding:\"\";formFields[\"topup_amount\"]=header_data?header_data.topup_amount:\"\";_this.setState({formFields:formFields});};_this.handlePagination=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(pageNo){var page;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:page=_this.state.page;page=pageNo.page;_context2.next=4;return _this.setState({page:page});case 4:_this.getCart();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.handlechangeSelection=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var typeofSelection;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:typeofSelection=_this.state.typeofSelection;typeofSelection[e.target.name]=e.target.value;_context3.next=4;return _this.setState({typeofSelection:typeofSelection});case 4:_this.getCart();case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.handleChange=function(e){var formFields=_this.state.formFields;formFields[e.target.name]=e.target.value;_this.setState({formFields:formFields});};_this.handleTopupChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(event){var formFields;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:// event.persist();\nformFields=_this.state.formFields;formFields.topup_amount=event.target.value;_context5.next=4;return _this.setState({formFields:formFields});case 4:if(!_this.debouncedFn){_this.debouncedFn=_.debounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.search();case 1:case\"end\":return _context4.stop();}}},_callee4);})),500);}_this.debouncedFn();case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref4.apply(this,arguments);};}();_this.search=function(){var formFields=_this.state.formFields;var old_outstand=Number(formFields.old_outstanding);var topup=Number(formFields.topup_amount);if(topup<=old_outstand){formFields[\"new_outstanding\"]=Number(old_outstand-topup).toFixed(2);_this.setState({formFields:formFields});}else{Toast({type:\"error\",message:\"The topup amount may not be greater than outstanding\"});}};_this.handlePayAmount=function(event,data,index){var treatmentList=_this.state.treatmentList;treatmentList[index][event.target.name]=event.target.value;_this.setState({treatmentList:treatmentList});};_this.handleCommonChange=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e){var _this$state2,treatmentList,is_auto,formFields,topup;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state2=_this.state,treatmentList=_this$state2.treatmentList,is_auto=_this$state2.is_auto;_this.setState(_defineProperty({},e.target.name,e.target.value));if(!([e.target.name]==\"is_auto\")){_context6.next=8;break;}treatmentList.forEach(function(item){{e.target.value==true?item[\"Autokey\"]=true:item[\"Autokey\"]=false;}});_context6.next=6;return _this.setState({treatmentList:treatmentList});case 6:_context6.next=28;break;case 8:if(!([e.target.name]==\"is_fullpay\")){_context6.next=28;break;}formFields=_this.state.formFields;topup=0;if(!is_auto){_context6.next=21;break;}treatmentList.forEach(function(item){if(item.Autokey){item[\"pay_amount\"]=item.outstanding;topup+=Number(item.outstanding);}});_context6.next=15;return _this.setState({treatmentList:treatmentList});case 15:formFields[\"topup_amount\"]=Number(topup).toFixed(2);formFields[\"new_outstanding\"]=Number(formFields.old_outstanding-topup).toFixed(2);_context6.next=19;return _this.setState({formFields:formFields});case 19:_context6.next=28;break;case 21:treatmentList.forEach(function(item){item[\"pay_amount\"]=item.outstanding;});_context6.next=24;return _this.setState({treatmentList:treatmentList});case 24:formFields[\"new_outstanding\"]=0;formFields[\"topup_amount\"]=formFields.old_outstanding;_context6.next=28;return _this.setState({formFields:formFields});case 28:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x5){return _ref6.apply(this,arguments);};}();_this.ParseFloatUpdate=function(str,val){str=str.toString();str=str.slice(0,str.indexOf(\".\")+val+1);return Number(str);};_this.handleAutoMatch=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this$state3,treatmentList,formFields,checkedCount,SelectedTotalOutstanding,recordCount,UpdatedTotalOutstanding;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$state3=_this.state,treatmentList=_this$state3.treatmentList,formFields=_this$state3.formFields;_context7.prev=1;if(!(formFields.topup_amount>0)){_context7.next=13;break;}checkedCount=treatmentList.filter(function(item){return item.Autokey==true;}).length;SelectedTotalOutstanding=0;treatmentList.forEach(function(item){if(item.Autokey){SelectedTotalOutstanding+=Number(item.outstanding);}});recordCount=0;UpdatedTotalOutstanding=0;treatmentList.forEach(function(item){if(item.Autokey){recordCount++;if(recordCount==checkedCount){var otherrowTotal=_this.ParseFloatUpdate(UpdatedTotalOutstanding,2);var linePay=Number(formFields.topup_amount-otherrowTotal);var tot=Number(linePay)+Number(otherrowTotal);var difference=formFields.topup_amount-tot;var final=linePay+difference;item[\"pay_amount\"]=_this.ParseFloatUpdate(final,2);}else{var findPercentage=Number(formFields.topup_amount/SelectedTotalOutstanding)*100;var _linePay=Number(findPercentage)/100*item.outstanding;UpdatedTotalOutstanding+=_this.ParseFloatUpdate(_linePay,2);item[\"pay_amount\"]=_this.ParseFloatUpdate(_linePay,2);}}});_context7.next=11;return _this.setState({treatmentList:treatmentList});case 11:_context7.next=14;break;case 13:Toast({type:\"error\",message:\"Please enter valid Top up amount\"});case 14:_context7.next=19;break;case 16:_context7.prev=16;_context7.t0=_context7[\"catch\"](1);console.log(_context7.t0,\"catchlogautomatch\");case 19:case\"end\":return _context7.stop();}}},_callee7,null,[[1,16]]);}));_this.handleClearAll=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var _this$state4,formFields,treatmentList;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this$state4=_this.state,formFields=_this$state4.formFields,treatmentList=_this$state4.treatmentList;formFields[\"topup_amount\"]=0;formFields[\"new_outstanding\"]=formFields.old_outstanding;_context8.next=5;return _this.setState({is_fullpay:false,formFields:formFields});case 5:treatmentList.forEach(function(item){item[\"pay_amount\"]=0;});_context8.next=8;return _this.setState({treatmentList:treatmentList});case 8:case\"end\":return _context8.stop();}}},_callee8);}));_this.handleCreateCart=function(){var basicApptDetail=_this.props.basicApptDetail;var treatmentList=_this.state.treatmentList;var payload=[];if(_this.validator.allValid()){var _iterator=_createForOfIteratorHelper(treatmentList),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;if(key.pay_amount>0){var obj={cust_noid:basicApptDetail.custId,cart_date:dateFormat(new Date(),\"yyyy-mm-dd\"),itemcodeid:key.stock_id,price:key.pay_amount,item_uom:null,treatment_account:key.TreatmentAccountid?key.TreatmentAccountid:null,deposit_account:key.DepositAccountid?key.DepositAccountid:null,prepaid_account:key.prepaid_id?key.prepaid_id:null};payload.push(obj);}}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.props.getCommonApi(\"itemcart/Check/?cart_date=\".concat(dateFormat(new Date(),\"yyyy-mm-dd\"),\"&cust_noid=\").concat(basicApptDetail.custId)).then(function(res){if(res.data.length===0){_this.props.commonCreateApi(\"itemcart/TopUpCartCreate/\",payload).then(function(res){// this.props.handleCartCreated()\n_this.props.handleModal();});}else{_this.props.commonCreateApi(\"itemcart/TopUpCartCreate/?cart_id=\".concat(res.cart_id),payload).then(function(res){_this.props.handleModal();});}});}else{_this.validator.showMessages();}};return _this;}_createClass(CombineTopupClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.getCart();}},{key:\"render\",value:function render(){var _this2=this;var _this$state5=this.state,_this$state5$workpoin=_this$state5.workpoint,workpoint=_this$state5$workpoin===void 0?\"\":_this$state5$workpoin,_this$state5$treatmen=_this$state5.treatmentList,treatmentList=_this$state5$treatmen===void 0?[]:_this$state5$treatmen,headerDetails=_this$state5.headerDetails,formFields=_this$state5.formFields,is_auto=_this$state5.is_auto,pageMeta=_this$state5.pageMeta,typeofSelection=_this$state5.typeofSelection,is_fullpay=_this$state5.is_fullpay,settingData=_this$state5.settingData,headerDetailsAuto=_this$state5.headerDetailsAuto;var customer_name=formFields.customer_name,new_outstanding=formFields.new_outstanding,old_outstanding=formFields.old_outstanding,topup_amount=formFields.topup_amount;var service=typeofSelection.service,prepaid=typeofSelection.prepaid,product=typeofSelection.product;var t=this.props.t;return/*#__PURE__*/React.createElement(\"div\",{className:\"row p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 col-12 fw-500 fs-18 text-left p-0 m-0\"},\"Top Up\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",submitBtn:true,className:\"confirm\",label:\"Confirm\",onClick:this.handleCreateCart})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 new-cart top-up\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5 col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text\"},t(\"Customer\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{value:customer_name,name:\"customer_name\",onChange:this.handleChange,disabled:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text\"},t(\"Outstanding\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{value:old_outstanding,name:\"old_outstanding\",onChange:this.handleTopupChange,disabled:true})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-1 col-12\"},/*#__PURE__*/React.createElement(NormalCheckbox,{type:\"checkbox\",onChange:this.handleCommonChange,name:\"is_auto\",checked:is_auto,label:\"Auto\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4 col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text mr-2\"},t(\"Top Up Amount\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{type:\"number\",value:topup_amount,name:\"topup_amount\",onChange:this.handleTopupChange,className:\"text-right\",max:old_outstanding}),topup_amount?this.validator.message(\"topup_amount\",topup_amount,\"required|max:\".concat(Number(old_outstanding),\",num\")):\"\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text mr-2\"},t(\"New Outstanding\")),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{type:\"number\",value:new_outstanding,name:\"new_outstanding\",onChange:this.handleChange,className:\"text-right\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2 col-12\"},/*#__PURE__*/React.createElement(NormalCheckbox,{type:\"checkbox\",onChange:this.handleCommonChange,name:\"is_fullpay\",checked:is_fullpay,label:\"Full payment\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap mt-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-1 col-12\"},/*#__PURE__*/React.createElement(NormalCheckbox,{checked:service,label:\"service\",name:\"service\",onChange:this.handlechangeSelection})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-1 col-12\"},/*#__PURE__*/React.createElement(NormalCheckbox,{checked:product,label:\"product\",name:\"product\",onChange:this.handlechangeSelection})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-1 col-12\"},/*#__PURE__*/React.createElement(NormalCheckbox,{checked:prepaid,label:\"prepaid\",name:\"prepaid\",onChange:this.handlechangeSelection})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container table-responsive mt-3\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:is_auto?headerDetailsAuto:headerDetails,queryHandler:this.handlePagination,pageMeta:pageMeta},treatmentList.length>0?treatmentList.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.sa_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.sa_transacno)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.description)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.qty)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.total_amount)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.balance)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.outstanding)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center payment-input justify-content-center\"},/*#__PURE__*/React.createElement(NormalInput,{value:item.pay_amount,name:\"pay_amount\",onChange:function onChange(e){return _this2.handlePayAmount(e,item,index);},className:\"customer-name text-right\"}),item.pay_amount?_this2.validator.message(\"pay_amount\",item.pay_amount,\"required|max:\".concat(Number(item.outstanding),\",num\")):\"\")),is_auto?/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center\"},/*#__PURE__*/React.createElement(NormalCheckbox,{type:\"checkbox\",onChange:function onChange(e){return _this2.handlePayAmount(e,item,index);},name:\"Autokey\",checked:item.Autokey//disabled={is_auto ? false : true}\n}))):\"\",/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.sa_staffname)));}):/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},\"No data\")))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 pt-4 action-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex  justify-content-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(NormalButton,{resetbg:true,label:\"Clear All\",className:\"mr-2\",onClick:this.handleClearAll}),is_auto?/*#__PURE__*/React.createElement(NormalButton,{mainbgrev:true,label:\"Auto Match\"// disabled={is_auto ? false : true}\n,onClick:this.handleAutoMatch,className:\"ml-2\"}):\"\")))));}}]);return CombineTopupClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{selected_cstomer:state.common.selected_cstomer,basicApptDetail:state.appointment.basicApptDetail};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({// getCustomer,\ngetCommonApi:getCommonApi,updateForm:updateForm,commonCreateApi:commonCreateApi,commonPatchApi:commonPatchApi,commonDeleteApi:commonDeleteApi},dispatch);};export var CombineTopup=withTranslation()(connect(mapStateToProps,mapDispatchToProps)(CombineTopupClass));","map":{"version":3,"sources":["F:/webfe/src/component/Admin/Cart/CombineTopup/index.js"],"names":["React","Component","NormalButton","NormalInput","NormalSelect","InputSearch","NormalModal","TableWrapper","NormalCheckbox","dateFormat","_","connect","bindActionCreators","getCommonApi","updateForm","commonCreateApi","commonDeleteApi","commonPatchApi","withTranslation","SimpleReactValidator","Toast","CombineTopupClass","state","treatmentList","formFields","customer_name","new_outstanding","old_outstanding","topup_amount","headerDetails","label","sortKey","width","divClass","headerDetailsAuto","typeofSelection","service","product","prepaid","is_fullpay","is_auto","page","limit","pageMeta","settingData","componentWillMount","validator","element","message","autoForceUpdate","handleItemSettings","props","then","key","status","data","console","log","setState","getCart","dataType","push","id","getDataFromRes","dataList","forEach","item","itemData","meta","pagination","e","header_data","handlePagination","pageNo","handlechangeSelection","target","name","value","handleChange","handleTopupChange","event","debouncedFn","debounce","search","old_outstand","Number","topup","toFixed","type","handlePayAmount","index","handleCommonChange","Autokey","outstanding","ParseFloatUpdate","str","val","toString","slice","indexOf","handleAutoMatch","checkedCount","filter","length","SelectedTotalOutstanding","recordCount","UpdatedTotalOutstanding","otherrowTotal","linePay","tot","difference","final","findPercentage","handleClearAll","handleCreateCart","basicApptDetail","payload","allValid","pay_amount","obj","cust_noid","custId","cart_date","Date","itemcodeid","stock_id","price","item_uom","treatment_account","TreatmentAccountid","deposit_account","DepositAccountid","prepaid_account","prepaid_id","res","handleModal","cart_id","showMessages","workpoint","t","map","sa_date","sa_transacno","description","qty","total_amount","balance","sa_staffname","mapStateToProps","selected_cstomer","common","appointment","mapDispatchToProps","dispatch","CombineTopup"],"mappings":"osCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OACEC,YADF,CAEEC,WAFF,CAGEC,YAHF,CAIEC,WAJF,CAKEC,WALF,CAMEC,YANF,CAOEC,cAPF,KAQO,kBARP,CASA,OAASC,UAAT,KAA2B,yBAA3B,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,kBAAT,KAAmC,OAAnC,CACA,OACEC,YADF,CAEEC,UAFF,CAGEC,eAHF,CAIEC,eAJF,CAKEC,cALF,KAMO,sBANP,CAOA,OAASC,eAAT,KAAgC,eAAhC,CACA,MAAOC,CAAAA,oBAAP,KAAiC,wBAAjC,CACA,OAASC,KAAT,KAAsB,eAAtB,CAEA,UAAaC,CAAAA,iBAAb,uWACEC,KADF,CACU,CACNC,aAAa,CAAE,EADT,CAENC,UAAU,CAAE,CACVC,aAAa,CAAE,EADL,CAEVC,eAAe,CAAE,EAFP,CAGVC,eAAe,CAAE,EAHP,CAIVC,YAAY,CAAE,EAJJ,CAFN,CAQNC,aAAa,CAAE,CACb,CACEC,KAAK,CAAE,MADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CADa,CAOb,CAAEH,KAAK,CAAE,YAAT,CAAuBC,OAAO,CAAE,KAAhC,CAAuCC,KAAK,CAAE,OAA9C,CAPa,CAQb,CAAEF,KAAK,CAAE,gBAAT,CAA2BC,OAAO,CAAE,KAApC,CAA2CC,KAAK,CAAE,OAAlD,CARa,CASb,CACEF,KAAK,CAAE,KADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,MAHT,CAIEC,QAAQ,CAAE,gCAJZ,CATa,CAeb,CACEH,KAAK,CAAE,cADT,CAEEE,KAAK,CAAE,OAFT,CAGEC,QAAQ,CAAE,gCAHZ,CAfa,CAoBb,CACEH,KAAK,CAAE,iBADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CApBa,CA0Bb,CACEH,KAAK,CAAE,aADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CA1Ba,CAiCb,CACEH,KAAK,CAAE,YADT,CAEEE,KAAK,CAAE,MAFT,CAGEC,QAAQ,CAAE,wBAHZ,CAjCa,CAsCb,CAAEH,KAAK,CAAE,OAAT,CAAkBE,KAAK,CAAE,OAAzB,CAtCa,CART,CAgDNE,iBAAiB,CAAE,CACjB,CACEJ,KAAK,CAAE,MADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CADiB,CAOjB,CAAEH,KAAK,CAAE,YAAT,CAAuBC,OAAO,CAAE,KAAhC,CAAuCC,KAAK,CAAE,OAA9C,CAPiB,CAQjB,CAAEF,KAAK,CAAE,gBAAT,CAA2BC,OAAO,CAAE,KAApC,CAA2CC,KAAK,CAAE,OAAlD,CARiB,CASjB,CACEF,KAAK,CAAE,KADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,MAHT,CAIEC,QAAQ,CAAE,gCAJZ,CATiB,CAejB,CACEH,KAAK,CAAE,cADT,CAEEE,KAAK,CAAE,OAFT,CAGEC,QAAQ,CAAE,gCAHZ,CAfiB,CAoBjB,CACEH,KAAK,CAAE,iBADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CApBiB,CA0BjB,CACEH,KAAK,CAAE,aADT,CAEEC,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAE,OAHT,CAIEC,QAAQ,CAAE,gCAJZ,CA1BiB,CAiCjB,CACEH,KAAK,CAAE,YADT,CAEEE,KAAK,CAAE,MAFT,CAGEC,QAAQ,CAAE,wBAHZ,CAjCiB,CAsCjB,CACEH,KAAK,CAAE,MADT,CAEEE,KAAK,CAAE,MAFT,CAGEC,QAAQ,yBAHV,CAtCiB,CA2CjB,CAAEH,KAAK,CAAE,OAAT,CAAkBE,KAAK,CAAE,OAAzB,CA3CiB,CAhDb,CA6FNG,eAAe,CAAE,CACfC,OAAO,CAAE,IADM,CAEfC,OAAO,CAAE,IAFM,CAGfC,OAAO,CAAE,IAHM,CA7FX,CAkGNC,UAAU,CAAE,KAlGN,CAmGNC,OAAO,CAAE,KAnGH,CAoGNC,IAAI,CAAE,CApGA,CAqGNC,KAAK,CAAE,EArGD,CAsGNC,QAAQ,CAAE,EAtGJ,CAuGNC,WAAW,CAAE,EAvGP,CADV,OA8GEC,kBA9GF,CA8GuB,UAAM,CACzB,MAAKC,SAAL,CAAiB,GAAI3B,CAAAA,oBAAJ,CAAyB,CACxC4B,OAAO,CAAE,iBAAAC,OAAO,qBACd,4BAAM,SAAS,CAAC,wCAAhB,EACGA,OADH,CADc,EADwB,CAMxCC,eAAe,8BANyB,CAAzB,CAAjB,CAQD,CAvHH,OAyHEC,kBAzHF,CAyHuB,UAAM,CACzB,GAAMN,CAAAA,WAAN,CAAsB,MAAKtB,KAA3B,CAAMsB,WAAN,CACA,MAAKO,KAAL,CAAWtC,YAAX,cAAqCuC,IAArC,CAA0C,SAAAC,GAAG,CAAI,CAC/C,GAAMC,CAAAA,MAAN,CAAuBD,GAAvB,CAAMC,MAAN,CAAcC,IAAd,CAAuBF,GAAvB,CAAcE,IAAd,CACAC,OAAO,CAACC,GAAR,CAAYJ,GAAZ,CAAiB,gCAAjB,EACA,GAAIC,MAAM,GAAK,GAAf,CAAoB,CAClBV,WAAW,CAAGW,IAAd,CACA,MAAKG,QAAL,CAAc,CAAEd,WAAW,CAAXA,WAAF,CAAd,EACD,CACF,CAPD,EAQD,CAnIH,OAoIEe,OApIF,CAoIY,UAAM,CACd,gBACE,MAAKrC,KADP,CAAMa,eAAN,aAAMA,eAAN,CAAuBZ,aAAvB,aAAuBA,aAAvB,CAAsCoB,QAAtC,aAAsCA,QAAtC,CAAgDH,OAAhD,aAAgDA,OAAhD,CAAyDD,UAAzD,aAAyDA,UAAzD,CAGA,GAAI,CACF,GAAIqB,CAAAA,QAAQ,CAAG,EAAf,CAEA,GAAIzB,eAAe,CAACC,OAApB,CAA6B,CAC3BwB,QAAQ,CAACC,IAAT,CAAc,SAAd,EACD,CACD,GAAI1B,eAAe,CAACG,OAApB,CAA6B,CAC3BsB,QAAQ,CAACC,IAAT,CAAc,SAAd,EACD,CACD,GAAI1B,eAAe,CAACE,OAApB,CAA6B,CAC3BuB,QAAQ,CAACC,IAAT,CAAc,SAAd,EACD,CAED,MAAKV,KAAL,CACGtC,YADH,sCAEkC,MAAKsC,KAAL,CAAWW,EAF7C,kBAEwDF,QAFxD,GAIGR,IAJH,0FAIQ,iBAAMC,GAAN,kIACEC,MADF,CACmBD,GADnB,CACEC,MADF,CACUC,IADV,CACmBF,GADnB,CACUE,IADV,MAGAD,MAAM,GAAK,GAHX,0BAIF/B,aAAa,CAAG,EAAhB,CAJE,sBAKI,OAAKmC,QAAL,CAAc,CAAEnC,aAAa,CAAbA,aAAF,CAAd,CALJ,QAMF,MAAKwC,cAAL,CAAoBV,GAApB,EACA,GAAIE,IAAJ,CAAU,CACR,GAAIA,IAAI,CAACS,QAAT,CAAmB,CACjBT,IAAI,CAACS,QAAL,CAAcC,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5B,GAAIC,CAAAA,QAAQ,CAAGD,IAAf,CACAC,QAAQ,CAAC,SAAD,CAAR,CAAsB,KAAtB,CACA5C,aAAa,CAACsC,IAAd,CAAmBM,QAAnB,EACD,CAJD,EAKAxB,QAAQ,CAAGY,IAAI,CAACa,IAAL,CAAUC,UAArB,CACA7B,OAAO,CAAG,KAAV,CACAD,UAAU,CAAG,KAAb,CACA,MAAKmB,QAAL,CAAc,CAAEnC,aAAa,CAAbA,aAAF,CAAiBoB,QAAQ,CAARA,QAAjB,CAA2BH,OAAO,CAAPA,OAA3B,CAAoCD,UAAU,CAAVA,UAApC,CAAd,EACD,CACF,CAnBC,sDAJR,gEA0BD,CAAC,MAAO+B,CAAP,CAAU,CACVd,OAAO,CAACC,GAAR,CAAYa,CAAZ,CAAe,oBAAf,EACD,CACF,CAlLH,OAoLEP,cApLF,CAoLmB,SAAAR,IAAI,CAAI,CACvB,GAAMgB,CAAAA,WAAN,CAAsBhB,IAAtB,CAAMgB,WAAN,CACA,GAAM/C,CAAAA,UAAN,CAAqB,MAAKF,KAA1B,CAAME,UAAN,CACAA,UAAU,CAAC,eAAD,CAAV,CAA8B+C,WAAW,CAAGA,WAAW,CAAC9C,aAAf,CAA+B,EAAxE,CACAD,UAAU,CAAC,iBAAD,CAAV,CAAgC+C,WAAW,CACvCA,WAAW,CAAC7C,eAD2B,CAEvC,EAFJ,CAGAF,UAAU,CAAC,iBAAD,CAAV,CAAgC+C,WAAW,CACvCA,WAAW,CAAC5C,eAD2B,CAEvC,EAFJ,CAGAH,UAAU,CAAC,cAAD,CAAV,CAA6B+C,WAAW,CAAGA,WAAW,CAAC3C,YAAf,CAA8B,EAAtE,CACA,MAAK8B,QAAL,CAAc,CACZlC,UAAU,CAAVA,UADY,CAAd,EAGD,CAlMH,OAmMEgD,gBAnMF,2FAmMqB,kBAAMC,MAAN,+HACXhC,IADW,CACF,MAAKnB,KADH,CACXmB,IADW,CAEjBA,IAAI,CAAGgC,MAAM,CAAChC,IAAd,CAFiB,uBAGX,OAAKiB,QAAL,CAAc,CAClBjB,IAAI,CAAJA,IADkB,CAAd,CAHW,QAMjB,MAAKkB,OAAL,GANiB,wDAnMrB,uEA2MEe,qBA3MF,2FA2M0B,kBAAMJ,CAAN,0IAChBnC,eADgB,CACI,MAAKb,KADT,CAChBa,eADgB,CAEtBA,eAAe,CAACmC,CAAC,CAACK,MAAF,CAASC,IAAV,CAAf,CAAiCN,CAAC,CAACK,MAAF,CAASE,KAA1C,CAFsB,uBAGhB,OAAKnB,QAAL,CAAc,CAClBvB,eAAe,CAAfA,eADkB,CAAd,CAHgB,QAMtB,MAAKwB,OAAL,GANsB,wDA3M1B,uEAoNEmB,YApNF,CAoNiB,SAAAR,CAAC,CAAI,CAClB,GAAM9C,CAAAA,UAAN,CAAqB,MAAKF,KAA1B,CAAME,UAAN,CACAA,UAAU,CAAC8C,CAAC,CAACK,MAAF,CAASC,IAAV,CAAV,CAA4BN,CAAC,CAACK,MAAF,CAASE,KAArC,CACA,MAAKnB,QAAL,CAAc,CACZlC,UAAU,CAAVA,UADY,CAAd,EAGD,CA1NH,OA4NEuD,iBA5NF,2FA4NsB,kBAAMC,KAAN,qIAClB;AACMxD,UAFY,CAEG,MAAKF,KAFR,CAEZE,UAFY,CAGlBA,UAAU,CAACI,YAAX,CAA0BoD,KAAK,CAACL,MAAN,CAAaE,KAAvC,CAHkB,uBAIZ,OAAKnB,QAAL,CAAc,CAAElC,UAAU,CAAVA,UAAF,CAAd,CAJY,QAKlB,GAAI,CAAC,MAAKyD,WAAV,CAAuB,CACrB,MAAKA,WAAL,CAAmBvE,CAAC,CAACwE,QAAF,sEAAW,wIAC5B,MAAKC,MAAL,GAD4B,wDAAX,GAEhB,GAFgB,CAAnB,CAGD,CACD,MAAKF,WAAL,GAVkB,wDA5NtB,uEAyOEE,MAzOF,CAyOW,UAAM,CACb,GAAM3D,CAAAA,UAAN,CAAqB,MAAKF,KAA1B,CAAME,UAAN,CACA,GAAI4D,CAAAA,YAAY,CAAGC,MAAM,CAAC7D,UAAU,CAACG,eAAZ,CAAzB,CACA,GAAI2D,CAAAA,KAAK,CAAGD,MAAM,CAAC7D,UAAU,CAACI,YAAZ,CAAlB,CACA,GAAI0D,KAAK,EAAIF,YAAb,CAA2B,CACzB5D,UAAU,CAAC,iBAAD,CAAV,CAAgC6D,MAAM,CAACD,YAAY,CAAGE,KAAhB,CAAN,CAA6BC,OAA7B,CAAqC,CAArC,CAAhC,CACA,MAAK7B,QAAL,CAAc,CACZlC,UAAU,CAAVA,UADY,CAAd,EAGD,CALD,IAKO,CACLJ,KAAK,CAAC,CACJoE,IAAI,CAAE,OADF,CAEJxC,OAAO,CAAE,sDAFL,CAAD,CAAL,CAID,CACF,CAxPH,OA0PEyC,eA1PF,CA0PoB,SAACT,KAAD,CAAQzB,IAAR,CAAcmC,KAAd,CAAwB,CACxC,GAAMnE,CAAAA,aAAN,CAAwB,MAAKD,KAA7B,CAAMC,aAAN,CACAA,aAAa,CAACmE,KAAD,CAAb,CAAqBV,KAAK,CAACL,MAAN,CAAaC,IAAlC,EAA0CI,KAAK,CAACL,MAAN,CAAaE,KAAvD,CACA,MAAKnB,QAAL,CAAc,CACZnC,aAAa,CAAbA,aADY,CAAd,EAGD,CAhQH,OAkQEoE,kBAlQF,2FAkQuB,kBAAMrB,CAAN,2LACc,MAAKhD,KADnB,CACbC,aADa,cACbA,aADa,CACEiB,OADF,cACEA,OADF,CAEnB,MAAKkB,QAAL,oBACGY,CAAC,CAACK,MAAF,CAASC,IADZ,CACmBN,CAAC,CAACK,MAAF,CAASE,KAD5B,GAFmB,KAMf,CAACP,CAAC,CAACK,MAAF,CAASC,IAAV,GAAmB,SANJ,2BAOjBrD,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5B,CACEI,CAAC,CAACK,MAAF,CAASE,KAAT,EAAkB,IAAlB,CACKX,IAAI,CAAC,SAAD,CAAJ,CAAkB,IADvB,CAEKA,IAAI,CAAC,SAAD,CAAJ,CAAkB,KAFvB,CAGD,CACF,CAND,EAPiB,uBAcX,OAAKR,QAAL,CAAc,CAClBnC,aAAa,CAAbA,aADkB,CAAd,CAdW,4CAiBR,CAAC+C,CAAC,CAACK,MAAF,CAASC,IAAV,GAAmB,YAjBX,4BAkBXpD,UAlBW,CAkBI,MAAKF,KAlBT,CAkBXE,UAlBW,CAmBb8D,KAnBa,CAmBL,CAnBK,KAoBb9C,OApBa,2BAqBfjB,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5B,GAAIA,IAAI,CAAC0B,OAAT,CAAkB,CAChB1B,IAAI,CAAC,YAAD,CAAJ,CAAqBA,IAAI,CAAC2B,WAA1B,CACAP,KAAK,EAAID,MAAM,CAACnB,IAAI,CAAC2B,WAAN,CAAf,CACD,CACF,CALD,EArBe,wBA2BT,OAAKnC,QAAL,CAAc,CAClBnC,aAAa,CAAbA,aADkB,CAAd,CA3BS,SA8BfC,UAAU,CAAC,cAAD,CAAV,CAA6B6D,MAAM,CAACC,KAAD,CAAN,CAAcC,OAAd,CAAsB,CAAtB,CAA7B,CACA/D,UAAU,CAAC,iBAAD,CAAV,CAAgC6D,MAAM,CACpC7D,UAAU,CAACG,eAAX,CAA6B2D,KADO,CAAN,CAE9BC,OAF8B,CAEtB,CAFsB,CAAhC,CA/Be,wBAkCT,OAAK7B,QAAL,CAAc,CAClBlC,UAAU,CAAVA,UADkB,CAAd,CAlCS,yCAsCfD,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5BA,IAAI,CAAC,YAAD,CAAJ,CAAqBA,IAAI,CAAC2B,WAA1B,CACD,CAFD,EAtCe,wBAyCT,OAAKnC,QAAL,CAAc,CAClBnC,aAAa,CAAbA,aADkB,CAAd,CAzCS,SA4CfC,UAAU,CAAC,iBAAD,CAAV,CAAgC,CAAhC,CACAA,UAAU,CAAC,cAAD,CAAV,CAA6BA,UAAU,CAACG,eAAxC,CA7Ce,wBA8CT,OAAK+B,QAAL,CAAc,CAClBlC,UAAU,CAAVA,UADkB,CAAd,CA9CS,0DAlQvB,uEAsTEsE,gBAtTF,CAsTqB,SAACC,GAAD,CAAMC,GAAN,CAAc,CAC/BD,GAAG,CAAGA,GAAG,CAACE,QAAJ,EAAN,CACAF,GAAG,CAAGA,GAAG,CAACG,KAAJ,CAAU,CAAV,CAAaH,GAAG,CAACI,OAAJ,CAAY,GAAZ,EAAmBH,GAAnB,CAAyB,CAAtC,CAAN,CACA,MAAOX,CAAAA,MAAM,CAACU,GAAD,CAAb,CACD,CA1TH,OA4TEK,eA5TF,sEA4ToB,yQACoB,MAAK9E,KADzB,CACVC,aADU,cACVA,aADU,CACKC,UADL,cACKA,UADL,uBAGVA,UAAU,CAACI,YAAX,CAA0B,CAHhB,4BAIRyE,YAJQ,CAIO9E,aAAa,CAAC+E,MAAd,CACjB,SAAApC,IAAI,QAAIA,CAAAA,IAAI,CAAC0B,OAAL,EAAgB,IAApB,EADa,EAEjBW,MANU,CAORC,wBAPQ,CAOmB,CAPnB,CASZjF,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5B,GAAIA,IAAI,CAAC0B,OAAT,CAAkB,CAChBY,wBAAwB,EAAInB,MAAM,CAACnB,IAAI,CAAC2B,WAAN,CAAlC,CACD,CACF,CAJD,EAMIY,WAfQ,CAeM,CAfN,CAgBRC,uBAhBQ,CAgBkB,CAhBlB,CAiBZnF,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5B,GAAIA,IAAI,CAAC0B,OAAT,CAAkB,CAChBa,WAAW,GACX,GAAIA,WAAW,EAAIJ,YAAnB,CAAiC,CAC/B,GAAIM,CAAAA,aAAa,CAAG,MAAKb,gBAAL,CAClBY,uBADkB,CAElB,CAFkB,CAApB,CAKA,GAAIE,CAAAA,OAAO,CAAGvB,MAAM,CAAC7D,UAAU,CAACI,YAAX,CAA0B+E,aAA3B,CAApB,CACA,GAAIE,CAAAA,GAAG,CAAGxB,MAAM,CAACuB,OAAD,CAAN,CAAkBvB,MAAM,CAACsB,aAAD,CAAlC,CACA,GAAIG,CAAAA,UAAU,CAAGtF,UAAU,CAACI,YAAX,CAA0BiF,GAA3C,CACA,GAAIE,CAAAA,KAAK,CAAGH,OAAO,CAAGE,UAAtB,CACA5C,IAAI,CAAC,YAAD,CAAJ,CAAqB,MAAK4B,gBAAL,CAAsBiB,KAAtB,CAA6B,CAA7B,CAArB,CACD,CAXD,IAWO,CACL,GAAIC,CAAAA,cAAc,CAChB3B,MAAM,CAAC7D,UAAU,CAACI,YAAX,CAA0B4E,wBAA3B,CAAN,CACA,GAFF,CAGA,GAAII,CAAAA,QAAO,CAAIvB,MAAM,CAAC2B,cAAD,CAAN,CAAyB,GAA1B,CAAiC9C,IAAI,CAAC2B,WAApD,CACAa,uBAAuB,EAAI,MAAKZ,gBAAL,CAAsBc,QAAtB,CAA+B,CAA/B,CAA3B,CACA1C,IAAI,CAAC,YAAD,CAAJ,CAAqB,MAAK4B,gBAAL,CAAsBc,QAAtB,CAA+B,CAA/B,CAArB,CACD,CACF,CACF,CAvBD,EAjBY,wBAyCN,OAAKlD,QAAL,CAAc,CAClBnC,aAAa,CAAbA,aADkB,CAAd,CAzCM,yCA6CZH,KAAK,CAAC,CACJoE,IAAI,CAAE,OADF,CAEJxC,OAAO,CAAE,kCAFL,CAAD,CAAL,CA7CY,6FAmDdQ,OAAO,CAACC,GAAR,cAAe,mBAAf,EAnDc,uEA5TpB,SAkXEwD,cAlXF,sEAkXmB,+LACqB,MAAK3F,KAD1B,CACTE,UADS,cACTA,UADS,CACGD,aADH,cACGA,aADH,CAEfC,UAAU,CAAC,cAAD,CAAV,CAA6B,CAA7B,CACAA,UAAU,CAAC,iBAAD,CAAV,CAAgCA,UAAU,CAACG,eAA3C,CAHe,uBAIT,OAAK+B,QAAL,CAAc,CAClBnB,UAAU,CAAE,KADM,CAElBf,UAAU,CAAVA,UAFkB,CAAd,CAJS,QAQfD,aAAa,CAAC0C,OAAd,CAAsB,SAAAC,IAAI,CAAI,CAC5BA,IAAI,CAAC,YAAD,CAAJ,CAAqB,CAArB,CACD,CAFD,EARe,uBAWT,OAAKR,QAAL,CAAc,CAClBnC,aAAa,CAAbA,aADkB,CAAd,CAXS,yDAlXnB,SAkYE2F,gBAlYF,CAkYqB,UAAM,CACvB,GAAMC,CAAAA,eAAN,CAA0B,MAAKhE,KAA/B,CAAMgE,eAAN,CACA,GAAM5F,CAAAA,aAAN,CAAwB,MAAKD,KAA7B,CAAMC,aAAN,CACA,GAAI6F,CAAAA,OAAO,CAAG,EAAd,CACA,GAAI,MAAKtE,SAAL,CAAeuE,QAAf,EAAJ,CAA+B,0CACb9F,aADa,YAC7B,+CAA+B,IAAtB8B,CAAAA,GAAsB,aAC7B,GAAIA,GAAG,CAACiE,UAAJ,CAAiB,CAArB,CAAwB,CACtB,GAAIC,CAAAA,GAAG,CAAG,CACRC,SAAS,CAAEL,eAAe,CAACM,MADnB,CAERC,SAAS,CAAEjH,UAAU,CAAC,GAAIkH,CAAAA,IAAJ,EAAD,CAAa,YAAb,CAFb,CAGRC,UAAU,CAAEvE,GAAG,CAACwE,QAHR,CAIRC,KAAK,CAAEzE,GAAG,CAACiE,UAJH,CAKRS,QAAQ,CAAE,IALF,CAMRC,iBAAiB,CAAE3E,GAAG,CAAC4E,kBAAJ,CACf5E,GAAG,CAAC4E,kBADW,CAEf,IARI,CASRC,eAAe,CAAE7E,GAAG,CAAC8E,gBAAJ,CAAuB9E,GAAG,CAAC8E,gBAA3B,CAA8C,IATvD,CAURC,eAAe,CAAE/E,GAAG,CAACgF,UAAJ,CAAiBhF,GAAG,CAACgF,UAArB,CAAkC,IAV3C,CAAV,CAYAjB,OAAO,CAACvD,IAAR,CAAa0D,GAAb,EACD,CACF,CAjB4B,qDAmB7B,MAAKpE,KAAL,CACGtC,YADH,qCAEiCJ,UAAU,CACrC,GAAIkH,CAAAA,IAAJ,EADqC,CAErC,YAFqC,CAF3C,uBAKmBR,eAAe,CAACM,MALnC,GAOGrE,IAPH,CAOQ,SAAAkF,GAAG,CAAI,CACX,GAAIA,GAAG,CAAC/E,IAAJ,CAASgD,MAAT,GAAoB,CAAxB,CAA2B,CACzB,MAAKpD,KAAL,CACGpC,eADH,CACmB,2BADnB,CACgDqG,OADhD,EAEGhE,IAFH,CAEQ,SAAAkF,GAAG,CAAI,CACX;AACA,MAAKnF,KAAL,CAAWoF,WAAX,GACD,CALH,EAMD,CAPD,IAOO,CACL,MAAKpF,KAAL,CACGpC,eADH,6CAEyCuH,GAAG,CAACE,OAF7C,EAGIpB,OAHJ,EAKGhE,IALH,CAKQ,SAAAkF,GAAG,CAAI,CACX,MAAKnF,KAAL,CAAWoF,WAAX,GACD,CAPH,EAQD,CACF,CAzBH,EA0BD,CA7CD,IA6CO,CACL,MAAKzF,SAAL,CAAe2F,YAAf,GACD,CACF,CAtbH,8EA2GE,4BAAoB,CAClB,KAAK9E,OAAL,GACD,CA7GH,sBAwbE,iBAAS,iBACP,iBAWI,KAAKrC,KAXT,oCACEoH,SADF,CACEA,SADF,gCACc,EADd,0DAEEnH,aAFF,CAEEA,aAFF,gCAEkB,EAFlB,uBAGEM,aAHF,cAGEA,aAHF,CAIEL,UAJF,cAIEA,UAJF,CAKEgB,OALF,cAKEA,OALF,CAMEG,QANF,cAMEA,QANF,CAOER,eAPF,cAOEA,eAPF,CAQEI,UARF,cAQEA,UARF,CASEK,WATF,cASEA,WATF,CAUEV,iBAVF,cAUEA,iBAVF,CAYA,GAAMT,CAAAA,aAAN,CACED,UADF,CAAMC,aAAN,CAAqBC,eAArB,CACEF,UADF,CAAqBE,eAArB,CAAsCC,eAAtC,CACEH,UADF,CAAsCG,eAAtC,CAAuDC,YAAvD,CACEJ,UADF,CAAuDI,YAAvD,CAEA,GAAMQ,CAAAA,OAAN,CAAoCD,eAApC,CAAMC,OAAN,CAAeE,OAAf,CAAoCH,eAApC,CAAeG,OAAf,CAAwBD,OAAxB,CAAoCF,eAApC,CAAwBE,OAAxB,CACA,GAAMsG,CAAAA,CAAN,CAAY,KAAKxF,KAAjB,CAAMwF,CAAN,CACA,mBACE,2BAAK,SAAS,CAAC,SAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,2BAAK,SAAS,CAAC,kBAAf,eACE,2BAAK,SAAS,CAAC,gDAAf,WADF,cAIE,2BAAK,SAAS,CAAC,UAAf,EAJF,cAKE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,YAAD,EACE,WAAW,CAAE,MADf,CAEE,SAAS,CAAE,IAFb,CAGE,SAAS,CAAC,SAHZ,CAIE,KAAK,CAAC,SAJR,CAKE,OAAO,CAAE,KAAKzB,gBALhB,EADF,CALF,CADF,CADF,cAkBE,2BAAK,SAAS,CAAC,wBAAf,eACE,2BAAK,SAAS,CAAC,kBAAf,eACE,2BAAK,SAAS,CAAC,iBAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,6BAAO,SAAS,CAAC,8CAAjB,EACGyB,CAAC,CAAC,UAAD,CADJ,CADF,cAIE,2BAAK,SAAS,CAAC,aAAf,eACE,oBAAC,WAAD,EACE,KAAK,CAAElH,aADT,CAEE,IAAI,CAAC,eAFP,CAGE,QAAQ,CAAE,KAAKqD,YAHjB,CAIE,QAAQ,KAJV,EADF,CAJF,CADF,cAcE,2BAAK,SAAS,CAAC,QAAf,eACE,6BAAO,SAAS,CAAC,8CAAjB,EACG6D,CAAC,CAAC,aAAD,CADJ,CADF,cAIE,2BAAK,SAAS,CAAC,aAAf,eACE,oBAAC,WAAD,EACE,KAAK,CAAEhH,eADT,CAEE,IAAI,CAAC,iBAFP,CAGE,QAAQ,CAAE,KAAKoD,iBAHjB,CAIE,QAAQ,KAJV,EADF,CAJF,CAdF,CADF,cA6BE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,cAAD,EACE,IAAI,CAAC,UADP,CAEE,QAAQ,CAAE,KAAKY,kBAFjB,CAGE,IAAI,CAAC,SAHP,CAIE,OAAO,CAAEnD,OAJX,CAKE,KAAK,CAAC,MALR,EADF,CA7BF,cAuCE,2BAAK,SAAS,CAAC,iBAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,6BAAO,SAAS,CAAC,mDAAjB,EACGmG,CAAC,CAAC,eAAD,CADJ,CADF,cAIE,2BAAK,SAAS,CAAC,aAAf,eACE,oBAAC,WAAD,EACE,IAAI,CAAC,QADP,CAEE,KAAK,CAAE/G,YAFT,CAGE,IAAI,CAAC,cAHP,CAIE,QAAQ,CAAE,KAAKmD,iBAJjB,CAKE,SAAS,CAAC,YALZ,CAME,GAAG,CAAEpD,eANP,EADF,CAUGC,YAAY,CACT,KAAKkB,SAAL,CAAeE,OAAf,CACE,cADF,CAEEpB,YAFF,wBAGkByD,MAAM,CAAC1D,eAAD,CAHxB,SADS,CAMT,EAhBN,CAJF,CADF,cAwBE,2BAAK,SAAS,CAAC,QAAf,eACE,6BAAO,SAAS,CAAC,mDAAjB,EACGgH,CAAC,CAAC,iBAAD,CADJ,CADF,cAIE,2BAAK,SAAS,CAAC,aAAf,eACE,oBAAC,WAAD,EACE,IAAI,CAAC,QADP,CAEE,KAAK,CAAEjH,eAFT,CAGE,IAAI,CAAC,iBAHP,CAIE,QAAQ,CAAE,KAAKoD,YAJjB,CAKE,SAAS,CAAE,YALb,EADF,CAJF,CAxBF,CAvCF,cA8EE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,cAAD,EACE,IAAI,CAAC,UADP,CAEE,QAAQ,CAAE,KAAKa,kBAFjB,CAGE,IAAI,CAAC,YAHP,CAIE,OAAO,CAAEpD,UAJX,CAKE,KAAK,CAAC,cALR,EADF,CA9EF,CADF,CAlBF,cA4GE,2BAAK,SAAS,CAAC,QAAf,eACE,2BAAK,SAAS,CAAC,uBAAf,eACE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,cAAD,EACE,OAAO,CAAEH,OADX,CAEE,KAAK,CAAC,SAFR,CAGE,IAAI,CAAC,SAHP,CAIE,QAAQ,CAAE,KAAKsC,qBAJjB,EADF,CADF,cASE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,cAAD,EACE,OAAO,CAAErC,OADX,CAEE,KAAK,CAAC,SAFR,CAGE,IAAI,CAAC,SAHP,CAIE,QAAQ,CAAE,KAAKqC,qBAJjB,EADF,CATF,cAiBE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,cAAD,EACE,OAAO,CAAEpC,OADX,CAEE,KAAK,CAAC,SAFR,CAGE,IAAI,CAAC,SAHP,CAIE,QAAQ,CAAE,KAAKoC,qBAJjB,EADF,CAjBF,cAyBE,2BAAK,SAAS,CAAC,UAAf,EAzBF,CADF,CA5GF,cAyIE,2BAAK,SAAS,SAAd,eACE,2BAAK,SAAS,CAAC,uCAAf,eACE,oBAAC,YAAD,EACE,aAAa,CAAElC,OAAO,CAAGN,iBAAH,CAAuBL,aAD/C,CAEE,YAAY,CAAE,KAAK2C,gBAFrB,CAGE,QAAQ,CAAE7B,QAHZ,EAKGpB,aAAa,CAACgF,MAAd,CAAuB,CAAvB,CACChF,aAAa,CAACqH,GAAd,CAAkB,SAAC1E,IAAD,CAAOwB,KAAP,CAAiB,CACjC,mBACE,0BAAI,GAAG,CAAEA,KAAT,eACE,2CACE,2BAAK,SAAS,CAAC,YAAf,EAA6BxB,IAAI,CAAC2E,OAAlC,CADF,CADF,cAIE,2CACE,2BAAK,SAAS,CAAC,WAAf,EAA4B3E,IAAI,CAAC4E,YAAjC,CADF,CAJF,cAOE,2CACE,2BAAK,SAAS,CAAC,WAAf,EAA4B5E,IAAI,CAAC6E,WAAjC,CADF,CAPF,cAUE,2CACE,2BAAK,SAAS,CAAC,YAAf,EAA6B7E,IAAI,CAAC8E,GAAlC,CADF,CAVF,cAaE,2CACE,2BAAK,SAAS,CAAC,YAAf,EAA6B9E,IAAI,CAAC+E,YAAlC,CADF,CAbF,cAgBE,2CACE,2BAAK,SAAS,CAAC,YAAf,EAA6B/E,IAAI,CAACgF,OAAlC,CADF,CAhBF,cAmBE,2CACE,2BAAK,SAAS,CAAC,YAAf,EAA6BhF,IAAI,CAAC2B,WAAlC,CADF,CAnBF,cAsBE,2CACE,2BAAK,SAAS,CAAC,gEAAf,eACE,oBAAC,WAAD,EACE,KAAK,CAAE3B,IAAI,CAACoD,UADd,CAEE,IAAI,CAAC,YAFP,CAGE,QAAQ,CAAE,kBAAAhD,CAAC,QAAI,CAAA,MAAI,CAACmB,eAAL,CAAqBnB,CAArB,CAAwBJ,IAAxB,CAA8BwB,KAA9B,CAAJ,EAHb,CAIE,SAAS,2BAJX,EADF,CAOGxB,IAAI,CAACoD,UAAL,CACG,MAAI,CAACxE,SAAL,CAAeE,OAAf,CACE,YADF,CAEEkB,IAAI,CAACoD,UAFP,wBAGkBjC,MAAM,CAACnB,IAAI,CAAC2B,WAAN,CAHxB,SADH,CAMG,EAbN,CADF,CAtBF,CAuCGrD,OAAO,cACN,2CACE,2BAAK,SAAS,CAAC,+BAAf,eACE,oBAAC,cAAD,EACE,IAAI,CAAC,UADP,CAEE,QAAQ,CAAE,kBAAA8B,CAAC,QACT,CAAA,MAAI,CAACmB,eAAL,CAAqBnB,CAArB,CAAwBJ,IAAxB,CAA8BwB,KAA9B,CADS,EAFb,CAKE,IAAI,CAAC,SALP,CAME,OAAO,CAAExB,IAAI,CAAC0B,OACd;AAPF,EADF,CADF,CADM,CAeN,EAtDJ,cAyDE,2CACE,2BAAK,SAAS,CAAC,WAAf,EAA4B1B,IAAI,CAACiF,YAAjC,CADF,CAzDF,CADF,CA+DD,CAhED,CADD,cAmEC,2CACE,0BAAI,OAAO,CAAC,IAAZ,eACE,2BAAK,SAAS,CAAC,aAAf,YADF,CADF,CAxEJ,CADF,CADF,CAzIF,cA4NE,2BAAK,SAAS,CAAC,wBAAf,eACE,2BAAK,SAAS,CAAC,6BAAf,eACE,2BAAK,SAAS,CAAC,UAAf,eACE,2BAAK,SAAS,CAAC,4BAAf,eACE,oBAAC,YAAD,EACE,OAAO,CAAE,IADX,CAEE,KAAK,CAAC,WAFR,CAGE,SAAS,CAAC,MAHZ,CAIE,OAAO,CAAE,KAAKlC,cAJhB,EADF,CAOGzE,OAAO,cACN,oBAAC,YAAD,EACE,SAAS,CAAE,IADb,CAEE,KAAK,CAAC,YACN;AAHF,CAIE,OAAO,CAAE,KAAK4D,eAJhB,CAKE,SAAS,CAAC,MALZ,EADM,CASN,EAhBJ,CADF,CADF,CADF,CA5NF,CADF,CAwPD,CAjsBH,+BAAuCnG,SAAvC,EAosBA,GAAMmJ,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAA9H,KAAK,QAAK,CAChC+H,gBAAgB,CAAE/H,KAAK,CAACgI,MAAN,CAAaD,gBADC,CAEhClC,eAAe,CAAE7F,KAAK,CAACiI,WAAN,CAAkBpC,eAFH,CAAL,EAA7B,CAKA,GAAMqC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAAC,QAAQ,CAAI,CACrC,MAAO7I,CAAAA,kBAAkB,CACvB,CACE;AACAC,YAAY,CAAZA,YAFF,CAGEC,UAAU,CAAVA,UAHF,CAIEC,eAAe,CAAfA,eAJF,CAKEE,cAAc,CAAdA,cALF,CAMED,eAAe,CAAfA,eANF,CADuB,CASvByI,QATuB,CAAzB,CAWD,CAZD,CAcA,MAAO,IAAMC,CAAAA,YAAY,CAAGxI,eAAe,GACzCP,OAAO,CAACyI,eAAD,CAAkBI,kBAAlB,CAAP,CAA6CnI,iBAA7C,CADyC,CAApC","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  NormalButton,\r\n  NormalInput,\r\n  NormalSelect,\r\n  InputSearch,\r\n  NormalModal,\r\n  TableWrapper,\r\n  NormalCheckbox,\r\n} from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport _ from \"lodash\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonCreateApi,\r\n  commonDeleteApi,\r\n  commonPatchApi,\r\n} from \"redux/actions/common\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\nimport { Toast } from \"service/toast\";\r\n\r\nexport class CombineTopupClass extends Component {\r\n  state = {\r\n    treatmentList: [],\r\n    formFields: {\r\n      customer_name: \"\",\r\n      new_outstanding: \"\",\r\n      old_outstanding: \"\",\r\n      topup_amount: \"\",\r\n    },\r\n    headerDetails: [\r\n      {\r\n        label: \"Date\",\r\n        sortKey: false,\r\n        width: \"120px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      { label: \"Invoice No\", sortKey: false, width: \"120px\" },\r\n      { label: \"Treatment Name\", sortKey: false, width: \"120px\" },\r\n      {\r\n        label: \"Qty\",\r\n        sortKey: false,\r\n        width: \"50px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Total Amount\",\r\n        width: \"120px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Deposit Balance\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Outstanding\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n\r\n      {\r\n        label: \"Pay amount\",\r\n        width: \"60px\",\r\n        divClass: \"justify-content-center\",\r\n      },\r\n      { label: \"Staff\", width: \"120px\" },\r\n    ],\r\n    headerDetailsAuto: [\r\n      {\r\n        label: \"Date\",\r\n        sortKey: false,\r\n        width: \"120px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      { label: \"Invoice No\", sortKey: false, width: \"120px\" },\r\n      { label: \"Treatment Name\", sortKey: false, width: \"120px\" },\r\n      {\r\n        label: \"Qty\",\r\n        sortKey: false,\r\n        width: \"50px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Total Amount\",\r\n        width: \"120px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Deposit Balance\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Outstanding\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n\r\n      {\r\n        label: \"Pay amount\",\r\n        width: \"60px\",\r\n        divClass: \"justify-content-center\",\r\n      },\r\n      {\r\n        label: \"Auto\",\r\n        width: \"50px\",\r\n        divClass: `justify-content-center`,\r\n      },\r\n      { label: \"Staff\", width: \"120px\" },\r\n    ],\r\n    typeofSelection: {\r\n      service: true,\r\n      product: true,\r\n      prepaid: true,\r\n    },\r\n    is_fullpay: false,\r\n    is_auto: false,\r\n    page: 1,\r\n    limit: 10,\r\n    pageMeta: {},\r\n    settingData: {},\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getCart();\r\n  }\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n  };\r\n\r\n  handleItemSettings = () => {\r\n    let { settingData } = this.state;\r\n    this.props.getCommonApi(`userlist/`).then(key => {\r\n      let { status, data } = key;\r\n      console.log(key, \"settingsData appointmentCreate\");\r\n      if (status === 200) {\r\n        settingData = data;\r\n        this.setState({ settingData });\r\n      }\r\n    });\r\n  };\r\n  getCart = () => {\r\n    let { typeofSelection, treatmentList, pageMeta, is_auto, is_fullpay } =\r\n      this.state;\r\n\r\n    try {\r\n      let dataType = [];\r\n\r\n      if (typeofSelection.service) {\r\n        dataType.push(\"service\");\r\n      }\r\n      if (typeofSelection.prepaid) {\r\n        dataType.push(\"prepaid\");\r\n      }\r\n      if (typeofSelection.product) {\r\n        dataType.push(\"product\");\r\n      }\r\n\r\n      this.props\r\n        .getCommonApi(\r\n          `topupcombinedlist/?cust_id=${this.props.id}&type=${dataType}`\r\n        )\r\n        .then(async key => {\r\n          let { status, data } = key;\r\n\r\n          if (status === 200) {\r\n            treatmentList = [];\r\n            await this.setState({ treatmentList });\r\n            this.getDataFromRes(key);\r\n            if (data) {\r\n              if (data.dataList) {\r\n                data.dataList.forEach(item => {\r\n                  let itemData = item;\r\n                  itemData[\"Autokey\"] = false;\r\n                  treatmentList.push(itemData);\r\n                });\r\n                pageMeta = data.meta.pagination;\r\n                is_auto = false;\r\n                is_fullpay = false;\r\n                this.setState({ treatmentList, pageMeta, is_auto, is_fullpay });\r\n              }\r\n            }\r\n          }\r\n        });\r\n    } catch (e) {\r\n      console.log(e, \"topupgetcombinelog\");\r\n    }\r\n  };\r\n\r\n  getDataFromRes = data => {\r\n    let { header_data } = data;\r\n    let { formFields } = this.state;\r\n    formFields[\"customer_name\"] = header_data ? header_data.customer_name : \"\";\r\n    formFields[\"new_outstanding\"] = header_data\r\n      ? header_data.new_outstanding\r\n      : \"\";\r\n    formFields[\"old_outstanding\"] = header_data\r\n      ? header_data.old_outstanding\r\n      : \"\";\r\n    formFields[\"topup_amount\"] = header_data ? header_data.topup_amount : \"\";\r\n    this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n  handlePagination = async pageNo => {\r\n    let { page } = this.state;\r\n    page = pageNo.page;\r\n    await this.setState({\r\n      page,\r\n    });\r\n    this.getCart();\r\n  };\r\n  handlechangeSelection = async e => {\r\n    let { typeofSelection } = this.state;\r\n    typeofSelection[e.target.name] = e.target.value;\r\n    await this.setState({\r\n      typeofSelection,\r\n    });\r\n    this.getCart();\r\n  };\r\n\r\n  handleChange = e => {\r\n    let { formFields } = this.state;\r\n    formFields[e.target.name] = e.target.value;\r\n    this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n\r\n  handleTopupChange = async event => {\r\n    // event.persist();\r\n    let { formFields } = this.state;\r\n    formFields.topup_amount = event.target.value;\r\n    await this.setState({ formFields });\r\n    if (!this.debouncedFn) {\r\n      this.debouncedFn = _.debounce(async () => {\r\n        this.search();\r\n      }, 500);\r\n    }\r\n    this.debouncedFn();\r\n  };\r\n\r\n  search = () => {\r\n    let { formFields } = this.state;\r\n    let old_outstand = Number(formFields.old_outstanding);\r\n    let topup = Number(formFields.topup_amount);\r\n    if (topup <= old_outstand) {\r\n      formFields[\"new_outstanding\"] = Number(old_outstand - topup).toFixed(2);\r\n      this.setState({\r\n        formFields,\r\n      });\r\n    } else {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"The topup amount may not be greater than outstanding\",\r\n      });\r\n    }\r\n  };\r\n\r\n  handlePayAmount = (event, data, index) => {\r\n    let { treatmentList } = this.state;\r\n    treatmentList[index][event.target.name] = event.target.value;\r\n    this.setState({\r\n      treatmentList,\r\n    });\r\n  };\r\n\r\n  handleCommonChange = async e => {\r\n    let { treatmentList, is_auto } = this.state;\r\n    this.setState({\r\n      [e.target.name]: e.target.value,\r\n    });\r\n\r\n    if ([e.target.name] == \"is_auto\") {\r\n      treatmentList.forEach(item => {\r\n        {\r\n          e.target.value == true\r\n            ? (item[\"Autokey\"] = true)\r\n            : (item[\"Autokey\"] = false);\r\n        }\r\n      });\r\n      await this.setState({\r\n        treatmentList,\r\n      });\r\n    } else if ([e.target.name] == \"is_fullpay\") {\r\n      let { formFields } = this.state;\r\n      let topup = 0;\r\n      if (is_auto) {\r\n        treatmentList.forEach(item => {\r\n          if (item.Autokey) {\r\n            item[\"pay_amount\"] = item.outstanding;\r\n            topup += Number(item.outstanding);\r\n          }\r\n        });\r\n        await this.setState({\r\n          treatmentList,\r\n        });\r\n        formFields[\"topup_amount\"] = Number(topup).toFixed(2);\r\n        formFields[\"new_outstanding\"] = Number(\r\n          formFields.old_outstanding - topup\r\n        ).toFixed(2);\r\n        await this.setState({\r\n          formFields,\r\n        });\r\n      } else {\r\n        treatmentList.forEach(item => {\r\n          item[\"pay_amount\"] = item.outstanding;\r\n        });\r\n        await this.setState({\r\n          treatmentList,\r\n        });\r\n        formFields[\"new_outstanding\"] = 0;\r\n        formFields[\"topup_amount\"] = formFields.old_outstanding;\r\n        await this.setState({\r\n          formFields,\r\n        });\r\n      }\r\n    }\r\n  };\r\n  ParseFloatUpdate = (str, val) => {\r\n    str = str.toString();\r\n    str = str.slice(0, str.indexOf(\".\") + val + 1);\r\n    return Number(str);\r\n  };\r\n\r\n  handleAutoMatch = async () => {\r\n    let { treatmentList, formFields } = this.state;\r\n    try {\r\n      if (formFields.topup_amount > 0) {\r\n        let checkedCount = treatmentList.filter(\r\n          item => item.Autokey == true\r\n        ).length;\r\n        let SelectedTotalOutstanding = 0;\r\n\r\n        treatmentList.forEach(item => {\r\n          if (item.Autokey) {\r\n            SelectedTotalOutstanding += Number(item.outstanding);\r\n          }\r\n        });\r\n\r\n        let recordCount = 0;\r\n        let UpdatedTotalOutstanding = 0;\r\n        treatmentList.forEach(item => {\r\n          if (item.Autokey) {\r\n            recordCount++;\r\n            if (recordCount == checkedCount) {\r\n              let otherrowTotal = this.ParseFloatUpdate(\r\n                UpdatedTotalOutstanding,\r\n                2\r\n              );\r\n\r\n              let linePay = Number(formFields.topup_amount - otherrowTotal);\r\n              let tot = Number(linePay) + Number(otherrowTotal);\r\n              let difference = formFields.topup_amount - tot;\r\n              let final = linePay + difference;\r\n              item[\"pay_amount\"] = this.ParseFloatUpdate(final, 2);\r\n            } else {\r\n              let findPercentage =\r\n                Number(formFields.topup_amount / SelectedTotalOutstanding) *\r\n                100;\r\n              let linePay = (Number(findPercentage) / 100) * item.outstanding;\r\n              UpdatedTotalOutstanding += this.ParseFloatUpdate(linePay, 2);\r\n              item[\"pay_amount\"] = this.ParseFloatUpdate(linePay, 2);\r\n            }\r\n          }\r\n        });\r\n        await this.setState({\r\n          treatmentList,\r\n        });\r\n      } else {\r\n        Toast({\r\n          type: \"error\",\r\n          message: \"Please enter valid Top up amount\",\r\n        });\r\n      }\r\n    } catch (e) {\r\n      console.log(e, \"catchlogautomatch\");\r\n    }\r\n  };\r\n  handleClearAll = async () => {\r\n    let { formFields, treatmentList } = this.state;\r\n    formFields[\"topup_amount\"] = 0;\r\n    formFields[\"new_outstanding\"] = formFields.old_outstanding;\r\n    await this.setState({\r\n      is_fullpay: false,\r\n      formFields,\r\n    });\r\n    treatmentList.forEach(item => {\r\n      item[\"pay_amount\"] = 0;\r\n    });\r\n    await this.setState({\r\n      treatmentList,\r\n    });\r\n  };\r\n\r\n  handleCreateCart = () => {\r\n    let { basicApptDetail } = this.props;\r\n    let { treatmentList } = this.state;\r\n    let payload = [];\r\n    if (this.validator.allValid()) {\r\n      for (let key of treatmentList) {\r\n        if (key.pay_amount > 0) {\r\n          let obj = {\r\n            cust_noid: basicApptDetail.custId,\r\n            cart_date: dateFormat(new Date(), \"yyyy-mm-dd\"),\r\n            itemcodeid: key.stock_id,\r\n            price: key.pay_amount,\r\n            item_uom: null,\r\n            treatment_account: key.TreatmentAccountid\r\n              ? key.TreatmentAccountid\r\n              : null,\r\n            deposit_account: key.DepositAccountid ? key.DepositAccountid : null,\r\n            prepaid_account: key.prepaid_id ? key.prepaid_id : null,\r\n          };\r\n          payload.push(obj);\r\n        }\r\n      }\r\n\r\n      this.props\r\n        .getCommonApi(\r\n          `itemcart/Check/?cart_date=${dateFormat(\r\n            new Date(),\r\n            \"yyyy-mm-dd\"\r\n          )}&cust_noid=${basicApptDetail.custId}`\r\n        )\r\n        .then(res => {\r\n          if (res.data.length === 0) {\r\n            this.props\r\n              .commonCreateApi(\"itemcart/TopUpCartCreate/\", payload)\r\n              .then(res => {\r\n                // this.props.handleCartCreated()\r\n                this.props.handleModal();\r\n              });\r\n          } else {\r\n            this.props\r\n              .commonCreateApi(\r\n                `itemcart/TopUpCartCreate/?cart_id=${res.cart_id}`,\r\n                payload\r\n              )\r\n              .then(res => {\r\n                this.props.handleModal();\r\n              });\r\n          }\r\n        });\r\n    } else {\r\n      this.validator.showMessages();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      workpoint = \"\",\r\n      treatmentList = [],\r\n      headerDetails,\r\n      formFields,\r\n      is_auto,\r\n      pageMeta,\r\n      typeofSelection,\r\n      is_fullpay,\r\n      settingData,\r\n      headerDetailsAuto,\r\n    } = this.state;\r\n    let { customer_name, new_outstanding, old_outstanding, topup_amount } =\r\n      formFields;\r\n    let { service, prepaid, product } = typeofSelection;\r\n    let { t } = this.props;\r\n    return (\r\n      <div className=\"row p-3\">\r\n        <div className=\"col-12 mb-2\">\r\n          <div className=\"d-flex flex-wrap\">\r\n            <div className=\"col-md-6 col-12 fw-500 fs-18 text-left p-0 m-0\">\r\n              Top Up\r\n            </div>\r\n            <div className=\"col-md-4\"></div>\r\n            <div className=\"col-md-2 col-12\">\r\n              <NormalButton\r\n                buttonClass={\"mx-2\"}\r\n                submitBtn={true}\r\n                className=\"confirm\"\r\n                label=\"Confirm\"\r\n                onClick={this.handleCreateCart}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 new-cart top-up\">\r\n          <div className=\"d-flex flex-wrap\">\r\n            <div className=\"col-md-5 col-12\">\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text\">\r\n                  {t(\"Customer\")}\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalInput\r\n                    value={customer_name}\r\n                    name=\"customer_name\"\r\n                    onChange={this.handleChange}\r\n                    disabled\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"d-flex\">\r\n                <label className=\"text-left w-100 text-black common-label-text\">\r\n                  {t(\"Outstanding\")}\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalInput\r\n                    value={old_outstanding}\r\n                    name=\"old_outstanding\"\r\n                    onChange={this.handleTopupChange}\r\n                    disabled\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-md-1 col-12\">\r\n              <NormalCheckbox\r\n                type=\"checkbox\"\r\n                onChange={this.handleCommonChange}\r\n                name=\"is_auto\"\r\n                checked={is_auto}\r\n                label=\"Auto\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"col-md-4 col-12\">\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n                  {t(\"Top Up Amount\")}\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalInput\r\n                    type=\"number\"\r\n                    value={topup_amount}\r\n                    name=\"topup_amount\"\r\n                    onChange={this.handleTopupChange}\r\n                    className=\"text-right\"\r\n                    max={old_outstanding}\r\n                  />\r\n\r\n                  {topup_amount\r\n                    ? this.validator.message(\r\n                        \"topup_amount\",\r\n                        topup_amount,\r\n                        `required|max:${Number(old_outstanding)},num`\r\n                      )\r\n                    : \"\"}\r\n                </div>\r\n              </div>\r\n              <div className=\"d-flex\">\r\n                <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n                  {t(\"New Outstanding\")}\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalInput\r\n                    type=\"number\"\r\n                    value={new_outstanding}\r\n                    name=\"new_outstanding\"\r\n                    onChange={this.handleChange}\r\n                    className={\"text-right\"}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-md-2 col-12\">\r\n              <NormalCheckbox\r\n                type=\"checkbox\"\r\n                onChange={this.handleCommonChange}\r\n                name=\"is_fullpay\"\r\n                checked={is_fullpay}\r\n                label=\"Full payment\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12\">\r\n          <div className=\"d-flex flex-wrap mt-2\">\r\n            <div className=\"col-md-1 col-12\">\r\n              <NormalCheckbox\r\n                checked={service}\r\n                label=\"service\"\r\n                name=\"service\"\r\n                onChange={this.handlechangeSelection}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-1 col-12\">\r\n              <NormalCheckbox\r\n                checked={product}\r\n                label=\"product\"\r\n                name=\"product\"\r\n                onChange={this.handlechangeSelection}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-1 col-12\">\r\n              <NormalCheckbox\r\n                checked={prepaid}\r\n                label=\"prepaid\"\r\n                name=\"prepaid\"\r\n                onChange={this.handlechangeSelection}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-9\"></div>\r\n          </div>\r\n        </div>\r\n        <div className={`col-12`}>\r\n          <div className=\"table-container table-responsive mt-3\">\r\n            <TableWrapper\r\n              headerDetails={is_auto ? headerDetailsAuto : headerDetails}\r\n              queryHandler={this.handlePagination}\r\n              pageMeta={pageMeta}\r\n            >\r\n              {treatmentList.length > 0 ? (\r\n                treatmentList.map((item, index) => {\r\n                  return (\r\n                    <tr key={index}>\r\n                      <td>\r\n                        <div className=\"text-right\">{item.sa_date}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-left\">{item.sa_transacno}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-left\">{item.description}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-right\">{item.qty}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-right\">{item.total_amount}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-right\">{item.balance}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"text-right\">{item.outstanding}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"d-flex align-items-center payment-input justify-content-center\">\r\n                          <NormalInput\r\n                            value={item.pay_amount}\r\n                            name=\"pay_amount\"\r\n                            onChange={e => this.handlePayAmount(e, item, index)}\r\n                            className={`customer-name text-right`}\r\n                          />\r\n                          {item.pay_amount\r\n                            ? this.validator.message(\r\n                                \"pay_amount\",\r\n                                item.pay_amount,\r\n                                `required|max:${Number(item.outstanding)},num`\r\n                              )\r\n                            : \"\"}\r\n                        </div>\r\n                      </td>\r\n                      {is_auto ? (\r\n                        <td>\r\n                          <div className=\"d-flex justify-content-center\">\r\n                            <NormalCheckbox\r\n                              type=\"checkbox\"\r\n                              onChange={e =>\r\n                                this.handlePayAmount(e, item, index)\r\n                              }\r\n                              name=\"Autokey\"\r\n                              checked={item.Autokey}\r\n                              //disabled={is_auto ? false : true}\r\n                            />\r\n                          </div>\r\n                        </td>\r\n                      ) : (\r\n                        \"\"\r\n                      )}\r\n\r\n                      <td>\r\n                        <div className=\"text-left\">{item.sa_staffname}</div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })\r\n              ) : (\r\n                <tr>\r\n                  <td colSpan=\"12\">\r\n                    <div className=\"text-center\">No data</div>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </TableWrapper>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 pt-4 action-bar\">\r\n          <div className=\"d-flex  justify-content-end\">\r\n            <div className=\"col-md-5\">\r\n              <div className=\"d-flex justify-content-end\">\r\n                <NormalButton\r\n                  resetbg={true}\r\n                  label=\"Clear All\"\r\n                  className=\"mr-2\"\r\n                  onClick={this.handleClearAll}\r\n                />\r\n                {is_auto ? (\r\n                  <NormalButton\r\n                    mainbgrev={true}\r\n                    label=\"Auto Match\"\r\n                    // disabled={is_auto ? false : true}\r\n                    onClick={this.handleAutoMatch}\r\n                    className=\"ml-2\"\r\n                  />\r\n                ) : (\r\n                  \"\"\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      // getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonCreateApi,\r\n      commonPatchApi,\r\n      commonDeleteApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const CombineTopup = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(CombineTopupClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}