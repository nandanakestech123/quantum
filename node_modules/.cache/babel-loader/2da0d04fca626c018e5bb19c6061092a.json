{"ast":null,"code":"var _jsxFileName = \"E:\\\\newfrontend\\\\webfe\\\\src\\\\component\\\\Admin\\\\Cart\\\\cart\\\\discount.js\";\nimport React, { Component } from \"react\";\nimport \"./style.scss\";\nimport { NormalButton, NormalInput, NormalSelect, NormalTextarea } from \"component/common\";\nimport { dateFormat } from \"service/helperFunctions\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { getCommonApi, updateForm, commonUpdateApi, commonCreateApi } from \"redux/actions/common\";\nimport SimpleReactValidator from \"simple-react-validator\";\nexport class DiscountClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      cartData: {},\n      discountFields: {\n        discount: 0,\n        discount_amt: 0,\n        disc_reason: \"\",\n        discreason_txt: null\n      },\n      discountReasonList: []\n    };\n\n    this.componentWillMount = async () => {\n      // this.getCart();\n      console.log(this.props, \"propsssssssssss\");\n      this.validator = new SimpleReactValidator({\n        element: message => /*#__PURE__*/React.createElement(\"span\", {\n          className: \"error-message text-danger validNo fs14\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 9\n          }\n        }, message),\n        autoForceUpdate: this\n      });\n      await this.setState({\n        cartData: this.props.cartData\n      });\n      this.getDropdownData();\n      this.getDataFromStore(this.props.cartData);\n    };\n\n    this.getDataFromStore = data => {\n      let {\n        discountFields\n      } = this.state;\n      console.log(\"fsdfgdfydfdfsg\", data, this.props);\n      discountFields[\"discount\"] = data.discpercent;\n      discountFields[\"discount_amt\"] = data.discountamt;\n      discountFields[\"disc_reason\"] = data.discount_reason;\n      discountFields[\"discreason_txt\"] = data.discreason_txt;\n      this.setState({\n        discountFields\n      });\n    };\n\n    this.getDropdownData = () => {\n      let {\n        discountReasonList\n      } = this.state;\n      this.props.getCommonApi(`paymentremarks/`).then(key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status === 200) {\n          for (let value of data) {\n            discountReasonList.push({\n              value: value.id,\n              label: value.r_desc\n            });\n          }\n\n          this.setState({\n            discountReasonList\n          });\n        }\n      });\n    };\n\n    this.getDateTime = data => {\n      let date = new Date(data);\n      date = String(date).split(\" \");\n      let date1 = date[2] + \"th \" + date[1] + \", \" + date[3];\n      let time = date[4].split(\":\");\n      let time1 = String(Number(time[0]) > 12 ? Number(time[0]) - 12 : time[0]) + \":\" + time[1] + (Number(time[0]) > 12 ? \"PM\" : \"AM\");\n      return time1 + \", \" + date1;\n    };\n\n    this.handleChangeDisc = async ({\n      target: {\n        value,\n        name\n      }\n    }) => {\n      let {\n        discountFields,\n        cartData\n      } = this.state;\n      discountFields[name] = value;\n\n      if (name === \"discount\") {\n        discountFields[\"discount_amt\"] = Number(this.props.discount_price / 100 * value).toFixed(2);\n      }\n\n      if (name === \"discount_amt\") {\n        // discountFields['discount'] = (value/formFields['price'])*100\n        discountFields[\"discount\"] = 0;\n      }\n\n      if (name === \"discount\" && Number(value) !== 182) {\n        discountFields[\"discreason_txt\"] = \"\";\n        this.setState({\n          discountFields\n        });\n      }\n\n      await this.setState({\n        discountFields\n      }); // this.props.updateForm('customerDetail', formFields)\n      // await this.props.updateForm('appointmentCustomerDetail', formFields)\n    };\n\n    this.handleUpdateDisc = async () => {\n      let {\n        discountFields\n      } = this.state;\n\n      if (this.validator.allValid()) {\n        // discountFields['discount'] = discountFields['discount'];\n        discountFields[\"discount_amt\"] = parseFloat(discountFields[\"discount_amt\"]).toFixed(2);\n        await this.setState({\n          discountFields\n        });\n        this.props.commonUpdateApi(`itemcart/${this.props.id}/?disc_add=1&disc_reset=0`, discountFields).then(key => {\n          let {\n            status,\n            data\n          } = key;\n          this.props.handleRefresh();\n        });\n      } else {\n        this.validator.showMessages();\n      }\n    };\n\n    this.handleResetDisc = async () => {\n      let {\n        discountFields\n      } = this.state;\n      await this.setState({\n        discountFields\n      });\n      this.props.commonUpdateApi(`itemcart/${this.props.id}/?disc_add=0&disc_reset=1`, discountFields).then(key => {\n        let {\n          status,\n          data\n        } = key;\n        this.props.handleRefresh();\n      });\n    };\n  }\n\n  render() {\n    let {\n      discountFields\n    } = this.state;\n    let {\n      discountReasonList\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row discount\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left text-black common-label-text \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }, \"Discount %\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group mb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput // placeholder=\"Enter here\"\n    // options={siteList}\n    , {\n      value: discountFields.discount,\n      name: \"discount\",\n      onChange: this.handleChangeDisc,\n      className: \"customer-name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }), this.validator.message(\"discount percentage\", discountFields.discount, \"required\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left text-black common-label-text \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 11\n      }\n    }, \"Discount amount\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group mb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput // placeholder=\"Enter here\"\n    // options={siteList}\n    , {\n      value: discountFields.discount_amt,\n      name: \"discount_amt\",\n      onChange: this.handleChangeDisc,\n      className: \"customer-name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 13\n      }\n    }), this.validator.message(\"discount amount\", discountFields.discount_amt, \"required\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left text-black common-label-text \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 11\n      }\n    }, \"Discount reason\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group mb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(NormalSelect // placeholder=\"Enter here\"\n    , {\n      options: discountReasonList,\n      value: discountFields.disc_reason,\n      name: \"disc_reason\",\n      onChange: this.handleChangeDisc,\n      className: \"customer-name py-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 13\n      }\n    }), this.validator.message(\"discount reason\", discountFields.disc_reason, \"required\"))), discountFields.disc_reason == \"182\" ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left text-black common-label-text \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 13\n      }\n    }, \"Discount reason\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group mb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalTextarea // placeholder=\"Enter here\"\n    // options={discountReasonList}\n    , {\n      value: discountFields.discreason_txt,\n      name: \"discreason_txt\",\n      onChange: this.handleChangeDisc,\n      className: \"customer-name py-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 15\n      }\n    }), this.validator.message(\"discount reason\", discountFields.discreason_txt, \"required\"))) : \"\", /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-12 text-center d-flex apply\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(NormalButton, {\n      buttonClass: \"mx-2\",\n      mainbg: false,\n      className: \" fs-15 confirm\",\n      label: \"Apply\",\n      outline: false,\n      onClick: this.handleUpdateDisc,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(NormalButton, {\n      buttonClass: \"mx-2\",\n      mainbg: true,\n      className: \" fs-15 reset\",\n      label: \"Reset\",\n      outline: false,\n      onClick: this.handleResetDisc,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  selected_cstomer: state.common.selected_cstomer,\n  basicApptDetail: state.appointment.basicApptDetail\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    // getCustomer,\n    getCommonApi,\n    updateForm,\n    commonUpdateApi,\n    commonCreateApi\n  }, dispatch);\n};\n\nexport const Discount = connect(mapStateToProps, mapDispatchToProps)(DiscountClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/cart/discount.js"],"names":["React","Component","NormalButton","NormalInput","NormalSelect","NormalTextarea","dateFormat","connect","bindActionCreators","getCommonApi","updateForm","commonUpdateApi","commonCreateApi","SimpleReactValidator","DiscountClass","state","cartData","discountFields","discount","discount_amt","disc_reason","discreason_txt","discountReasonList","componentWillMount","console","log","props","validator","element","message","autoForceUpdate","setState","getDropdownData","getDataFromStore","data","discpercent","discountamt","discount_reason","then","key","status","value","push","id","label","r_desc","getDateTime","date","Date","String","split","date1","time","time1","Number","handleChangeDisc","target","name","discount_price","toFixed","handleUpdateDisc","allValid","parseFloat","handleRefresh","showMessages","handleResetDisc","render","mapStateToProps","selected_cstomer","common","basicApptDetail","appointment","mapDispatchToProps","dispatch","Discount"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport {\r\n  NormalButton,\r\n  NormalInput,\r\n  NormalSelect,\r\n  NormalTextarea,\r\n} from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonUpdateApi,\r\n  commonCreateApi,\r\n} from \"redux/actions/common\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\n\r\nexport class DiscountClass extends Component {\r\n  state = {\r\n    cartData: {},\r\n    discountFields: {\r\n      discount: 0,\r\n      discount_amt: 0,\r\n      disc_reason: \"\",\r\n      discreason_txt: null,\r\n    },\r\n    discountReasonList: [],\r\n  };\r\n\r\n  componentWillMount = async () => {\r\n    // this.getCart();\r\n    console.log(this.props, \"propsssssssssss\");\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n    await this.setState({\r\n      cartData: this.props.cartData,\r\n    });\r\n    this.getDropdownData();\r\n\r\n    this.getDataFromStore(this.props.cartData);\r\n  };\r\n\r\n  getDataFromStore = data => {\r\n    let { discountFields } = this.state;\r\n    console.log(\"fsdfgdfydfdfsg\", data, this.props);\r\n    discountFields[\"discount\"] = data.discpercent;\r\n    discountFields[\"discount_amt\"] = data.discountamt;\r\n    discountFields[\"disc_reason\"] = data.discount_reason;\r\n    discountFields[\"discreason_txt\"] = data.discreason_txt;\r\n    this.setState({\r\n      discountFields,\r\n    });\r\n  };\r\n\r\n  getDropdownData = () => {\r\n    let { discountReasonList } = this.state;\r\n\r\n    this.props.getCommonApi(`paymentremarks/`).then(key => {\r\n      let { status, data } = key;\r\n      if (status === 200) {\r\n        for (let value of data) {\r\n          discountReasonList.push({ value: value.id, label: value.r_desc });\r\n        }\r\n        this.setState({ discountReasonList });\r\n      }\r\n    });\r\n  };\r\n\r\n  getDateTime = data => {\r\n    let date = new Date(data);\r\n    date = String(date).split(\" \");\r\n    let date1 = date[2] + \"th \" + date[1] + \", \" + date[3];\r\n    let time = date[4].split(\":\");\r\n    let time1 =\r\n      String(Number(time[0]) > 12 ? Number(time[0]) - 12 : time[0]) +\r\n      \":\" +\r\n      time[1] +\r\n      (Number(time[0]) > 12 ? \"PM\" : \"AM\");\r\n    return time1 + \", \" + date1;\r\n  };\r\n\r\n  handleChangeDisc = async ({ target: { value, name } }) => {\r\n    let { discountFields, cartData } = this.state;\r\n    discountFields[name] = value;\r\n    if (name === \"discount\") {\r\n      discountFields[\"discount_amt\"] = Number(\r\n        (this.props.discount_price / 100) * value\r\n      ).toFixed(2);\r\n    }\r\n    if (name === \"discount_amt\") {\r\n      // discountFields['discount'] = (value/formFields['price'])*100\r\n      discountFields[\"discount\"] = 0;\r\n    }\r\n    if (name === \"discount\" && Number(value) !== 182) {\r\n      discountFields[\"discreason_txt\"] = \"\";\r\n      this.setState({\r\n        discountFields,\r\n      });\r\n    }\r\n    await this.setState({\r\n      discountFields,\r\n    });\r\n    // this.props.updateForm('customerDetail', formFields)\r\n    // await this.props.updateForm('appointmentCustomerDetail', formFields)\r\n  };\r\n\r\n  handleUpdateDisc = async () => {\r\n    let { discountFields } = this.state;\r\n\r\n    if (this.validator.allValid()) {\r\n      // discountFields['discount'] = discountFields['discount'];\r\n      discountFields[\"discount_amt\"] = parseFloat(\r\n        discountFields[\"discount_amt\"]\r\n      ).toFixed(2);\r\n      await this.setState({ discountFields });\r\n      this.props\r\n        .commonUpdateApi(\r\n          `itemcart/${this.props.id}/?disc_add=1&disc_reset=0`,\r\n          discountFields\r\n        )\r\n        .then(key => {\r\n          let { status, data } = key;\r\n          this.props.handleRefresh();\r\n        });\r\n    } else {\r\n      this.validator.showMessages();\r\n    }\r\n  };\r\n\r\n  handleResetDisc = async () => {\r\n    let { discountFields } = this.state;\r\n    await this.setState({ discountFields });\r\n\r\n    this.props\r\n      .commonUpdateApi(\r\n        `itemcart/${this.props.id}/?disc_add=0&disc_reset=1`,\r\n        discountFields\r\n      )\r\n      .then(key => {\r\n        let { status, data } = key;\r\n        this.props.handleRefresh();\r\n      });\r\n  };\r\n\r\n  render() {\r\n    let { discountFields } = this.state;\r\n    let { discountReasonList } = this.state;\r\n    return (\r\n      <div className=\"row discount\">\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount %\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalInput\r\n              // placeholder=\"Enter here\"\r\n              // options={siteList}\r\n              value={discountFields.discount}\r\n              name=\"discount\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount percentage\",\r\n              discountFields.discount,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount amount\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalInput\r\n              // placeholder=\"Enter here\"\r\n              // options={siteList}\r\n              value={discountFields.discount_amt}\r\n              name=\"discount_amt\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount amount\",\r\n              discountFields.discount_amt,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount reason\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalSelect\r\n              // placeholder=\"Enter here\"\r\n              options={discountReasonList}\r\n              value={discountFields.disc_reason}\r\n              name=\"disc_reason\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name py-0\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount reason\",\r\n              discountFields.disc_reason,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        {discountFields.disc_reason == \"182\" ? (\r\n          <div className=\"col-12\">\r\n            <label className=\"text-left text-black common-label-text \">\r\n              Discount reason\r\n            </label>\r\n            <div className=\"input-group mb-2\">\r\n              <NormalTextarea\r\n                // placeholder=\"Enter here\"\r\n                // options={discountReasonList}\r\n                value={discountFields.discreason_txt}\r\n                name=\"discreason_txt\"\r\n                onChange={this.handleChangeDisc}\r\n                className=\"customer-name py-0\"\r\n              />\r\n              {this.validator.message(\r\n                \"discount reason\",\r\n                discountFields.discreason_txt,\r\n                \"required\"\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n        <div className=\"col-12 text-center d-flex apply\">\r\n          <NormalButton\r\n            buttonClass={\"mx-2\"}\r\n            mainbg={false}\r\n            className=\" fs-15 confirm\"\r\n            label=\"Apply\"\r\n            outline={false}\r\n            onClick={this.handleUpdateDisc}\r\n          />\r\n\r\n          <NormalButton\r\n            buttonClass={\"mx-2\"}\r\n            mainbg={true}\r\n            className=\" fs-15 reset\"\r\n            label=\"Reset\"\r\n            outline={false}\r\n            onClick={this.handleResetDisc}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      // getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonUpdateApi,\r\n      commonCreateApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Discount = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(DiscountClass);\r\n"]},"metadata":{},"sourceType":"module"}