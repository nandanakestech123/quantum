{"ast":null,"code":"var _jsxFileName = \"E:\\\\newfrontend\\\\webfe\\\\src\\\\component\\\\Admin\\\\Appointment\\\\ListAppointment\\\\Scheduler\\\\index.js\";\nimport React, { Component } from 'react';\nimport { SchedulerModal } from 'component/common/Plugins'; // import BigSchedulerModal from 'component/common/Plugins/BigScheduler';\n\nimport { NormalInput, NormalSelect, NormalButton, NormalDate, NormalModal } from 'component/common';\nimport { getCustomer, getCommonApi, commonDeleteApi } from 'redux/actions/common';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from \"redux\"; // import timeOption from 'data/timeOption.json'\n\nimport { dateFormat } from 'service/helperFunctions';\nimport { history } from 'helpers';\nimport './style.scss';\nimport SimpleReactValidator from 'simple-react-validator';\nimport { CreateAppointment, updateForm } from 'redux/actions/appointment';\nconst data = [{\n  start_date: '2020-06-09 4:00',\n  end_date: '2020-06-09 6:00',\n  text: 'Event 1',\n  id: 1\n}, {\n  start_date: '2020-06-11 8:00',\n  end_date: '2020-06-11 10:00',\n  text: 'Event 2',\n  id: 2\n}, {\n  start_date: '2020-06-12 12:00',\n  end_date: '2018-06-12 14:00',\n  text: 'dblclick me!',\n  id: 3\n}];\nexport class SchedulerClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      appointment: [{\n        time: '10.00 AM,',\n        date: 'Wednesday, 1st April, 2020',\n        name: 'Benjamin',\n        treatment: 'Head Massage'\n      }, {\n        time: '12.00 PM,',\n        date: 'Wednesday, 1st April, 2020',\n        name: 'Daniel',\n        treatment: 'Pedicure'\n      }, {\n        time: '1.00 PM,',\n        date: 'Wednesday, 1st April, 2020',\n        name: 'John',\n        treatment: 'Haircut'\n      }, {\n        time: '2.00 PM,',\n        date: 'Wednesday, 1st April, 2020',\n        name: 'Josua',\n        treatment: 'Manicure'\n      }, {\n        time: '4.00 PM, ',\n        date: 'Wednesday, 1st April, 2020',\n        name: 'Derrik',\n        treatment: 'Body Massage'\n      }],\n      events: [// {\n        //     \"start_date\": \"2021-01-06 3:30\",\n        //     \"end_date\": \"2021-01-06 5:00\",\n        //     \"text\": \"Korean Anti Aging\",\n        //     \"id\": 199787,\n        //     \"user_id\": 171,\n        //     \"status\": \"Booking\",\n        //     \"color\": \"#f0b5ec\",\n        //     \"title\": \"divya test\",\n        //     \"staff_name\": \"HAN HAI YAN\"\n        // }\n      ],\n      brachList: [],\n      formField: {\n        branchId: \"\",\n        time: \"\"\n      },\n      list: [],\n      filterDate: new Date(),\n      filterType: 'day',\n      selectedId: \"\"\n    };\n\n    this.componentWillMount = () => {\n      this.validator = new SimpleReactValidator({\n        element: message => /*#__PURE__*/React.createElement(\"span\", {\n          className: \"error-message text-danger validNo fs14\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 33\n          }\n        }, message),\n        autoForceUpdate: this\n      });\n      let {\n        brachList,\n        appointment,\n        formField,\n        filterDate\n      } = this.state;\n      this.props.getCommonApi(`treatment/Outlet/`).then(key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status === 200) {\n          for (let value of data) {\n            brachList.push({\n              value: value.id,\n              label: value.itemsite_desc\n            });\n          }\n\n          this.setState({\n            brachList\n          }); // console.log(brachList, \"jhksdfkjsdhfks\")\n        }\n      });\n      this.getAvailability();\n      this.getAppointment();\n    };\n\n    this.getAvailability = () => {\n      let {\n        filterDate\n      } = this.state;\n      this.props.getCommonApi(`staffsavailable/?Appt_date=${dateFormat(filterDate, \"yyyy-mm-dd\")}`).then(key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status === 200) {\n          // for (let value of data) {\n          //     staffList.push({ value: value.id, label: value.emp_name })\n          // }\n          this.setState({\n            list: data\n          });\n        }\n      });\n    };\n\n    this.handleAppointmentOpen = (id, e) => {\n      console.log(e, id, \"hgjsydfisuyfsdfm ==== handleAppointmentOpen\");\n    };\n\n    this.getHoursFromDate = date => {\n      let hour = date.getHours();\n      let minute = date.getMinutes();\n      let hours = hour > 9 ? hour : \"0\" + hour;\n      let minutes;\n\n      if (minute < 15) {\n        minutes = \"00\";\n      } else if (minute >= 15 && minute < 30) {\n        minutes = \"15\";\n      } else if (minute >= 30 && minute < 45) {\n        minutes = \"30\";\n      } else if (minute >= 45 && minute < 59) {\n        minutes = \"45\";\n      }\n\n      return hours + ':' + minutes;\n    };\n\n    this.handleEmptyEvent = async (date, e) => {\n      debugger;\n      let {\n        customerDetail\n      } = this.props;\n      let {\n        formField\n      } = this.state; // if (this.validator.allValid()) {\n\n      let time = new Date(date);\n      formField['time'] = this.getHoursFromDate(time);\n      formField['date'] = date;\n      await this.setState({\n        formField\n      });\n      console.log(date, e, \"hgjsydfisuyfsdfm ==== handleEmptyEvent\", time.getHours);\n      await this.props.updateForm('basicApptDetail', formField);\n      history.push(`/admin/appointment/create`); // console.log(date, e, \"hgjsydfisuyfsdfm ====\");\n      // } else {\n      //     this.validator.showMessages();\n      // }\n    };\n\n    this.getAppointment = () => {\n      let {\n        brachList,\n        events,\n        formField,\n        filterType,\n        filterDate\n      } = this.state;\n      this.props.getCommonApi(`appointmentcalender/?date=${dateFormat(filterDate)}&check=${filterType}`).then(async key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status === 200) {\n          events = [];\n          await this.setState({\n            events: null\n          });\n          events = data;\n          await this.setState({\n            events\n          }); // console.log(events, \"jhksdfkjsdhfks\", key)\n        }\n      });\n    };\n\n    this.handleChangeFilter = async (prevMode, prevDate, newMode, newDate) => {\n      let {\n        filterDate,\n        filterType\n      } = this.state;\n      filterDate = newDate;\n      filterType = newMode;\n      await this.setState({\n        filterDate,\n        filterType\n      });\n      console.log(\"dfhgfhjhjghjdfhg\", prevMode, prevDate, newMode, newDate);\n\n      if (prevMode !== newMode || prevDate !== newDate) {\n        this.getAvailability();\n        this.getAppointment();\n      }\n    };\n\n    this.handleChange = async ({\n      target: {\n        value,\n        name\n      }\n    }) => {\n      let {\n        formField\n      } = this.state;\n      formField[name] = value;\n      await this.setState({\n        formField\n      });\n\n      if (name === \"branchId\") {\n        this.getAvailability();\n        this.getAppointment();\n      } // console.log(formField, \"afasfasdfdfasd\")\n\n\n      this.props.updateForm('basicApptDetail', formField);\n    };\n\n    this.handleDelete = async (id, event) => {\n      let {\n        selectedId\n      } = this.state;\n      console.log(id, \"===afasfasdfdfasd=====\", selectedId);\n\n      if (id !== selectedId) {\n        await this.setState({\n          selectedId: id\n        });\n        await this.props.commonDeleteApi(`appointment/${id}/`).then(res => {});\n      }\n    };\n\n    this.openDetail = id => {\n      history.push(`/admin/appointment/${id}/detail`);\n    };\n\n    this.handleOpenStaff = (one, two, three) => {\n      console.log(\"namdfsfgsghsfghf\", one, two, three);\n      let {\n        filterDate\n      } = this.state;\n      this.props.handleOpen(filterDate);\n    };\n  }\n\n  render() {\n    let {\n      appointment,\n      brachList,\n      branchId,\n      formField,\n      list,\n      events,\n      filterType,\n      filterDate\n    } = this.state;\n    console.log(list[appointment]);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row m-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-3 pl-0 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"position-relative scheduler\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"schedule-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 25\n      }\n    }, \"Today's Appointments\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"appointment appointment-available-staff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 21\n      }\n    }, list && list.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-12 text-left detail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 34\n      }\n    }, data.appointment.map((app, index) => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex flex-wrap\",\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"head-message mb-0 fs-10 fw-400 col-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 45\n      }\n    }, app.time), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"head-message mb-0 fs-12 col-7\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 45\n      }\n    }, app.cust_name)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-12 text-left detail mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex flex-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"head-message mb-0 col-5 text-uppercase\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 41\n      }\n    }, data.emp_name), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"head-message mb-0 col-7\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 41\n      }\n    }, data.services))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"border-bottom-line mx-3 mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 33\n      }\n    }))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"scheduler-container col-9 pr-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 17\n      }\n    }, events ? /*#__PURE__*/React.createElement(SchedulerModal, {\n      events: events,\n      onClick: (id, e) => this.handleAppointmentOpen(id, e),\n      onEmptyClick: (date, e) => this.handleEmptyEvent(date, e),\n      handleChangeFilter: this.handleChangeFilter,\n      filterType: filterType,\n      filterDate: filterDate,\n      onDeleteEvent: this.handleDelete,\n      openDetail: this.openDetail,\n      openStaffView: this.handleOpenStaff,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 25\n      }\n    }) : \"\"));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  customerDetail: state.appointment.customerDetail,\n  customerList: state.common.customerList,\n  multipleCustomerForm: state.appointment.multipleCustomerForm\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    getCustomer,\n    getCommonApi,\n    updateForm,\n    commonDeleteApi\n  }, dispatch);\n};\n\nexport const Scheduler = connect(mapStateToProps, mapDispatchToProps)(SchedulerClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Appointment/ListAppointment/Scheduler/index.js"],"names":["React","Component","SchedulerModal","NormalInput","NormalSelect","NormalButton","NormalDate","NormalModal","getCustomer","getCommonApi","commonDeleteApi","connect","bindActionCreators","dateFormat","history","SimpleReactValidator","CreateAppointment","updateForm","data","start_date","end_date","text","id","SchedulerClass","state","appointment","time","date","name","treatment","events","brachList","formField","branchId","list","filterDate","Date","filterType","selectedId","componentWillMount","validator","element","message","autoForceUpdate","props","then","key","status","value","push","label","itemsite_desc","setState","getAvailability","getAppointment","handleAppointmentOpen","e","console","log","getHoursFromDate","hour","getHours","minute","getMinutes","hours","minutes","handleEmptyEvent","customerDetail","handleChangeFilter","prevMode","prevDate","newMode","newDate","handleChange","target","handleDelete","event","res","openDetail","handleOpenStaff","one","two","three","handleOpen","render","map","index","app","cust_name","emp_name","services","mapStateToProps","customerList","common","multipleCustomerForm","mapDispatchToProps","dispatch","Scheduler"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,cAAT,QAA+B,0BAA/B,C,CACA;;AACA,SAASC,WAAT,EAAsBC,YAAtB,EAAoCC,YAApC,EAAkDC,UAAlD,EAA8DC,WAA9D,QAAiF,kBAAjF;AACA,SAASC,WAAT,EAAsBC,YAAtB,EAAoCC,eAApC,QAA2D,sBAA3D;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,kBAAT,QAAmC,OAAnC,C,CACA;;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,OAAT,QAAwB,SAAxB;AACA,OAAO,cAAP;AACA,OAAOC,oBAAP,MAAiC,wBAAjC;AACA,SAASC,iBAAT,EAA4BC,UAA5B,QAA8C,2BAA9C;AAEA,MAAMC,IAAI,GAAG,CACT;AAAEC,EAAAA,UAAU,EAAE,iBAAd;AAAiCC,EAAAA,QAAQ,EAAE,iBAA3C;AAA8DC,EAAAA,IAAI,EAAE,SAApE;AAA+EC,EAAAA,EAAE,EAAE;AAAnF,CADS,EAET;AAAEH,EAAAA,UAAU,EAAE,iBAAd;AAAiCC,EAAAA,QAAQ,EAAE,kBAA3C;AAA+DC,EAAAA,IAAI,EAAE,SAArE;AAAgFC,EAAAA,EAAE,EAAE;AAApF,CAFS,EAGT;AAAEH,EAAAA,UAAU,EAAE,kBAAd;AAAkCC,EAAAA,QAAQ,EAAE,kBAA5C;AAAgEC,EAAAA,IAAI,EAAE,cAAtE;AAAsFC,EAAAA,EAAE,EAAE;AAA1F,CAHS,CAAb;AAMA,OAAO,MAAMC,cAAN,SAA6BtB,SAA7B,CAAuC;AAAA;AAAA;AAAA,SAC1CuB,KAD0C,GAClC;AACJC,MAAAA,WAAW,EAAE,CACT;AACIC,QAAAA,IAAI,EAAE,WADV;AAEIC,QAAAA,IAAI,EAAE,4BAFV;AAGIC,QAAAA,IAAI,EAAE,UAHV;AAIIC,QAAAA,SAAS,EAAE;AAJf,OADS,EAOT;AACIH,QAAAA,IAAI,EAAE,WADV;AAEIC,QAAAA,IAAI,EAAE,4BAFV;AAGIC,QAAAA,IAAI,EAAE,QAHV;AAIIC,QAAAA,SAAS,EAAE;AAJf,OAPS,EAaT;AACIH,QAAAA,IAAI,EAAE,UADV;AAEIC,QAAAA,IAAI,EAAE,4BAFV;AAGIC,QAAAA,IAAI,EAAE,MAHV;AAIIC,QAAAA,SAAS,EAAE;AAJf,OAbS,EAmBT;AACIH,QAAAA,IAAI,EAAE,UADV;AAEIC,QAAAA,IAAI,EAAE,4BAFV;AAGIC,QAAAA,IAAI,EAAE,OAHV;AAIIC,QAAAA,SAAS,EAAE;AAJf,OAnBS,EAyBT;AACIH,QAAAA,IAAI,EAAE,WADV;AAEIC,QAAAA,IAAI,EAAE,4BAFV;AAGIC,QAAAA,IAAI,EAAE,QAHV;AAIIC,QAAAA,SAAS,EAAE;AAJf,OAzBS,CADT;AAkCJC,MAAAA,MAAM,EAAE,CACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXI,OAlCJ;AA+CJC,MAAAA,SAAS,EAAE,EA/CP;AAgDJC,MAAAA,SAAS,EAAE;AACPC,QAAAA,QAAQ,EAAE,EADH;AAEPP,QAAAA,IAAI,EAAE;AAFC,OAhDP;AAoDJQ,MAAAA,IAAI,EAAE,EApDF;AAqDJC,MAAAA,UAAU,EAAE,IAAIC,IAAJ,EArDR;AAsDJC,MAAAA,UAAU,EAAE,KAtDR;AAuDJC,MAAAA,UAAU,EAAE;AAvDR,KADkC;;AAAA,SA2D1CC,kBA3D0C,GA2DrB,MAAM;AACvB,WAAKC,SAAL,GAAiB,IAAIzB,oBAAJ,CAAyB;AACtC0B,QAAAA,OAAO,EAAEC,OAAO,iBAAI;AAAM,UAAA,SAAS,EAAC,wCAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA0DA,OAA1D,CADkB;AAEtCC,QAAAA,eAAe,EAAE;AAFqB,OAAzB,CAAjB;AAIA,UAAI;AAAEZ,QAAAA,SAAF;AAAaN,QAAAA,WAAb;AAA0BO,QAAAA,SAA1B;AAAqCG,QAAAA;AAArC,UAAoD,KAAKX,KAA7D;AACA,WAAKoB,KAAL,CAAWnC,YAAX,CAAyB,mBAAzB,EAA6CoC,IAA7C,CAAmDC,GAAD,IAAS;AACvD,YAAI;AAAEC,UAAAA,MAAF;AAAU7B,UAAAA;AAAV,YAAmB4B,GAAvB;;AACA,YAAIC,MAAM,KAAK,GAAf,EAAoB;AAChB,eAAK,IAAIC,KAAT,IAAkB9B,IAAlB,EAAwB;AACpBa,YAAAA,SAAS,CAACkB,IAAV,CAAe;AAAED,cAAAA,KAAK,EAAEA,KAAK,CAAC1B,EAAf;AAAmB4B,cAAAA,KAAK,EAAEF,KAAK,CAACG;AAAhC,aAAf;AACH;;AACD,eAAKC,QAAL,CAAc;AAAErB,YAAAA;AAAF,WAAd,EAJgB,CAKhB;AACH;AACJ,OATD;AAUA,WAAKsB,eAAL;AACA,WAAKC,cAAL;AACH,KA7EyC;;AAAA,SA+E1CD,eA/E0C,GA+ExB,MAAM;AACpB,UAAI;AAAElB,QAAAA;AAAF,UAAiB,KAAKX,KAA1B;AACA,WAAKoB,KAAL,CAAWnC,YAAX,CAAyB,8BAA6BI,UAAU,CAACsB,UAAD,EAAa,YAAb,CAA2B,EAA3F,EAA8FU,IAA9F,CAAoGC,GAAD,IAAS;AACxG,YAAI;AAAEC,UAAAA,MAAF;AAAU7B,UAAAA;AAAV,YAAmB4B,GAAvB;;AACA,YAAIC,MAAM,KAAK,GAAf,EAAoB;AAChB;AACA;AACA;AACA,eAAKK,QAAL,CAAc;AAAElB,YAAAA,IAAI,EAAEhB;AAAR,WAAd;AACH;AACJ,OARD;AASH,KA1FyC;;AAAA,SA4F1CqC,qBA5F0C,GA4FlB,CAACjC,EAAD,EAAKkC,CAAL,KAAW;AAC/BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ,EAAelC,EAAf,EAAmB,6CAAnB;AACH,KA9FyC;;AAAA,SA+F1CqC,gBA/F0C,GA+FtBhC,IAAD,IAAU;AACzB,UAAIiC,IAAI,GAAGjC,IAAI,CAACkC,QAAL,EAAX;AACA,UAAIC,MAAM,GAAGnC,IAAI,CAACoC,UAAL,EAAb;AACA,UAAIC,KAAK,GAAGJ,IAAI,GAAG,CAAP,GAAYA,IAAZ,GAAqB,MAAMA,IAAvC;AACA,UAAIK,OAAJ;;AACA,UAAGH,MAAM,GAAG,EAAZ,EAAe;AACXG,QAAAA,OAAO,GAAG,IAAV;AACH,OAFD,MAGK,IAAGH,MAAM,IAAI,EAAV,IAAgBA,MAAM,GAAG,EAA5B,EAA+B;AAChCG,QAAAA,OAAO,GAAG,IAAV;AACH,OAFI,MAGA,IAAGH,MAAM,IAAI,EAAV,IAAgBA,MAAM,GAAG,EAA5B,EAA+B;AAChCG,QAAAA,OAAO,GAAG,IAAV;AACH,OAFI,MAGA,IAAGH,MAAM,IAAI,EAAV,IAAgBA,MAAM,GAAG,EAA5B,EAA+B;AAChCG,QAAAA,OAAO,GAAG,IAAV;AACH;;AACD,aAAOD,KAAK,GAAG,GAAR,GAAcC,OAArB;AACD,KAjHuC;;AAAA,SAmH1CC,gBAnH0C,GAmHvB,OAAOvC,IAAP,EAAa6B,CAAb,KAAmB;AAClC;AACA,UAAI;AAAEW,QAAAA;AAAF,UAAqB,KAAKvB,KAA9B;AACA,UAAI;AAAEZ,QAAAA;AAAF,UAAgB,KAAKR,KAAzB,CAHkC,CAIlC;;AACA,UAAIE,IAAI,GAAG,IAAIU,IAAJ,CAAST,IAAT,CAAX;AAEAK,MAAAA,SAAS,CAAC,MAAD,CAAT,GAAoB,KAAK2B,gBAAL,CAAsBjC,IAAtB,CAApB;AACAM,MAAAA,SAAS,CAAC,MAAD,CAAT,GAAoBL,IAApB;AACA,YAAM,KAAKyB,QAAL,CAAc;AAAEpB,QAAAA;AAAF,OAAd,CAAN;AACAyB,MAAAA,OAAO,CAACC,GAAR,CAAY/B,IAAZ,EAAkB6B,CAAlB,EAAqB,wCAArB,EAA+D9B,IAAI,CAACmC,QAApE;AACA,YAAM,KAAKjB,KAAL,CAAW3B,UAAX,CAAsB,iBAAtB,EAAyCe,SAAzC,CAAN;AACAlB,MAAAA,OAAO,CAACmC,IAAR,CAAc,2BAAd,EAZkC,CAalC;AACA;AACA;AACA;AAEH,KArIyC;;AAAA,SAuI1CK,cAvI0C,GAuIzB,MAAM;AACnB,UAAI;AAAEvB,QAAAA,SAAF;AAAaD,QAAAA,MAAb;AAAqBE,QAAAA,SAArB;AAAgCK,QAAAA,UAAhC;AAA4CF,QAAAA;AAA5C,UAA2D,KAAKX,KAApE;AACA,WAAKoB,KAAL,CAAWnC,YAAX,CAAyB,6BAA4BI,UAAU,CAACsB,UAAD,CAAa,UAASE,UAAW,EAAhG,EAAmGQ,IAAnG,CAAwG,MAAOC,GAAP,IAAe;AACnH,YAAI;AAAEC,UAAAA,MAAF;AAAU7B,UAAAA;AAAV,YAAmB4B,GAAvB;;AACA,YAAIC,MAAM,KAAK,GAAf,EAAoB;AAChBjB,UAAAA,MAAM,GAAG,EAAT;AACA,gBAAM,KAAKsB,QAAL,CAAc;AAAEtB,YAAAA,MAAM,EAAE;AAAV,WAAd,CAAN;AACAA,UAAAA,MAAM,GAAGZ,IAAT;AACA,gBAAM,KAAKkC,QAAL,CAAc;AAAEtB,YAAAA;AAAF,WAAd,CAAN,CAJgB,CAKhB;AACH;AACJ,OATD;AAUH,KAnJyC;;AAAA,SAoJ1CsC,kBApJ0C,GAoJrB,OAAOC,QAAP,EAAiBC,QAAjB,EAA2BC,OAA3B,EAAoCC,OAApC,KAAgD;AAEjE,UAAI;AAAErC,QAAAA,UAAF;AAAcE,QAAAA;AAAd,UAA6B,KAAKb,KAAtC;AACAW,MAAAA,UAAU,GAAGqC,OAAb;AACAnC,MAAAA,UAAU,GAAGkC,OAAb;AACA,YAAM,KAAKnB,QAAL,CAAc;AAChBjB,QAAAA,UADgB;AAEhBE,QAAAA;AAFgB,OAAd,CAAN;AAIAoB,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCW,QAAhC,EAA0CC,QAA1C,EAAoDC,OAApD,EAA6DC,OAA7D;;AACA,UAAGH,QAAQ,KAAGE,OAAX,IAAsBD,QAAQ,KAAGE,OAApC,EAA6C;AACzC,aAAKnB,eAAL;AACA,aAAKC,cAAL;AACH;AACJ,KAlKyC;;AAAA,SAoK1CmB,YApK0C,GAoK3B,OAAO;AAAEC,MAAAA,MAAM,EAAE;AAAE1B,QAAAA,KAAF;AAASpB,QAAAA;AAAT;AAAV,KAAP,KAAuC;AAClD,UAAI;AAAEI,QAAAA;AAAF,UAAgB,KAAKR,KAAzB;AACAQ,MAAAA,SAAS,CAACJ,IAAD,CAAT,GAAkBoB,KAAlB;AACA,YAAM,KAAKI,QAAL,CAAc;AAChBpB,QAAAA;AADgB,OAAd,CAAN;;AAGA,UAAIJ,IAAI,KAAK,UAAb,EAAyB;AACrB,aAAKyB,eAAL;AACA,aAAKC,cAAL;AACH,OATiD,CAUlD;;;AACA,WAAKV,KAAL,CAAW3B,UAAX,CAAsB,iBAAtB,EAAyCe,SAAzC;AACH,KAhLyC;;AAAA,SAkL1C2C,YAlL0C,GAkL3B,OAAOrD,EAAP,EAAWsD,KAAX,KAAqB;AAChC,UAAI;AAAEtC,QAAAA;AAAF,UAAiB,KAAKd,KAA1B;AACAiC,MAAAA,OAAO,CAACC,GAAR,CAAYpC,EAAZ,EAAgB,wBAAhB,EAA0CgB,UAA1C;;AACA,UAAIhB,EAAE,KAAKgB,UAAX,EAAuB;AACnB,cAAM,KAAKc,QAAL,CAAc;AAChBd,UAAAA,UAAU,EAAEhB;AADI,SAAd,CAAN;AAGA,cAAM,KAAKsB,KAAL,CAAWlC,eAAX,CAA4B,eAAcY,EAAG,GAA7C,EAAiDuB,IAAjD,CAAuDgC,GAAD,IAAS,CAEpE,CAFK,CAAN;AAGH;AAEJ,KA9LyC;;AAAA,SAgM1CC,UAhM0C,GAgM5BxD,EAAD,IAAQ;AACjBR,MAAAA,OAAO,CAACmC,IAAR,CAAc,sBAAqB3B,EAAG,SAAtC;AACH,KAlMyC;;AAAA,SAoM1CyD,eApM0C,GAoMxB,CAACC,GAAD,EAAMC,GAAN,EAAWC,KAAX,KAAqB;AACnCzB,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCsB,GAAhC,EAAqCC,GAArC,EAA0CC,KAA1C;AACA,UAAI;AAAC/C,QAAAA;AAAD,UAAgB,KAAKX,KAAzB;AACA,WAAKoB,KAAL,CAAWuC,UAAX,CAAsBhD,UAAtB;AACH,KAxMyC;AAAA;;AA4M1CiD,EAAAA,MAAM,GAAG;AACL,QAAI;AAAE3D,MAAAA,WAAF;AAAeM,MAAAA,SAAf;AAA0BE,MAAAA,QAA1B;AAAoCD,MAAAA,SAApC;AAA+CE,MAAAA,IAA/C;AAAqDJ,MAAAA,MAArD;AAA6DO,MAAAA,UAA7D;AAAyEF,MAAAA;AAAzE,QAAwF,KAAKX,KAAjG;AACAiC,IAAAA,OAAO,CAACC,GAAR,CAAYxB,IAAI,CAACT,WAAD,CAAhB;AACA,wBACI;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEI;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADJ,CADJ,eAOI;AAAK,MAAA,SAAS,EAAC,yCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEKS,IAAI,IAAIA,IAAI,CAACmD,GAAL,CAAS,CAACnE,IAAD,EAAOoE,KAAP,kBAEd;AAAK,MAAA,GAAG,EAAEA,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACK;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACIpE,IAAI,CAACO,WAAL,CAAiB4D,GAAjB,CAAqB,CAACE,GAAD,EAAMD,KAAN,kBAClB;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAkC,MAAA,GAAG,EAAEA,KAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,sCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAuDC,GAAG,CAAC7D,IAA3D,CADJ,eAEI;AAAK,MAAA,SAAS,EAAC,+BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAgD6D,GAAG,CAACC,SAApD,CAFJ,CADH,CADJ,CADL,eAQI;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAyDtE,IAAI,CAACuE,QAA9D,CADJ,eAEI;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA0CvE,IAAI,CAACwE,QAA/C,CAFJ,CADJ,CARJ,eAcI;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAdJ,CAFK,CAFb,CAPJ,CAFJ,eAgCI;AAAK,MAAA,SAAS,EAAC,gCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEK5D,MAAM,gBACH,oBAAC,cAAD;AACI,MAAA,MAAM,EAAEA,MADZ;AAEI,MAAA,OAAO,EAAE,CAACR,EAAD,EAAKkC,CAAL,KAAW,KAAKD,qBAAL,CAA2BjC,EAA3B,EAA+BkC,CAA/B,CAFxB;AAGI,MAAA,YAAY,EAAE,CAAC7B,IAAD,EAAO6B,CAAP,KAAa,KAAKU,gBAAL,CAAsBvC,IAAtB,EAA4B6B,CAA5B,CAH/B;AAII,MAAA,kBAAkB,EAAE,KAAKY,kBAJ7B;AAKI,MAAA,UAAU,EAAE/B,UALhB;AAK4B,MAAA,UAAU,EAAEF,UALxC;AAMI,MAAA,aAAa,EAAE,KAAKwC,YANxB;AAOI,MAAA,UAAU,EAAE,KAAKG,UAPrB;AAQI,MAAA,aAAa,EAAE,KAAKC,eARxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADG,GAUE,EAZb,CAhCJ,CADJ;AAoDH;;AAnQyC;;AAsQ9C,MAAMY,eAAe,GAAInE,KAAD,KAAY;AAChC2C,EAAAA,cAAc,EAAE3C,KAAK,CAACC,WAAN,CAAkB0C,cADF;AAEhCyB,EAAAA,YAAY,EAAEpE,KAAK,CAACqE,MAAN,CAAaD,YAFK;AAGhCE,EAAAA,oBAAoB,EAAEtE,KAAK,CAACC,WAAN,CAAkBqE;AAHR,CAAZ,CAAxB;;AAMA,MAAMC,kBAAkB,GAAGC,QAAQ,IAAI;AACnC,SAAOpF,kBAAkB,CAAC;AACtBJ,IAAAA,WADsB;AAEtBC,IAAAA,YAFsB;AAGtBQ,IAAAA,UAHsB;AAItBP,IAAAA;AAJsB,GAAD,EAKtBsF,QALsB,CAAzB;AAMH,CAPD;;AASA,OAAO,MAAMC,SAAS,GAAGtF,OAAO,CAACgF,eAAD,EAAkBI,kBAAlB,CAAP,CAA6CxE,cAA7C,CAAlB","sourcesContent":["import React, { Component } from 'react';\r\nimport { SchedulerModal } from 'component/common/Plugins';\r\n// import BigSchedulerModal from 'component/common/Plugins/BigScheduler';\r\nimport { NormalInput, NormalSelect, NormalButton, NormalDate, NormalModal } from 'component/common';\r\nimport { getCustomer, getCommonApi, commonDeleteApi } from 'redux/actions/common';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from \"redux\";\r\n// import timeOption from 'data/timeOption.json'\r\nimport { dateFormat } from 'service/helperFunctions';\r\nimport { history } from 'helpers';\r\nimport './style.scss';\r\nimport SimpleReactValidator from 'simple-react-validator';\r\nimport { CreateAppointment, updateForm } from 'redux/actions/appointment';\r\n\r\nconst data = [\r\n    { start_date: '2020-06-09 4:00', end_date: '2020-06-09 6:00', text: 'Event 1', id: 1 },\r\n    { start_date: '2020-06-11 8:00', end_date: '2020-06-11 10:00', text: 'Event 2', id: 2 },\r\n    { start_date: '2020-06-12 12:00', end_date: '2018-06-12 14:00', text: 'dblclick me!', id: 3 }\r\n];\r\n\r\nexport class SchedulerClass extends Component {\r\n    state = {\r\n        appointment: [\r\n            {\r\n                time: '10.00 AM,',\r\n                date: 'Wednesday, 1st April, 2020',\r\n                name: 'Benjamin',\r\n                treatment: 'Head Massage'\r\n            },\r\n            {\r\n                time: '12.00 PM,',\r\n                date: 'Wednesday, 1st April, 2020',\r\n                name: 'Daniel',\r\n                treatment: 'Pedicure'\r\n            },\r\n            {\r\n                time: '1.00 PM,',\r\n                date: 'Wednesday, 1st April, 2020',\r\n                name: 'John',\r\n                treatment: 'Haircut'\r\n            },\r\n            {\r\n                time: '2.00 PM,',\r\n                date: 'Wednesday, 1st April, 2020',\r\n                name: 'Josua',\r\n                treatment: 'Manicure'\r\n            },\r\n            {\r\n                time: '4.00 PM, ',\r\n                date: 'Wednesday, 1st April, 2020',\r\n                name: 'Derrik',\r\n                treatment: 'Body Massage'\r\n            },\r\n\r\n        ],\r\n        events: [\r\n            // {\r\n            //     \"start_date\": \"2021-01-06 3:30\",\r\n            //     \"end_date\": \"2021-01-06 5:00\",\r\n            //     \"text\": \"Korean Anti Aging\",\r\n            //     \"id\": 199787,\r\n            //     \"user_id\": 171,\r\n            //     \"status\": \"Booking\",\r\n            //     \"color\": \"#f0b5ec\",\r\n            //     \"title\": \"divya test\",\r\n            //     \"staff_name\": \"HAN HAI YAN\"\r\n            // }\r\n        ],\r\n        brachList: [],\r\n        formField: {\r\n            branchId: \"\",\r\n            time: \"\"\r\n        },\r\n        list: [],\r\n        filterDate: new Date(),\r\n        filterType: 'day',\r\n        selectedId: \"\"\r\n    }\r\n\r\n    componentWillMount = () => {\r\n        this.validator = new SimpleReactValidator({\r\n            element: message => <span className=\"error-message text-danger validNo fs14\">{message}</span>,\r\n            autoForceUpdate: this,\r\n        });\r\n        let { brachList, appointment, formField, filterDate } = this.state;\r\n        this.props.getCommonApi(`treatment/Outlet/`).then((key) => {\r\n            let { status, data } = key;\r\n            if (status === 200) {\r\n                for (let value of data) {\r\n                    brachList.push({ value: value.id, label: value.itemsite_desc })\r\n                }\r\n                this.setState({ brachList })\r\n                // console.log(brachList, \"jhksdfkjsdhfks\")\r\n            }\r\n        })\r\n        this.getAvailability();\r\n        this.getAppointment();\r\n    }\r\n\r\n    getAvailability = () => {\r\n        let { filterDate } = this.state;\r\n        this.props.getCommonApi(`staffsavailable/?Appt_date=${dateFormat(filterDate, \"yyyy-mm-dd\")}`).then((key) => {\r\n            let { status, data } = key;\r\n            if (status === 200) {\r\n                // for (let value of data) {\r\n                //     staffList.push({ value: value.id, label: value.emp_name })\r\n                // }\r\n                this.setState({ list: data })\r\n            }\r\n        })\r\n    }\r\n\r\n    handleAppointmentOpen = (id, e) => {\r\n        console.log(e, id, \"hgjsydfisuyfsdfm ==== handleAppointmentOpen\");\r\n    }\r\n    getHoursFromDate = (date) => {\r\n        let hour = date.getHours();\r\n        let minute = date.getMinutes();\r\n        let hours = hour > 9 ? (hour) : (\"0\" + hour)\r\n        let minutes;\r\n        if(minute < 15){\r\n            minutes = \"00\"\r\n        }\r\n        else if(minute >= 15 && minute < 30){\r\n            minutes = \"15\"\r\n        }\r\n        else if(minute >= 30 && minute < 45){\r\n            minutes = \"30\"\r\n        }\r\n        else if(minute >= 45 && minute < 59){\r\n            minutes = \"45\"\r\n        }\r\n        return hours + ':' + minutes;\r\n      }\r\n\r\n    handleEmptyEvent = async (date, e) => {\r\n        debugger\r\n        let { customerDetail } = this.props;\r\n        let { formField } = this.state;\r\n        // if (this.validator.allValid()) {\r\n        let time = new Date(date)\r\n        \r\n        formField['time'] = this.getHoursFromDate(time);\r\n        formField['date'] = date;\r\n        await this.setState({ formField });\r\n        console.log(date, e, \"hgjsydfisuyfsdfm ==== handleEmptyEvent\", time.getHours);\r\n        await this.props.updateForm('basicApptDetail', formField);\r\n        history.push(`/admin/appointment/create`)\r\n        // console.log(date, e, \"hgjsydfisuyfsdfm ====\");\r\n        // } else {\r\n        //     this.validator.showMessages();\r\n        // }\r\n\r\n    }\r\n\r\n    getAppointment = () => {\r\n        let { brachList, events, formField, filterType, filterDate } = this.state;\r\n        this.props.getCommonApi(`appointmentcalender/?date=${dateFormat(filterDate)}&check=${filterType}`).then(async (key) => {\r\n            let { status, data } = key;\r\n            if (status === 200) {\r\n                events = [];\r\n                await this.setState({ events: null })\r\n                events = data;\r\n                await this.setState({ events })\r\n                // console.log(events, \"jhksdfkjsdhfks\", key)\r\n            }\r\n        })\r\n    }\r\n    handleChangeFilter = async (prevMode, prevDate, newMode, newDate) => {\r\n\r\n        let { filterDate, filterType } = this.state;\r\n        filterDate = newDate;\r\n        filterType = newMode;\r\n        await this.setState({\r\n            filterDate,\r\n            filterType\r\n        })\r\n        console.log(\"dfhgfhjhjghjdfhg\", prevMode, prevDate, newMode, newDate)\r\n        if(prevMode!==newMode || prevDate!==newDate) {\r\n            this.getAvailability();\r\n            this.getAppointment()\r\n        }\r\n    }\r\n\r\n    handleChange = async ({ target: { value, name } }) => {\r\n        let { formField } = this.state;\r\n        formField[name] = value;\r\n        await this.setState({\r\n            formField,\r\n        });\r\n        if (name === \"branchId\") {\r\n            this.getAvailability();\r\n            this.getAppointment();\r\n        }\r\n        // console.log(formField, \"afasfasdfdfasd\")\r\n        this.props.updateForm('basicApptDetail', formField);\r\n    };\r\n\r\n    handleDelete = async (id, event) => {\r\n        let { selectedId } = this.state;\r\n        console.log(id, \"===afasfasdfdfasd=====\", selectedId)\r\n        if (id !== selectedId) {\r\n            await this.setState({\r\n                selectedId: id\r\n            })\r\n            await this.props.commonDeleteApi(`appointment/${id}/`).then((res) => {\r\n\r\n            })\r\n        }\r\n        \r\n    }\r\n\r\n    openDetail = (id) => {\r\n        history.push(`/admin/appointment/${id}/detail`)\r\n    }\r\n\r\n    handleOpenStaff = (one, two, three) => {\r\n        console.log(\"namdfsfgsghsfghf\", one, two, three)\r\n        let {filterDate } = this.state;\r\n        this.props.handleOpen(filterDate);\r\n    }\r\n\r\n   \r\n\r\n    render() {\r\n        let { appointment, brachList, branchId, formField, list, events, filterType, filterDate } = this.state;\r\n        console.log(list[appointment])\r\n        return (\r\n            <div className=\"row m-0\">\r\n\r\n                <div className=\"col-3 pl-0 \">\r\n                    <div className=\"position-relative scheduler\">\r\n                        <div className=\"schedule-label\">\r\n                            Today's Appointments\r\n                        </div>\r\n                        {/* <span className=\"icon-down-blue clip-icon\"></span> */}\r\n                    </div>\r\n                    <div className=\"appointment appointment-available-staff\">\r\n\r\n                        {list && list.map((data, index) => (\r\n                            \r\n                            <div key={index}>\r\n                                 <div className='col-12 text-left detail'>\r\n                                    {data.appointment.map((app, index)=>(\r\n                                        <div className='d-flex flex-wrap' key={index}>\r\n                                            <div className=\"head-message mb-0 fs-10 fw-400 col-5\">{app.time}</div>\r\n                                            <div className=\"head-message mb-0 fs-12 col-7\">{app.cust_name}</div>\r\n                                        </div>))}   \r\n                                    </div>\r\n                                <div className=\"col-12 text-left detail mt-2\">                                   \r\n                                    <div className=\"d-flex flex-wrap\">\r\n                                        <div className=\"head-message mb-0 col-5 text-uppercase\">{data.emp_name}</div>\r\n                                        <div className=\"head-message mb-0 col-7\">{data.services}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"border-bottom-line mx-3 mt-3\"></div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n                <div className='scheduler-container col-9 pr-0'>\r\n\r\n                    {events ?\r\n                        <SchedulerModal\r\n                            events={events}\r\n                            onClick={(id, e) => this.handleAppointmentOpen(id, e)}\r\n                            onEmptyClick={(date, e) => this.handleEmptyEvent(date, e)}\r\n                            handleChangeFilter={this.handleChangeFilter}\r\n                            filterType={filterType} filterDate={filterDate}\r\n                            onDeleteEvent={this.handleDelete}\r\n                            openDetail={this.openDetail}\r\n                            openStaffView={this.handleOpenStaff}\r\n                        /> : \"\"\r\n                    }\r\n                    {/* {console.log(\"render ===\", this.state, this.props)} */}\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    customerDetail: state.appointment.customerDetail,\r\n    customerList: state.common.customerList,\r\n    multipleCustomerForm: state.appointment.multipleCustomerForm\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return bindActionCreators({\r\n        getCustomer,\r\n        getCommonApi,\r\n        updateForm,\r\n        commonDeleteApi\r\n    }, dispatch)\r\n}\r\n\r\nexport const Scheduler = connect(mapStateToProps, mapDispatchToProps)(SchedulerClass)"]},"metadata":{},"sourceType":"module"}