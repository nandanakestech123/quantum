{"ast":null,"code":"/**\r\n * DevExtreme (ui/html_editor/modules/resizing.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../../core/renderer\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../../../events/core/events_engine\"));\n\nvar _click = require(\"../../../events/click\");\n\nvar _index = require(\"../../../events/utils/index\");\n\nvar _translator = require(\"../../../animation/translator\");\n\nvar _devices = _interopRequireDefault(require(\"../../../core/devices\"));\n\nvar _resizable = _interopRequireDefault(require(\"../../resizable\"));\n\nvar _position = require(\"../../../core/utils/position\");\n\nvar _devextremeQuill = _interopRequireDefault(require(\"devextreme-quill\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar DX_RESIZE_FRAME_CLASS = \"dx-resize-frame\";\nvar DX_TOUCH_DEVICE_CLASS = \"dx-touch-device\";\nvar MODULE_NAMESPACE = \"dxHtmlResizingModule\";\nvar KEYDOWN_EVENT = (0, _index.addNamespace)(\"keydown\", MODULE_NAMESPACE);\nvar SCROLL_EVENT = (0, _index.addNamespace)(\"scroll\", MODULE_NAMESPACE);\nvar MOUSEDOWN_EVENT = (0, _index.addNamespace)(\"mousedown\", MODULE_NAMESPACE);\nvar FRAME_PADDING = 1;\n\nvar ResizingModule = function () {\n  function ResizingModule(quill, options) {\n    _classCallCheck(this, ResizingModule);\n\n    this.quill = quill;\n    this.editorInstance = options.editorInstance;\n    this.allowedTargets = options.allowedTargets || [\"image\"];\n    this.enabled = !!options.enabled;\n\n    if (this.enabled) {\n      this._attachEvents();\n\n      this._createResizeFrame();\n    }\n  }\n\n  _createClass(ResizingModule, [{\n    key: \"_attachEvents\",\n    value: function () {\n      _events_engine.default.on(this.quill.root, (0, _index.addNamespace)(_click.name, MODULE_NAMESPACE), this._clickHandler.bind(this));\n\n      _events_engine.default.on(this.quill.root, SCROLL_EVENT, this._scrollHandler.bind(this));\n    }\n  }, {\n    key: \"_detachEvents\",\n    value: function () {\n      _events_engine.default.off(this.quill.root, MODULE_NAMESPACE);\n    }\n  }, {\n    key: \"_clickHandler\",\n    value: function (e) {\n      if (this._isAllowedTarget(e.target)) {\n        if (this._$target === e.target) {\n          return;\n        }\n\n        this._$target = e.target;\n        this.updateFramePosition();\n        this.showFrame();\n      } else {\n        if (this._$target) {\n          this.hideFrame();\n        }\n      }\n    }\n  }, {\n    key: \"_scrollHandler\",\n    value: function (e) {\n      if (this._$target) {\n        this.updateFramePosition();\n      }\n    }\n  }, {\n    key: \"_isAllowedTarget\",\n    value: function (targetElement) {\n      return this._isImage(targetElement);\n    }\n  }, {\n    key: \"_isImage\",\n    value: function (targetElement) {\n      return this.allowedTargets.indexOf(\"image\") !== -1 && \"IMG\" === targetElement.tagName.toUpperCase();\n    }\n  }, {\n    key: \"showFrame\",\n    value: function () {\n      this._$resizeFrame.show();\n\n      _events_engine.default.on(this.quill.root, KEYDOWN_EVENT, this._handleFrameKeyDown.bind(this));\n    }\n  }, {\n    key: \"_handleFrameKeyDown\",\n    value: function (e) {\n      var keyName = (0, _index.normalizeKeyName)(e);\n\n      if (\"del\" === keyName || \"backspace\" === keyName) {\n        this._deleteImage();\n      }\n\n      this.hideFrame();\n    }\n  }, {\n    key: \"hideFrame\",\n    value: function () {\n      this._$target = null;\n\n      this._$resizeFrame.hide();\n\n      _events_engine.default.off(this.quill.root, KEYDOWN_EVENT);\n    }\n  }, {\n    key: \"updateFramePosition\",\n    value: function () {\n      var _getBoundingRect = (0, _position.getBoundingRect)(this._$target),\n          height = _getBoundingRect.height,\n          width = _getBoundingRect.width,\n          targetTop = _getBoundingRect.top,\n          targetLeft = _getBoundingRect.left;\n\n      var _getBoundingRect2 = (0, _position.getBoundingRect)(this.quill.root),\n          containerTop = _getBoundingRect2.top,\n          containerLeft = _getBoundingRect2.left;\n\n      var borderWidth = this._getBorderWidth();\n\n      this._$resizeFrame.css({\n        height: height,\n        width: width,\n        padding: FRAME_PADDING,\n        top: targetTop - containerTop - borderWidth - FRAME_PADDING,\n        left: targetLeft - containerLeft - borderWidth - FRAME_PADDING\n      });\n\n      (0, _translator.move)(this._$resizeFrame, {\n        left: 0,\n        top: 0\n      });\n    }\n  }, {\n    key: \"_getBorderWidth\",\n    value: function () {\n      return parseInt(this._$resizeFrame.css(\"borderTopWidth\"));\n    }\n  }, {\n    key: \"_createResizeFrame\",\n    value: function () {\n      var _this = this;\n\n      if (this._$resizeFrame) {\n        return;\n      }\n\n      var _devices$current = _devices.default.current(),\n          deviceType = _devices$current.deviceType;\n\n      this._$resizeFrame = (0, _renderer.default)(\"<div>\").addClass(DX_RESIZE_FRAME_CLASS).toggleClass(DX_TOUCH_DEVICE_CLASS, \"desktop\" !== deviceType).appendTo(this.editorInstance._getQuillContainer()).hide();\n\n      _events_engine.default.on(this._$resizeFrame, MOUSEDOWN_EVENT, function (e) {\n        e.preventDefault();\n      });\n\n      this.editorInstance._createComponent(this._$resizeFrame, _resizable.default, {\n        onResize: function (e) {\n          if (!_this._$target) {\n            return;\n          }\n\n          var correction = 2 * (FRAME_PADDING + _this._getBorderWidth());\n\n          (0, _renderer.default)(_this._$target).attr({\n            height: e.height - correction,\n            width: e.width - correction\n          });\n\n          _this.updateFramePosition();\n        }\n      });\n    }\n  }, {\n    key: \"_deleteImage\",\n    value: function () {\n      if (this._isAllowedTarget(this._$target)) {\n        _devextremeQuill.default.find(this._$target).deleteAt(0);\n      }\n    }\n  }, {\n    key: \"option\",\n    value: function (_option, value) {\n      var _this2 = this;\n\n      if (\"mediaResizing\" === _option) {\n        Object.keys(value).forEach(function (optionName) {\n          return _this2.option(optionName, value[optionName]);\n        });\n        return;\n      }\n\n      if (\"enabled\" === _option) {\n        this.enabled = value;\n        value ? this._attachEvents() : this._detachEvents();\n      } else {\n        if (\"allowedTargets\" === _option && Array.isArray(value)) {\n          this.allowedTargets = value;\n        }\n      }\n    }\n  }, {\n    key: \"clean\",\n    value: function () {\n      this._detachEvents();\n\n      this._$resizeFrame.remove();\n\n      this._$resizeFrame = void 0;\n    }\n  }]);\n\n  return ResizingModule;\n}();\n\nexports.default = ResizingModule;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/html_editor/modules/resizing.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_events_engine","_click","_index","_translator","_devices","_resizable","_position","_devextremeQuill","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","DX_RESIZE_FRAME_CLASS","DX_TOUCH_DEVICE_CLASS","MODULE_NAMESPACE","KEYDOWN_EVENT","addNamespace","SCROLL_EVENT","MOUSEDOWN_EVENT","FRAME_PADDING","ResizingModule","quill","options","editorInstance","allowedTargets","enabled","_attachEvents","_createResizeFrame","value","on","root","name","_clickHandler","bind","_scrollHandler","off","e","_isAllowedTarget","_$target","updateFramePosition","showFrame","hideFrame","targetElement","_isImage","indexOf","tagName","toUpperCase","_$resizeFrame","show","_handleFrameKeyDown","keyName","normalizeKeyName","_deleteImage","hide","_getBoundingRect","getBoundingRect","height","width","targetTop","top","targetLeft","left","_getBoundingRect2","containerTop","containerLeft","borderWidth","_getBorderWidth","css","padding","move","parseInt","_this","_devices$current","current","deviceType","addClass","toggleClass","appendTo","_getQuillContainer","preventDefault","_createComponent","onResize","correction","attr","find","deleteAt","_option","_this2","keys","forEach","optionName","option","_detachEvents","Array","isArray","remove","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/html_editor/modules/resizing.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../../core/renderer\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../../../events/core/events_engine\"));\r\nvar _click = require(\"../../../events/click\");\r\nvar _index = require(\"../../../events/utils/index\");\r\nvar _translator = require(\"../../../animation/translator\");\r\nvar _devices = _interopRequireDefault(require(\"../../../core/devices\"));\r\nvar _resizable = _interopRequireDefault(require(\"../../resizable\"));\r\nvar _position = require(\"../../../core/utils/position\");\r\nvar _devextremeQuill = _interopRequireDefault(require(\"devextreme-quill\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar DX_RESIZE_FRAME_CLASS = \"dx-resize-frame\";\r\nvar DX_TOUCH_DEVICE_CLASS = \"dx-touch-device\";\r\nvar MODULE_NAMESPACE = \"dxHtmlResizingModule\";\r\nvar KEYDOWN_EVENT = (0, _index.addNamespace)(\"keydown\", MODULE_NAMESPACE);\r\nvar SCROLL_EVENT = (0, _index.addNamespace)(\"scroll\", MODULE_NAMESPACE);\r\nvar MOUSEDOWN_EVENT = (0, _index.addNamespace)(\"mousedown\", MODULE_NAMESPACE);\r\nvar FRAME_PADDING = 1;\r\nvar ResizingModule = function() {\r\n    function ResizingModule(quill, options) {\r\n        _classCallCheck(this, ResizingModule);\r\n        this.quill = quill;\r\n        this.editorInstance = options.editorInstance;\r\n        this.allowedTargets = options.allowedTargets || [\"image\"];\r\n        this.enabled = !!options.enabled;\r\n        if (this.enabled) {\r\n            this._attachEvents();\r\n            this._createResizeFrame()\r\n        }\r\n    }\r\n    _createClass(ResizingModule, [{\r\n        key: \"_attachEvents\",\r\n        value: function() {\r\n            _events_engine.default.on(this.quill.root, (0, _index.addNamespace)(_click.name, MODULE_NAMESPACE), this._clickHandler.bind(this));\r\n            _events_engine.default.on(this.quill.root, SCROLL_EVENT, this._scrollHandler.bind(this))\r\n        }\r\n    }, {\r\n        key: \"_detachEvents\",\r\n        value: function() {\r\n            _events_engine.default.off(this.quill.root, MODULE_NAMESPACE)\r\n        }\r\n    }, {\r\n        key: \"_clickHandler\",\r\n        value: function(e) {\r\n            if (this._isAllowedTarget(e.target)) {\r\n                if (this._$target === e.target) {\r\n                    return\r\n                }\r\n                this._$target = e.target;\r\n                this.updateFramePosition();\r\n                this.showFrame()\r\n            } else {\r\n                if (this._$target) {\r\n                    this.hideFrame()\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_scrollHandler\",\r\n        value: function(e) {\r\n            if (this._$target) {\r\n                this.updateFramePosition()\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_isAllowedTarget\",\r\n        value: function(targetElement) {\r\n            return this._isImage(targetElement)\r\n        }\r\n    }, {\r\n        key: \"_isImage\",\r\n        value: function(targetElement) {\r\n            return this.allowedTargets.indexOf(\"image\") !== -1 && \"IMG\" === targetElement.tagName.toUpperCase()\r\n        }\r\n    }, {\r\n        key: \"showFrame\",\r\n        value: function() {\r\n            this._$resizeFrame.show();\r\n            _events_engine.default.on(this.quill.root, KEYDOWN_EVENT, this._handleFrameKeyDown.bind(this))\r\n        }\r\n    }, {\r\n        key: \"_handleFrameKeyDown\",\r\n        value: function(e) {\r\n            var keyName = (0, _index.normalizeKeyName)(e);\r\n            if (\"del\" === keyName || \"backspace\" === keyName) {\r\n                this._deleteImage()\r\n            }\r\n            this.hideFrame()\r\n        }\r\n    }, {\r\n        key: \"hideFrame\",\r\n        value: function() {\r\n            this._$target = null;\r\n            this._$resizeFrame.hide();\r\n            _events_engine.default.off(this.quill.root, KEYDOWN_EVENT)\r\n        }\r\n    }, {\r\n        key: \"updateFramePosition\",\r\n        value: function() {\r\n            var _getBoundingRect = (0, _position.getBoundingRect)(this._$target),\r\n                height = _getBoundingRect.height,\r\n                width = _getBoundingRect.width,\r\n                targetTop = _getBoundingRect.top,\r\n                targetLeft = _getBoundingRect.left;\r\n            var _getBoundingRect2 = (0, _position.getBoundingRect)(this.quill.root),\r\n                containerTop = _getBoundingRect2.top,\r\n                containerLeft = _getBoundingRect2.left;\r\n            var borderWidth = this._getBorderWidth();\r\n            this._$resizeFrame.css({\r\n                height: height,\r\n                width: width,\r\n                padding: FRAME_PADDING,\r\n                top: targetTop - containerTop - borderWidth - FRAME_PADDING,\r\n                left: targetLeft - containerLeft - borderWidth - FRAME_PADDING\r\n            });\r\n            (0, _translator.move)(this._$resizeFrame, {\r\n                left: 0,\r\n                top: 0\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_getBorderWidth\",\r\n        value: function() {\r\n            return parseInt(this._$resizeFrame.css(\"borderTopWidth\"))\r\n        }\r\n    }, {\r\n        key: \"_createResizeFrame\",\r\n        value: function() {\r\n            var _this = this;\r\n            if (this._$resizeFrame) {\r\n                return\r\n            }\r\n            var _devices$current = _devices.default.current(),\r\n                deviceType = _devices$current.deviceType;\r\n            this._$resizeFrame = (0, _renderer.default)(\"<div>\").addClass(DX_RESIZE_FRAME_CLASS).toggleClass(DX_TOUCH_DEVICE_CLASS, \"desktop\" !== deviceType).appendTo(this.editorInstance._getQuillContainer()).hide();\r\n            _events_engine.default.on(this._$resizeFrame, MOUSEDOWN_EVENT, function(e) {\r\n                e.preventDefault()\r\n            });\r\n            this.editorInstance._createComponent(this._$resizeFrame, _resizable.default, {\r\n                onResize: function(e) {\r\n                    if (!_this._$target) {\r\n                        return\r\n                    }\r\n                    var correction = 2 * (FRAME_PADDING + _this._getBorderWidth());\r\n                    (0, _renderer.default)(_this._$target).attr({\r\n                        height: e.height - correction,\r\n                        width: e.width - correction\r\n                    });\r\n                    _this.updateFramePosition()\r\n                }\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_deleteImage\",\r\n        value: function() {\r\n            if (this._isAllowedTarget(this._$target)) {\r\n                _devextremeQuill.default.find(this._$target).deleteAt(0)\r\n            }\r\n        }\r\n    }, {\r\n        key: \"option\",\r\n        value: function(_option, value) {\r\n            var _this2 = this;\r\n            if (\"mediaResizing\" === _option) {\r\n                Object.keys(value).forEach(function(optionName) {\r\n                    return _this2.option(optionName, value[optionName])\r\n                });\r\n                return\r\n            }\r\n            if (\"enabled\" === _option) {\r\n                this.enabled = value;\r\n                value ? this._attachEvents() : this._detachEvents()\r\n            } else {\r\n                if (\"allowedTargets\" === _option && Array.isArray(value)) {\r\n                    this.allowedTargets = value\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"clean\",\r\n        value: function() {\r\n            this._detachEvents();\r\n            this._$resizeFrame.remove();\r\n            this._$resizeFrame = void 0\r\n        }\r\n    }]);\r\n    return ResizingModule\r\n}();\r\nexports.default = ResizingModule;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}