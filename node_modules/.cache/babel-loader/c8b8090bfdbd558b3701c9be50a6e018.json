{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hp\\\\Downloads\\\\quantumCode20082022\\\\src\\\\component\\\\Admin\\\\Cart\\\\topup\\\\product.js\";\nimport React, { Component } from \"react\";\nimport \"./style.scss\";\nimport { NormalButton, NormalInput, NormalSelect, InputSearch, NormalModal, TableWrapper } from \"component/common\";\nimport { dateFormat } from \"service/helperFunctions\";\nimport _ from \"lodash\";\nimport { history } from \"helpers\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { getCommonApi, updateForm, commonCreateApi, commonDeleteApi, commonPatchApi } from \"redux/actions/common\";\nimport SimpleReactValidator from \"simple-react-validator\"; // import { Treatment, Payment, EditCart } from './cart/index';\n\nimport service from \"assets/images/make-up-brush.png\"; // import Discount from './cart/discount';\n\nimport { FormGroup, Label, Input } from \"reactstrap\";\nimport { withTranslation } from \"react-i18next\";\nexport class TopupProductClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      treatmentList: [],\n      cartData: {},\n      formFields: {\n        customer_name: \"\",\n        new_outstanding: \"\",\n        old_outstanding: \"\",\n        topup_amount: \"\"\n      },\n      headerDetails: [{\n        label: \"Invoice No\",\n        sortKey: false,\n        width: \"120px\"\n      }, {\n        label: \"Item\",\n        sortKey: false,\n        width: \"150px\"\n      }, {\n        label: \"Qty\",\n        sortKey: false,\n        width: \"50px\",\n        divClass: \"justify-content-end text-right\"\n      }, {\n        label: \"Deposit\",\n        width: \"100px\",\n        divClass: \"justify-content-end text-right\"\n      }, {\n        label: \"Outstanding\",\n        sortKey: false,\n        width: \"100px\",\n        divClass: \"justify-content-end text-right\"\n      }, {\n        label: \"Pay amount\",\n        width: \"100px\",\n        divClass: \"justify-content-center\"\n      }, {\n        label: \"Staff\",\n        width: \"100px\"\n      }]\n    };\n\n    this.componentWillMount = () => {\n      this.validator = new SimpleReactValidator({\n        element: message => /*#__PURE__*/React.createElement(\"span\", {\n          className: \"error-message text-danger validNo fs14\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 9\n          }\n        }, message),\n        autoForceUpdate: this\n      });\n      let {\n        roomList,\n        sourceList,\n        staffList,\n        cartData,\n        duration,\n        treatmentList\n      } = this.state;\n      this.getCart();\n    };\n\n    this.getCart = () => {\n      let {\n        roomList,\n        sourceList,\n        staffList,\n        cartData,\n        duration,\n        treatmentList\n      } = this.state;\n      this.props.getCommonApi(`topupproduct/?cust_id=${this.props.id}`).then(key => {\n        cartData = key;\n        treatmentList = key.data;\n        this.setState({\n          cartData,\n          treatmentList\n        });\n        this.getDataFromRes(key); // }\n      });\n    };\n\n    this.getDataFromRes = data => {\n      let {\n        header_data\n      } = data;\n      let {\n        formFields\n      } = this.state;\n      formFields[\"customer_name\"] = header_data ? header_data.customer_name : \"\";\n      formFields[\"new_outstanding\"] = header_data ? header_data.new_outstanding : \"\";\n      formFields[\"old_outstanding\"] = header_data ? header_data.old_outstanding : \"\";\n      formFields[\"topup_amount\"] = header_data ? header_data.topup_amount : \"\";\n      this.setState({\n        formFields\n      });\n    };\n\n    this.handleCreateCart = () => {\n      let {\n        basicApptDetail\n      } = this.props;\n      let {\n        treatmentList\n      } = this.state;\n      let payload = [];\n\n      if (this.validator.allValid()) {\n        for (let key of treatmentList) {\n          if (key.pay_amount > 0) {\n            let obj = {\n              cust_noid: basicApptDetail.custId,\n              cart_date: dateFormat(new Date(), \"yyyy-mm-dd\"),\n              itemcodeid: key.stock_id,\n              price: key.pay_amount,\n              item_uom: null,\n              treatment_account: null,\n              deposit_account: key.DepositAccountid,\n              prepaid_account: null\n            };\n            payload.push(obj);\n          }\n        }\n\n        this.props.getCommonApi(`itemcart/Check/?cart_date=${dateFormat(new Date(), \"yyyy-mm-dd\")}&cust_noid=${basicApptDetail.custId}`).then(res => {\n          if (res.data.length === 0) {\n            this.props.commonCreateApi(\"itemcart/TopUpCartCreate/\", payload).then(res => {\n              // this.props.handleCartCreated()\n              this.props.handleModal();\n            });\n          } else {\n            this.props.commonCreateApi(`itemcart/TopUpCartCreate/?cart_id=${res.cart_id}`, payload).then(res => {\n              this.props.handleModal();\n            });\n          }\n        });\n      } else {\n        this.validator.showMessages();\n      }\n    };\n\n    this.handleClearLine = () => {\n      this.props.commonDeleteApi(`tmpitemhelper/delete/?clear_all=0&cartid=${this.props.cartId}`).then(() => {\n        this.getCart();\n      });\n    };\n\n    this.handleClearAll = () => {\n      this.props.commonDeleteApi(`tmpitemhelper/delete/?clear_all=1&cartid=${this.props.cartId}`).then(() => {\n        let {\n          formFields,\n          postFields\n        } = this.state; // formFields[\"work_point\"] = \"\";\n        // postFields['times'] = \"\";\n\n        this.setState({\n          formFields,\n          postFields\n        });\n        this.getCart();\n      });\n    };\n\n    this.handlePayAmount = (event, data, index) => {\n      let {\n        treatmentList\n      } = this.state;\n      treatmentList[index][event.target.name] = event.target.value;\n      this.setState({\n        treatmentList\n      });\n    };\n  }\n\n  render() {\n    let {\n      workpoint = \"\",\n      treatmentList = [],\n      headerDetails,\n      formFields\n    } = this.state;\n    let {\n      customer_name,\n      new_outstanding,\n      old_outstanding,\n      topup_amount\n    } = formFields;\n    let {\n      t\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row new-cart treatment-done top-up\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left w-100 text-black common-label-text mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }\n    }, t(\"Customer\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput, {\n      value: customer_name,\n      name: \"customer_name\",\n      onChange: this.handlePostChange,\n      className: `customer-name`,\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left w-100 text-black common-label-text mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 13\n      }\n    }, t(\"Outstanding\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput, {\n      value: old_outstanding,\n      name: \"old_outstanding\",\n      onChange: this.handlePostChange,\n      className: `customer-name`,\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      check: true,\n      className: \"m-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      check: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"checkbox\",\n      onChange: this.props.handleChangeBox,\n      name: \"cust_maillist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 15\n      }\n    }), t(\"Auto\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left w-100 text-black common-label-text mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 13\n      }\n    }, t(\"Top Up Amount\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput, {\n      value: topup_amount,\n      name: \"topup_amount\",\n      onChange: this.handlePostChange,\n      className: `customer-name`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-left w-100 text-black common-label-text mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 13\n      }\n    }, t(\"New Outstanding\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalInput, {\n      value: new_outstanding,\n      name: \"new_outstanding\",\n      onChange: this.handlePostChange,\n      className: `customer-name`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: `col-12 cart-item mt-2`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: `item-list`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableWrapper, {\n      headerDetails: headerDetails,\n      queryHandler: this.handlePagination,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 15\n      }\n    }, treatmentList.length > 0 ? treatmentList.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 29\n        }\n      }, item.transaction_code)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 29\n        }\n      }, item.item_description)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 29\n        }\n      }, item.qty)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 29\n        }\n      }, item.balance)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 29\n        }\n      }, item.outstanding)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center payment-input justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        value: item.pay_amount,\n        name: \"pay_amount\",\n        onChange: e => this.handlePayAmount(e, item, index),\n        className: `customer-name text-right`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 31\n        }\n      }), item.pay_amount ? this.validator.message(\"pay_amount\", item.pay_amount, `required|max:${Number(item.outstanding)},num`) : \"\")), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 29\n        }\n      }, item.sa_staffname)));\n    }) : null)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-12 pt-4 action-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4 text-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 text-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(NormalButton, {\n      buttonClass: \"mx-2\",\n      mainbg: true,\n      className: \" fs-15 confirm\",\n      label: \"Confirm\",\n      outline: false,\n      onClick: this.handleCreateCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 15\n      }\n    })))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  selected_cstomer: state.common.selected_cstomer,\n  basicApptDetail: state.appointment.basicApptDetail\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    // getCustomer,\n    getCommonApi,\n    updateForm,\n    commonCreateApi,\n    commonPatchApi,\n    commonDeleteApi\n  }, dispatch);\n};\n\nexport const TopupProduct = withTranslation()(connect(mapStateToProps, mapDispatchToProps)(TopupProductClass));","map":{"version":3,"sources":["C:/Users/hp/Downloads/quantumCode20082022/src/component/Admin/Cart/topup/product.js"],"names":["React","Component","NormalButton","NormalInput","NormalSelect","InputSearch","NormalModal","TableWrapper","dateFormat","_","history","connect","bindActionCreators","getCommonApi","updateForm","commonCreateApi","commonDeleteApi","commonPatchApi","SimpleReactValidator","service","FormGroup","Label","Input","withTranslation","TopupProductClass","state","treatmentList","cartData","formFields","customer_name","new_outstanding","old_outstanding","topup_amount","headerDetails","label","sortKey","width","divClass","componentWillMount","validator","element","message","autoForceUpdate","roomList","sourceList","staffList","duration","getCart","props","id","then","key","data","setState","getDataFromRes","header_data","handleCreateCart","basicApptDetail","payload","allValid","pay_amount","obj","cust_noid","custId","cart_date","Date","itemcodeid","stock_id","price","item_uom","treatment_account","deposit_account","DepositAccountid","prepaid_account","push","res","length","handleModal","cart_id","showMessages","handleClearLine","cartId","handleClearAll","postFields","handlePayAmount","event","index","target","name","value","render","workpoint","t","handlePostChange","handleChangeBox","handlePagination","map","item","transaction_code","item_description","qty","balance","outstanding","e","Number","sa_staffname","mapStateToProps","selected_cstomer","common","appointment","mapDispatchToProps","dispatch","TopupProduct"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport {\r\n  NormalButton,\r\n  NormalInput,\r\n  NormalSelect,\r\n  InputSearch,\r\n  NormalModal,\r\n  TableWrapper,\r\n} from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport _ from \"lodash\";\r\nimport { history } from \"helpers\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonCreateApi,\r\n  commonDeleteApi,\r\n  commonPatchApi,\r\n} from \"redux/actions/common\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\n// import { Treatment, Payment, EditCart } from './cart/index';\r\nimport service from \"assets/images/make-up-brush.png\";\r\n// import Discount from './cart/discount';\r\nimport { FormGroup, Label, Input } from \"reactstrap\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class TopupProductClass extends Component {\r\n  state = {\r\n    treatmentList: [],\r\n    cartData: {},\r\n    formFields: {\r\n      customer_name: \"\",\r\n      new_outstanding: \"\",\r\n      old_outstanding: \"\",\r\n      topup_amount: \"\",\r\n    },\r\n    headerDetails: [\r\n      { label: \"Invoice No\", sortKey: false, width: \"120px\" },\r\n      { label: \"Item\", sortKey: false, width: \"150px\" },\r\n      {\r\n        label: \"Qty\",\r\n        sortKey: false,\r\n        width: \"50px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Deposit\",\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Outstanding\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Pay amount\",\r\n        width: \"100px\",\r\n        divClass: \"justify-content-center\",\r\n      },\r\n      { label: \"Staff\", width: \"100px\" },\r\n    ],\r\n  };\r\n\r\n  componentWillMount = () => {\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n    let { roomList, sourceList, staffList, cartData, duration, treatmentList } =\r\n      this.state;\r\n\r\n    this.getCart();\r\n  };\r\n\r\n  getCart = () => {\r\n    let { roomList, sourceList, staffList, cartData, duration, treatmentList } =\r\n      this.state;\r\n    this.props\r\n      .getCommonApi(`topupproduct/?cust_id=${this.props.id}`)\r\n      .then(key => {\r\n        cartData = key;\r\n        treatmentList = key.data;\r\n        this.setState({ cartData, treatmentList });\r\n        this.getDataFromRes(key);\r\n        // }\r\n      });\r\n  };\r\n\r\n  getDataFromRes = data => {\r\n    let { header_data } = data;\r\n    let { formFields } = this.state;\r\n    formFields[\"customer_name\"] = header_data ? header_data.customer_name : \"\";\r\n    formFields[\"new_outstanding\"] = header_data\r\n      ? header_data.new_outstanding\r\n      : \"\";\r\n    formFields[\"old_outstanding\"] = header_data\r\n      ? header_data.old_outstanding\r\n      : \"\";\r\n    formFields[\"topup_amount\"] = header_data ? header_data.topup_amount : \"\";\r\n    this.setState({\r\n      formFields,\r\n    });\r\n  };\r\n\r\n  handleCreateCart = () => {\r\n    let { basicApptDetail } = this.props;\r\n    let { treatmentList } = this.state;\r\n    let payload = [];\r\n    if (this.validator.allValid()) {\r\n      for (let key of treatmentList) {\r\n        if (key.pay_amount > 0) {\r\n          let obj = {\r\n            cust_noid: basicApptDetail.custId,\r\n            cart_date: dateFormat(new Date(), \"yyyy-mm-dd\"),\r\n            itemcodeid: key.stock_id,\r\n            price: key.pay_amount,\r\n            item_uom: null,\r\n            treatment_account: null,\r\n            deposit_account: key.DepositAccountid,\r\n            prepaid_account: null,\r\n          };\r\n          payload.push(obj);\r\n        }\r\n      }\r\n\r\n      this.props\r\n        .getCommonApi(\r\n          `itemcart/Check/?cart_date=${dateFormat(\r\n            new Date(),\r\n            \"yyyy-mm-dd\"\r\n          )}&cust_noid=${basicApptDetail.custId}`\r\n        )\r\n        .then(res => {\r\n          if (res.data.length === 0) {\r\n            this.props\r\n              .commonCreateApi(\"itemcart/TopUpCartCreate/\", payload)\r\n              .then(res => {\r\n                // this.props.handleCartCreated()\r\n                this.props.handleModal();\r\n              });\r\n          } else {\r\n            this.props\r\n              .commonCreateApi(\r\n                `itemcart/TopUpCartCreate/?cart_id=${res.cart_id}`,\r\n                payload\r\n              )\r\n              .then(res => {\r\n                this.props.handleModal();\r\n              });\r\n          }\r\n        });\r\n    } else {\r\n      this.validator.showMessages();\r\n    }\r\n  };\r\n\r\n  handleClearLine = () => {\r\n    this.props\r\n      .commonDeleteApi(\r\n        `tmpitemhelper/delete/?clear_all=0&cartid=${this.props.cartId}`\r\n      )\r\n      .then(() => {\r\n        this.getCart();\r\n      });\r\n  };\r\n\r\n  handleClearAll = () => {\r\n    this.props\r\n      .commonDeleteApi(\r\n        `tmpitemhelper/delete/?clear_all=1&cartid=${this.props.cartId}`\r\n      )\r\n      .then(() => {\r\n        let { formFields, postFields } = this.state;\r\n        // formFields[\"work_point\"] = \"\";\r\n        // postFields['times'] = \"\";\r\n        this.setState({\r\n          formFields,\r\n          postFields,\r\n        });\r\n        this.getCart();\r\n      });\r\n  };\r\n\r\n  handlePayAmount = (event, data, index) => {\r\n    let { treatmentList } = this.state;\r\n    treatmentList[index][event.target.name] = event.target.value;\r\n    this.setState({\r\n      treatmentList,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      workpoint = \"\",\r\n      treatmentList = [],\r\n      headerDetails,\r\n      formFields,\r\n    } = this.state;\r\n    let { customer_name, new_outstanding, old_outstanding, topup_amount } =\r\n      formFields;\r\n    let { t } = this.props;\r\n    return (\r\n      <div className=\"row new-cart treatment-done top-up\">\r\n        <div className=\"col-5\">\r\n          <div className=\"d-flex\">\r\n            <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n              {t(\"Customer\")}\r\n            </label>\r\n            <div className=\"input-group\">\r\n              <NormalInput\r\n                value={customer_name}\r\n                name=\"customer_name\"\r\n                onChange={this.handlePostChange}\r\n                className={`customer-name`}\r\n                disabled\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex\">\r\n            <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n              {t(\"Outstanding\")}\r\n            </label>\r\n            <div className=\"input-group\">\r\n              <NormalInput\r\n                value={old_outstanding}\r\n                name=\"old_outstanding\"\r\n                onChange={this.handlePostChange}\r\n                className={`customer-name`}\r\n                disabled\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-3\">\r\n          <FormGroup check className=\"m-0\">\r\n            <Label check>\r\n              <Input\r\n                type=\"checkbox\"\r\n                onChange={this.props.handleChangeBox}\r\n                name=\"cust_maillist\"\r\n              />\r\n              {t(\"Auto\")}\r\n            </Label>\r\n          </FormGroup>\r\n        </div>\r\n        <div className=\"col-4\">\r\n          <div className=\"d-flex\">\r\n            <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n              {t(\"Top Up Amount\")}\r\n            </label>\r\n            <div className=\"input-group\">\r\n              <NormalInput\r\n                value={topup_amount}\r\n                name=\"topup_amount\"\r\n                onChange={this.handlePostChange}\r\n                className={`customer-name`}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex\">\r\n            <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n              {t(\"New Outstanding\")}\r\n            </label>\r\n            <div className=\"input-group\">\r\n              <NormalInput\r\n                value={new_outstanding}\r\n                name=\"new_outstanding\"\r\n                onChange={this.handlePostChange}\r\n                className={`customer-name`}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className={`col-12 cart-item mt-2`}>\r\n          <div className={`item-list`}>\r\n            <div className=\"table\">\r\n              <TableWrapper\r\n                headerDetails={headerDetails}\r\n                queryHandler={this.handlePagination}\r\n              >\r\n                {treatmentList.length > 0\r\n                  ? treatmentList.map((item, index) => {\r\n                      return (\r\n                        <tr key={index}>\r\n                          <td>\r\n                            <div className=\"text-left\">\r\n                              {item.transaction_code}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-left\">\r\n                              {item.item_description}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-right\">{item.qty}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-right\">{item.balance}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-right\">{item.outstanding}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"d-flex align-items-center payment-input justify-content-center\">\r\n                              <NormalInput\r\n                                value={item.pay_amount}\r\n                                name=\"pay_amount\"\r\n                                onChange={e =>\r\n                                  this.handlePayAmount(e, item, index)\r\n                                }\r\n                                className={`customer-name text-right`}\r\n                              />\r\n                              {item.pay_amount\r\n                                ? this.validator.message(\r\n                                    \"pay_amount\",\r\n                                    item.pay_amount,\r\n                                    `required|max:${Number(\r\n                                      item.outstanding\r\n                                    )},num`\r\n                                  )\r\n                                : \"\"}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-left\">{item.sa_staffname}</div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  : null}\r\n              </TableWrapper>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 pt-4 action-bar\">\r\n          <div className=\"row\">\r\n            <div className=\"col-6 d-flex\">\r\n              {/* <NormalButton\r\n                                buttonClass={\"mx-2\"}\r\n                                mainbg={true}\r\n                                className=\"fs-15 clear-line\"\r\n                                label=\"Clear Line\"\r\n                                outline={false}\r\n                                onClick={this.handleClearLine}\r\n                            />\r\n                            <NormalButton\r\n                                buttonClass={\"mx-2\"}\r\n                                mainbg={true}\r\n                                className=\"fs-15 clear-all\"\r\n                                label=\"Clear All\"\r\n                                outline={false}\r\n                                onClick={this.handleClearAll}\r\n                            /> */}\r\n            </div>\r\n            <div className=\"col-4 text-right\"></div>\r\n            <div className=\"col-2 text-right\">\r\n              <NormalButton\r\n                buttonClass={\"mx-2\"}\r\n                mainbg={true}\r\n                className=\" fs-15 confirm\"\r\n                label=\"Confirm\"\r\n                outline={false}\r\n                onClick={this.handleCreateCart}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      // getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonCreateApi,\r\n      commonPatchApi,\r\n      commonDeleteApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const TopupProduct = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(TopupProductClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}