{"ast":null,"code":"var _jsxFileName = \"E:\\\\newfrontend\\\\webfe\\\\src\\\\component\\\\Admin\\\\Cart\\\\cart\\\\productDetailsPopup.js\";\nimport React, { Component } from \"react\";\nimport { NormalInput, NormalButton, NormalSelect } from \"component/common\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { getCommonApi, commonPatchApi, commonCreateApi } from \"redux/actions/common\";\nimport { Toast } from \"service/toast\";\nimport _ from \"lodash\";\nimport \"./style.scss\";\nimport { withTranslation } from \"react-i18next\";\nexport class ProductDetailsPopupClass extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data_list: [],\n      hold_item_reasons_options: [],\n      sourceList: [],\n      activRow: 0,\n      depositIndex: null\n    };\n\n    this.getProductList = () => {\n      let {\n        data_list\n      } = this.state;\n      let {\n        basicApptDetail\n      } = this.props;\n      this.props.getCommonApi(`cartpopup/?cust_noid=${basicApptDetail.custId}&cart_id=${this.props.id}&is_product=1`).then(async key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status == \"200\") {\n          console.log(key, \"cartproductpopuplist\");\n          data_list = data;\n          await this.setState({\n            data_list\n          });\n\n          if (this.state.data_list.length > 0) {\n            this.setState({\n              activeRow: this.state.data_list[0].id\n            });\n            document.getElementById(this.state.data_list[0].id).classList.toggle(\"d-none\");\n          }\n        }\n      });\n    };\n\n    this.handleSubmit = () => {\n      let {\n        data_list,\n        sourceList\n      } = this.state;\n      sourceList = [];\n\n      for (let value of data_list) {\n        let currentData = Number(value.deposit);\n        let transamt = Number(value.trans_amt);\n\n        if (currentData > transamt) {\n          Toast({\n            type: \"error\",\n            message: \"Deposit amount should be less than or equal to transaction amount\"\n          });\n          return false;\n        } else {\n          if (value.is_foc) {\n            sourceList.push({\n              id: value.id,\n              quantity: Number(value.quantity),\n              price: Number(value.price).toFixed(2),\n              holditemqty: Number(value.holditemqty),\n              holdreason: Number(value.holdreason)\n            });\n          } else {\n            sourceList.push({\n              id: value.id,\n              quantity: Number(value.quantity),\n              price: Number(value.price).toFixed(2),\n              deposit: Number(value.deposit).toFixed(2),\n              holditemqty: Number(value.holditemqty),\n              holdreason: Number(value.holdreason)\n            });\n          }\n        }\n      }\n\n      console.log(sourceList, \"productupdatelist\");\n      this.props.commonCreateApi(`cartpopup/product/`, sourceList).then(key => {\n        let {\n          status,\n          data\n        } = key;\n\n        if (status == 200) {\n          this.props.handleModal();\n        }\n      });\n    };\n\n    this.handleChange = (e, index) => {\n      let {\n        data_list\n      } = this.state;\n      let data = e.target.value;\n\n      if ([e.target.name] == \"holdreason\") {\n        data_list[index][e.target.name] = Number(data);\n      } else if ([e.target.name] == \"holditemqty\") {\n        let ActualQty = Number(data_list[index][\"quantity\"]);\n        let HoldQty = Number(data);\n\n        if (HoldQty > ActualQty) {\n          Toast({\n            type: \"error\",\n            message: \"Hold quantity should be less than or equal to actual quantity\"\n          });\n        } else {\n          data_list[index][e.target.name] = HoldQty;\n        }\n      } else {\n        data_list[index][e.target.name] = data;\n      }\n\n      this.setState({\n        data_list\n      });\n\n      if ([e.target.name] == \"quantity\" || [e.target.name] == \"price\") {\n        this.handlePriceandQuantityChange(index);\n      }\n    };\n\n    this.handleAccordion = async id => {\n      let elements = document.getElementsByClassName(\"accordion\");\n      await this.setState({\n        activeRow: id\n      });\n\n      for (let i = 0; i < elements.length; i++) {\n        elements[i].classList.add(\"d-none\");\n      }\n\n      document.getElementById(id).classList.toggle(\"d-none\");\n    };\n\n    this.handlePriceandQuantityChange = index => {\n      let {\n        data_list\n      } = this.state;\n      let total_disc = Number(data_list[index][\"discount_amt\"]).toFixed(2) + Number(data_list[index][\"additional_discountamt\"]);\n      data_list[index][\"discount_price\"] = Number(data_list[index][\"price\"] - total_disc).toFixed(2);\n      let after_linedisc = (data_list[index][\"price\"] - data_list[index][\"discount_amt\"]) * data_list[index][\"quantity\"];\n      data_list[index][\"trans_amt\"] = Number(after_linedisc - data_list[index][\"additional_discountamt\"]).toFixed(2);\n      data_list[index][\"deposit\"] = Number(after_linedisc - data_list[index][\"additional_discountamt\"]).toFixed(2);\n      this.setState({\n        data_list\n      });\n    };\n\n    this.validateDepositAmount = () => {\n      debugger;\n      let {\n        data_list,\n        depositIndex\n      } = this.state;\n      let deposit = Number(data_list[depositIndex][\"deposit\"]);\n      let transAmt = Number(data_list[depositIndex][\"trans_amt\"]);\n\n      if (deposit > transAmt) {\n        Toast({\n          type: \"error\",\n          message: \"Deposit amount should be less than or equal to transaction amount\"\n        });\n        data_list[depositIndex][\"deposit\"] = \"\";\n        depositIndex = null;\n        this.setState({\n          data_list,\n          depositIndex\n        });\n      }\n    };\n\n    this.handleDepositOnChange = async (event, index) => {\n      //event.persist();\n      let {\n        data_list,\n        depositIndex\n      } = this.state;\n      data_list[index][\"deposit\"] = event.target.value;\n      depositIndex = index;\n      await this.setState({\n        data_list,\n        depositIndex\n      });\n\n      if (!this.debouncedFnDeposit) {\n        this.debouncedFnDeposit = _.debounce(async () => {\n          this.validateDepositAmount();\n        }, 500);\n      }\n\n      this.debouncedFnDeposit();\n    };\n  }\n\n  componentDidMount() {\n    let {\n      hold_item_reasons_options\n    } = this.state;\n    this.props.getCommonApi(`holditemsetup/`).then(key => {\n      let {\n        status,\n        data\n      } = key;\n\n      if (status === 200) {\n        for (let value of data) {\n          hold_item_reasons_options.push({\n            value: value.id,\n            label: value.hold_desc\n          });\n        }\n\n        this.setState({\n          hold_item_reasons_options\n        });\n      }\n    });\n    this.getProductList();\n  }\n\n  render() {\n    let {\n      data_list,\n      hold_item_reasons_options,\n      activeRow\n    } = this.state;\n    let {\n      t\n    } = this.props;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid mb-4 mt-2 product-details\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 15\n      }\n    }, t(\"Product Details\"))), data_list && data_list.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(NormalButton, {\n      mainbg: false,\n      className: \"col-12 fs-15 submit-btn\",\n      label: \"Done\",\n      onClick: () => this.handleSubmit(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 17\n      }\n    })) : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-3 pr-5 mt-2 fw-500 h6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 13\n      }\n    }, t(`Item`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    }, t(`Qty`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 13\n      }\n    }, t(`Unit Price`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 13\n      }\n    }, t(`Disc`), \"\\xA0$\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 13\n      }\n    }, t(`D/Price`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 13\n      }\n    }, t(`Amount`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 13\n      }\n    }, t(`Deposit`)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 13\n      }\n    }, t(`Staff`))), data_list && data_list.length <= 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-5 pr-3 mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 13\n      }\n    }, t(\"No Record Found\")) : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row pl-5 pr-3 mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }\n    }, data_list.map((item, index) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 mb-2 fs-14\",\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: `row w-100 rounded p-2 accordion-menu border ${activeRow == item.id ? \"border-primary\" : \"\"}`,\n        onClick: () => this.handleAccordion(item.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 21\n        }\n      }, item.itemdesc), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 21\n        }\n      }, item.quantity), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 21\n        }\n      }, item.price), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }\n      }, item.totl_disc), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 21\n        }\n      }, item.discount_price), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 21\n        }\n      }, item.trans_amt), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 21\n        }\n      }, item.deposit), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 21\n        }\n      }, item.sales_staffs)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 rounded bg-light p-3 d-none accordion fs-14\",\n        id: item.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 pl-3 mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 25\n        }\n      }, t(\"Quantity\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.quantity,\n        type: \"number\",\n        name: \"quantity\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 27\n        }\n      }))), !item.is_foc ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 27\n        }\n      }, t(\"Deposit\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.deposit,\n        name: \"deposit\",\n        onChange: e => this.handleDepositOnChange(e, index) //onBlur={e => this.validateDepositAmount(e, index)}\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 29\n        }\n      }))) : null, !item.is_foc ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 27\n        }\n      }, t(\"Unit Price\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.price,\n        type: \"number\",\n        name: \"price\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 29\n        }\n      }))) : null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 25\n        }\n      }, t(\"Hold Reason\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalSelect, {\n        options: hold_item_reasons_options,\n        value: item.holdreason ? item.holdreason : 0,\n        name: \"holdreason\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 27\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"text-left text-black common-label-text fs-17 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 25\n        }\n      }, t(\"Hold Quantity\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(NormalInput, {\n        placeholder: \"Enter here\",\n        value: item.holditemqty ? item.holditemqty : \"\",\n        type: \"number\",\n        name: \"holditemqty\",\n        onChange: e => this.handleChange(e, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 27\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row w-100 pl-3 mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 21\n        }\n      })));\n    }))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  basicApptDetail: state.appointment.basicApptDetail\n});\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    getCommonApi,\n    commonPatchApi,\n    commonCreateApi\n  }, dispatch);\n};\n\nexport const ProductDetailsPopup = withTranslation()(connect(mapStateToProps, mapDispatchToProps)(ProductDetailsPopupClass));","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/cart/productDetailsPopup.js"],"names":["React","Component","NormalInput","NormalButton","NormalSelect","connect","bindActionCreators","getCommonApi","commonPatchApi","commonCreateApi","Toast","_","withTranslation","ProductDetailsPopupClass","state","data_list","hold_item_reasons_options","sourceList","activRow","depositIndex","getProductList","basicApptDetail","props","custId","id","then","key","status","data","console","log","setState","length","activeRow","document","getElementById","classList","toggle","handleSubmit","value","currentData","Number","deposit","transamt","trans_amt","type","message","is_foc","push","quantity","price","toFixed","holditemqty","holdreason","handleModal","handleChange","e","index","target","name","ActualQty","HoldQty","handlePriceandQuantityChange","handleAccordion","elements","getElementsByClassName","i","add","total_disc","after_linedisc","validateDepositAmount","transAmt","handleDepositOnChange","event","debouncedFnDeposit","debounce","componentDidMount","label","hold_desc","render","t","map","item","itemdesc","totl_disc","discount_price","sales_staffs","mapStateToProps","appointment","mapDispatchToProps","dispatch","ProductDetailsPopup"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { NormalInput, NormalButton, NormalSelect } from \"component/common\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  commonPatchApi,\r\n  commonCreateApi,\r\n} from \"redux/actions/common\";\r\nimport { Toast } from \"service/toast\";\r\nimport _ from \"lodash\";\r\nimport \"./style.scss\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class ProductDetailsPopupClass extends Component {\r\n  state = {\r\n    data_list: [],\r\n    hold_item_reasons_options: [],\r\n    sourceList: [],\r\n    activRow: 0,\r\n    depositIndex: null,\r\n  };\r\n\r\n  componentDidMount() {\r\n    let { hold_item_reasons_options } = this.state;\r\n    this.props.getCommonApi(`holditemsetup/`).then(key => {\r\n      let { status, data } = key;\r\n      if (status === 200) {\r\n        for (let value of data) {\r\n          hold_item_reasons_options.push({\r\n            value: value.id,\r\n            label: value.hold_desc,\r\n          });\r\n        }\r\n        this.setState({ hold_item_reasons_options });\r\n      }\r\n    });\r\n    this.getProductList();\r\n  }\r\n  getProductList = () => {\r\n    let { data_list } = this.state;\r\n    let { basicApptDetail } = this.props;\r\n    this.props\r\n      .getCommonApi(\r\n        `cartpopup/?cust_noid=${basicApptDetail.custId}&cart_id=${this.props.id}&is_product=1`\r\n      )\r\n      .then(async key => {\r\n        let { status, data } = key;\r\n        if (status == \"200\") {\r\n          console.log(key, \"cartproductpopuplist\");\r\n          data_list = data;\r\n          await this.setState({\r\n            data_list,\r\n          });\r\n          if (this.state.data_list.length > 0) {\r\n            this.setState({\r\n              activeRow: this.state.data_list[0].id,\r\n            });\r\n            document\r\n              .getElementById(this.state.data_list[0].id)\r\n              .classList.toggle(\"d-none\");\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  handleSubmit = () => {\r\n    let { data_list, sourceList } = this.state;\r\n    sourceList = [];\r\n\r\n    for (let value of data_list) {\r\n      let currentData = Number(value.deposit);\r\n      let transamt = Number(value.trans_amt);\r\n      if (currentData > transamt) {\r\n        Toast({\r\n          type: \"error\",\r\n          message:\r\n            \"Deposit amount should be less than or equal to transaction amount\",\r\n        });\r\n        return false;\r\n      } else {\r\n        if (value.is_foc) {\r\n          sourceList.push({\r\n            id: value.id,\r\n            quantity: Number(value.quantity),\r\n            price: Number(value.price).toFixed(2),\r\n            holditemqty: Number(value.holditemqty),\r\n            holdreason: Number(value.holdreason),\r\n          });\r\n        } else {\r\n          sourceList.push({\r\n            id: value.id,\r\n            quantity: Number(value.quantity),\r\n            price: Number(value.price).toFixed(2),\r\n            deposit: Number(value.deposit).toFixed(2),\r\n            holditemqty: Number(value.holditemqty),\r\n            holdreason: Number(value.holdreason),\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log(sourceList, \"productupdatelist\");\r\n    this.props.commonCreateApi(`cartpopup/product/`, sourceList).then(key => {\r\n      let { status, data } = key;\r\n      if (status == 200) {\r\n        this.props.handleModal();\r\n      }\r\n    });\r\n  };\r\n\r\n  handleChange = (e, index) => {\r\n    let { data_list } = this.state;\r\n    let data = e.target.value;\r\n    if ([e.target.name] == \"holdreason\") {\r\n      data_list[index][e.target.name] = Number(data);\r\n    } else if ([e.target.name] == \"holditemqty\") {\r\n      let ActualQty = Number(data_list[index][\"quantity\"]);\r\n      let HoldQty = Number(data);\r\n      if (HoldQty > ActualQty) {\r\n        Toast({\r\n          type: \"error\",\r\n          message:\r\n            \"Hold quantity should be less than or equal to actual quantity\",\r\n        });\r\n      } else {\r\n        data_list[index][e.target.name] = HoldQty;\r\n      }\r\n    } else {\r\n      data_list[index][e.target.name] = data;\r\n    }\r\n    this.setState({ data_list });\r\n    if ([e.target.name] == \"quantity\" || [e.target.name] == \"price\") {\r\n      this.handlePriceandQuantityChange(index);\r\n    }\r\n  };\r\n\r\n  handleAccordion = async id => {\r\n    let elements = document.getElementsByClassName(\"accordion\");\r\n    await this.setState({\r\n      activeRow: id,\r\n    });\r\n    for (let i = 0; i < elements.length; i++) {\r\n      elements[i].classList.add(\"d-none\");\r\n    }\r\n    document.getElementById(id).classList.toggle(\"d-none\");\r\n  };\r\n  handlePriceandQuantityChange = index => {\r\n    let { data_list } = this.state;\r\n    let total_disc =\r\n      Number(data_list[index][\"discount_amt\"]).toFixed(2) +\r\n      Number(data_list[index][\"additional_discountamt\"]);\r\n    data_list[index][\"discount_price\"] = Number(\r\n      data_list[index][\"price\"] - total_disc\r\n    ).toFixed(2);\r\n    let after_linedisc =\r\n      (data_list[index][\"price\"] - data_list[index][\"discount_amt\"]) *\r\n      data_list[index][\"quantity\"];\r\n    data_list[index][\"trans_amt\"] = Number(\r\n      after_linedisc - data_list[index][\"additional_discountamt\"]\r\n    ).toFixed(2);\r\n    data_list[index][\"deposit\"] = Number(\r\n      after_linedisc - data_list[index][\"additional_discountamt\"]\r\n    ).toFixed(2);\r\n    this.setState({\r\n      data_list,\r\n    });\r\n  };\r\n\r\n  validateDepositAmount = () => {\r\n    debugger;\r\n    let { data_list, depositIndex } = this.state;\r\n    let deposit = Number(data_list[depositIndex][\"deposit\"]);\r\n    let transAmt = Number(data_list[depositIndex][\"trans_amt\"]);\r\n    if (deposit > transAmt) {\r\n      Toast({\r\n        type: \"error\",\r\n        message:\r\n          \"Deposit amount should be less than or equal to transaction amount\",\r\n      });\r\n      data_list[depositIndex][\"deposit\"] = \"\";\r\n      depositIndex = null;\r\n      this.setState({\r\n        data_list,\r\n        depositIndex,\r\n      });\r\n    }\r\n  };\r\n  handleDepositOnChange = async (event, index) => {\r\n    //event.persist();\r\n    let { data_list, depositIndex } = this.state;\r\n    data_list[index][\"deposit\"] = event.target.value;\r\n    depositIndex = index;\r\n    await this.setState({ data_list, depositIndex });\r\n    if (!this.debouncedFnDeposit) {\r\n      this.debouncedFnDeposit = _.debounce(async () => {\r\n        this.validateDepositAmount();\r\n      }, 500);\r\n    }\r\n    this.debouncedFnDeposit();\r\n  };\r\n\r\n  render() {\r\n    let { data_list, hold_item_reasons_options, activeRow } = this.state;\r\n    let { t } = this.props;\r\n    return (\r\n      <>\r\n        <div className=\"container-fluid mb-4 mt-2 product-details\">\r\n          <div className=\"row\">\r\n            <div className=\"col-10\">\r\n              <h4>{t(\"Product Details\")}</h4>\r\n            </div>\r\n            {data_list && data_list.length > 0 ? (\r\n              <div className=\"col-2\">\r\n                <NormalButton\r\n                  mainbg={false}\r\n                  className=\"col-12 fs-15 submit-btn\"\r\n                  label=\"Done\"\r\n                  onClick={() => this.handleSubmit()}\r\n                />\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n          <div className=\"row pl-3 pr-5 mt-2 fw-500 h6\">\r\n            <div className=\"col-4\">{t(`Item`)}</div>\r\n            <div className=\"col-1 text-center\">{t(`Qty`)}</div>\r\n            <div className=\"col-1 text-center\">{t(`Unit Price`)}</div>\r\n            <div className=\"col-1 text-center\">{t(`Disc`)}&nbsp;$</div>\r\n            <div className=\"col-1 text-center\">{t(`D/Price`)}</div>\r\n            <div className=\"col-1 text-center\">{t(`Amount`)}</div>\r\n            <div className=\"col-1 text-center\">{t(`Deposit`)}</div>\r\n            <div className=\"col-2\">{t(`Staff`)}</div>\r\n          </div>\r\n          {data_list && data_list.length <= 0 ? (\r\n            <div className=\"row pl-5 pr-3 mt-2\">{t(\"No Record Found\")}</div>\r\n          ) : null}\r\n\r\n          <div className=\"row pl-5 pr-3 mt-2\">\r\n            {data_list.map((item, index) => {\r\n              return (\r\n                <div className=\"row w-100 mb-2 fs-14\" key={index}>\r\n                  <div\r\n                    className={`row w-100 rounded p-2 accordion-menu border ${\r\n                      activeRow == item.id ? \"border-primary\" : \"\"\r\n                    }`}\r\n                    onClick={() => this.handleAccordion(item.id)}\r\n                  >\r\n                    <div className=\"col-4\">{item.itemdesc}</div>\r\n                    <div className=\"col-1 text-center\">{item.quantity}</div>\r\n                    <div className=\"col-1 text-right\">{item.price}</div>\r\n                    <div className=\"col-1 text-right\">{item.totl_disc}</div>\r\n                    <div className=\"col-1 text-right\">\r\n                      {item.discount_price}\r\n                    </div>\r\n                    <div className=\"col-1 text-right\">{item.trans_amt}</div>\r\n                    <div className=\"col-1 text-right\">{item.deposit}</div>\r\n                    <div className=\"col-2\">{item.sales_staffs}</div>\r\n                  </div>\r\n                  <div\r\n                    className=\"row w-100 rounded bg-light p-3 d-none accordion fs-14\"\r\n                    id={item.id}\r\n                  >\r\n                    <div className=\"row w-100 pl-3 mb-3\">\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          {t(\"Quantity\")}\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalInput\r\n                            placeholder=\"Enter here\"\r\n                            value={item.quantity}\r\n                            type=\"number\"\r\n                            name=\"quantity\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      {!item.is_foc ? (\r\n                        <div className=\"col\">\r\n                          <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                            {t(\"Deposit\")}\r\n                          </label>\r\n                          <div className=\"input-group\">\r\n                            <NormalInput\r\n                              placeholder=\"Enter here\"\r\n                              value={item.deposit}\r\n                              name=\"deposit\"\r\n                              onChange={e =>\r\n                                this.handleDepositOnChange(e, index)\r\n                              }\r\n                              //onBlur={e => this.validateDepositAmount(e, index)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n                      {!item.is_foc ? (\r\n                        <div className=\"col\">\r\n                          <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                            {t(\"Unit Price\")}\r\n                          </label>\r\n                          <div className=\"input-group\">\r\n                            <NormalInput\r\n                              placeholder=\"Enter here\"\r\n                              value={item.price}\r\n                              type=\"number\"\r\n                              name=\"price\"\r\n                              onChange={e => this.handleChange(e, index)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          {t(\"Hold Reason\")}\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalSelect\r\n                            options={hold_item_reasons_options}\r\n                            value={item.holdreason ? item.holdreason : 0}\r\n                            name=\"holdreason\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"col\">\r\n                        <label className=\"text-left text-black common-label-text fs-17 pb-2\">\r\n                          {t(\"Hold Quantity\")}\r\n                        </label>\r\n                        <div className=\"input-group\">\r\n                          <NormalInput\r\n                            placeholder=\"Enter here\"\r\n                            value={item.holditemqty ? item.holditemqty : \"\"}\r\n                            type=\"number\"\r\n                            name=\"holditemqty\"\r\n                            onChange={e => this.handleChange(e, index)}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"row w-100 pl-3 mb-3\"></div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      commonPatchApi,\r\n      commonCreateApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\nexport const ProductDetailsPopup = withTranslation()(\r\n  connect(mapStateToProps, mapDispatchToProps)(ProductDetailsPopupClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}