{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{NormalButton,NormalDate,NormalSelect}from\"component/common\";import{InputSearch,TableWrapper}from\"component/common\";import{NormalInput,NormalDateTime}from\"component/common\";import{dateFormat}from\"service/helperFunctions\";import{history}from\"helpers\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{getCommonApi,commonCreateApi}from\"redux/actions/common\";export var InvoiceHistoryClass=/*#__PURE__*/function(_Component){_inherits(InvoiceHistoryClass,_Component);var _super=_createSuper(InvoiceHistoryClass);function InvoiceHistoryClass(){var _this;_classCallCheck(this,InvoiceHistoryClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={headerDetails:[{label:\"Cust Code\"},{label:\"Cust Name\"},{label:\"Paid On\"},{label:\"Amount\"},{label:\"Transaction No\"},{label:\"Reference No\"},{label:\"Billed By\"},{label:\"Status\"},{label:\"Type\"},{label:\"\"}],billingList:[],pageMeta:{chunk:10,page:1,total:10,totalPages:2},formField:{fromDate:new Date(),toDate:new Date(),transCode:\"\",custCode:\"\",custName:\"\",transtype:\"All\"},active:false,currentIndex:-1,page:1,limit:10,isOpenvoidCheckout:false,transtypeOptions:[{label:\"All\",value:\"All\"},{label:\"Sales\",value:\"Sales\"},{label:\"Void\",value:\"Void\"},{label:\"TD\",value:\"TD\"}],customer_id:\"\"};_this.getTransactions=function(){debugger;var _this$state=_this.state,billingList=_this$state.billingList,pageMeta=_this$state.pageMeta,formField=_this$state.formField,page=_this$state.page,limit=_this$state.limit,customer_id=_this$state.customer_id;var fromDate=formField.fromDate,toDate=formField.toDate,transCode=formField.transCode,custCode=formField.custCode,custName=formField.custName,transtype=formField.transtype;var From=new Date();if(fromDate&&fromDate!==\"\"){From=fromDate;}else{_this.setState({fromDate:From});}var To=new Date();if(toDate&&toDate!==\"\"){To=toDate;}else{_this.setState({toDate:To});}_this.props.getCommonApi(\"transactionhistory/?from_date=\".concat(dateFormat(From,\"yyyy-mm-dd\"),\"&to_date=\").concat(dateFormat(To,\"yyyy-mm-dd\"),\"&transac_no=\").concat(transCode,\"&cust_code=\").concat(custCode,\"&cust_name=\").concat(custName,\"&page=\").concat(page,\"&limit=\").concat(limit,\"&invoice_type=\").concat(transtype,\"&cust_id=\").concat(_this.props.id)).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(res,\"dsfdfaafg\");_context.next=3;return _this.setState({billingList:[]});case 3:billingList=res.data.dataList;pageMeta=res.data.meta.pagination;_this.setState({billingList:billingList,pageMeta:pageMeta});case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};_this.handlePrint=function(id){var _this$state2=_this.state,billingList=_this$state2.billingList,pageMeta=_this$state2.pageMeta,formField=_this$state2.formField,page=_this$state2.page,limit=_this$state2.limit;var fromDate=formField.fromDate,toDate=formField.toDate,transCode=formField.transCode,custCode=formField.custCode,custName=formField.custName;_this.props.getCommonApi(\"receiptpdf/?sa_transacno=\".concat(id)).then(function(res){});};_this.handlePagination=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(pageNo){var page;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:page=_this.state.page;page=pageNo.page;_context2.next=4;return _this.setState({page:page});case 4:_this.getTransactions();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.handleShare=function(id){_this.props.commonCreateApi(\"receiptpdfsend/?sa_transacno=\".concat(id)).then(function(res){});};_this.handleInvoice=function(id){_this.props.getCommonApi(\"customerreceiptprint/?sa_transacno=\".concat(id)).then(function(res){});};_this.handleClick=function(key){if(!_this.state.active){document.addEventListener(\"click\",_this.handleOutsideClick,false);}else{document.removeEventListener(\"click\",_this.handleOutsideClick,false);}_this.setState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.handleOutsideClick=function(e){if(_this.node!=null){if(_this.node.contains(e.target)){return;}}_this.handleClick();};_this.handleChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref3){var _ref3$target,value,name,formField;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref3$target=_ref3.target,value=_ref3$target.value,name=_ref3$target.name;formField=_this.state.formField;formField[name]=value;_context3.next=5;return _this.setState({formField:formField});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}();_this.handleDatePick=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(name,value){var formField;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:formField=_this.state.formField;formField[name]=value;_context4.next=4;return _this.setState({formField:formField});case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4,_x5){return _ref5.apply(this,arguments);};}();_this.handleSearch=function(){_this.getTransactions();};return _this;}_createClass(InvoiceHistoryClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.setState({customer_id:this.props.id});var From=new Date();var formField=this.state.formField;var firstdayMonth=new Date(From.getFullYear()-2,From.getMonth(),1);formField[\"fromDate\"]=firstdayMonth;this.setState({formField:formField});this.getTransactions();}},{key:\"render\",value:function render(){var _this$state3=this.state,headerDetails=_this$state3.headerDetails,pageMeta=_this$state3.pageMeta,billingList=_this$state3.billingList,formField=_this$state3.formField,transtypeOptions=_this$state3.transtypeOptions;var fromDate=formField.fromDate,toDate=formField.toDate,transCode=formField.transCode,custCode=formField.custCode,custName=formField.custName,transtype=formField.transtype;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"invoice-History mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row m-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text\"},\"From Date\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalDateTime,{onChange:this.handleDatePick,value:fromDate?new Date(fromDate):new Date(),name:\"fromDate\",showYearDropdown:true,dateFormat:\"dd/MM/yyyy\",type:\"date\",maxDate:new Date(toDate)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text\"},\"To Date\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalDateTime,{onChange:this.handleDatePick,inputcol:\"p-0 inTime\",value:toDate?new Date(toDate):new Date(),name:\"toDate\",className:\"dob-pick\",showYearDropdown:true,dateFormat:\"dd/MM/yyyy\",type:\"date\",minDate:new Date(fromDate)})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text mr-2\"},\"Transaction Code\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalInput,{value:transCode,name:\"transCode\",onChange:this.handleChange,className:\"customer-name\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex mb-2\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left w-100 text-black common-label-text\"},\"Transaction Type\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(NormalSelect,{placeholderrequired:false,options:transtypeOptions,value:transtype,iconname:\"icon-down-key\",name:\"transtype\",onChange:this.handleChange})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",mainbg:true,className:\" fs-15 confirm\",label:\"Search\",outline:false,onClick:this.handleSearch}))),/*#__PURE__*/React.createElement(\"div\",{className:\"billing-table\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-container\"},/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination,pageMeta:pageMeta},billingList?billingList.map(function(item,index){var icon=item.icon,id=item.id,sa_custno=item.sa_custno,sa_custname=item.sa_custname,sa_date=item.sa_date,sa_totamt=item.sa_totamt,sa_transacno_ref=item.sa_transacno_ref,void_refno=item.void_refno,sa_staffname=item.sa_staffname,sa_status=item.sa_status,sa_transacno_type=item.sa_transacno_type,sa_transacno=item.sa_transacno;return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_custno)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_custname)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_totamt)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_transacno_ref)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},void_refno)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_staffname)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_status)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center\"},sa_transacno_type)),/*#__PURE__*/React.createElement(\"td\",{className:\"position-relative\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",mainbg:true,className:\" fs-15 confirm\",label:\"View\",outline:false,onClick:function onClick(){return history.push(\"/admin/transactionhistory/print/bill/\".concat(sa_transacno));}})));}):null))))));}}]);return InvoiceHistoryClass;}(Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCommonApi:getCommonApi,commonCreateApi:commonCreateApi},dispatch);};export var Invoice=connect(null,mapDispatchToProps)(InvoiceHistoryClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Customer/CustomerDetails/Invoice/Invoice.js"],"names":["React","Component","NormalButton","NormalDate","NormalSelect","InputSearch","TableWrapper","NormalInput","NormalDateTime","dateFormat","history","connect","bindActionCreators","getCommonApi","commonCreateApi","InvoiceHistoryClass","state","headerDetails","label","billingList","pageMeta","chunk","page","total","totalPages","formField","fromDate","Date","toDate","transCode","custCode","custName","transtype","active","currentIndex","limit","isOpenvoidCheckout","transtypeOptions","value","customer_id","getTransactions","From","setState","To","props","id","then","res","console","log","data","dataList","meta","pagination","handlePrint","handlePagination","pageNo","handleShare","handleInvoice","handleClick","key","document","addEventListener","handleOutsideClick","removeEventListener","prevState","e","node","contains","target","handleChange","name","handleDatePick","handleSearch","firstdayMonth","getFullYear","getMonth","map","item","index","icon","sa_custno","sa_custname","sa_date","sa_totamt","sa_transacno_ref","void_refno","sa_staffname","sa_status","sa_transacno_type","sa_transacno","push","mapDispatchToProps","dispatch","Invoice"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { NormalButton, NormalDate, NormalSelect } from \"component/common\";\r\nimport { InputSearch, TableWrapper } from \"component/common\";\r\nimport { NormalInput, NormalDateTime } from \"component/common\";\r\n\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport { history } from \"helpers\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { getCommonApi, commonCreateApi } from \"redux/actions/common\";\r\n\r\nexport class InvoiceHistoryClass extends Component {\r\n  state = {\r\n    headerDetails: [\r\n      { label: \"Cust Code\" },\r\n      { label: \"Cust Name\" },\r\n      { label: \"Paid On\" },\r\n      { label: \"Amount\" },\r\n      { label: \"Transaction No\" },\r\n      { label: \"Reference No\" },\r\n      { label: \"Billed By\" },\r\n      { label: \"Status\" },\r\n      { label: \"Type\" },\r\n      { label: \"\" },\r\n    ],\r\n    billingList: [],\r\n    pageMeta: {\r\n      chunk: 10,\r\n      page: 1,\r\n      total: 10,\r\n      totalPages: 2,\r\n    },\r\n    formField: {\r\n      fromDate: new Date(),\r\n      toDate: new Date(),\r\n      transCode: \"\",\r\n      custCode: \"\",\r\n      custName: \"\",\r\n      transtype: \"All\",\r\n    },\r\n    active: false,\r\n    currentIndex: -1,\r\n    page: 1,\r\n    limit: 10,\r\n    isOpenvoidCheckout: false,\r\n    transtypeOptions: [\r\n      { label: \"All\", value: \"All\" },\r\n      { label: \"Sales\", value: \"Sales\" },\r\n      { label: \"Void\", value: \"Void\" },\r\n      { label: \"TD\", value: \"TD\" },\r\n    ],\r\n    customer_id: \"\",\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({\r\n      customer_id: this.props.id,\r\n    });\r\n    let From = new Date();\r\n    let { formField } = this.state;\r\n    let firstdayMonth = new Date(From.getFullYear() - 2, From.getMonth(), 1);\r\n    formField[\"fromDate\"] = firstdayMonth;\r\n    this.setState({\r\n      formField,\r\n    });\r\n\r\n    this.getTransactions();\r\n  }\r\n  getTransactions = () => {\r\n    debugger;\r\n    let {\r\n      billingList,\r\n      pageMeta,\r\n      formField,\r\n      page,\r\n      limit,\r\n      customer_id,\r\n    } = this.state;\r\n    let {\r\n      fromDate,\r\n      toDate,\r\n      transCode,\r\n      custCode,\r\n      custName,\r\n      transtype,\r\n    } = formField;\r\n\r\n    let From = new Date();\r\n    if (fromDate && fromDate !== \"\") {\r\n      From = fromDate;\r\n    } else {\r\n      this.setState({ fromDate: From });\r\n    }\r\n    let To = new Date();\r\n    if (toDate && toDate !== \"\") {\r\n      To = toDate;\r\n    } else {\r\n      this.setState({ toDate: To });\r\n    }\r\n    this.props\r\n      .getCommonApi(\r\n        `transactionhistory/?from_date=${dateFormat(\r\n          From,\r\n          \"yyyy-mm-dd\"\r\n        )}&to_date=${dateFormat(\r\n          To,\r\n          \"yyyy-mm-dd\"\r\n        )}&transac_no=${transCode}&cust_code=${custCode}&cust_name=${custName}&page=${page}&limit=${limit}&invoice_type=${transtype}&cust_id=${\r\n          this.props.id\r\n        }`\r\n      )\r\n      .then(async res => {\r\n        console.log(res, \"dsfdfaafg\");\r\n        await this.setState({ billingList: [] });\r\n        billingList = res.data.dataList;\r\n        pageMeta = res.data.meta.pagination;\r\n        this.setState({ billingList, pageMeta });\r\n      });\r\n  };\r\n  handlePrint = id => {\r\n    let { billingList, pageMeta, formField, page, limit } = this.state;\r\n    let { fromDate, toDate, transCode, custCode, custName } = formField;\r\n    this.props.getCommonApi(`receiptpdf/?sa_transacno=${id}`).then(res => {});\r\n  };\r\n\r\n  handlePagination = async pageNo => {\r\n    let { page } = this.state;\r\n    page = pageNo.page;\r\n    await this.setState({\r\n      page,\r\n    });\r\n    this.getTransactions();\r\n  };\r\n\r\n  handleShare = id => {\r\n    this.props\r\n      .commonCreateApi(`receiptpdfsend/?sa_transacno=${id}`)\r\n      .then(res => {});\r\n  };\r\n\r\n  handleInvoice = id => {\r\n    this.props\r\n      .getCommonApi(`customerreceiptprint/?sa_transacno=${id}`)\r\n      .then(res => {});\r\n  };\r\n\r\n  handleClick = key => {\r\n    if (!this.state.active) {\r\n      document.addEventListener(\"click\", this.handleOutsideClick, false);\r\n    } else {\r\n      document.removeEventListener(\"click\", this.handleOutsideClick, false);\r\n    }\r\n\r\n    this.setState(prevState => ({\r\n      active: !prevState.active,\r\n      currentIndex: key,\r\n    }));\r\n  };\r\n\r\n  handleOutsideClick = e => {\r\n    if (this.node != null) {\r\n      if (this.node.contains(e.target)) {\r\n        return;\r\n      }\r\n    }\r\n    this.handleClick();\r\n  };\r\n\r\n  handleChange = async ({ target: { value, name } }) => {\r\n    let { formField } = this.state;\r\n    formField[name] = value;\r\n    await this.setState({\r\n      formField,\r\n    });\r\n  };\r\n\r\n  handleDatePick = async (name, value) => {\r\n    let { formField } = this.state;\r\n    formField[name] = value;\r\n    await this.setState({\r\n      formField,\r\n    });\r\n  };\r\n\r\n  handleSearch = () => {\r\n    this.getTransactions();\r\n  };\r\n  render() {\r\n    let {\r\n      headerDetails,\r\n      pageMeta,\r\n      billingList,\r\n      formField,\r\n      transtypeOptions,\r\n    } = this.state;\r\n    let {\r\n      fromDate,\r\n      toDate,\r\n      transCode,\r\n      custCode,\r\n      custName,\r\n      transtype,\r\n    } = formField;\r\n    return (\r\n      <>\r\n        <div className=\"invoice-History mt-3\">\r\n          <div className=\"row m-0\">\r\n            <div className=\"col-4\">\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text\">\r\n                  From Date\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalDateTime\r\n                    onChange={this.handleDatePick}\r\n                    value={fromDate ? new Date(fromDate) : new Date()}\r\n                    name=\"fromDate\"\r\n                    showYearDropdown={true}\r\n                    dateFormat=\"dd/MM/yyyy\"\r\n                    type=\"date\"\r\n                    maxDate={new Date(toDate)}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text\">\r\n                  To Date\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalDateTime\r\n                    onChange={this.handleDatePick}\r\n                    inputcol=\"p-0 inTime\"\r\n                    value={toDate ? new Date(toDate) : new Date()}\r\n                    name=\"toDate\"\r\n                    className=\"dob-pick\"\r\n                    showYearDropdown={true}\r\n                    dateFormat=\"dd/MM/yyyy\"\r\n                    type=\"date\"\r\n                    minDate={new Date(fromDate)}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"col-4\">\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text mr-2\">\r\n                  Transaction Code\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalInput\r\n                    value={transCode}\r\n                    name=\"transCode\"\r\n                    onChange={this.handleChange}\r\n                    className={`customer-name`}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"d-flex mb-2\">\r\n                <label className=\"text-left w-100 text-black common-label-text\">\r\n                  Transaction Type\r\n                </label>\r\n                <div className=\"input-group\">\r\n                  <NormalSelect\r\n                    placeholderrequired={false}\r\n                    options={transtypeOptions}\r\n                    value={transtype}\r\n                    iconname=\"icon-down-key\"\r\n                    name=\"transtype\"\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"col-4\">\r\n              <NormalButton\r\n                buttonClass={\"mx-2\"}\r\n                mainbg={true}\r\n                className=\" fs-15 confirm\"\r\n                label=\"Search\"\r\n                outline={false}\r\n                onClick={this.handleSearch}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"billing-table\">\r\n            <div className=\"py-4\">\r\n              <div className=\"table-container\">\r\n                <TableWrapper\r\n                  headerDetails={headerDetails}\r\n                  queryHandler={this.handlePagination}\r\n                  pageMeta={pageMeta}\r\n                >\r\n                  {billingList\r\n                    ? billingList.map((item, index) => {\r\n                        let {\r\n                          icon,\r\n                          id,\r\n                          sa_custno,\r\n                          sa_custname,\r\n                          sa_date,\r\n                          sa_totamt,\r\n                          sa_transacno_ref,\r\n                          void_refno,\r\n                          sa_staffname,\r\n                          sa_status,\r\n                          sa_transacno_type,\r\n                          sa_transacno,\r\n                        } = item;\r\n                        return (\r\n                          <tr key={index}>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_custno}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_custname}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_date}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_totamt}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_transacno_ref}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {void_refno}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_staffname}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_status}\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center justify-content-center\">\r\n                                {sa_transacno_type}\r\n                              </div>\r\n                            </td>\r\n                            <td className=\"position-relative\">\r\n                              <NormalButton\r\n                                buttonClass={\"mx-2\"}\r\n                                mainbg={true}\r\n                                className=\" fs-15 confirm\"\r\n                                label=\"View\"\r\n                                outline={false}\r\n                                onClick={() =>\r\n                                  history.push(\r\n                                    `/admin/transactionhistory/print/bill/${sa_transacno}`\r\n                                  )\r\n                                }\r\n                              />\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })\r\n                    : null}\r\n                </TableWrapper>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      commonCreateApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Invoice = connect(null, mapDispatchToProps)(InvoiceHistoryClass);\r\n"]},"metadata":{},"sourceType":"module"}