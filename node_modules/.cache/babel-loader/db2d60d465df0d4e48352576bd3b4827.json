{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'./style.scss';import{NormalButton}from'component/common';import{dateFormat}from'service/helperFunctions';import _ from'lodash';import{history}from'helpers';import{connect}from'react-redux';import{bindActionCreators}from\"redux\";import{getCommonApi}from\"redux/actions/common\";export var CartClass=/*#__PURE__*/function(_Component){_inherits(CartClass,_Component);var _super=_createSuper(CartClass);function CartClass(){var _this;_classCallCheck(this,CartClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isOpen:false,currentIndex:-1,cartList:[],cartData:{}};_this.componentDidMount=function(){// this.getCart()\n};_this.getCart=function(){var _this$state=_this.state,productCard=_this$state.productCard,cartList=_this$state.cartList;var selected_cstomer=_this.props.selected_cstomer;// this.props.getCommonApi(`itemcart/Check/?sitecodeid=${selected_cstomer.branchId}&cart_date=${\"2020-09-17\"}&cust_noid=${selected_cstomer.cust_noid}`).then((key) => {\n_this.props.getCommonApi(\"itemcart/Check/?sitecodeid=\".concat(selected_cstomer.branchId,\"&cart_date=\").concat(dateFormat(new Date()),\"&cust_noid=\").concat(selected_cstomer.cust_noid)).then(function(key){var status=key.status,data=key.data;if(status===200){_this.props.getCommonApi(\"itemcart/?sitecodeid=\".concat(selected_cstomer.branchId,\"&cart_date=\").concat(dateFormat(new Date()),\"&cust_noid=\").concat(selected_cstomer.cust_noid,\"&cart_id=\").concat(data[0].cart_id)).then(function(res){// this.props.getCommonApi(`itemcart/?sitecodeid=${selected_cstomer.branchId}&cart_date=${\"2020-09-17\"}&cust_noid=${selected_cstomer.cust_noid}&cart_id=${data[0].cart_id}`).then((res) => {\nvar status=res.status,data=res.data;if(status===200){_this.setState({cartList:data,cartData:res});}});}});};_this.handleOpen=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var isOpen;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isOpen=_this.state.isOpen;_context.next=3;return _this.setState({isOpen:!isOpen});case 3:if(isOpen===false){_this.getCart();}case 4:case\"end\":return _context.stop();}}},_callee);}));_this.handleClick=function(key){if(!_this.state.active){document.addEventListener('click',_this.handleOutsideClick,false);}else{document.removeEventListener('click',_this.handleOutsideClick,false);}_this.setState(function(prevState){return{active:!prevState.active,currentIndex:key};});};_this.getDateTime=function(data){var date=new Date(data);date=String(date).split(\" \");var date1=date[2]+\"th \"+date[1]+\", \"+date[3];var time=date[4].split(\":\");var time1=String(Number(time[0])>12?Number(time[0])-12:time[0])+\":\"+time[1]+(Number(time[0])>12?\"PM\":\"AM\");return time1+\", \"+date1;};_this.handleSubmit=function(id){history.push(\"/admin/payment/\".concat(id));};return _this;}_createClass(CartClass,[{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,isOpen=_this$state2.isOpen,currentIndex=_this$state2.currentIndex,cartList=_this$state2.cartList,cartData=_this$state2.cartData;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"cart-holder \".concat(isOpen?'open':'')},/*#__PURE__*/React.createElement(\"div\",{className:\"cart-head\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-left-arrow\",onClick:function onClick(){return _this2.handleOpen();}}),/*#__PURE__*/React.createElement(\"p\",null,\"Cart\")),/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(!isOpen?'item-list':'')},isOpen?/*#__PURE__*/React.createElement(\"div\",{className:\"row item-list-detail\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-9 list\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row my-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 text-center\"},\"Treatment\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 text-center\"},\"Cost\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 text-center\"},\"Quantity\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 text-center\"},\"Booking Detail\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 text-center\"})),cartList.map(function(item,index){var name=item.name,staffId=item.staffId,specialist=item.specialist,homeSite=item.homeSite,currentSite=item.currentSite,contact=item.contact,status=item.status;return/*#__PURE__*/React.createElement(\"div\",{className:\"row detail m-2\",key:index},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 treatment\"},/*#__PURE__*/React.createElement(\"p\",{className:\"title mb-2\"},item.itemdesc),/*#__PURE__*/React.createElement(\"p\",{className:\"sub-title mb-2\"},item.item_class),/*#__PURE__*/React.createElement(\"p\",{className:\"time\"},item.cart_date?_this2.getDateTime(item.cart_date):\"\",\",  \",item.sitecode_name)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 cost\"},\"$ \",item.total_price),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 quantity\"},item.quantity),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 booking\"},\"$ \",item.deposit),/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 action\"},/*#__PURE__*/React.createElement(\"div\",{className:\"position-relative\",ref:function ref(node){_this2.node=node;},onClick:function onClick(){return _this2.handleClick(index);}},currentIndex===index?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more-active\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"option card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pt-3\",onClick:function onClick(){return _this2.props.history.push('/admin/staff/staffDetails');}},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-eye-grey px-3\"}),\" View \"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-edit px-3\"}),\" Edit \"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center fs-16 pb-3\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon-delete px-3\"}),\" Delete \"))):/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center horizontal-more\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icon-more\"})))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3 billable-amount\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"Subtotal\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",cartData.subtotal),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"Discount\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"$ \",cartData.discount)),/*#__PURE__*/React.createElement(\"div\",{className:\"right-total text-center\"},/*#__PURE__*/React.createElement(\"p\",{className:\"label\"},\"Billable Amount\"),/*#__PURE__*/React.createElement(\"p\",{className:\"amount text-orenge\"},\"$ \",cartData.trans_amt)))):/*#__PURE__*/React.createElement(\"p\",null,\"No Items available\")),/*#__PURE__*/React.createElement(\"div\",{className:\"total\"},/*#__PURE__*/React.createElement(\"p\",null,\"Total\"),/*#__PURE__*/React.createElement(\"p\",null,\"$ \",cartData.trans_amt)),/*#__PURE__*/React.createElement(\"div\",{className:\"confirm-booking\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"treatment\",mainbg:true,className:\"col-12 fs-15 \",label:\"Checkout to payment\",onClick:cartList.length>0?function(){return _this2.handleSubmit(cartList[0].cart_id);}:\"\"}))));}}]);return CartClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{customerDetail:state.appointment.customerDetail,selected_cstomer:state.common.selected_cstomer};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({// getCustomer,\ngetCommonApi:getCommonApi},dispatch);};export var Cart=connect(mapStateToProps,mapDispatchToProps)(CartClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/index.js"],"names":["React","Component","NormalButton","dateFormat","_","history","connect","bindActionCreators","getCommonApi","CartClass","state","isOpen","currentIndex","cartList","cartData","componentDidMount","getCart","productCard","selected_cstomer","props","branchId","Date","cust_noid","then","key","status","data","cart_id","res","setState","handleOpen","handleClick","active","document","addEventListener","handleOutsideClick","removeEventListener","prevState","getDateTime","date","String","split","date1","time","time1","Number","handleSubmit","id","push","map","item","index","name","staffId","specialist","homeSite","currentSite","contact","itemdesc","item_class","cart_date","sitecode_name","total_price","quantity","deposit","node","subtotal","discount","trans_amt","length","mapStateToProps","customerDetail","appointment","common","mapDispatchToProps","dispatch","Cart"],"mappings":"y1BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAO,cAAP,CACA,OAASC,YAAT,KAA6B,kBAA7B,CACA,OAASC,UAAT,KAA2B,yBAA3B,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,OAASC,OAAT,KAAwB,SAAxB,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,kBAAT,KAAmC,OAAnC,CACA,OAASC,YAAT,KAA6B,sBAA7B,CAEA,UAAaC,CAAAA,SAAb,uUACIC,KADJ,CACY,CACJC,MAAM,CAAE,KADJ,CAEJC,YAAY,CAAE,CAAC,CAFX,CAGJC,QAAQ,CAAE,EAHN,CAIJC,QAAQ,CAAE,EAJN,CADZ,OAQIC,iBARJ,CAQwB,UAAM,CACtB;AAEH,CAXL,OAaIC,OAbJ,CAac,UAAM,CACZ,gBAAgC,MAAKN,KAArC,CAAMO,WAAN,aAAMA,WAAN,CAAmBJ,QAAnB,aAAmBA,QAAnB,CACA,GAAMK,CAAAA,gBAAN,CAA2B,MAAKC,KAAhC,CAAMD,gBAAN,CACA;AACI,MAAKC,KAAL,CAAWX,YAAX,sCAAsDU,gBAAgB,CAACE,QAAvE,uBAA6FjB,UAAU,CAAC,GAAIkB,CAAAA,IAAJ,EAAD,CAAvG,uBAAiIH,gBAAgB,CAACI,SAAlJ,GAA+JC,IAA/J,CAAoK,SAACC,GAAD,CAAS,CAC7K,GAAMC,CAAAA,MAAN,CAAuBD,GAAvB,CAAMC,MAAN,CAAcC,IAAd,CAAuBF,GAAvB,CAAcE,IAAd,CACA,GAAID,MAAM,GAAK,GAAf,CAAoB,CAEhB,MAAKN,KAAL,CAAWX,YAAX,gCAAgDU,gBAAgB,CAACE,QAAjE,uBAAuFjB,UAAU,CAAC,GAAIkB,CAAAA,IAAJ,EAAD,CAAjG,uBAA2HH,gBAAgB,CAACI,SAA5I,qBAAiKI,IAAI,CAAC,CAAD,CAAJ,CAAQC,OAAzK,GAAoLJ,IAApL,CAAyL,SAACK,GAAD,CAAS,CAC9L;AACA,GAAMH,CAAAA,MAAN,CAAuBG,GAAvB,CAAMH,MAAN,CAAcC,IAAd,CAAuBE,GAAvB,CAAcF,IAAd,CACA,GAAID,MAAM,GAAK,GAAf,CAAoB,CAEhB,MAAKI,QAAL,CAAc,CAAEhB,QAAQ,CAAEa,IAAZ,CAAkBZ,QAAQ,CAAEc,GAA5B,CAAd,EACH,CACJ,CAPD,EAQH,CACJ,CAbG,EAcP,CA/BL,OAiCIE,UAjCJ,sEAiCiB,8IACHnB,MADG,CACQ,MAAKD,KADb,CACHC,MADG,uBAEH,OAAKkB,QAAL,CAAc,CAChBlB,MAAM,CAAE,CAACA,MADO,CAAd,CAFG,QAKT,GAAGA,MAAM,GAAK,KAAd,CAAoB,CAEhB,MAAKK,OAAL,GACH,CARQ,sDAjCjB,SA4CIe,WA5CJ,CA4CkB,SAACP,GAAD,CAAS,CACnB,GAAI,CAAC,MAAKd,KAAL,CAAWsB,MAAhB,CAAwB,CACpBC,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,CAAmC,MAAKC,kBAAxC,CAA4D,KAA5D,EACH,CAFD,IAEO,CACHF,QAAQ,CAACG,mBAAT,CAA6B,OAA7B,CAAsC,MAAKD,kBAA3C,CAA+D,KAA/D,EACH,CAED,MAAKN,QAAL,CAAc,SAAAQ,SAAS,QAAK,CACxBL,MAAM,CAAE,CAACK,SAAS,CAACL,MADK,CAExBpB,YAAY,CAAEY,GAFU,CAAL,EAAvB,EAIH,CAvDL,OAyDIc,WAzDJ,CAyDkB,SAACZ,IAAD,CAAU,CACpB,GAAIa,CAAAA,IAAI,CAAG,GAAIlB,CAAAA,IAAJ,CAASK,IAAT,CAAX,CACAa,IAAI,CAAGC,MAAM,CAACD,IAAD,CAAN,CAAaE,KAAb,CAAmB,GAAnB,CAAP,CACA,GAAIC,CAAAA,KAAK,CAAGH,IAAI,CAAC,CAAD,CAAJ,CAAU,KAAV,CAAkBA,IAAI,CAAC,CAAD,CAAtB,CAA4B,IAA5B,CAAmCA,IAAI,CAAC,CAAD,CAAnD,CACA,GAAII,CAAAA,IAAI,CAAGJ,IAAI,CAAC,CAAD,CAAJ,CAAQE,KAAR,CAAc,GAAd,CAAX,CACA,GAAIG,CAAAA,KAAK,CAAGJ,MAAM,CAACK,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAAlB,CAAwBE,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAA1C,CAAgDA,IAAI,CAAC,CAAD,CAArD,CAAN,CAAkE,GAAlE,CAAwEA,IAAI,CAAC,CAAD,CAA5E,EAAmFE,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAAlB,CAAuB,IAAvB,CAA8B,IAAjH,CAAZ,CACA,MAAOC,CAAAA,KAAK,CAAG,IAAR,CAAeF,KAAtB,CACH,CAhEL,OAkEII,YAlEJ,CAkEmB,SAACC,EAAD,CAAQ,CACnB1C,OAAO,CAAC2C,IAAR,0BAA+BD,EAA/B,GACH,CApEL,2DAsEI,iBAAS,iBACL,iBAAmD,KAAKrC,KAAxD,CAAMC,MAAN,cAAMA,MAAN,CAAcC,YAAd,cAAcA,YAAd,CAA4BC,QAA5B,cAA4BA,QAA5B,CAAsCC,QAAtC,cAAsCA,QAAtC,CACA,mBACI,qDACI,2BAAK,SAAS,uBAAiBH,MAAM,CAAG,MAAH,CAAY,EAAnC,CAAd,eACI,2BAAK,SAAS,CAAC,WAAf,eACI,yBAAG,SAAS,CAAC,iBAAb,CAA+B,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACmB,UAAL,EAAN,EAAxC,EADJ,cAEI,oCAFJ,CADJ,cAKI,2BAAK,SAAS,WAAK,CAACnB,MAAD,CAAU,WAAV,CAAwB,EAA7B,CAAd,EACKA,MAAM,cACP,2BAAK,SAAS,CAAC,sBAAf,eACI,2BAAK,SAAS,CAAC,YAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,2BAAK,SAAS,CAAC,mBAAf,cADJ,cAII,2BAAK,SAAS,CAAC,mBAAf,SAJJ,cAKI,2BAAK,SAAS,CAAC,mBAAf,aALJ,cAMI,2BAAK,SAAS,CAAC,mBAAf,mBANJ,cAOI,2BAAK,SAAS,CAAC,mBAAf,EAPJ,CADJ,CAUCE,QAAQ,CAACoC,GAAT,CAAa,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAE/B,GACIC,CAAAA,IADJ,CAQIF,IARJ,CACIE,IADJ,CAEIC,OAFJ,CAQIH,IARJ,CAEIG,OAFJ,CAGIC,UAHJ,CAQIJ,IARJ,CAGII,UAHJ,CAIIC,QAJJ,CAQIL,IARJ,CAIIK,QAJJ,CAKIC,WALJ,CAQIN,IARJ,CAKIM,WALJ,CAMIC,OANJ,CAQIP,IARJ,CAMIO,OANJ,CAOIhC,MAPJ,CAQIyB,IARJ,CAOIzB,MAPJ,CASA,mBACI,2BAAK,SAAS,CAAC,gBAAf,CAAgC,GAAG,CAAE0B,KAArC,eACI,2BAAK,SAAS,CAAC,iBAAf,eACI,yBAAG,SAAS,CAAC,YAAb,EAA2BD,IAAI,CAACQ,QAAhC,CADJ,cAEI,yBAAG,SAAS,CAAC,gBAAb,EAA+BR,IAAI,CAACS,UAApC,CAFJ,cAGI,yBAAG,SAAS,CAAC,MAAb,EAAqBT,IAAI,CAACU,SAAL,CAAiB,MAAI,CAACtB,WAAL,CAAiBY,IAAI,CAACU,SAAtB,CAAjB,CAAkD,EAAvE,OAA8EV,IAAI,CAACW,aAAnF,CAHJ,CADJ,cAMI,2BAAK,SAAS,CAAC,YAAf,OAA+BX,IAAI,CAACY,WAApC,CANJ,cAOI,2BAAK,SAAS,CAAC,gBAAf,EAAiCZ,IAAI,CAACa,QAAtC,CAPJ,cAQI,2BAAK,SAAS,CAAC,eAAf,OAAkCb,IAAI,CAACc,OAAvC,CARJ,cASI,2BAAK,SAAS,CAAC,cAAf,eACI,2BAAK,SAAS,CAAC,mBAAf,CAAmC,GAAG,CAAE,aAAAC,IAAI,CAAI,CAAE,MAAI,CAACA,IAAL,CAAYA,IAAZ,CAAmB,CAArE,CACI,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAClC,WAAL,CAAiBoB,KAAjB,CAAN,EADb,EAEKvC,YAAY,GAAKuC,KAAjB,cACG,qDACI,2BAAK,SAAS,CAAC,yEAAf,eAAyF,yBAAG,SAAS,CAAC,WAAb,EAAzF,CADJ,cAEI,2BAAK,SAAS,CAAC,aAAf,eACI,2BAAK,SAAS,CAAC,sCAAf,CAAsD,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAChC,KAAL,CAAWd,OAAX,CAAmB2C,IAAnB,CAAwB,2BAAxB,CAAN,EAA/D,eAA2H,4BAAM,SAAS,CAAC,oBAAhB,EAA3H,UADJ,cAEI,2BAAK,SAAS,CAAC,iCAAf,eAAiD,4BAAM,SAAS,CAAC,gBAAhB,EAAjD,UAFJ,cAGI,2BAAK,SAAS,CAAC,sCAAf,eAAsD,4BAAM,SAAS,CAAC,kBAAhB,EAAtD,YAHJ,CAFJ,CADH,cAUG,2BAAK,SAAS,CAAC,kEAAf,eAAkF,yBAAG,SAAS,CAAC,WAAb,EAAlF,CAZR,CADJ,CATJ,CADJ,CA6BK,CAxCJ,CAVD,CADJ,cAqDI,2BAAK,SAAS,CAAC,uBAAf,eACI,2BAAK,SAAS,CAAC,KAAf,eACI,2BAAK,SAAS,CAAC,OAAf,aADJ,cAEI,2BAAK,SAAS,CAAC,OAAf,OAA0BlC,QAAQ,CAACoD,QAAnC,CAFJ,cAKI,2BAAK,SAAS,CAAC,OAAf,aALJ,cAMI,2BAAK,SAAS,CAAC,OAAf,OAA0BpD,QAAQ,CAACqD,QAAnC,CANJ,CADJ,cAWI,2BAAK,SAAS,CAAC,yBAAf,eACI,yBAAG,SAAS,CAAC,OAAb,oBADJ,cAEI,yBAAG,SAAS,CAAC,oBAAb,OAAqCrD,QAAQ,CAACsD,SAA9C,CAFJ,CAXJ,CArDJ,CADO,cAuEL,kDAxEN,CALJ,cAgFI,2BAAK,SAAS,CAAC,OAAf,eACI,qCADJ,cAEI,kCAAMtD,QAAQ,CAACsD,SAAf,CAFJ,CAhFJ,cAoFI,2BAAK,SAAS,CAAC,iBAAf,eACA,oBAAC,YAAD,EACI,WAAW,CAAE,WADjB,CAEI,MAAM,CAAE,IAFZ,CAGI,SAAS,CAAC,eAHd,CAII,KAAK,CAAC,qBAJV,CAKI,OAAO,CAAEvD,QAAQ,CAACwD,MAAT,CAAgB,CAAhB,CAAoB,iBAAI,CAAA,MAAI,CAACvB,YAAL,CAAkBjC,QAAQ,CAAC,CAAD,CAAR,CAAYc,OAA9B,CAAJ,EAApB,CAA+D,EAL5E,EADA,CApFJ,CADJ,CADJ,CAkGH,CA1KL,uBAA+B1B,SAA/B,EA8KA,GAAMqE,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAC5D,KAAD,QAAY,CAChC6D,cAAc,CAAE7D,KAAK,CAAC8D,WAAN,CAAkBD,cADF,CAEhCrD,gBAAgB,CAAER,KAAK,CAAC+D,MAAN,CAAavD,gBAFC,CAAZ,EAAxB,CAKA,GAAMwD,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAAC,QAAQ,CAAI,CACnC,MAAOpE,CAAAA,kBAAkB,CAAC,CACtB;AACAC,YAAY,CAAZA,YAFsB,CAAD,CAGtBmE,QAHsB,CAAzB,CAIH,CALD,CAOA,MAAO,IAAMC,CAAAA,IAAI,CAAGtE,OAAO,CAACgE,eAAD,CAAkBI,kBAAlB,CAAP,CAA6CjE,SAA7C,CAAb","sourcesContent":["import React, { Component } from 'react';\r\nimport './style.scss';\r\nimport { NormalButton } from 'component/common';\r\nimport { dateFormat } from 'service/helperFunctions';\r\nimport _ from 'lodash';\r\nimport { history } from 'helpers';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from \"redux\";\r\nimport { getCommonApi } from \"redux/actions/common\"\r\n\r\nexport class CartClass extends Component {\r\n    state = {\r\n        isOpen: false,\r\n        currentIndex: -1,\r\n        cartList: [],\r\n        cartData: {}\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        // this.getCart()\r\n        \r\n    }\r\n\r\n    getCart = () => {\r\n        let { productCard, cartList } = this.state;\r\n        let { selected_cstomer } = this.props;\r\n        // this.props.getCommonApi(`itemcart/Check/?sitecodeid=${selected_cstomer.branchId}&cart_date=${\"2020-09-17\"}&cust_noid=${selected_cstomer.cust_noid}`).then((key) => {\r\n            this.props.getCommonApi(`itemcart/Check/?sitecodeid=${selected_cstomer.branchId}&cart_date=${dateFormat(new Date())}&cust_noid=${selected_cstomer.cust_noid}`).then((key) => {\r\n            let { status, data } = key;\r\n            if (status === 200) {\r\n\r\n                this.props.getCommonApi(`itemcart/?sitecodeid=${selected_cstomer.branchId}&cart_date=${dateFormat(new Date())}&cust_noid=${selected_cstomer.cust_noid}&cart_id=${data[0].cart_id}`).then((res) => {\r\n                    // this.props.getCommonApi(`itemcart/?sitecodeid=${selected_cstomer.branchId}&cart_date=${\"2020-09-17\"}&cust_noid=${selected_cstomer.cust_noid}&cart_id=${data[0].cart_id}`).then((res) => {\r\n                    let { status, data } = res;\r\n                    if (status === 200) {\r\n        \r\n                        this.setState({ cartList: data, cartData: res })\r\n                    }\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    handleOpen = async() => {\r\n        let { isOpen } = this.state\r\n        await this.setState({\r\n            isOpen: !isOpen,\r\n        })\r\n        if(isOpen === false){\r\n\r\n            this.getCart()\r\n        }\r\n    }\r\n\r\n    handleClick = (key) => {\r\n        if (!this.state.active) {\r\n            document.addEventListener('click', this.handleOutsideClick, false);\r\n        } else {\r\n            document.removeEventListener('click', this.handleOutsideClick, false);\r\n        }\r\n\r\n        this.setState(prevState => ({\r\n            active: !prevState.active,\r\n            currentIndex: key\r\n        }));\r\n    }\r\n\r\n    getDateTime = (data) => {\r\n        let date = new Date(data)\r\n        date = String(date).split(\" \")\r\n        let date1 = date[2] + \"th \" + date[1] + \", \" + date[3]\r\n        let time = date[4].split(\":\")\r\n        let time1 = String(Number(time[0]) > 12 ? (Number(time[0]) - 12) : time[0]) + \":\" + time[1] + (Number(time[0]) > 12 ? \"PM\" : \"AM\")\r\n        return time1 + \", \" + date1\r\n    }\r\n\r\n    handleSubmit = (id) => {\r\n        history.push(`/admin/payment/${id}`)\r\n    }\r\n\r\n    render() {\r\n        let { isOpen, currentIndex, cartList, cartData } = this.state\r\n        return (\r\n            <>\r\n                <div className={`cart-holder ${isOpen ? 'open' : ''}`}>\r\n                    <div className=\"cart-head\">\r\n                        <i className=\"icon-left-arrow\" onClick={() => this.handleOpen()}></i>\r\n                        <p>Cart</p>\r\n                    </div>\r\n                    <div className={`${!isOpen ? 'item-list' : ''}`}>\r\n                        {isOpen ? (\r\n                        <div className=\"row item-list-detail\">\r\n                            <div className=\"col-9 list\">\r\n                                <div className=\"row my-2\">\r\n                                    <div className=\"col-4 text-center\">\r\n                                        Treatment\r\n                                    </div>\r\n                                    <div className=\"col-2 text-center\">Cost</div>\r\n                                    <div className=\"col-2 text-center\">Quantity</div>\r\n                                    <div className=\"col-2 text-center\">Booking Detail</div>\r\n                                    <div className=\"col-2 text-center\"></div>\r\n                                </div>\r\n                            {cartList.map((item, index) => {\r\n\r\n                            let {\r\n                                name,\r\n                                staffId,\r\n                                specialist,\r\n                                homeSite,\r\n                                currentSite,\r\n                                contact,\r\n                                status\r\n                            } = item\r\n                            return (\r\n                                <div className=\"row detail m-2\" key={index}>\r\n                                    <div className=\"col-4 treatment\">\r\n                                        <p className=\"title mb-2\">{item.itemdesc}</p>\r\n                                        <p className=\"sub-title mb-2\">{item.item_class}</p>\r\n                                        <p className=\"time\">{item.cart_date ? this.getDateTime(item.cart_date):\"\"},  {item.sitecode_name}</p>\r\n                                    </div>\r\n                                    <div className=\"col-2 cost\">$ {item.total_price}</div>\r\n                                    <div className=\"col-2 quantity\">{item.quantity}</div>\r\n                                    <div className=\"col-2 booking\">$ {item.deposit}</div>\r\n                                    <div className=\"col-2 action\">\r\n                                        <div className=\"position-relative\" ref={node => { this.node = node; }}\r\n                                            onClick={() => this.handleClick(index)}>\r\n                                            {currentIndex === index ?\r\n                                                <>\r\n                                                    <div className=\"d-flex align-items-center justify-content-center horizontal-more-active\"><i className=\"icon-more\"></i></div>\r\n                                                    <div className=\"option card\">\r\n                                                        <div className=\"d-flex align-items-center fs-16 pt-3\" onClick={() => this.props.history.push('/admin/staff/staffDetails')}><span className=\"icon-eye-grey px-3\"></span> View </div>\r\n                                                        <div className=\"d-flex align-items-center fs-16\"><span className=\"icon-edit px-3\"></span> Edit </div>\r\n                                                        <div className=\"d-flex align-items-center fs-16 pb-3\"><span className=\"icon-delete px-3\"></span> Delete </div>\r\n                                                    </div>\r\n                                                </>\r\n                                                :\r\n                                                <div className=\"d-flex align-items-center justify-content-center horizontal-more\"><i className=\"icon-more\"></i></div>\r\n                                            }\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                )\r\n                                })}\r\n                            </div>\r\n                            <div className=\"col-3 billable-amount\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-6\">Subtotal</div>\r\n                                    <div className=\"col-6\">$ {cartData.subtotal}</div>\r\n                                    {/* <div className=\"col-6\">Tax</div>\r\n                                    <div className=\"col-6\">$ 20</div> */}\r\n                                    <div className=\"col-6\">Discount</div>\r\n                                    <div className=\"col-6\">$ {cartData.discount}</div>\r\n                                    {/* <div className=\"col-6\">Voucher</div>\r\n                                    <div className=\"col-6\"></div> */}\r\n                                </div>\r\n                                <div className=\"right-total text-center\">\r\n                                    <p className=\"label\">Billable Amount</p>\r\n                                    <p className=\"amount text-orenge\">$ {cartData.trans_amt}</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        ):<p>No Items available</p>}\r\n                        \r\n                    </div>\r\n                    <div className=\"total\">\r\n                        <p>Total</p>\r\n                        <p>$ {cartData.trans_amt}</p>\r\n                    </div>\r\n                    <div className=\"confirm-booking\">\r\n                    <NormalButton\r\n                        buttonClass={\"treatment\"}\r\n                        mainbg={true}\r\n                        className=\"col-12 fs-15 \"\r\n                        label=\"Checkout to payment\"\r\n                        onClick={cartList.length>0 ? ()=>this.handleSubmit(cartList[0].cart_id):\"\"}\r\n                    />\r\n                    </div>\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n    customerDetail: state.appointment.customerDetail,\r\n    selected_cstomer: state.common.selected_cstomer,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return bindActionCreators({\r\n        // getCustomer,\r\n        getCommonApi\r\n    }, dispatch)\r\n}\r\n\r\nexport const Cart = connect(mapStateToProps, mapDispatchToProps)(CartClass)"]},"metadata":{},"sourceType":"module"}