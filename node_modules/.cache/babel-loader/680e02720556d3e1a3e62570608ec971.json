{"ast":null,"code":"/**\r\n * DevExtreme (ui/map/provider.dynamic.google.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _devices = _interopRequireDefault(require(\"../../core/devices\"));\n\nvar _promise = _interopRequireDefault(require(\"../../core/polyfills/promise\"));\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _provider = _interopRequireDefault(require(\"./provider.dynamic\"));\n\nvar _ui = _interopRequireDefault(require(\"../widget/ui.errors\"));\n\nvar _color = _interopRequireDefault(require(\"../../color\"));\n\nvar _ajax = _interopRequireDefault(require(\"../../core/utils/ajax\"));\n\nvar _type = require(\"../../core/utils/type\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar window = (0, _window.getWindow)();\nvar GOOGLE_MAP_READY = \"_googleScriptReady\";\nvar GOOGLE_URL = \"https://maps.googleapis.com/maps/api/js?callback=\" + GOOGLE_MAP_READY;\nvar INFO_WINDOW_CLASS = \"gm-style-iw\";\nvar CustomMarker;\n\nvar initCustomMarkerClass = function () {\n  CustomMarker = function (options) {\n    this._position = options.position;\n    this._offset = options.offset;\n    this._$overlayContainer = (0, _renderer.default)(\"<div>\").css({\n      position: \"absolute\",\n      display: \"none\",\n      cursor: \"pointer\"\n    }).append(options.html);\n    this.setMap(options.map);\n  };\n\n  CustomMarker.prototype = new google.maps.OverlayView();\n\n  CustomMarker.prototype.onAdd = function () {\n    var $pane = (0, _renderer.default)(this.getPanes().overlayMouseTarget);\n    $pane.append(this._$overlayContainer);\n    this._clickListener = google.maps.event.addDomListener(this._$overlayContainer.get(0), \"click\", function (e) {\n      google.maps.event.trigger(this, \"click\");\n      e.preventDefault();\n    }.bind(this));\n    this.draw();\n  };\n\n  CustomMarker.prototype.onRemove = function () {\n    google.maps.event.removeListener(this._clickListener);\n\n    this._$overlayContainer.remove();\n  };\n\n  CustomMarker.prototype.draw = function () {\n    var position = this.getProjection().fromLatLngToDivPixel(this._position);\n\n    this._$overlayContainer.css({\n      left: position.x + this._offset.left,\n      top: position.y + this._offset.top,\n      display: \"block\"\n    });\n  };\n};\n\nvar googleMapsLoaded = function () {\n  return window.google && window.google.maps;\n};\n\nvar googleMapsLoader;\n\nvar GoogleProvider = _provider.default.inherit({\n  _mapType: function (type) {\n    var mapTypes = {\n      hybrid: google.maps.MapTypeId.HYBRID,\n      roadmap: google.maps.MapTypeId.ROADMAP,\n      satellite: google.maps.MapTypeId.SATELLITE\n    };\n    return mapTypes[type] || mapTypes.hybrid;\n  },\n  _movementMode: function (type) {\n    var movementTypes = {\n      driving: google.maps.TravelMode.DRIVING,\n      walking: google.maps.TravelMode.WALKING\n    };\n    return movementTypes[type] || movementTypes.driving;\n  },\n  _resolveLocation: function (location) {\n    return new _promise.default(function (resolve) {\n      var latLng = this._getLatLng(location);\n\n      if (latLng) {\n        resolve(new google.maps.LatLng(latLng.lat, latLng.lng));\n      } else {\n        this._geocodeLocation(location).then(function (geocodedLocation) {\n          resolve(geocodedLocation);\n        });\n      }\n    }.bind(this));\n  },\n  _geocodedLocations: {},\n  _geocodeLocationImpl: function (location) {\n    return new _promise.default(function (resolve) {\n      if (!(0, _type.isDefined)(location)) {\n        resolve(new google.maps.LatLng(0, 0));\n        return;\n      }\n\n      var geocoder = new google.maps.Geocoder();\n      geocoder.geocode({\n        address: location\n      }, function (results, status) {\n        if (status === google.maps.GeocoderStatus.OK) {\n          resolve(results[0].geometry.location);\n        } else {\n          _ui.default.log(\"W1006\", status);\n\n          resolve(new google.maps.LatLng(0, 0));\n        }\n      });\n    });\n  },\n  _normalizeLocation: function (location) {\n    return {\n      lat: location.lat(),\n      lng: location.lng()\n    };\n  },\n  _normalizeLocationRect: function (locationRect) {\n    return {\n      northEast: this._normalizeLocation(locationRect.getNorthEast()),\n      southWest: this._normalizeLocation(locationRect.getSouthWest())\n    };\n  },\n  _loadImpl: function () {\n    return new _promise.default(function (resolve) {\n      if (googleMapsLoaded()) {\n        resolve();\n      } else {\n        if (!googleMapsLoader) {\n          googleMapsLoader = this._loadMapScript();\n        }\n\n        googleMapsLoader.then(function () {\n          if (googleMapsLoaded()) {\n            resolve();\n            return;\n          }\n\n          this._loadMapScript().then(resolve);\n        }.bind(this));\n      }\n    }.bind(this)).then(function () {\n      initCustomMarkerClass();\n    });\n  },\n  _loadMapScript: function () {\n    return new _promise.default(function (resolve) {\n      var key = this._keyOption(\"google\");\n\n      window[GOOGLE_MAP_READY] = resolve;\n\n      _ajax.default.sendRequest({\n        url: GOOGLE_URL + (key ? \"&key=\" + key : \"\"),\n        dataType: \"script\"\n      });\n    }.bind(this)).then(function () {\n      try {\n        delete window[GOOGLE_MAP_READY];\n      } catch (e) {\n        window[GOOGLE_MAP_READY] = void 0;\n      }\n    });\n  },\n  _init: function () {\n    return new _promise.default(function (resolve) {\n      this._resolveLocation(this._option(\"center\")).then(function (center) {\n        var showDefaultUI = this._option(\"controls\");\n\n        this._map = new google.maps.Map(this._$container[0], {\n          zoom: this._option(\"zoom\"),\n          center: center,\n          disableDefaultUI: !showDefaultUI\n        });\n        var listener = google.maps.event.addListener(this._map, \"idle\", function () {\n          resolve(listener);\n        });\n      }.bind(this));\n    }.bind(this)).then(function (listener) {\n      google.maps.event.removeListener(listener);\n    });\n  },\n  _attachHandlers: function () {\n    this._boundsChangeListener = google.maps.event.addListener(this._map, \"bounds_changed\", this._boundsChangeHandler.bind(this));\n    this._clickListener = google.maps.event.addListener(this._map, \"click\", this._clickActionHandler.bind(this));\n  },\n  _boundsChangeHandler: function () {\n    var bounds = this._map.getBounds();\n\n    this._option(\"bounds\", this._normalizeLocationRect(bounds));\n\n    var center = this._map.getCenter();\n\n    this._option(\"center\", this._normalizeLocation(center));\n\n    if (!this._preventZoomChangeEvent) {\n      this._option(\"zoom\", this._map.getZoom());\n    }\n  },\n  _clickActionHandler: function (e) {\n    this._fireClickAction({\n      location: this._normalizeLocation(e.latLng)\n    });\n  },\n  updateDimensions: function () {\n    var center = this._option(\"center\");\n\n    google.maps.event.trigger(this._map, \"resize\");\n\n    this._option(\"center\", center);\n\n    return this.updateCenter();\n  },\n  updateMapType: function () {\n    this._map.setMapTypeId(this._mapType(this._option(\"type\")));\n\n    return _promise.default.resolve();\n  },\n  updateBounds: function () {\n    return _promise.default.all([this._resolveLocation(this._option(\"bounds.northEast\")), this._resolveLocation(this._option(\"bounds.southWest\"))]).then(function (result) {\n      var bounds = new google.maps.LatLngBounds();\n      bounds.extend(result[0]);\n      bounds.extend(result[1]);\n\n      this._map.fitBounds(bounds);\n    }.bind(this));\n  },\n  updateCenter: function () {\n    return this._resolveLocation(this._option(\"center\")).then(function (center) {\n      this._map.setCenter(center);\n\n      this._option(\"center\", this._normalizeLocation(center));\n    }.bind(this));\n  },\n  updateZoom: function () {\n    this._map.setZoom(this._option(\"zoom\"));\n\n    return _promise.default.resolve();\n  },\n  updateControls: function () {\n    var showDefaultUI = this._option(\"controls\");\n\n    this._map.setOptions({\n      disableDefaultUI: !showDefaultUI\n    });\n\n    return _promise.default.resolve();\n  },\n  isEventsCanceled: function (e) {\n    var gestureHandling = this._map && this._map.get(\"gestureHandling\");\n\n    var isInfoWindowContent = (0, _renderer.default)(e.target).closest(\".\".concat(INFO_WINDOW_CLASS)).length > 0;\n\n    if (isInfoWindowContent || \"desktop\" !== _devices.default.real().deviceType && \"cooperative\" === gestureHandling) {\n      return false;\n    }\n\n    return this.callBase();\n  },\n  _renderMarker: function (options) {\n    return this._resolveLocation(options.location).then(function (location) {\n      var marker;\n\n      if (options.html) {\n        marker = new CustomMarker({\n          map: this._map,\n          position: location,\n          html: options.html,\n          offset: (0, _extend.extend)({\n            top: 0,\n            left: 0\n          }, options.htmlOffset)\n        });\n      } else {\n        marker = new google.maps.Marker({\n          position: location,\n          map: this._map,\n          icon: options.iconSrc || this._option(\"markerIconSrc\")\n        });\n      }\n\n      var infoWindow = this._renderTooltip(marker, options.tooltip);\n\n      var listener;\n\n      if (options.onClick || options.tooltip) {\n        var markerClickAction = this._mapWidget._createAction(options.onClick || _common.noop);\n\n        var markerNormalizedLocation = this._normalizeLocation(location);\n\n        listener = google.maps.event.addListener(marker, \"click\", function () {\n          markerClickAction({\n            location: markerNormalizedLocation\n          });\n\n          if (infoWindow) {\n            infoWindow.open(this._map, marker);\n          }\n        }.bind(this));\n      }\n\n      return {\n        location: location,\n        marker: marker,\n        listener: listener\n      };\n    }.bind(this));\n  },\n  _renderTooltip: function (marker, options) {\n    if (!options) {\n      return;\n    }\n\n    options = this._parseTooltipOptions(options);\n    var infoWindow = new google.maps.InfoWindow({\n      content: options.text\n    });\n\n    if (options.visible) {\n      infoWindow.open(this._map, marker);\n    }\n\n    return infoWindow;\n  },\n  _destroyMarker: function (marker) {\n    marker.marker.setMap(null);\n\n    if (marker.listener) {\n      google.maps.event.removeListener(marker.listener);\n    }\n  },\n  _renderRoute: function (options) {\n    return _promise.default.all((0, _iterator.map)(options.locations, function (point) {\n      return this._resolveLocation(point);\n    }.bind(this))).then(function (locations) {\n      return new _promise.default(function (resolve) {\n        var origin = locations.shift();\n        var destination = locations.pop();\n        var waypoints = (0, _iterator.map)(locations, function (location) {\n          return {\n            location: location,\n            stopover: true\n          };\n        });\n        var request = {\n          origin: origin,\n          destination: destination,\n          waypoints: waypoints,\n          optimizeWaypoints: true,\n          travelMode: this._movementMode(options.mode)\n        };\n        new google.maps.DirectionsService().route(request, function (response, status) {\n          if (status === google.maps.DirectionsStatus.OK) {\n            var color = new _color.default(options.color || this._defaultRouteColor()).toHex();\n            var directionOptions = {\n              directions: response,\n              map: this._map,\n              suppressMarkers: true,\n              preserveViewport: true,\n              polylineOptions: {\n                strokeWeight: options.weight || this._defaultRouteWeight(),\n                strokeOpacity: options.opacity || this._defaultRouteOpacity(),\n                strokeColor: color\n              }\n            };\n            var route = new google.maps.DirectionsRenderer(directionOptions);\n            var bounds = response.routes[0].bounds;\n            resolve({\n              instance: route,\n              northEast: bounds.getNorthEast(),\n              southWest: bounds.getSouthWest()\n            });\n          } else {\n            _ui.default.log(\"W1006\", status);\n\n            resolve({\n              instance: new google.maps.DirectionsRenderer({})\n            });\n          }\n        }.bind(this));\n      }.bind(this));\n    }.bind(this));\n  },\n  _destroyRoute: function (routeObject) {\n    routeObject.instance.setMap(null);\n  },\n  _fitBounds: function () {\n    this._updateBounds();\n\n    if (this._bounds && this._option(\"autoAdjust\")) {\n      var zoomBeforeFitting = this._map.getZoom();\n\n      this._preventZoomChangeEvent = true;\n\n      this._map.fitBounds(this._bounds);\n\n      this._boundsChangeHandler();\n\n      var zoomAfterFitting = this._map.getZoom();\n\n      if (zoomBeforeFitting < zoomAfterFitting) {\n        this._map.setZoom(zoomBeforeFitting);\n      } else {\n        this._option(\"zoom\", zoomAfterFitting);\n      }\n\n      delete this._preventZoomChangeEvent;\n    }\n\n    return _promise.default.resolve();\n  },\n  _extendBounds: function (location) {\n    if (this._bounds) {\n      this._bounds.extend(location);\n    } else {\n      this._bounds = new google.maps.LatLngBounds();\n\n      this._bounds.extend(location);\n    }\n  },\n  clean: function () {\n    if (this._map) {\n      google.maps.event.removeListener(this._boundsChangeListener);\n      google.maps.event.removeListener(this._clickListener);\n\n      this._clearMarkers();\n\n      this._clearRoutes();\n\n      delete this._map;\n\n      this._$container.empty();\n    }\n\n    return _promise.default.resolve();\n  }\n});\n\nvar _default = GoogleProvider;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/newfrontend/webfe/node_modules/devextreme/ui/map/provider.dynamic.google.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_window","_common","_devices","_promise","_extend","_iterator","_provider","_ui","_color","_ajax","_type","obj","__esModule","window","getWindow","GOOGLE_MAP_READY","GOOGLE_URL","INFO_WINDOW_CLASS","CustomMarker","initCustomMarkerClass","options","_position","position","_offset","offset","_$overlayContainer","css","display","cursor","append","html","setMap","map","prototype","google","maps","OverlayView","onAdd","$pane","getPanes","overlayMouseTarget","_clickListener","event","addDomListener","get","e","trigger","preventDefault","bind","draw","onRemove","removeListener","remove","getProjection","fromLatLngToDivPixel","left","x","top","y","googleMapsLoaded","googleMapsLoader","GoogleProvider","inherit","_mapType","type","mapTypes","hybrid","MapTypeId","HYBRID","roadmap","ROADMAP","satellite","SATELLITE","_movementMode","movementTypes","driving","TravelMode","DRIVING","walking","WALKING","_resolveLocation","location","resolve","latLng","_getLatLng","LatLng","lat","lng","_geocodeLocation","then","geocodedLocation","_geocodedLocations","_geocodeLocationImpl","isDefined","geocoder","Geocoder","geocode","address","results","status","GeocoderStatus","OK","geometry","log","_normalizeLocation","_normalizeLocationRect","locationRect","northEast","getNorthEast","southWest","getSouthWest","_loadImpl","_loadMapScript","key","_keyOption","sendRequest","url","dataType","_init","_option","center","showDefaultUI","_map","Map","_$container","zoom","disableDefaultUI","listener","addListener","_attachHandlers","_boundsChangeListener","_boundsChangeHandler","_clickActionHandler","bounds","getBounds","getCenter","_preventZoomChangeEvent","getZoom","_fireClickAction","updateDimensions","updateCenter","updateMapType","setMapTypeId","updateBounds","all","result","LatLngBounds","extend","fitBounds","setCenter","updateZoom","setZoom","updateControls","setOptions","isEventsCanceled","gestureHandling","isInfoWindowContent","target","closest","concat","length","real","deviceType","callBase","_renderMarker","marker","htmlOffset","Marker","icon","iconSrc","infoWindow","_renderTooltip","tooltip","onClick","markerClickAction","_mapWidget","_createAction","noop","markerNormalizedLocation","open","_parseTooltipOptions","InfoWindow","content","text","visible","_destroyMarker","_renderRoute","locations","point","origin","shift","destination","pop","waypoints","stopover","request","optimizeWaypoints","travelMode","mode","DirectionsService","route","response","DirectionsStatus","color","_defaultRouteColor","toHex","directionOptions","directions","suppressMarkers","preserveViewport","polylineOptions","strokeWeight","weight","_defaultRouteWeight","strokeOpacity","opacity","_defaultRouteOpacity","strokeColor","DirectionsRenderer","routes","instance","_destroyRoute","routeObject","_fitBounds","_updateBounds","_bounds","zoomBeforeFitting","zoomAfterFitting","_extendBounds","clean","_clearMarkers","_clearRoutes","empty","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/map/provider.dynamic.google.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _devices = _interopRequireDefault(require(\"../../core/devices\"));\r\nvar _promise = _interopRequireDefault(require(\"../../core/polyfills/promise\"));\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _provider = _interopRequireDefault(require(\"./provider.dynamic\"));\r\nvar _ui = _interopRequireDefault(require(\"../widget/ui.errors\"));\r\nvar _color = _interopRequireDefault(require(\"../../color\"));\r\nvar _ajax = _interopRequireDefault(require(\"../../core/utils/ajax\"));\r\nvar _type = require(\"../../core/utils/type\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar window = (0, _window.getWindow)();\r\nvar GOOGLE_MAP_READY = \"_googleScriptReady\";\r\nvar GOOGLE_URL = \"https://maps.googleapis.com/maps/api/js?callback=\" + GOOGLE_MAP_READY;\r\nvar INFO_WINDOW_CLASS = \"gm-style-iw\";\r\nvar CustomMarker;\r\nvar initCustomMarkerClass = function() {\r\n    CustomMarker = function(options) {\r\n        this._position = options.position;\r\n        this._offset = options.offset;\r\n        this._$overlayContainer = (0, _renderer.default)(\"<div>\").css({\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            cursor: \"pointer\"\r\n        }).append(options.html);\r\n        this.setMap(options.map)\r\n    };\r\n    CustomMarker.prototype = new google.maps.OverlayView;\r\n    CustomMarker.prototype.onAdd = function() {\r\n        var $pane = (0, _renderer.default)(this.getPanes().overlayMouseTarget);\r\n        $pane.append(this._$overlayContainer);\r\n        this._clickListener = google.maps.event.addDomListener(this._$overlayContainer.get(0), \"click\", function(e) {\r\n            google.maps.event.trigger(this, \"click\");\r\n            e.preventDefault()\r\n        }.bind(this));\r\n        this.draw()\r\n    };\r\n    CustomMarker.prototype.onRemove = function() {\r\n        google.maps.event.removeListener(this._clickListener);\r\n        this._$overlayContainer.remove()\r\n    };\r\n    CustomMarker.prototype.draw = function() {\r\n        var position = this.getProjection().fromLatLngToDivPixel(this._position);\r\n        this._$overlayContainer.css({\r\n            left: position.x + this._offset.left,\r\n            top: position.y + this._offset.top,\r\n            display: \"block\"\r\n        })\r\n    }\r\n};\r\nvar googleMapsLoaded = function() {\r\n    return window.google && window.google.maps\r\n};\r\nvar googleMapsLoader;\r\nvar GoogleProvider = _provider.default.inherit({\r\n    _mapType: function(type) {\r\n        var mapTypes = {\r\n            hybrid: google.maps.MapTypeId.HYBRID,\r\n            roadmap: google.maps.MapTypeId.ROADMAP,\r\n            satellite: google.maps.MapTypeId.SATELLITE\r\n        };\r\n        return mapTypes[type] || mapTypes.hybrid\r\n    },\r\n    _movementMode: function(type) {\r\n        var movementTypes = {\r\n            driving: google.maps.TravelMode.DRIVING,\r\n            walking: google.maps.TravelMode.WALKING\r\n        };\r\n        return movementTypes[type] || movementTypes.driving\r\n    },\r\n    _resolveLocation: function(location) {\r\n        return new _promise.default(function(resolve) {\r\n            var latLng = this._getLatLng(location);\r\n            if (latLng) {\r\n                resolve(new google.maps.LatLng(latLng.lat, latLng.lng))\r\n            } else {\r\n                this._geocodeLocation(location).then(function(geocodedLocation) {\r\n                    resolve(geocodedLocation)\r\n                })\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _geocodedLocations: {},\r\n    _geocodeLocationImpl: function(location) {\r\n        return new _promise.default(function(resolve) {\r\n            if (!(0, _type.isDefined)(location)) {\r\n                resolve(new google.maps.LatLng(0, 0));\r\n                return\r\n            }\r\n            var geocoder = new google.maps.Geocoder;\r\n            geocoder.geocode({\r\n                address: location\r\n            }, function(results, status) {\r\n                if (status === google.maps.GeocoderStatus.OK) {\r\n                    resolve(results[0].geometry.location)\r\n                } else {\r\n                    _ui.default.log(\"W1006\", status);\r\n                    resolve(new google.maps.LatLng(0, 0))\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _normalizeLocation: function(location) {\r\n        return {\r\n            lat: location.lat(),\r\n            lng: location.lng()\r\n        }\r\n    },\r\n    _normalizeLocationRect: function(locationRect) {\r\n        return {\r\n            northEast: this._normalizeLocation(locationRect.getNorthEast()),\r\n            southWest: this._normalizeLocation(locationRect.getSouthWest())\r\n        }\r\n    },\r\n    _loadImpl: function() {\r\n        return new _promise.default(function(resolve) {\r\n            if (googleMapsLoaded()) {\r\n                resolve()\r\n            } else {\r\n                if (!googleMapsLoader) {\r\n                    googleMapsLoader = this._loadMapScript()\r\n                }\r\n                googleMapsLoader.then(function() {\r\n                    if (googleMapsLoaded()) {\r\n                        resolve();\r\n                        return\r\n                    }\r\n                    this._loadMapScript().then(resolve)\r\n                }.bind(this))\r\n            }\r\n        }.bind(this)).then(function() {\r\n            initCustomMarkerClass()\r\n        })\r\n    },\r\n    _loadMapScript: function() {\r\n        return new _promise.default(function(resolve) {\r\n            var key = this._keyOption(\"google\");\r\n            window[GOOGLE_MAP_READY] = resolve;\r\n            _ajax.default.sendRequest({\r\n                url: GOOGLE_URL + (key ? \"&key=\" + key : \"\"),\r\n                dataType: \"script\"\r\n            })\r\n        }.bind(this)).then(function() {\r\n            try {\r\n                delete window[GOOGLE_MAP_READY]\r\n            } catch (e) {\r\n                window[GOOGLE_MAP_READY] = void 0\r\n            }\r\n        })\r\n    },\r\n    _init: function() {\r\n        return new _promise.default(function(resolve) {\r\n            this._resolveLocation(this._option(\"center\")).then(function(center) {\r\n                var showDefaultUI = this._option(\"controls\");\r\n                this._map = new google.maps.Map(this._$container[0], {\r\n                    zoom: this._option(\"zoom\"),\r\n                    center: center,\r\n                    disableDefaultUI: !showDefaultUI\r\n                });\r\n                var listener = google.maps.event.addListener(this._map, \"idle\", function() {\r\n                    resolve(listener)\r\n                })\r\n            }.bind(this))\r\n        }.bind(this)).then(function(listener) {\r\n            google.maps.event.removeListener(listener)\r\n        })\r\n    },\r\n    _attachHandlers: function() {\r\n        this._boundsChangeListener = google.maps.event.addListener(this._map, \"bounds_changed\", this._boundsChangeHandler.bind(this));\r\n        this._clickListener = google.maps.event.addListener(this._map, \"click\", this._clickActionHandler.bind(this))\r\n    },\r\n    _boundsChangeHandler: function() {\r\n        var bounds = this._map.getBounds();\r\n        this._option(\"bounds\", this._normalizeLocationRect(bounds));\r\n        var center = this._map.getCenter();\r\n        this._option(\"center\", this._normalizeLocation(center));\r\n        if (!this._preventZoomChangeEvent) {\r\n            this._option(\"zoom\", this._map.getZoom())\r\n        }\r\n    },\r\n    _clickActionHandler: function(e) {\r\n        this._fireClickAction({\r\n            location: this._normalizeLocation(e.latLng)\r\n        })\r\n    },\r\n    updateDimensions: function() {\r\n        var center = this._option(\"center\");\r\n        google.maps.event.trigger(this._map, \"resize\");\r\n        this._option(\"center\", center);\r\n        return this.updateCenter()\r\n    },\r\n    updateMapType: function() {\r\n        this._map.setMapTypeId(this._mapType(this._option(\"type\")));\r\n        return _promise.default.resolve()\r\n    },\r\n    updateBounds: function() {\r\n        return _promise.default.all([this._resolveLocation(this._option(\"bounds.northEast\")), this._resolveLocation(this._option(\"bounds.southWest\"))]).then(function(result) {\r\n            var bounds = new google.maps.LatLngBounds;\r\n            bounds.extend(result[0]);\r\n            bounds.extend(result[1]);\r\n            this._map.fitBounds(bounds)\r\n        }.bind(this))\r\n    },\r\n    updateCenter: function() {\r\n        return this._resolveLocation(this._option(\"center\")).then(function(center) {\r\n            this._map.setCenter(center);\r\n            this._option(\"center\", this._normalizeLocation(center))\r\n        }.bind(this))\r\n    },\r\n    updateZoom: function() {\r\n        this._map.setZoom(this._option(\"zoom\"));\r\n        return _promise.default.resolve()\r\n    },\r\n    updateControls: function() {\r\n        var showDefaultUI = this._option(\"controls\");\r\n        this._map.setOptions({\r\n            disableDefaultUI: !showDefaultUI\r\n        });\r\n        return _promise.default.resolve()\r\n    },\r\n    isEventsCanceled: function(e) {\r\n        var gestureHandling = this._map && this._map.get(\"gestureHandling\");\r\n        var isInfoWindowContent = (0, _renderer.default)(e.target).closest(\".\".concat(INFO_WINDOW_CLASS)).length > 0;\r\n        if (isInfoWindowContent || \"desktop\" !== _devices.default.real().deviceType && \"cooperative\" === gestureHandling) {\r\n            return false\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _renderMarker: function(options) {\r\n        return this._resolveLocation(options.location).then(function(location) {\r\n            var marker;\r\n            if (options.html) {\r\n                marker = new CustomMarker({\r\n                    map: this._map,\r\n                    position: location,\r\n                    html: options.html,\r\n                    offset: (0, _extend.extend)({\r\n                        top: 0,\r\n                        left: 0\r\n                    }, options.htmlOffset)\r\n                })\r\n            } else {\r\n                marker = new google.maps.Marker({\r\n                    position: location,\r\n                    map: this._map,\r\n                    icon: options.iconSrc || this._option(\"markerIconSrc\")\r\n                })\r\n            }\r\n            var infoWindow = this._renderTooltip(marker, options.tooltip);\r\n            var listener;\r\n            if (options.onClick || options.tooltip) {\r\n                var markerClickAction = this._mapWidget._createAction(options.onClick || _common.noop);\r\n                var markerNormalizedLocation = this._normalizeLocation(location);\r\n                listener = google.maps.event.addListener(marker, \"click\", function() {\r\n                    markerClickAction({\r\n                        location: markerNormalizedLocation\r\n                    });\r\n                    if (infoWindow) {\r\n                        infoWindow.open(this._map, marker)\r\n                    }\r\n                }.bind(this))\r\n            }\r\n            return {\r\n                location: location,\r\n                marker: marker,\r\n                listener: listener\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _renderTooltip: function(marker, options) {\r\n        if (!options) {\r\n            return\r\n        }\r\n        options = this._parseTooltipOptions(options);\r\n        var infoWindow = new google.maps.InfoWindow({\r\n            content: options.text\r\n        });\r\n        if (options.visible) {\r\n            infoWindow.open(this._map, marker)\r\n        }\r\n        return infoWindow\r\n    },\r\n    _destroyMarker: function(marker) {\r\n        marker.marker.setMap(null);\r\n        if (marker.listener) {\r\n            google.maps.event.removeListener(marker.listener)\r\n        }\r\n    },\r\n    _renderRoute: function(options) {\r\n        return _promise.default.all((0, _iterator.map)(options.locations, function(point) {\r\n            return this._resolveLocation(point)\r\n        }.bind(this))).then(function(locations) {\r\n            return new _promise.default(function(resolve) {\r\n                var origin = locations.shift();\r\n                var destination = locations.pop();\r\n                var waypoints = (0, _iterator.map)(locations, function(location) {\r\n                    return {\r\n                        location: location,\r\n                        stopover: true\r\n                    }\r\n                });\r\n                var request = {\r\n                    origin: origin,\r\n                    destination: destination,\r\n                    waypoints: waypoints,\r\n                    optimizeWaypoints: true,\r\n                    travelMode: this._movementMode(options.mode)\r\n                };\r\n                (new google.maps.DirectionsService).route(request, function(response, status) {\r\n                    if (status === google.maps.DirectionsStatus.OK) {\r\n                        var color = new _color.default(options.color || this._defaultRouteColor()).toHex();\r\n                        var directionOptions = {\r\n                            directions: response,\r\n                            map: this._map,\r\n                            suppressMarkers: true,\r\n                            preserveViewport: true,\r\n                            polylineOptions: {\r\n                                strokeWeight: options.weight || this._defaultRouteWeight(),\r\n                                strokeOpacity: options.opacity || this._defaultRouteOpacity(),\r\n                                strokeColor: color\r\n                            }\r\n                        };\r\n                        var route = new google.maps.DirectionsRenderer(directionOptions);\r\n                        var bounds = response.routes[0].bounds;\r\n                        resolve({\r\n                            instance: route,\r\n                            northEast: bounds.getNorthEast(),\r\n                            southWest: bounds.getSouthWest()\r\n                        })\r\n                    } else {\r\n                        _ui.default.log(\"W1006\", status);\r\n                        resolve({\r\n                            instance: new google.maps.DirectionsRenderer({})\r\n                        })\r\n                    }\r\n                }.bind(this))\r\n            }.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _destroyRoute: function(routeObject) {\r\n        routeObject.instance.setMap(null)\r\n    },\r\n    _fitBounds: function() {\r\n        this._updateBounds();\r\n        if (this._bounds && this._option(\"autoAdjust\")) {\r\n            var zoomBeforeFitting = this._map.getZoom();\r\n            this._preventZoomChangeEvent = true;\r\n            this._map.fitBounds(this._bounds);\r\n            this._boundsChangeHandler();\r\n            var zoomAfterFitting = this._map.getZoom();\r\n            if (zoomBeforeFitting < zoomAfterFitting) {\r\n                this._map.setZoom(zoomBeforeFitting)\r\n            } else {\r\n                this._option(\"zoom\", zoomAfterFitting)\r\n            }\r\n            delete this._preventZoomChangeEvent\r\n        }\r\n        return _promise.default.resolve()\r\n    },\r\n    _extendBounds: function(location) {\r\n        if (this._bounds) {\r\n            this._bounds.extend(location)\r\n        } else {\r\n            this._bounds = new google.maps.LatLngBounds;\r\n            this._bounds.extend(location)\r\n        }\r\n    },\r\n    clean: function() {\r\n        if (this._map) {\r\n            google.maps.event.removeListener(this._boundsChangeListener);\r\n            google.maps.event.removeListener(this._clickListener);\r\n            this._clearMarkers();\r\n            this._clearRoutes();\r\n            delete this._map;\r\n            this._$container.empty()\r\n        }\r\n        return _promise.default.resolve()\r\n    }\r\n});\r\nvar _default = GoogleProvider;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}