{"ast":null,"code":"import _objectSpread from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"./style.scss\";import{IssuedStaff}from\"./modal\";import{NormalInput,NormalButton,NormalModal,TableWrapper}from\"component/common\";import{getCommonApi,updateForm,commonCreateApi,commonDeleteApi,commonPatchApi}from\"redux/actions/common\";import{Toast}from\"service/toast\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{history}from\"helpers\";import{CreateHoldItem}from\"redux/actions/customer\";import{withTranslation}from\"react-i18next\";export var HoldSectionClass=/*#__PURE__*/function(_Component){_inherits(HoldSectionClass,_Component);var _super=_createSuper(HoldSectionClass);function HoldSectionClass(){var _this;_classCallCheck(this,HoldSectionClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={activeTab:\"\",headerDetails:[{label:\"Date\",sortKey:false,width:\"70px\",divClass:\"justify-content-end text-right\"},{label:\"Transaction #\",width:\"180px\"},{label:\"Item Name\",sortKey:false,width:\"150px\"},{label:\"Item Code\",sortKey:false,width:\"150px\"},{label:\"Qty Hold\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Qty issued\",sortKey:false,width:\"100px\",divClass:\"justify-content-end text-right\"},{label:\"Staff issued\",sortKey:false,width:\"100px\"}],accountList:[],accountHeader:{},isIssued:false,isWarning:false,Staffid:0,holdItem:{},formData:[],downloadlLink:\"\",isPrint:false};_this.toggle=function(tab){if(_this.state.activeTab!==tab){_this.setState({activeTab:tab});}};_this.modalclose=function(){_this.setState({isIssued:!_this.state.isIssued});};_this.getAccountData=function(){var accountHeader=_this.state.accountHeader;_this.props.getCommonApi(\"holditem/?cust_id=\".concat(_this.props.id)).then(function(key){var data=key.data,header_data=key.header_data;var accountList=_this.state.accountList;accountList=data;accountHeader=header_data;_this.setState({accountList:accountList,accountHeader:accountHeader});});};_this.handleissuedstaff=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(item){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.setState({holdItem:item});case 2:if(item.onhand){if(item.check==\"fullpay\"){_this.setState({isIssued:!_this.state.isIssued});}else{_this.setState({isWarning:!_this.state.isWarning});}}else{Toast({type:\"error\",message:\"Stock is not available for this product\"});}case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.proceedtoissuedstaff=function(){_this.setState({isWarning:!_this.state.isWarning,isIssued:!_this.state.isIssued});};_this.denyissuedstaff=function(){_this.setState({isWarning:!_this.state.isWarning});};_this.issuedlisttableupdate=function(holdData){var accountList=_this.state.accountList;var filterList=accountList.find(function(account){return account.id===holdData.id;});filterList[\"qty_issued\"]=holdData.issueQty;filterList[\"staff_issued\"]=holdData.emp_name;filterList[\"emp_id\"]=holdData.emp_id;filterList[\"emp_name\"]=holdData.emp_name;_this.setState(_objectSpread(_objectSpread({},_this.state.accountList),{},{filterList:filterList}));};_this.issuedlistupdate=function(holdData){var formData=_this.state.formData;var filterList=formData.find(function(account){return account.id===holdData.id;});if(filterList){filterList[\"id\"]=holdData.id;filterList[\"issued_qty\"]=holdData.issueQty;filterList[\"emp_id\"]=holdData.emp_id;_this.setState(_objectSpread(_objectSpread({},_this.state.formData),{},{filterList:filterList}));}else{var data={};data[\"id\"]=holdData.id;data[\"issued_qty\"]=holdData.issueQty;data[\"emp_id\"]=holdData.emp_id;formData.push(data);_this.setState(_objectSpread(_objectSpread({},_this.state.formData),{},{formData:formData}));}};_this.handlePrint=function(){_this.setState({isPrint:false});window.open(_this.state.downloadlLink);};_this.onSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var formData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:formData=_this.state.formData;if(!(formData.length>0)){_context3.next=6;break;}_context3.next=4;return _this.props.CreateHoldItem(formData).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(res.status===200||res.status===201){_this.setState({downloadlLink:res.data,isPrint:true,formData:[]});_this.getAccountData();}else{Toast({type:\"error\",message:res.message});}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());case 4:_context3.next=7;break;case 6:Toast({type:\"error\",message:\"There is no record to update\"});case 7:case\"end\":return _context3.stop();}}},_callee3);}));return _this;}_createClass(HoldSectionClass,[{key:\"componentDidMount\",value:function componentDidMount(){this.getAccountData();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,headerDetails=_this$state.headerDetails,_this$state$accountLi=_this$state.accountList,accountList=_this$state$accountLi===void 0?[]:_this$state$accountLi,activeTab=_this$state.activeTab,isIssued=_this$state.isIssued,isWarning=_this$state.isWarning,Staffid=_this$state.Staffid,_this$state$holdItem=_this$state.holdItem,holdItem=_this$state$holdItem===void 0?{}:_this$state$holdItem,downloadlLink=_this$state.downloadlLink,isPrint=_this$state.isPrint;var t=this.props.t;return/*#__PURE__*/React.createElement(\"div\",{className:\"treatment-account row mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table\"},activeTab!==\"detail\"?/*#__PURE__*/React.createElement(TableWrapper,{headerDetails:headerDetails,queryHandler:this.handlePagination},accountList&&accountList.length>0?accountList.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.sa_date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.sa_transacno_ref)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.hi_itemdesc)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-left\"},item.itemno)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},item.holditemqty)),/*#__PURE__*/React.createElement(\"td\",{onClick:function onClick(){return _this2.handleissuedstaff(item);}},/*#__PURE__*/React.createElement(\"div\",{className:\"text-right cursor-pointer\"},item.qty_issued)),/*#__PURE__*/React.createElement(\"td\",{onClick:function onClick(){return _this2.handleissuedstaff(item);}},/*#__PURE__*/React.createElement(\"div\",{className:\"text-left justify-content-center\"},item.staff_issued)));}):null):null)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.onSubmit();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},t(\"Issued\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isIssued?/*#__PURE__*/React.createElement(IssuedStaff,{isIssued:isIssued,key:holdItem.id,toggle:this.modalclose,holdItem:holdItem,handleModal:this.handleissuedstaff,issuedlistupdate:this.issuedlistupdate,issuedlisttableupdate:this.issuedlisttableupdate}):\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isWarning?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NormalModal,{style:{minWidth:\"25%\"},modal:isWarning,handleModal:this.toggle},/*#__PURE__*/React.createElement(\"div\",{className:\"row new-cart issued-staff p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,t(\"Product have outstanding, Are you sure you want to\\n                        issued ?\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.proceedtoissuedstaff();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},t(\"Yes\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.denyissuedstaff();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},t(\"No\")))))))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-flex justify-center\"},isPrint?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NormalModal,{style:{minWidth:\"25%\"},modal:isPrint,handleModal:this.toggle},/*#__PURE__*/React.createElement(\"div\",{className:\"row new-cart issued-staff p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,t(\"Do you want to print ?\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.handlePrint();},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},t(\"Yes\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-3\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.setState({isPrint:false});},className:\"btn outline-btn mx-2 fs-14  text-capitalize\"},t(\"No\")))))))):null));}}]);return HoldSectionClass;}(Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getCommonApi:getCommonApi,updateForm:updateForm,commonCreateApi:commonCreateApi,commonPatchApi:commonPatchApi,commonDeleteApi:commonDeleteApi,CreateHoldItem:CreateHoldItem},dispatch);};export var Hold=withTranslation()(connect(null,mapDispatchToProps)(HoldSectionClass));","map":{"version":3,"sources":["F:/webfe/src/component/Admin/CustomerPlus/CustomerDetailsPlus/HoldSection/Hold.js"],"names":["React","Component","IssuedStaff","NormalInput","NormalButton","NormalModal","TableWrapper","getCommonApi","updateForm","commonCreateApi","commonDeleteApi","commonPatchApi","Toast","connect","bindActionCreators","history","CreateHoldItem","withTranslation","HoldSectionClass","state","activeTab","headerDetails","label","sortKey","width","divClass","accountList","accountHeader","isIssued","isWarning","Staffid","holdItem","formData","downloadlLink","isPrint","toggle","tab","setState","modalclose","getAccountData","props","id","then","key","data","header_data","handleissuedstaff","item","onhand","check","type","message","proceedtoissuedstaff","denyissuedstaff","issuedlisttableupdate","holdData","filterList","find","account","issueQty","emp_name","emp_id","issuedlistupdate","push","handlePrint","window","open","onSubmit","length","res","status","t","handlePagination","map","index","sa_date","sa_transacno_ref","hi_itemdesc","itemno","holditemqty","qty_issued","staff_issued","minWidth","mapDispatchToProps","dispatch","Hold"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport { IssuedStaff } from \"./modal\";\r\nimport {\r\n  NormalInput,\r\n  NormalButton,\r\n  NormalModal,\r\n  TableWrapper,\r\n} from \"component/common\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonCreateApi,\r\n  commonDeleteApi,\r\n  commonPatchApi,\r\n} from \"redux/actions/common\";\r\nimport { Toast } from \"service/toast\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { history } from \"helpers\";\r\nimport { CreateHoldItem } from \"redux/actions/customer\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nexport class HoldSectionClass extends Component {\r\n  state = {\r\n    activeTab: \"\",\r\n    headerDetails: [\r\n      {\r\n        label: \"Date\",\r\n        sortKey: false,\r\n        width: \"70px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      { label: \"Transaction #\", width: \"180px\" },\r\n      { label: \"Item Name\", sortKey: false, width: \"150px\" },\r\n      { label: \"Item Code\", sortKey: false, width: \"150px\" },\r\n      {\r\n        label: \"Qty Hold\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      {\r\n        label: \"Qty issued\",\r\n        sortKey: false,\r\n        width: \"100px\",\r\n        divClass: \"justify-content-end text-right\",\r\n      },\r\n      { label: \"Staff issued\", sortKey: false, width: \"100px\" },\r\n    ],\r\n    accountList: [],\r\n    accountHeader: {},\r\n    isIssued: false,\r\n    isWarning: false,\r\n    Staffid: 0,\r\n    holdItem: {},\r\n    formData: [],\r\n    downloadlLink: \"\",\r\n    isPrint: false,\r\n  };\r\n\r\n  toggle = tab => {\r\n    if (this.state.activeTab !== tab) {\r\n      this.setState({\r\n        activeTab: tab,\r\n      });\r\n    }\r\n  };\r\n  modalclose = () => {\r\n    this.setState({ isIssued: !this.state.isIssued });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getAccountData();\r\n  }\r\n\r\n  getAccountData = () => {\r\n    let { accountHeader } = this.state;\r\n    this.props.getCommonApi(`holditem/?cust_id=${this.props.id}`).then(key => {\r\n      let { data, header_data } = key;\r\n      let { accountList } = this.state;\r\n      accountList = data;\r\n      accountHeader = header_data;\r\n      this.setState({ accountList, accountHeader });\r\n    });\r\n  };\r\n\r\n  handleissuedstaff = async item => {\r\n    await this.setState({\r\n      holdItem: item,\r\n    });\r\n\r\n    if (item.onhand) {\r\n      if (item.check == \"fullpay\") {\r\n        this.setState({\r\n          isIssued: !this.state.isIssued,\r\n        });\r\n      } else {\r\n        this.setState({\r\n          isWarning: !this.state.isWarning,\r\n        });\r\n      }\r\n    } else {\r\n      Toast({\r\n        type: \"error\",\r\n        message: \"Stock is not available for this product\",\r\n      });\r\n    }\r\n  };\r\n\r\n  proceedtoissuedstaff = () => {\r\n    this.setState({\r\n      isWarning: !this.state.isWarning,\r\n      isIssued: !this.state.isIssued,\r\n    });\r\n  };\r\n\r\n  denyissuedstaff = () => {\r\n    this.setState({\r\n      isWarning: !this.state.isWarning,\r\n    });\r\n  };\r\n\r\n  issuedlisttableupdate = holdData => {\r\n    let { accountList } = this.state;\r\n    let filterList = accountList.find(account => account.id === holdData.id);\r\n    filterList[\"qty_issued\"] = holdData.issueQty;\r\n    filterList[\"staff_issued\"] = holdData.emp_name;\r\n    filterList[\"emp_id\"] = holdData.emp_id;\r\n    filterList[\"emp_name\"] = holdData.emp_name;\r\n    this.setState({ ...this.state.accountList, filterList });\r\n  };\r\n\r\n  issuedlistupdate = holdData => {\r\n    let { formData } = this.state;\r\n    let filterList = formData.find(account => account.id === holdData.id);\r\n    if (filterList) {\r\n      filterList[\"id\"] = holdData.id;\r\n      filterList[\"issued_qty\"] = holdData.issueQty;\r\n      filterList[\"emp_id\"] = holdData.emp_id;\r\n      this.setState({ ...this.state.formData, filterList });\r\n    } else {\r\n      let data = {};\r\n      data[\"id\"] = holdData.id;\r\n      data[\"issued_qty\"] = holdData.issueQty;\r\n      data[\"emp_id\"] = holdData.emp_id;\r\n      formData.push(data);\r\n      this.setState({ ...this.state.formData, formData });\r\n    }\r\n  };\r\n\r\n  handlePrint = () => {\r\n    this.setState({ isPrint: false });\r\n    window.open(this.state.downloadlLink);\r\n  };\r\n\r\n  onSubmit = async () => {\r\n    let { formData } = this.state;\r\n    if (formData.length > 0) {\r\n      await this.props.CreateHoldItem(formData).then(async res => {\r\n        if (res.status === 200 || res.status === 201) {\r\n          this.setState({\r\n            downloadlLink: res.data,\r\n            isPrint: true,\r\n            formData: [],\r\n          });\r\n          this.getAccountData();\r\n        } else {\r\n          Toast({ type: \"error\", message: res.message });\r\n        }\r\n      });\r\n    } else {\r\n      Toast({ type: \"error\", message: \"There is no record to update\" });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {\r\n      headerDetails,\r\n      accountList = [],\r\n      activeTab,\r\n      isIssued,\r\n      isWarning,\r\n      Staffid,\r\n      holdItem = {},\r\n      downloadlLink,\r\n      isPrint,\r\n    } = this.state;\r\n    let { t } = this.props;\r\n    return (\r\n      <div className=\"treatment-account row mt-3\">\r\n        <div className=\"col-12\">\r\n          <div className=\"table\">\r\n            {activeTab !== \"detail\" ? (\r\n              <TableWrapper\r\n                headerDetails={headerDetails}\r\n                queryHandler={this.handlePagination}\r\n              >\r\n                {accountList && accountList.length > 0\r\n                  ? accountList.map((item, index) => {\r\n                      return (\r\n                        <tr key={index}>\r\n                          <td>\r\n                            <div className=\"text-right\">{item.sa_date}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-left\">\r\n                              {item.sa_transacno_ref}\r\n                            </div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-left\">{item.hi_itemdesc}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-left\">{item.itemno}</div>\r\n                          </td>\r\n                          <td>\r\n                            <div className=\"text-right\">{item.holditemqty}</div>\r\n                          </td>\r\n                          <td onClick={() => this.handleissuedstaff(item)}>\r\n                            <div className=\"text-right cursor-pointer\">\r\n                              {item.qty_issued}\r\n                            </div>\r\n                          </td>\r\n                          <td onClick={() => this.handleissuedstaff(item)}>\r\n                            <div className=\"text-left justify-content-center\">\r\n                              {item.staff_issued}\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  : null}\r\n              </TableWrapper>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          <div className=\"col-4\">\r\n            <button\r\n              onClick={() => this.onSubmit()}\r\n              className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n            >\r\n              {t(\"Issued\")}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isIssued ? (\r\n            <IssuedStaff\r\n              isIssued={isIssued}\r\n              key={holdItem.id}\r\n              toggle={this.modalclose}\r\n              holdItem={holdItem}\r\n              handleModal={this.handleissuedstaff}\r\n              issuedlistupdate={this.issuedlistupdate}\r\n              issuedlisttableupdate={this.issuedlisttableupdate}\r\n            />\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isWarning ? (\r\n            <>\r\n              <NormalModal\r\n                style={{ minWidth: \"25%\" }}\r\n                modal={isWarning}\r\n                handleModal={this.toggle}\r\n              >\r\n                <div className=\"row new-cart issued-staff p-3\">\r\n                  <div className=\"col-12\">\r\n                    <div>\r\n                      <p>\r\n                        {t(`Product have outstanding, Are you sure you want to\r\n                        issued ?`)}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-12 p-3\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.proceedtoissuedstaff()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {t(\"Yes\")}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.denyissuedstaff()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {t(\"No\")}\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </NormalModal>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n        <div className=\"col-12 d-flex justify-center\">\r\n          {isPrint ? (\r\n            <>\r\n              <NormalModal\r\n                style={{ minWidth: \"25%\" }}\r\n                modal={isPrint}\r\n                handleModal={this.toggle}\r\n              >\r\n                <div className=\"row new-cart issued-staff p-3\">\r\n                  <div className=\"col-12\">\r\n                    <div>\r\n                      <p>{t(`Do you want to print ?`)}</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-12 p-3\">\r\n                    <div className=\"row\">\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.handlePrint()}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {t(\"Yes\")}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"col-3\">\r\n                        <button\r\n                          onClick={() => this.setState({ isPrint: false })}\r\n                          className={`btn outline-btn mx-2 fs-14  text-capitalize`}\r\n                        >\r\n                          {t(\"No\")}\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </NormalModal>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      getCommonApi,\r\n      updateForm,\r\n      commonCreateApi,\r\n      commonPatchApi,\r\n      commonDeleteApi,\r\n      CreateHoldItem,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Hold = withTranslation()(\r\n  connect(null, mapDispatchToProps)(HoldSectionClass)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}