{"ast":null,"code":"import _createForOfIteratorHelper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\newfrontend\\\\webfe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"./style.scss\";import{NormalButton,NormalInput,NormalSelect,NormalTextarea}from\"component/common\";import{dateFormat}from\"service/helperFunctions\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{getCommonApi,updateForm,commonUpdateApi,commonCreateApi}from\"redux/actions/common\";import SimpleReactValidator from\"simple-react-validator\";export var DiscountClass=/*#__PURE__*/function(_Component){_inherits(DiscountClass,_Component);var _super=_createSuper(DiscountClass);function DiscountClass(){var _this;_classCallCheck(this,DiscountClass);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={cartData:{},discountFields:{discount:0,discount_amt:0,disc_reason:\"\",discreason_txt:null},discountReasonList:[]};_this.componentWillMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// this.getCart();\nconsole.log(_this.props,\"propsssssssssss\");_this.validator=new SimpleReactValidator({element:function element(message){return/*#__PURE__*/React.createElement(\"span\",{className:\"error-message text-danger validNo fs14\"},message);},autoForceUpdate:_assertThisInitialized(_this)});_context.next=4;return _this.setState({cartData:_this.props.cartData});case 4:_this.getDropdownData();_this.getDataFromStore(_this.props.cartData);case 6:case\"end\":return _context.stop();}}},_callee);}));_this.getDataFromStore=function(data){var discountFields=_this.state.discountFields;console.log(\"fsdfgdfydfdfsg\",data,_this.props);discountFields[\"discount\"]=data.discpercent;discountFields[\"discount_amt\"]=data.discountamt;discountFields[\"disc_reason\"]=data.discount_reason;discountFields[\"discreason_txt\"]=data.discreason_txt;_this.setState({discountFields:discountFields});};_this.getDropdownData=function(){var discountReasonList=_this.state.discountReasonList;_this.props.getCommonApi(\"paymentremarks/\").then(function(key){var status=key.status,data=key.data;if(status===200){var _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;discountReasonList.push({value:value.id,label:value.r_desc});}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({discountReasonList:discountReasonList});}});};_this.getDateTime=function(data){var date=new Date(data);date=String(date).split(\" \");var date1=date[2]+\"th \"+date[1]+\", \"+date[3];var time=date[4].split(\":\");var time1=String(Number(time[0])>12?Number(time[0])-12:time[0])+\":\"+time[1]+(Number(time[0])>12?\"PM\":\"AM\");return time1+\", \"+date1;};_this.handleChangeDisc=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2){var _ref2$target,value,name,_this$state,discountFields,cartData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref2$target=_ref2.target,value=_ref2$target.value,name=_ref2$target.name;_this$state=_this.state,discountFields=_this$state.discountFields,cartData=_this$state.cartData;discountFields[name]=value;if(name===\"discount\"){discountFields[\"discount_amt\"]=Number(_this.props.discount_price/100*value).toFixed(2);}if(name===\"discount_amt\"){// discountFields['discount'] = (value/formFields['price'])*100\ndiscountFields[\"discount\"]=0;}if(name===\"discount\"&&Number(value)!==182){discountFields[\"discreason_txt\"]=\"\";_this.setState({discountFields:discountFields});}_context2.next=8;return _this.setState({discountFields:discountFields});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.handleUpdateDisc=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var discountFields;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:discountFields=_this.state.discountFields;if(!_this.validator.allValid()){_context3.next=8;break;}// discountFields['discount'] = discountFields['discount'];\ndiscountFields[\"discount_amt\"]=parseFloat(discountFields[\"discount_amt\"]).toFixed(2);_context3.next=5;return _this.setState({discountFields:discountFields});case 5:_this.props.commonUpdateApi(\"itemcart/\".concat(_this.props.id,\"/?disc_add=1&disc_reset=0\"),discountFields).then(function(key){var status=key.status,data=key.data;_this.props.handleRefresh();});_context3.next=9;break;case 8:_this.validator.showMessages();case 9:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleResetDisc=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var discountFields;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:discountFields=_this.state.discountFields;_context4.next=3;return _this.setState({discountFields:discountFields});case 3:_this.props.commonUpdateApi(\"itemcart/\".concat(_this.props.id,\"/?disc_add=0&disc_reset=1\"),discountFields).then(function(key){var status=key.status,data=key.data;_this.props.handleRefresh();});case 4:case\"end\":return _context4.stop();}}},_callee4);}));return _this;}_createClass(DiscountClass,[{key:\"render\",value:function render(){var discountFields=this.state.discountFields;var discountReasonList=this.state.discountReasonList;return/*#__PURE__*/React.createElement(\"div\",{className:\"row discount\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Discount %\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput// placeholder=\"Enter here\"\n// options={siteList}\n,{value:discountFields.discount,name:\"discount\",onChange:this.handleChangeDisc,className:\"customer-name\"}),this.validator.message(\"discount percentage\",discountFields.discount,\"required\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Discount amount\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalInput// placeholder=\"Enter here\"\n// options={siteList}\n,{value:discountFields.discount_amt,name:\"discount_amt\",onChange:this.handleChangeDisc,className:\"customer-name\"}),this.validator.message(\"discount amount\",discountFields.discount_amt,\"required\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Discount reason\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalSelect// placeholder=\"Enter here\"\n,{options:discountReasonList,value:discountFields.disc_reason,name:\"disc_reason\",onChange:this.handleChangeDisc,className:\"customer-name py-0\"}),this.validator.message(\"discount reason\",discountFields.disc_reason,\"required\"))),discountFields.disc_reason==\"182\"?/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-left text-black common-label-text \"},\"Discount reason\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(NormalTextarea// placeholder=\"Enter here\"\n// options={discountReasonList}\n,{value:discountFields.discreason_txt,name:\"discreason_txt\",onChange:this.handleChangeDisc,className:\"customer-name py-0\"}),this.validator.message(\"discount reason\",discountFields.discreason_txt,\"required\"))):\"\",/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 text-center d-flex apply\"},/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",mainbg:false,className:\" fs-15 confirm\",label:\"Apply\",outline:false,onClick:this.handleUpdateDisc}),/*#__PURE__*/React.createElement(NormalButton,{buttonClass:\"mx-2\",mainbg:true,className:\" fs-15 reset\",label:\"Reset\",outline:false,onClick:this.handleResetDisc})));}}]);return DiscountClass;}(Component);var mapStateToProps=function mapStateToProps(state){return{selected_cstomer:state.common.selected_cstomer,basicApptDetail:state.appointment.basicApptDetail};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({// getCustomer,\ngetCommonApi:getCommonApi,updateForm:updateForm,commonUpdateApi:commonUpdateApi,commonCreateApi:commonCreateApi},dispatch);};export var Discount=connect(mapStateToProps,mapDispatchToProps)(DiscountClass);","map":{"version":3,"sources":["E:/newfrontend/webfe/src/component/Admin/Cart/cart/discount.js"],"names":["React","Component","NormalButton","NormalInput","NormalSelect","NormalTextarea","dateFormat","connect","bindActionCreators","getCommonApi","updateForm","commonUpdateApi","commonCreateApi","SimpleReactValidator","DiscountClass","state","cartData","discountFields","discount","discount_amt","disc_reason","discreason_txt","discountReasonList","componentWillMount","console","log","props","validator","element","message","autoForceUpdate","setState","getDropdownData","getDataFromStore","data","discpercent","discountamt","discount_reason","then","key","status","value","push","id","label","r_desc","getDateTime","date","Date","String","split","date1","time","time1","Number","handleChangeDisc","target","name","discount_price","toFixed","handleUpdateDisc","allValid","parseFloat","handleRefresh","showMessages","handleResetDisc","mapStateToProps","selected_cstomer","common","basicApptDetail","appointment","mapDispatchToProps","dispatch","Discount"],"mappings":"qqCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAO,cAAP,CACA,OACEC,YADF,CAEEC,WAFF,CAGEC,YAHF,CAIEC,cAJF,KAKO,kBALP,CAMA,OAASC,UAAT,KAA2B,yBAA3B,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,kBAAT,KAAmC,OAAnC,CACA,OACEC,YADF,CAEEC,UAFF,CAGEC,eAHF,CAIEC,eAJF,KAKO,sBALP,CAMA,MAAOC,CAAAA,oBAAP,KAAiC,wBAAjC,CAEA,UAAaC,CAAAA,aAAb,uVACEC,KADF,CACU,CACNC,QAAQ,CAAE,EADJ,CAENC,cAAc,CAAE,CACdC,QAAQ,CAAE,CADI,CAEdC,YAAY,CAAE,CAFA,CAGdC,WAAW,CAAE,EAHC,CAIdC,cAAc,CAAE,IAJF,CAFV,CAQNC,kBAAkB,CAAE,EARd,CADV,OAYEC,kBAZF,sEAYuB,mIACnB;AACAC,OAAO,CAACC,GAAR,CAAY,MAAKC,KAAjB,CAAwB,iBAAxB,EACA,MAAKC,SAAL,CAAiB,GAAId,CAAAA,oBAAJ,CAAyB,CACxCe,OAAO,CAAE,iBAAAC,OAAO,qBACd,4BAAM,SAAS,CAAC,wCAAhB,EACGA,OADH,CADc,EADwB,CAMxCC,eAAe,8BANyB,CAAzB,CAAjB,CAHmB,sBAWb,OAAKC,QAAL,CAAc,CAClBf,QAAQ,CAAE,MAAKU,KAAL,CAAWV,QADH,CAAd,CAXa,QAcnB,MAAKgB,eAAL,GAEA,MAAKC,gBAAL,CAAsB,MAAKP,KAAL,CAAWV,QAAjC,EAhBmB,sDAZvB,SA+BEiB,gBA/BF,CA+BqB,SAAAC,IAAI,CAAI,CACzB,GAAMjB,CAAAA,cAAN,CAAyB,MAAKF,KAA9B,CAAME,cAAN,CACAO,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAA8BS,IAA9B,CAAoC,MAAKR,KAAzC,EACAT,cAAc,CAAC,UAAD,CAAd,CAA6BiB,IAAI,CAACC,WAAlC,CACAlB,cAAc,CAAC,cAAD,CAAd,CAAiCiB,IAAI,CAACE,WAAtC,CACAnB,cAAc,CAAC,aAAD,CAAd,CAAgCiB,IAAI,CAACG,eAArC,CACApB,cAAc,CAAC,gBAAD,CAAd,CAAmCiB,IAAI,CAACb,cAAxC,CACA,MAAKU,QAAL,CAAc,CACZd,cAAc,CAAdA,cADY,CAAd,EAGD,CAzCH,OA2CEe,eA3CF,CA2CoB,UAAM,CACtB,GAAMV,CAAAA,kBAAN,CAA6B,MAAKP,KAAlC,CAAMO,kBAAN,CAEA,MAAKI,KAAL,CAAWjB,YAAX,oBAA2C6B,IAA3C,CAAgD,SAAAC,GAAG,CAAI,CACrD,GAAMC,CAAAA,MAAN,CAAuBD,GAAvB,CAAMC,MAAN,CAAcN,IAAd,CAAuBK,GAAvB,CAAcL,IAAd,CACA,GAAIM,MAAM,GAAK,GAAf,CAAoB,0CACAN,IADA,YAClB,+CAAwB,IAAfO,CAAAA,KAAe,aACtBnB,kBAAkB,CAACoB,IAAnB,CAAwB,CAAED,KAAK,CAAEA,KAAK,CAACE,EAAf,CAAmBC,KAAK,CAAEH,KAAK,CAACI,MAAhC,CAAxB,EACD,CAHiB,qDAIlB,MAAKd,QAAL,CAAc,CAAET,kBAAkB,CAAlBA,kBAAF,CAAd,EACD,CACF,CARD,EASD,CAvDH,OAyDEwB,WAzDF,CAyDgB,SAAAZ,IAAI,CAAI,CACpB,GAAIa,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,CAASd,IAAT,CAAX,CACAa,IAAI,CAAGE,MAAM,CAACF,IAAD,CAAN,CAAaG,KAAb,CAAmB,GAAnB,CAAP,CACA,GAAIC,CAAAA,KAAK,CAAGJ,IAAI,CAAC,CAAD,CAAJ,CAAU,KAAV,CAAkBA,IAAI,CAAC,CAAD,CAAtB,CAA4B,IAA5B,CAAmCA,IAAI,CAAC,CAAD,CAAnD,CACA,GAAIK,CAAAA,IAAI,CAAGL,IAAI,CAAC,CAAD,CAAJ,CAAQG,KAAR,CAAc,GAAd,CAAX,CACA,GAAIG,CAAAA,KAAK,CACPJ,MAAM,CAACK,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAAlB,CAAuBE,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAAzC,CAA8CA,IAAI,CAAC,CAAD,CAAnD,CAAN,CACA,GADA,CAEAA,IAAI,CAAC,CAAD,CAFJ,EAGCE,MAAM,CAACF,IAAI,CAAC,CAAD,CAAL,CAAN,CAAkB,EAAlB,CAAuB,IAAvB,CAA8B,IAH/B,CADF,CAKA,MAAOC,CAAAA,KAAK,CAAG,IAAR,CAAeF,KAAtB,CACD,CApEH,OAsEEI,gBAtEF,2FAsEqB,gOAASC,MAAT,CAAmBf,KAAnB,cAAmBA,KAAnB,CAA0BgB,IAA1B,cAA0BA,IAA1B,aACkB,MAAK1C,KADvB,CACXE,cADW,aACXA,cADW,CACKD,QADL,aACKA,QADL,CAEjBC,cAAc,CAACwC,IAAD,CAAd,CAAuBhB,KAAvB,CACA,GAAIgB,IAAI,GAAK,UAAb,CAAyB,CACvBxC,cAAc,CAAC,cAAD,CAAd,CAAiCqC,MAAM,CACpC,MAAK5B,KAAL,CAAWgC,cAAX,CAA4B,GAA7B,CAAoCjB,KADC,CAAN,CAE/BkB,OAF+B,CAEvB,CAFuB,CAAjC,CAGD,CACD,GAAIF,IAAI,GAAK,cAAb,CAA6B,CAC3B;AACAxC,cAAc,CAAC,UAAD,CAAd,CAA6B,CAA7B,CACD,CACD,GAAIwC,IAAI,GAAK,UAAT,EAAuBH,MAAM,CAACb,KAAD,CAAN,GAAkB,GAA7C,CAAkD,CAChDxB,cAAc,CAAC,gBAAD,CAAd,CAAmC,EAAnC,CACA,MAAKc,QAAL,CAAc,CACZd,cAAc,CAAdA,cADY,CAAd,EAGD,CAjBgB,uBAkBX,OAAKc,QAAL,CAAc,CAClBd,cAAc,CAAdA,cADkB,CAAd,CAlBW,yDAtErB,sEA+FE2C,gBA/FF,sEA+FqB,2JACX3C,cADW,CACQ,MAAKF,KADb,CACXE,cADW,KAGb,MAAKU,SAAL,CAAekC,QAAf,EAHa,0BAIf;AACA5C,cAAc,CAAC,cAAD,CAAd,CAAiC6C,UAAU,CACzC7C,cAAc,CAAC,cAAD,CAD2B,CAAV,CAE/B0C,OAF+B,CAEvB,CAFuB,CAAjC,CALe,uBAQT,OAAK5B,QAAL,CAAc,CAAEd,cAAc,CAAdA,cAAF,CAAd,CARS,QASf,MAAKS,KAAL,CACGf,eADH,oBAEgB,MAAKe,KAAL,CAAWiB,EAF3B,8BAGI1B,cAHJ,EAKGqB,IALH,CAKQ,SAAAC,GAAG,CAAI,CACX,GAAMC,CAAAA,MAAN,CAAuBD,GAAvB,CAAMC,MAAN,CAAcN,IAAd,CAAuBK,GAAvB,CAAcL,IAAd,CACA,MAAKR,KAAL,CAAWqC,aAAX,GACD,CARH,EATe,8BAmBf,MAAKpC,SAAL,CAAeqC,YAAf,GAnBe,wDA/FrB,SAsHEC,eAtHF,sEAsHoB,2JACVhD,cADU,CACS,MAAKF,KADd,CACVE,cADU,wBAEV,OAAKc,QAAL,CAAc,CAAEd,cAAc,CAAdA,cAAF,CAAd,CAFU,QAIhB,MAAKS,KAAL,CACGf,eADH,oBAEgB,MAAKe,KAAL,CAAWiB,EAF3B,8BAGI1B,cAHJ,EAKGqB,IALH,CAKQ,SAAAC,GAAG,CAAI,CACX,GAAMC,CAAAA,MAAN,CAAuBD,GAAvB,CAAMC,MAAN,CAAcN,IAAd,CAAuBK,GAAvB,CAAcL,IAAd,CACA,MAAKR,KAAL,CAAWqC,aAAX,GACD,CARH,EAJgB,wDAtHpB,iEAqIE,iBAAS,CACP,GAAM9C,CAAAA,cAAN,CAAyB,KAAKF,KAA9B,CAAME,cAAN,CACA,GAAMK,CAAAA,kBAAN,CAA6B,KAAKP,KAAlC,CAAMO,kBAAN,CACA,mBACE,2BAAK,SAAS,CAAC,cAAf,eACE,2BAAK,SAAS,CAAC,OAAf,eACE,6BAAO,SAAS,CAAC,yCAAjB,eADF,cAIE,2BAAK,SAAS,CAAC,kBAAf,eACE,oBAAC,WACC;AACA;AAFF,EAGE,KAAK,CAAEL,cAAc,CAACC,QAHxB,CAIE,IAAI,CAAC,UAJP,CAKE,QAAQ,CAAE,KAAKqC,gBALjB,CAME,SAAS,CAAC,eANZ,EADF,CASG,KAAK5B,SAAL,CAAeE,OAAf,CACC,qBADD,CAECZ,cAAc,CAACC,QAFhB,CAGC,UAHD,CATH,CAJF,CADF,cAqBE,2BAAK,SAAS,CAAC,OAAf,eACE,6BAAO,SAAS,CAAC,yCAAjB,oBADF,cAIE,2BAAK,SAAS,CAAC,kBAAf,eACE,oBAAC,WACC;AACA;AAFF,EAGE,KAAK,CAAED,cAAc,CAACE,YAHxB,CAIE,IAAI,CAAC,cAJP,CAKE,QAAQ,CAAE,KAAKoC,gBALjB,CAME,SAAS,CAAC,eANZ,EADF,CASG,KAAK5B,SAAL,CAAeE,OAAf,CACC,iBADD,CAECZ,cAAc,CAACE,YAFhB,CAGC,UAHD,CATH,CAJF,CArBF,cAyCE,2BAAK,SAAS,CAAC,OAAf,eACE,6BAAO,SAAS,CAAC,yCAAjB,oBADF,cAIE,2BAAK,SAAS,CAAC,kBAAf,eACE,oBAAC,YACC;AADF,EAEE,OAAO,CAAEG,kBAFX,CAGE,KAAK,CAAEL,cAAc,CAACG,WAHxB,CAIE,IAAI,CAAC,aAJP,CAKE,QAAQ,CAAE,KAAKmC,gBALjB,CAME,SAAS,CAAC,oBANZ,EADF,CASG,KAAK5B,SAAL,CAAeE,OAAf,CACC,iBADD,CAECZ,cAAc,CAACG,WAFhB,CAGC,UAHD,CATH,CAJF,CAzCF,CA6DGH,cAAc,CAACG,WAAf,EAA8B,KAA9B,cACC,2BAAK,SAAS,CAAC,QAAf,eACE,6BAAO,SAAS,CAAC,yCAAjB,oBADF,cAIE,2BAAK,SAAS,CAAC,kBAAf,eACE,oBAAC,cACC;AACA;AAFF,EAGE,KAAK,CAAEH,cAAc,CAACI,cAHxB,CAIE,IAAI,CAAC,gBAJP,CAKE,QAAQ,CAAE,KAAKkC,gBALjB,CAME,SAAS,CAAC,oBANZ,EADF,CASG,KAAK5B,SAAL,CAAeE,OAAf,CACC,iBADD,CAECZ,cAAc,CAACI,cAFhB,CAGC,UAHD,CATH,CAJF,CADD,CAsBC,EAnFJ,cAqFE,2BAAK,SAAS,CAAC,iCAAf,eACE,oBAAC,YAAD,EACE,WAAW,CAAE,MADf,CAEE,MAAM,CAAE,KAFV,CAGE,SAAS,CAAC,gBAHZ,CAIE,KAAK,CAAC,OAJR,CAKE,OAAO,CAAE,KALX,CAME,OAAO,CAAE,KAAKuC,gBANhB,EADF,cAUE,oBAAC,YAAD,EACE,WAAW,CAAE,MADf,CAEE,MAAM,CAAE,IAFV,CAGE,SAAS,CAAC,cAHZ,CAIE,KAAK,CAAC,OAJR,CAKE,OAAO,CAAE,KALX,CAME,OAAO,CAAE,KAAKK,eANhB,EAVF,CArFF,CADF,CA2GD,CAnPH,2BAAmChE,SAAnC,EAsPA,GAAMiE,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAAnD,KAAK,QAAK,CAChCoD,gBAAgB,CAAEpD,KAAK,CAACqD,MAAN,CAAaD,gBADC,CAEhCE,eAAe,CAAEtD,KAAK,CAACuD,WAAN,CAAkBD,eAFH,CAAL,EAA7B,CAKA,GAAME,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAAC,QAAQ,CAAI,CACrC,MAAOhE,CAAAA,kBAAkB,CACvB,CACE;AACAC,YAAY,CAAZA,YAFF,CAGEC,UAAU,CAAVA,UAHF,CAIEC,eAAe,CAAfA,eAJF,CAKEC,eAAe,CAAfA,eALF,CADuB,CAQvB4D,QARuB,CAAzB,CAUD,CAXD,CAaA,MAAO,IAAMC,CAAAA,QAAQ,CAAGlE,OAAO,CAC7B2D,eAD6B,CAE7BK,kBAF6B,CAAP,CAGtBzD,aAHsB,CAAjB","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./style.scss\";\r\nimport {\r\n  NormalButton,\r\n  NormalInput,\r\n  NormalSelect,\r\n  NormalTextarea,\r\n} from \"component/common\";\r\nimport { dateFormat } from \"service/helperFunctions\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport {\r\n  getCommonApi,\r\n  updateForm,\r\n  commonUpdateApi,\r\n  commonCreateApi,\r\n} from \"redux/actions/common\";\r\nimport SimpleReactValidator from \"simple-react-validator\";\r\n\r\nexport class DiscountClass extends Component {\r\n  state = {\r\n    cartData: {},\r\n    discountFields: {\r\n      discount: 0,\r\n      discount_amt: 0,\r\n      disc_reason: \"\",\r\n      discreason_txt: null,\r\n    },\r\n    discountReasonList: [],\r\n  };\r\n\r\n  componentWillMount = async () => {\r\n    // this.getCart();\r\n    console.log(this.props, \"propsssssssssss\");\r\n    this.validator = new SimpleReactValidator({\r\n      element: message => (\r\n        <span className=\"error-message text-danger validNo fs14\">\r\n          {message}\r\n        </span>\r\n      ),\r\n      autoForceUpdate: this,\r\n    });\r\n    await this.setState({\r\n      cartData: this.props.cartData,\r\n    });\r\n    this.getDropdownData();\r\n\r\n    this.getDataFromStore(this.props.cartData);\r\n  };\r\n\r\n  getDataFromStore = data => {\r\n    let { discountFields } = this.state;\r\n    console.log(\"fsdfgdfydfdfsg\", data, this.props);\r\n    discountFields[\"discount\"] = data.discpercent;\r\n    discountFields[\"discount_amt\"] = data.discountamt;\r\n    discountFields[\"disc_reason\"] = data.discount_reason;\r\n    discountFields[\"discreason_txt\"] = data.discreason_txt;\r\n    this.setState({\r\n      discountFields,\r\n    });\r\n  };\r\n\r\n  getDropdownData = () => {\r\n    let { discountReasonList } = this.state;\r\n\r\n    this.props.getCommonApi(`paymentremarks/`).then(key => {\r\n      let { status, data } = key;\r\n      if (status === 200) {\r\n        for (let value of data) {\r\n          discountReasonList.push({ value: value.id, label: value.r_desc });\r\n        }\r\n        this.setState({ discountReasonList });\r\n      }\r\n    });\r\n  };\r\n\r\n  getDateTime = data => {\r\n    let date = new Date(data);\r\n    date = String(date).split(\" \");\r\n    let date1 = date[2] + \"th \" + date[1] + \", \" + date[3];\r\n    let time = date[4].split(\":\");\r\n    let time1 =\r\n      String(Number(time[0]) > 12 ? Number(time[0]) - 12 : time[0]) +\r\n      \":\" +\r\n      time[1] +\r\n      (Number(time[0]) > 12 ? \"PM\" : \"AM\");\r\n    return time1 + \", \" + date1;\r\n  };\r\n\r\n  handleChangeDisc = async ({ target: { value, name } }) => {\r\n    let { discountFields, cartData } = this.state;\r\n    discountFields[name] = value;\r\n    if (name === \"discount\") {\r\n      discountFields[\"discount_amt\"] = Number(\r\n        (this.props.discount_price / 100) * value\r\n      ).toFixed(2);\r\n    }\r\n    if (name === \"discount_amt\") {\r\n      // discountFields['discount'] = (value/formFields['price'])*100\r\n      discountFields[\"discount\"] = 0;\r\n    }\r\n    if (name === \"discount\" && Number(value) !== 182) {\r\n      discountFields[\"discreason_txt\"] = \"\";\r\n      this.setState({\r\n        discountFields,\r\n      });\r\n    }\r\n    await this.setState({\r\n      discountFields,\r\n    });\r\n    // this.props.updateForm('customerDetail', formFields)\r\n    // await this.props.updateForm('appointmentCustomerDetail', formFields)\r\n  };\r\n\r\n  handleUpdateDisc = async () => {\r\n    let { discountFields } = this.state;\r\n\r\n    if (this.validator.allValid()) {\r\n      // discountFields['discount'] = discountFields['discount'];\r\n      discountFields[\"discount_amt\"] = parseFloat(\r\n        discountFields[\"discount_amt\"]\r\n      ).toFixed(2);\r\n      await this.setState({ discountFields });\r\n      this.props\r\n        .commonUpdateApi(\r\n          `itemcart/${this.props.id}/?disc_add=1&disc_reset=0`,\r\n          discountFields\r\n        )\r\n        .then(key => {\r\n          let { status, data } = key;\r\n          this.props.handleRefresh();\r\n        });\r\n    } else {\r\n      this.validator.showMessages();\r\n    }\r\n  };\r\n\r\n  handleResetDisc = async () => {\r\n    let { discountFields } = this.state;\r\n    await this.setState({ discountFields });\r\n\r\n    this.props\r\n      .commonUpdateApi(\r\n        `itemcart/${this.props.id}/?disc_add=0&disc_reset=1`,\r\n        discountFields\r\n      )\r\n      .then(key => {\r\n        let { status, data } = key;\r\n        this.props.handleRefresh();\r\n      });\r\n  };\r\n\r\n  render() {\r\n    let { discountFields } = this.state;\r\n    let { discountReasonList } = this.state;\r\n    return (\r\n      <div className=\"row discount\">\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount %\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalInput\r\n              // placeholder=\"Enter here\"\r\n              // options={siteList}\r\n              value={discountFields.discount}\r\n              name=\"discount\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount percentage\",\r\n              discountFields.discount,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount amount\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalInput\r\n              // placeholder=\"Enter here\"\r\n              // options={siteList}\r\n              value={discountFields.discount_amt}\r\n              name=\"discount_amt\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount amount\",\r\n              discountFields.discount_amt,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-4\">\r\n          <label className=\"text-left text-black common-label-text \">\r\n            Discount reason\r\n          </label>\r\n          <div className=\"input-group mb-2\">\r\n            <NormalSelect\r\n              // placeholder=\"Enter here\"\r\n              options={discountReasonList}\r\n              value={discountFields.disc_reason}\r\n              name=\"disc_reason\"\r\n              onChange={this.handleChangeDisc}\r\n              className=\"customer-name py-0\"\r\n            />\r\n            {this.validator.message(\r\n              \"discount reason\",\r\n              discountFields.disc_reason,\r\n              \"required\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        {discountFields.disc_reason == \"182\" ? (\r\n          <div className=\"col-12\">\r\n            <label className=\"text-left text-black common-label-text \">\r\n              Discount reason\r\n            </label>\r\n            <div className=\"input-group mb-2\">\r\n              <NormalTextarea\r\n                // placeholder=\"Enter here\"\r\n                // options={discountReasonList}\r\n                value={discountFields.discreason_txt}\r\n                name=\"discreason_txt\"\r\n                onChange={this.handleChangeDisc}\r\n                className=\"customer-name py-0\"\r\n              />\r\n              {this.validator.message(\r\n                \"discount reason\",\r\n                discountFields.discreason_txt,\r\n                \"required\"\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n        <div className=\"col-12 text-center d-flex apply\">\r\n          <NormalButton\r\n            buttonClass={\"mx-2\"}\r\n            mainbg={false}\r\n            className=\" fs-15 confirm\"\r\n            label=\"Apply\"\r\n            outline={false}\r\n            onClick={this.handleUpdateDisc}\r\n          />\r\n\r\n          <NormalButton\r\n            buttonClass={\"mx-2\"}\r\n            mainbg={true}\r\n            className=\" fs-15 reset\"\r\n            label=\"Reset\"\r\n            outline={false}\r\n            onClick={this.handleResetDisc}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  selected_cstomer: state.common.selected_cstomer,\r\n  basicApptDetail: state.appointment.basicApptDetail,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      // getCustomer,\r\n      getCommonApi,\r\n      updateForm,\r\n      commonUpdateApi,\r\n      commonCreateApi,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport const Discount = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(DiscountClass);\r\n"]},"metadata":{},"sourceType":"module"}