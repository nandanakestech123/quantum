{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _recurrence = require(\"./recurrence\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _component_registrator = _interopRequireDefault(require(\"../../core/component_registrator\"));\n\nvar _ui = require(\"../tooltip/ui.tooltip\");\n\nvar _uiScheduler = _interopRequireDefault(require(\"./ui.scheduler.publisher_mixin\"));\n\nvar _index = require(\"../../events/utils/index\");\n\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\n\nvar _dom_component = _interopRequireDefault(require(\"../../core/dom_component\"));\n\nvar _resizable = _interopRequireDefault(require(\"../resizable\"));\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _date = _interopRequireDefault(require(\"../../localization/date\"));\n\nvar _constants = require(\"./constants\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = (0, _index.addNamespace)(_pointer.default.enter, \"dxSchedulerAppointment\");\nvar REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = (0, _index.addNamespace)(_pointer.default.leave, \"dxSchedulerAppointment\");\n\nvar Appointment = _dom_component.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      data: {},\n      geometry: {\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0\n      },\n      allowDrag: true,\n      allowResize: true,\n      reduced: null,\n      isCompact: false,\n      direction: \"vertical\",\n      resizableConfig: {},\n      cellHeight: 0,\n      cellWidth: 0,\n      isDragSource: false\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"data\":\n      case \"geometry\":\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"reduced\":\n      case \"sortedIndex\":\n      case \"isCompact\":\n      case \"direction\":\n      case \"resizableConfig\":\n      case \"cellHeight\":\n      case \"cellWidth\":\n        this._invalidate();\n\n        break;\n\n      case \"isDragSource\":\n        this._renderDragSourceClass();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getHorizontalResizingRule: function _getHorizontalResizingRule() {\n    var reducedHandles = {\n      head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\n      body: \"\",\n      tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\n    };\n    return {\n      handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\n      minHeight: 0,\n      minWidth: this.invoke(\"getCellWidth\"),\n      step: this.invoke(\"getResizableStep\"),\n      roundStepValue: false\n    };\n  },\n  _getVerticalResizingRule: function _getVerticalResizingRule() {\n    var height = this.invoke(\"getCellHeight\");\n    return {\n      handles: DEFAULT_VERTICAL_HANDLES,\n      minWidth: 0,\n      minHeight: height,\n      step: height,\n      roundStepValue: true\n    };\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderAppointmentGeometry();\n\n    this._renderEmptyClass();\n\n    this._renderReducedAppointment();\n\n    this._renderAllDayClass();\n\n    this._renderDragSourceClass();\n\n    this._renderDirection();\n\n    this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\n    this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.option(\"data\")));\n    this.$element().attr(\"role\", \"button\");\n\n    this._renderRecurrenceClass();\n\n    this._renderResizable();\n  },\n  _renderAppointmentGeometry: function _renderAppointmentGeometry() {\n    var geometry = this.option(\"geometry\");\n    var $element = this.$element();\n    (0, _translator.move)($element, {\n      top: geometry.top,\n      left: geometry.left\n    });\n    $element.css({\n      width: geometry.width < 0 ? 0 : geometry.width,\n      height: geometry.height < 0 ? 0 : geometry.height\n    });\n  },\n  _renderEmptyClass: function _renderEmptyClass() {\n    var geometry = this.option(\"geometry\");\n\n    if (geometry.empty || this.option(\"isCompact\")) {\n      this.$element().addClass(_constants.EMPTY_APPOINTMENT_CLASS);\n    }\n  },\n  _renderReducedAppointment: function _renderReducedAppointment() {\n    var reducedPart = this.option(\"reduced\");\n\n    if (!reducedPart) {\n      return;\n    }\n\n    this.$element().toggleClass(_constants.REDUCED_APPOINTMENT_CLASS, true).toggleClass(_constants.REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\n\n    this._renderAppointmentReducedIcon();\n  },\n  _renderAppointmentReducedIcon: function _renderAppointmentReducedIcon() {\n    var $icon = (0, _renderer.default)(\"<div>\").addClass(_constants.REDUCED_APPOINTMENT_ICON).appendTo(this.$element());\n\n    var endDate = this._getEndDate();\n\n    var tooltipLabel = _message.default.format(\"dxScheduler-editorLabelEndDate\");\n\n    var tooltipText = [tooltipLabel, \": \", _date.default.format(endDate, \"monthAndDay\"), \", \", _date.default.format(endDate, \"year\")].join(\"\");\n\n    _events_engine.default.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\n\n    _events_engine.default.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, function () {\n      (0, _ui.show)({\n        target: $icon,\n        content: tooltipText\n      });\n    });\n\n    _events_engine.default.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\n\n    _events_engine.default.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, function () {\n      (0, _ui.hide)();\n    });\n  },\n  _getEndDate: function _getEndDate() {\n    var result = this.invoke(\"getField\", \"endDate\", this.option(\"data\"));\n\n    if (result) {\n      return new Date(result);\n    }\n\n    return result;\n  },\n  _renderAllDayClass: function _renderAllDayClass() {\n    this.$element().toggleClass(_constants.ALL_DAY_APPOINTMENT_CLASS, !!this.option(\"allDay\"));\n  },\n  _renderDragSourceClass: function _renderDragSourceClass() {\n    this.$element().toggleClass(_constants.APPOINTMENT_DRAG_SOURCE_CLASS, !!this.option(\"isDragSource\"));\n  },\n  _renderRecurrenceClass: function _renderRecurrenceClass() {\n    var rule = this.invoke(\"getField\", \"recurrenceRule\", this.option(\"data\"));\n\n    if ((0, _recurrence.getRecurrenceProcessor)().isValidRecurrenceRule(rule)) {\n      this.$element().addClass(_constants.RECURRENCE_APPOINTMENT_CLASS);\n    }\n  },\n  _renderDirection: function _renderDirection() {\n    this.$element().addClass(_constants.DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")]);\n  },\n  _createResizingConfig: function _createResizingConfig() {\n    var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\n\n    if (!this.invoke(\"isGroupedByDate\")) {\n      config.stepPrecision = \"strict\";\n    }\n\n    return config;\n  },\n  _renderResizable: function _renderResizable() {\n    if (this.option(\"allowResize\")) {\n      this._createComponent(this.$element(), _resizable.default, (0, _extend.extend)(this._createResizingConfig(), this.option(\"resizableConfig\")));\n    }\n  },\n  _useTemplates: function _useTemplates() {\n    return false;\n  }\n}).include(_uiScheduler.default);\n\n(0, _component_registrator.default)(\"dxSchedulerAppointment\", Appointment);\nvar _default = Appointment;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["F:/webfe/node_modules/devextreme/ui/scheduler/ui.scheduler.appointment.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_events_engine","_translator","_recurrence","_extend","_component_registrator","_ui","_uiScheduler","_index","_pointer","_dom_component","_resizable","_message","_date","_constants","obj","__esModule","DEFAULT_HORIZONTAL_HANDLES","DEFAULT_VERTICAL_HANDLES","REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME","addNamespace","enter","REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME","leave","Appointment","inherit","_getDefaultOptions","extend","callBase","data","geometry","top","left","width","height","allowDrag","allowResize","reduced","isCompact","direction","resizableConfig","cellHeight","cellWidth","isDragSource","_optionChanged","args","name","_invalidate","_renderDragSourceClass","_getHorizontalResizingRule","reducedHandles","head","option","body","tail","handles","minHeight","minWidth","invoke","step","roundStepValue","_getVerticalResizingRule","_render","_renderAppointmentGeometry","_renderEmptyClass","_renderReducedAppointment","_renderAllDayClass","_renderDirection","$element","attr","_renderRecurrenceClass","_renderResizable","move","css","empty","addClass","EMPTY_APPOINTMENT_CLASS","reducedPart","toggleClass","REDUCED_APPOINTMENT_CLASS","REDUCED_APPOINTMENT_PARTS_CLASSES","_renderAppointmentReducedIcon","$icon","REDUCED_APPOINTMENT_ICON","appendTo","endDate","_getEndDate","tooltipLabel","format","tooltipText","join","off","on","show","target","content","hide","result","Date","ALL_DAY_APPOINTMENT_CLASS","APPOINTMENT_DRAG_SOURCE_CLASS","rule","getRecurrenceProcessor","isValidRecurrenceRule","RECURRENCE_APPOINTMENT_CLASS","DIRECTION_APPOINTMENT_CLASSES","_createResizingConfig","config","stepPrecision","_createComponent","_useTemplates","include","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment.js)\r\n * Version: 20.2.5\r\n * Build date: Fri Jan 15 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _recurrence = require(\"./recurrence\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _component_registrator = _interopRequireDefault(require(\"../../core/component_registrator\"));\r\nvar _ui = require(\"../tooltip/ui.tooltip\");\r\nvar _uiScheduler = _interopRequireDefault(require(\"./ui.scheduler.publisher_mixin\"));\r\nvar _index = require(\"../../events/utils/index\");\r\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\r\nvar _dom_component = _interopRequireDefault(require(\"../../core/dom_component\"));\r\nvar _resizable = _interopRequireDefault(require(\"../resizable\"));\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _date = _interopRequireDefault(require(\"../../localization/date\"));\r\nvar _constants = require(\"./constants\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\r\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\r\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = (0, _index.addNamespace)(_pointer.default.enter, \"dxSchedulerAppointment\");\r\nvar REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = (0, _index.addNamespace)(_pointer.default.leave, \"dxSchedulerAppointment\");\r\nvar Appointment = _dom_component.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            data: {},\r\n            geometry: {\r\n                top: 0,\r\n                left: 0,\r\n                width: 0,\r\n                height: 0\r\n            },\r\n            allowDrag: true,\r\n            allowResize: true,\r\n            reduced: null,\r\n            isCompact: false,\r\n            direction: \"vertical\",\r\n            resizableConfig: {},\r\n            cellHeight: 0,\r\n            cellWidth: 0,\r\n            isDragSource: false\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"data\":\r\n            case \"geometry\":\r\n            case \"allowDrag\":\r\n            case \"allowResize\":\r\n            case \"reduced\":\r\n            case \"sortedIndex\":\r\n            case \"isCompact\":\r\n            case \"direction\":\r\n            case \"resizableConfig\":\r\n            case \"cellHeight\":\r\n            case \"cellWidth\":\r\n                this._invalidate();\r\n                break;\r\n            case \"isDragSource\":\r\n                this._renderDragSourceClass();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _getHorizontalResizingRule: function() {\r\n        var reducedHandles = {\r\n            head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\r\n            body: \"\",\r\n            tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\r\n        };\r\n        return {\r\n            handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\r\n            minHeight: 0,\r\n            minWidth: this.invoke(\"getCellWidth\"),\r\n            step: this.invoke(\"getResizableStep\"),\r\n            roundStepValue: false\r\n        }\r\n    },\r\n    _getVerticalResizingRule: function() {\r\n        var height = this.invoke(\"getCellHeight\");\r\n        return {\r\n            handles: DEFAULT_VERTICAL_HANDLES,\r\n            minWidth: 0,\r\n            minHeight: height,\r\n            step: height,\r\n            roundStepValue: true\r\n        }\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderAppointmentGeometry();\r\n        this._renderEmptyClass();\r\n        this._renderReducedAppointment();\r\n        this._renderAllDayClass();\r\n        this._renderDragSourceClass();\r\n        this._renderDirection();\r\n        this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\r\n        this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.option(\"data\")));\r\n        this.$element().attr(\"role\", \"button\");\r\n        this._renderRecurrenceClass();\r\n        this._renderResizable()\r\n    },\r\n    _renderAppointmentGeometry: function() {\r\n        var geometry = this.option(\"geometry\");\r\n        var $element = this.$element();\r\n        (0, _translator.move)($element, {\r\n            top: geometry.top,\r\n            left: geometry.left\r\n        });\r\n        $element.css({\r\n            width: geometry.width < 0 ? 0 : geometry.width,\r\n            height: geometry.height < 0 ? 0 : geometry.height\r\n        })\r\n    },\r\n    _renderEmptyClass: function() {\r\n        var geometry = this.option(\"geometry\");\r\n        if (geometry.empty || this.option(\"isCompact\")) {\r\n            this.$element().addClass(_constants.EMPTY_APPOINTMENT_CLASS)\r\n        }\r\n    },\r\n    _renderReducedAppointment: function() {\r\n        var reducedPart = this.option(\"reduced\");\r\n        if (!reducedPart) {\r\n            return\r\n        }\r\n        this.$element().toggleClass(_constants.REDUCED_APPOINTMENT_CLASS, true).toggleClass(_constants.REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\r\n        this._renderAppointmentReducedIcon()\r\n    },\r\n    _renderAppointmentReducedIcon: function() {\r\n        var $icon = (0, _renderer.default)(\"<div>\").addClass(_constants.REDUCED_APPOINTMENT_ICON).appendTo(this.$element());\r\n        var endDate = this._getEndDate();\r\n        var tooltipLabel = _message.default.format(\"dxScheduler-editorLabelEndDate\");\r\n        var tooltipText = [tooltipLabel, \": \", _date.default.format(endDate, \"monthAndDay\"), \", \", _date.default.format(endDate, \"year\")].join(\"\");\r\n        _events_engine.default.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\r\n        _events_engine.default.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, function() {\r\n            (0, _ui.show)({\r\n                target: $icon,\r\n                content: tooltipText\r\n            })\r\n        });\r\n        _events_engine.default.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\r\n        _events_engine.default.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, function() {\r\n            (0, _ui.hide)()\r\n        })\r\n    },\r\n    _getEndDate: function() {\r\n        var result = this.invoke(\"getField\", \"endDate\", this.option(\"data\"));\r\n        if (result) {\r\n            return new Date(result)\r\n        }\r\n        return result\r\n    },\r\n    _renderAllDayClass: function() {\r\n        this.$element().toggleClass(_constants.ALL_DAY_APPOINTMENT_CLASS, !!this.option(\"allDay\"))\r\n    },\r\n    _renderDragSourceClass: function() {\r\n        this.$element().toggleClass(_constants.APPOINTMENT_DRAG_SOURCE_CLASS, !!this.option(\"isDragSource\"))\r\n    },\r\n    _renderRecurrenceClass: function() {\r\n        var rule = this.invoke(\"getField\", \"recurrenceRule\", this.option(\"data\"));\r\n        if ((0, _recurrence.getRecurrenceProcessor)().isValidRecurrenceRule(rule)) {\r\n            this.$element().addClass(_constants.RECURRENCE_APPOINTMENT_CLASS)\r\n        }\r\n    },\r\n    _renderDirection: function() {\r\n        this.$element().addClass(_constants.DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")])\r\n    },\r\n    _createResizingConfig: function() {\r\n        var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\r\n        if (!this.invoke(\"isGroupedByDate\")) {\r\n            config.stepPrecision = \"strict\"\r\n        }\r\n        return config\r\n    },\r\n    _renderResizable: function() {\r\n        if (this.option(\"allowResize\")) {\r\n            this._createComponent(this.$element(), _resizable.default, (0, _extend.extend)(this._createResizingConfig(), this.option(\"resizableConfig\")))\r\n        }\r\n    },\r\n    _useTemplates: function() {\r\n        return false\r\n    }\r\n}).include(_uiScheduler.default);\r\n(0, _component_registrator.default)(\"dxSchedulerAppointment\", Appointment);\r\nvar _default = Appointment;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}